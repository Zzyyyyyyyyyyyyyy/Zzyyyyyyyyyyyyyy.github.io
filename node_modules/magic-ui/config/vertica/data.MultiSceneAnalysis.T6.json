{
  "module": "MultiSceneAnalysis.T6",
  "flag": "vertical",
  "configs": [
    {
      "key": "dataMultiSceneAnalysisT6",
      "desc": "LTE室内外场景分析-网间业务指标统计",
      "config": {
        "parameters": [
          {
            "name": "p_en",
            "columnname": "",
            "type": "string",
            "format": "",
            "conditionid": "c0",
            "symbol": ""
          },
          {
            "name": "starttime",
            "columnname": "",
            "type": "string",
            "format": "",
            "conditionid": "c1",
            "symbol": ""
          },
          {
            "name": "endtime",
            "columnname": "",
            "type": "string",
            "format": "",
            "conditionid": "c2",
            "symbol": ""
          }, {
            "name": "province",
            "columnname": "",
            "type":"string",
            "format": "",
            "conditionid": "c3",
            "symbol":""
          }
        ],
     "value":"SELECT      city,      data1,      data2,      data3,      data4,      data5,      data6,      data7,      data8,      data9,      data10,      data11,      data12,      data13,      data14,      data15,      data16,      data17,      data18,      data19,      data20,      data21,      data22,      data23,      data24,      data25,      data26,      data27,      data28,      data29,      data30,      data31,      data32,      data33,      data34,      data35,      data36,      data37,      data38,      data39,      data40,      data41,      data42,      data43,      data44,      data45,      data46,      data47,      data48,      data49  FROM      (          SELECT              tb2.city,              '全网' AS data1,              '全网' AS data2,              ROUND(SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>0                      THEN delay                      ELSE 0                  END)/1000/60,2.0) AS data3,              ROUND(SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>0                      THEN delay                      ELSE 0                  END)/MAX(tb1.sumdelay),2.0) AS data4 ,              ROUND(SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>0                      THEN delay                      ELSE 0                  END)/1000/60,2.0) AS data5,              ROUND( SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>0                      THEN delay                      ELSE 0                  END)/MAX(tb1.sumdelay),2.0) AS data6 ,              ROUND(SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>0                      THEN dl_flow                      ELSE 0                  END)/1024/1024,2.0) AS data7,              ROUND( SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>0                      THEN dl_flow                      ELSE 0                  END)/MAX(tb1.sumdl_flow),2.0) AS data8 ,              ROUND( SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>0                      THEN dl_flow                      ELSE 0                  END)/1024/1024,2.0) AS data9,              ROUND( SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>0                      THEN dl_flow                      ELSE 0                  END)/MAX(tb1.sumdl_flow) ,2.0)AS data10 ,              ROUND(SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>0                      THEN delay                      ELSE 0                  END)/1000/60,2.0) AS data41,              ROUND(SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>0                      THEN dl_flow                      ELSE 0                  END)/1024/1024,2.0) AS data42 ,              ROUND( SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>0                      THEN dl_flow                      ELSE 0                  END)/SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>0                      THEN delay                      ELSE 0                  END)*8000/1024,2.0) AS data43,              ROUND(SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>0                      THEN delay                      ELSE 0                  END)/1000/60,2.0) AS data44,              ROUND( SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>0                      THEN dl_flow                      ELSE 0                  END)/1024/1024,2.0) AS data45 ,              ROUND( SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>0                      THEN dl_flow                      ELSE 0                  END)/SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>0                      THEN delay                      ELSE 0                  END)*8000/1024,2.0) AS data46,              ROUND(SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>0                      THEN delay                      ELSE 0                  END)/1000/60,2.0) AS data47,              ROUND( SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>0                      THEN dl_flow                      ELSE 0                  END)/1024/1024,2.0) AS data48,              ROUND(SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>0                      THEN dl_flow                      ELSE 0                  END)/SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>0                      THEN delay                      ELSE 0                  END)*8000/1024,2.0) AS data49 ,              ROUND(SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN delay                      ELSE 0                  END)/1000/60,2.0) AS data11,              ROUND(SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN dl_flow                      ELSE 0                  END)/1024/1024,2.0) AS data12,              ROUND( SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN dl_flow                      ELSE 0                  END)/SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN delay                      ELSE 0                  END)*8000/1024,2.0) AS data13,              SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END) AS data14,              SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN satisfied_sucess_xdr_count                      ELSE 0                  END) AS data15 ,              ROUND(SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN satisfied_sucess_xdr_count                      ELSE 0                  END)/SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END),2.0) AS data16,              SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END) AS data17,              SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN satisfied_speed_xdr_count                      ELSE 0                  END) AS data18 ,              ROUND(SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN satisfied_speed_xdr_count                      ELSE 0                  END)/SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END),2.0) AS data19,              ROUND(SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN satisfied_sucess_xdr_count*satisfied_speed_xdr_count                      ELSE 0                  END)/SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN satisfied_xdr_count*satisfied_xdr_count                      ELSE 0                  END),2.0) AS data20,              ROUND(SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN delay                      ELSE 0                  END)/1000/60,2.0) AS data21,              ROUND(SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN dl_flow                      ELSE 0                  END)/1024/1024,2.0) AS data22,              ROUND( SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN dl_flow                      ELSE 0                  END)/SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN delay                      ELSE 0                  END)*8000/1024,2.0) AS data23,              SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END) AS data24,              SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN satisfied_sucess_xdr_count                      ELSE 0                  END) AS data25 ,              ROUND( SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN satisfied_sucess_xdr_count                      ELSE 0                  END)/SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END),2.0) AS data26,              SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END) AS data27,              SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN satisfied_speed_xdr_count                      ELSE 0                  END) AS data28 ,              ROUND( SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN satisfied_speed_xdr_count                      ELSE 0                  END)/SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END),2.0) AS data29,              ROUND( SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN satisfied_sucess_xdr_count*satisfied_speed_xdr_count                      ELSE 0                  END)/SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN satisfied_xdr_count*satisfied_xdr_count                      ELSE 0                  END),2.0) AS data30,              ROUND( SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN delay                      ELSE 0                  END)/1000/60,2.0) AS data31,              ROUND(SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN dl_flow                      ELSE 0                  END)/1024/1024,2.0) AS data32,              ROUND(SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN dl_flow                      ELSE 0                  END)/SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN delay                      ELSE 0                  END)*8000/1024,2.0) AS data33,              SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END) AS data34,              SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN satisfied_sucess_xdr_count                      ELSE 0                  END) AS data35 ,              ROUND(SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN satisfied_sucess_xdr_count                      ELSE 0                  END)/SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END),2.0) AS data36,              SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END) AS data37,              SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN satisfied_speed_xdr_count                      ELSE 0                  END) AS data38 ,              ROUND(SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN satisfied_speed_xdr_count                      ELSE 0                  END)/SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END),2.0) AS data39,              ROUND( SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN satisfied_sucess_xdr_count*satisfied_speed_xdr_count                      ELSE 0                  END)/SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN satisfied_xdr_count*satisfied_xdr_count                      ELSE 0                  END),2.0) AS data40          FROM              lte_sys.[@c0]_T_QUALITYSTATISTICS_ALLUSER tb2          LEFT JOIN              (                  SELECT                      city,                      SUM(xdr_count) sumcnt,                      SUM(delay)     sumdelay,                      SUM(dl_flow)   sumdl_flow                  FROM                      lte_sys.[@c0]_T_QUALITYSTATISTICS_ALLUSER                  WHERE                      nettype IN (1,2)                  AND AppType IN(15,1,5,6,7,8)                  AND hour>='[@c1]'                  AND hour<='[@c2]'                  GROUP BY                      city)tb1          ON              tb2.city=tb1.city          WHERE              nettype IN (1,2)          AND AppType IN(15,1,5,6,7,8)          AND hour>='[@c1]'          AND hour<='[@c2]'          GROUP BY              tb2.city          UNION          SELECT              tb2.city,              '全网' AS data1,              (                  CASE                      WHEN AppType=1                      THEN '即时通信'                      WHEN AppType=15                      THEN '浏览下载'                      WHEN AppType=5                      THEN '视频'                      WHEN AppType=6                      THEN '音乐'                      WHEN AppType=7                      THEN '应用商店'                      WHEN AppType=8                      THEN '游戏'                  END ) AS data2,              ROUND(SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>0                      THEN delay                      ELSE 0                  END)/1000/60,2.0) AS data3,              ROUND(SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>0                      THEN delay                      ELSE 0                  END)/MAX(tb1.sumdelay),2.0) AS data4 ,              ROUND(SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>0                      THEN delay                      ELSE 0                  END)/1000/60,2.0) AS data5,              ROUND( SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>0                      THEN delay                      ELSE 0                  END)/MAX(tb1.sumdelay),2.0) AS data6 ,              ROUND(SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>0                      THEN dl_flow                      ELSE 0                  END)/1024/1024,2.0) AS data7,              ROUND( SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>0                      THEN dl_flow                      ELSE 0                  END)/MAX(tb1.sumdl_flow),2.0) AS data8 ,              ROUND( SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>0                      THEN dl_flow                      ELSE 0                  END)/1024/1024,2.0) AS data9,              ROUND( SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>0                      THEN dl_flow                      ELSE 0                  END)/MAX(tb1.sumdl_flow) ,2.0)AS data10 ,              ROUND(SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>0                      THEN delay                      ELSE 0                  END)/1000/60,2.0) AS data41,              ROUND(SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>0                      THEN dl_flow                      ELSE 0                  END)/1024/1024,2.0) AS data42 ,              ROUND( SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>0                      THEN dl_flow                      ELSE 0                  END)/SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>0                      THEN delay                      ELSE 0                  END)*8000/1024,2.0) AS data43,              ROUND(SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>0                      THEN delay                      ELSE 0                  END)/1000/60,2.0) AS data44,              ROUND( SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>0                      THEN dl_flow                      ELSE 0                  END)/1024/1024,2.0) AS data45 ,              ROUND( SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>0                      THEN dl_flow                      ELSE 0                  END)/SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>0                      THEN delay                      ELSE 0                  END)*8000/1024,2.0) AS data46,              ROUND(SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>0                      THEN delay                      ELSE 0                  END)/1000/60,2.0) AS data47,              ROUND( SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>0                      THEN dl_flow                      ELSE 0                  END)/1024/1024,2.0) AS data48,              ROUND(SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>0                      THEN dl_flow                      ELSE 0                  END)/SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>0                      THEN delay                      ELSE 0                  END)*8000/1024,2.0) AS data49 ,              ROUND(SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN delay                      ELSE 0                  END)/1000/60,2.0) AS data11,              ROUND(SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN dl_flow                      ELSE 0                  END)/1024/1024,2.0) AS data12,              ROUND( SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN dl_flow                      ELSE 0                  END)/SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN delay                      ELSE 0                  END)*8000/1024,2.0) AS data13,              SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END) AS data14,              SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN satisfied_sucess_xdr_count                      ELSE 0                  END) AS data15 ,              ROUND(SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN satisfied_sucess_xdr_count                      ELSE 0                  END)/SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END),2.0) AS data16,              SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END) AS data17,              SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN satisfied_speed_xdr_count                      ELSE 0                  END) AS data18 ,              ROUND(SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN satisfied_speed_xdr_count                      ELSE 0                  END)/SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END),2.0) AS data19,              ROUND(SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN satisfied_sucess_xdr_count*satisfied_speed_xdr_count                      ELSE 0                  END)/SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN satisfied_xdr_count*satisfied_xdr_count                      ELSE 0                  END),2.0) AS data20,              ROUND(SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN delay                      ELSE 0                  END)/1000/60,2.0) AS data21,              ROUND(SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN dl_flow                      ELSE 0                  END)/1024/1024,2.0) AS data22,              ROUND( SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN dl_flow                      ELSE 0                  END)/SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN delay                      ELSE 0                  END)*8000/1024,2.0) AS data23,              SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END) AS data24,              SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN satisfied_sucess_xdr_count                      ELSE 0                  END) AS data25 ,              ROUND( SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN satisfied_sucess_xdr_count                      ELSE 0                  END)/SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END),2.0) AS data26,              SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END) AS data27,              SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN satisfied_speed_xdr_count                      ELSE 0                  END) AS data28 ,              ROUND( SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN satisfied_speed_xdr_count                      ELSE 0                  END)/SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END),2.0) AS data29,              ROUND( SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN satisfied_sucess_xdr_count*satisfied_speed_xdr_count                      ELSE 0                  END)/SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN satisfied_xdr_count*satisfied_xdr_count                      ELSE 0                  END),2.0) AS data30,              ROUND( SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN delay                      ELSE 0                  END)/1000/60,2.0) AS data31,              ROUND(SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN dl_flow                      ELSE 0                  END)/1024/1024,2.0) AS data32,              ROUND(SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN dl_flow                      ELSE 0                  END)/SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN delay                      ELSE 0                  END)*8000/1024,2.0) AS data33,              SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END) AS data34,              SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN satisfied_sucess_xdr_count                      ELSE 0                  END) AS data35 ,              ROUND(SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN satisfied_sucess_xdr_count                      ELSE 0                  END)/SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END),2.0) AS data36,              SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END) AS data37,              SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN satisfied_speed_xdr_count                      ELSE 0                  END) AS data38 ,              ROUND(SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN satisfied_speed_xdr_count                      ELSE 0                  END)/SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END),2.0) AS data39,              ROUND( SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN satisfied_sucess_xdr_count*satisfied_speed_xdr_count                      ELSE 0                  END)/SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN satisfied_xdr_count*satisfied_xdr_count                      ELSE 0                  END),2.0) AS data40          FROM              lte_sys.[@c0]_T_QUALITYSTATISTICS_ALLUSER tb2          LEFT JOIN              (                  SELECT                      city,                      SUM(xdr_count) sumcnt,                      SUM(delay)     sumdelay,                      SUM(dl_flow)   sumdl_flow                  FROM                      lte_sys.[@c0]_T_QUALITYSTATISTICS_ALLUSER                  WHERE                      nettype IN (1,2)                  AND AppType IN(15,1,5,6,7,8)                  AND hour>='[@c1]'                  AND hour<='[@c2]'                  GROUP BY                      city)tb1          ON              tb2.city=tb1.city          WHERE              nettype IN (1,2)          AND AppType IN(15,1,5,6,7,8)          AND hour>='[@c1]'          AND hour<='[@c2]'          GROUP BY              tb2.city,              tb2.AppType          UNION          SELECT              tb2.city,              CASE                  WHEN tb2.scene1=1                  THEN '室外用户'                  WHEN tb2.scene1=2                  THEN '占用室分的室内稳定用户(有室分)'                  WHEN tb2.scene1=3                  THEN '占用宏站的室内稳定用户(无室分)'                  WHEN tb2.scene1=4                  THEN '室内稳定用户(占用宏站和室分)'                  ELSE '未知场景'              END AS data1,              CASE                  WHEN tb2.scene1=1                  THEN '室外用户'                  WHEN tb2.scene1=2                  THEN '占用室分的室内稳定用户(有室分)'                  WHEN tb2.scene1=3                  THEN '占用宏站的室内稳定用户(无室分)'                  WHEN tb2.scene1=4                  THEN '室内稳定用户(占用宏站和室分)'                  ELSE '未知场景'              END AS data2,              ROUND(SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>0                      THEN delay                      ELSE 0                  END)/1000/60,2.0) AS data3,              ROUND(SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>0                      THEN delay                      ELSE 0                  END)/MAX(tb1.sumdelay),2.0) AS data4 ,              ROUND(SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>0                      THEN delay                      ELSE 0                  END)/1000/60,2.0) AS data5,              ROUND( SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>0                      THEN delay                      ELSE 0                  END)/MAX(tb1.sumdelay),2.0) AS data6 ,              ROUND(SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>0                      THEN dl_flow                      ELSE 0                  END)/1024/1024,2.0) AS data7,              ROUND( SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>0                      THEN dl_flow                      ELSE 0                  END)/MAX(tb1.sumdl_flow),2.0) AS data8 ,              ROUND( SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>0                      THEN dl_flow                      ELSE 0                  END)/1024/1024,2.0) AS data9,              ROUND( SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>0                      THEN dl_flow                      ELSE 0                  END)/MAX(tb1.sumdl_flow) ,2.0)AS data10 ,              ROUND(SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>0                      THEN delay                      ELSE 0                  END)/1000/60,2.0) AS data41,              ROUND(SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>0                      THEN dl_flow                      ELSE 0                  END)/1024/1024,2.0) AS data42 ,              ROUND( SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>0                      THEN dl_flow                      ELSE 0                  END)/SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>0                      THEN delay                      ELSE 0                  END)*8000/1024,2.0) AS data43,              ROUND(SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>0                      THEN delay                      ELSE 0                  END)/1000/60,2.0) AS data44,              ROUND( SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>0                      THEN dl_flow                      ELSE 0                  END)/1024/1024,2.0) AS data45 ,              ROUND( SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>0                      THEN dl_flow                      ELSE 0                  END)/SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>0                      THEN delay                      ELSE 0                  END)*8000/1024,2.0) AS data46,              ROUND(SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>0                      THEN delay                      ELSE 0                  END)/1000/60,2.0) AS data47,              ROUND( SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>0                      THEN dl_flow                      ELSE 0                  END)/1024/1024,2.0) AS data48,              ROUND(SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>0                      THEN dl_flow                      ELSE 0                  END)/SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>0                      THEN delay                      ELSE 0                  END)*8000/1024,2.0) AS data49 ,              ROUND(SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN delay                      ELSE 0                  END)/1000/60,2.0) AS data11,              ROUND(SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN dl_flow                      ELSE 0                  END)/1024/1024,2.0) AS data12,              ROUND( SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN dl_flow                      ELSE 0                  END)/SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN delay                      ELSE 0                  END)*8000/1024,2.0) AS data13,              SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END) AS data14,              SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN satisfied_sucess_xdr_count                      ELSE 0                  END) AS data15 ,              ROUND(SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN satisfied_sucess_xdr_count                      ELSE 0                  END)/SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END),2.0) AS data16,              SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END) AS data17,              SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN satisfied_speed_xdr_count                      ELSE 0                  END) AS data18 ,              ROUND(SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN satisfied_speed_xdr_count                      ELSE 0                  END)/SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END),2.0) AS data19,              ROUND(SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN satisfied_sucess_xdr_count*satisfied_speed_xdr_count                      ELSE 0                  END)/SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN satisfied_xdr_count*satisfied_xdr_count                      ELSE 0                  END),2.0) AS data20,              ROUND(SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN delay                      ELSE 0                  END)/1000/60,2.0) AS data21,              ROUND(SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN dl_flow                      ELSE 0                  END)/1024/1024,2.0) AS data22,              ROUND( SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN dl_flow                      ELSE 0                  END)/SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN delay                      ELSE 0                  END)*8000/1024,2.0) AS data23,              SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END) AS data24,              SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN satisfied_sucess_xdr_count                      ELSE 0                  END) AS data25 ,              ROUND( SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN satisfied_sucess_xdr_count                      ELSE 0                  END)/SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END),2.0) AS data26,              SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END) AS data27,              SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN satisfied_speed_xdr_count                      ELSE 0                  END) AS data28 ,              ROUND( SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN satisfied_speed_xdr_count                      ELSE 0                  END)/SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END),2.0) AS data29,              ROUND( SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN satisfied_sucess_xdr_count*satisfied_speed_xdr_count                      ELSE 0                  END)/SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN satisfied_xdr_count*satisfied_xdr_count                      ELSE 0                  END),2.0) AS data30,              ROUND( SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN delay                      ELSE 0                  END)/1000/60,2.0) AS data31,              ROUND(SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN dl_flow                      ELSE 0                  END)/1024/1024,2.0) AS data32,              ROUND(SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN dl_flow                      ELSE 0                  END)/SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN delay                      ELSE 0                  END)*8000/1024,2.0) AS data33,              SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END) AS data34,              SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN satisfied_sucess_xdr_count                      ELSE 0                  END) AS data35 ,              ROUND(SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN satisfied_sucess_xdr_count                      ELSE 0                  END)/SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END),2.0) AS data36,              SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END) AS data37,              SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN satisfied_speed_xdr_count                      ELSE 0                  END) AS data38 ,              ROUND(SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN satisfied_speed_xdr_count                      ELSE 0                  END)/SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END),2.0) AS data39,              ROUND( SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN satisfied_sucess_xdr_count*satisfied_speed_xdr_count                      ELSE 0                  END)/SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN satisfied_xdr_count*satisfied_xdr_count                      ELSE 0                  END),2.0) AS data40          FROM              lte_sys.[@c0]_T_QUALITYSTATISTICS_ALLUSER tb2          LEFT JOIN              (                  SELECT                      city,                      scene1,                      SUM(xdr_count) sumcnt,                      SUM(delay)     sumdelay,                      SUM(dl_flow)   sumdl_flow                  FROM                      lte_sys.[@c0]_T_QUALITYSTATISTICS_ALLUSER                  WHERE                      nettype IN (1,2)                  AND AppType IN(15,1,5,6,7,8)                  AND hour>='[@c1]'                  AND hour<='[@c2]'                  GROUP BY                      city,                      scene1)tb1          ON              tb2.city=tb1.city          AND tb2.scene1=tb1.scene1          WHERE              nettype IN (1,2)          AND AppType IN(15,1,5,6,7,8)          AND hour>='[@c1]'          AND hour<='[@c2]'          GROUP BY              tb2.city,              tb2.scene1          UNION          SELECT              tb2.city,              CASE                  WHEN tb2.scene1=1                  THEN '室外用户'                  WHEN tb2.scene1=2                  THEN '占用室分的室内稳定用户(有室分)'                  WHEN tb2.scene1=3                  THEN '占用宏站的室内稳定用户(无室分)'                  WHEN tb2.scene1=4                  THEN '室内稳定用户(占用宏站和室分)'                  ELSE '未知场景'              END AS data1,              (                  CASE                      WHEN AppType=1                      THEN '即时通信'                      WHEN AppType=15                      THEN '浏览下载'                      WHEN AppType=5                      THEN '视频'                      WHEN AppType=6                      THEN '音乐'                      WHEN AppType=7                      THEN '应用商店'                      WHEN AppType=8                      THEN '游戏'                  END ) AS data2,              ROUND(SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>0                      THEN delay                      ELSE 0                  END)/1000/60,2.0) AS data3,              ROUND(SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>0                      THEN delay                      ELSE 0                  END)/MAX(tb1.sumdelay),2.0) AS data4 ,              ROUND(SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>0                      THEN delay                      ELSE 0                  END)/1000/60,2.0) AS data5,              ROUND( SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>0                      THEN delay                      ELSE 0                  END)/MAX(tb1.sumdelay),2.0) AS data6 ,              ROUND(SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>0                      THEN dl_flow                      ELSE 0                  END)/1024/1024,2.0) AS data7,              ROUND( SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>0                      THEN dl_flow                      ELSE 0                  END)/MAX(tb1.sumdl_flow),2.0) AS data8 ,              ROUND( SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>0                      THEN dl_flow                      ELSE 0                  END)/1024/1024,2.0) AS data9,              ROUND( SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>0                      THEN dl_flow                      ELSE 0                  END)/MAX(tb1.sumdl_flow) ,2.0)AS data10 ,              ROUND(SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>0                      THEN delay                      ELSE 0                  END)/1000/60,2.0) AS data41,              ROUND(SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>0                      THEN dl_flow                      ELSE 0                  END)/1024/1024,2.0) AS data42 ,              ROUND( SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>0                      THEN dl_flow                      ELSE 0                  END)/SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>0                      THEN delay                      ELSE 0                  END)*8000/1024,2.0) AS data43,              ROUND(SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>0                      THEN delay                      ELSE 0                  END)/1000/60,2.0) AS data44,              ROUND( SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>0                      THEN dl_flow                      ELSE 0                  END)/1024/1024,2.0) AS data45 ,              ROUND( SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>0                      THEN dl_flow                      ELSE 0                  END)/SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>0                      THEN delay                      ELSE 0                  END)*8000/1024,2.0) AS data46,              ROUND(SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>0                      THEN delay                      ELSE 0                  END)/1000/60,2.0) AS data47,              ROUND( SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>0                      THEN dl_flow                      ELSE 0                  END)/1024/1024,2.0) AS data48,              ROUND(SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>0                      THEN dl_flow                      ELSE 0                  END)/SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>0                      THEN delay                      ELSE 0                  END)*8000/1024,2.0) AS data49 ,              ROUND(SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN delay                      ELSE 0                  END)/1000/60,2.0) AS data11,              ROUND(SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN dl_flow                      ELSE 0                  END)/1024/1024,2.0) AS data12,              ROUND( SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN dl_flow                      ELSE 0                  END)/SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN delay                      ELSE 0                  END)*8000/1024,2.0) AS data13,              SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END) AS data14,              SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN satisfied_sucess_xdr_count                      ELSE 0                  END) AS data15 ,              ROUND(SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN satisfied_sucess_xdr_count                      ELSE 0                  END)/SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END),2.0) AS data16,              SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END) AS data17,              SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN satisfied_speed_xdr_count                      ELSE 0                  END) AS data18 ,              ROUND(SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN satisfied_speed_xdr_count                      ELSE 0                  END)/SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END),2.0) AS data19,              ROUND(SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN satisfied_sucess_xdr_count*satisfied_speed_xdr_count                      ELSE 0                  END)/SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN satisfied_xdr_count*satisfied_xdr_count                      ELSE 0                  END),2.0) AS data20,              ROUND(SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN delay                      ELSE 0                  END)/1000/60,2.0) AS data21,              ROUND(SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN dl_flow                      ELSE 0                  END)/1024/1024,2.0) AS data22,              ROUND( SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN dl_flow                      ELSE 0                  END)/SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN delay                      ELSE 0                  END)*8000/1024,2.0) AS data23,              SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END) AS data24,              SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN satisfied_sucess_xdr_count                      ELSE 0                  END) AS data25 ,              ROUND( SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN satisfied_sucess_xdr_count                      ELSE 0                  END)/SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END),2.0) AS data26,              SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END) AS data27,              SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN satisfied_speed_xdr_count                      ELSE 0                  END) AS data28 ,              ROUND( SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN satisfied_speed_xdr_count                      ELSE 0                  END)/SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END),2.0) AS data29,              ROUND( SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN satisfied_sucess_xdr_count*satisfied_speed_xdr_count                      ELSE 0                  END)/SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN satisfied_xdr_count*satisfied_xdr_count                      ELSE 0                  END),2.0) AS data30,              ROUND( SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN delay                      ELSE 0                  END)/1000/60,2.0) AS data31,              ROUND(SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN dl_flow                      ELSE 0                  END)/1024/1024,2.0) AS data32,              ROUND(SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN dl_flow                      ELSE 0                  END)/SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN delay                      ELSE 0                  END)*8000/1024,2.0) AS data33,              SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END) AS data34,              SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN satisfied_sucess_xdr_count                      ELSE 0                  END) AS data35 ,              ROUND(SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN satisfied_sucess_xdr_count                      ELSE 0                  END)/SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END),2.0) AS data36,              SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END) AS data37,              SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN satisfied_speed_xdr_count                      ELSE 0                  END) AS data38 ,              ROUND(SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN satisfied_speed_xdr_count                      ELSE 0                  END)/SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END),2.0) AS data39,              ROUND( SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN satisfied_sucess_xdr_count*satisfied_speed_xdr_count                      ELSE 0                  END)/SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN satisfied_xdr_count*satisfied_xdr_count                      ELSE 0                  END),2.0) AS data40          FROM              lte_sys.[@c0]_T_QUALITYSTATISTICS_ALLUSER tb2          LEFT JOIN              (                  SELECT                      city,                      scene1,                      SUM(xdr_count) sumcnt,                      SUM(delay)     sumdelay,                      SUM(dl_flow)   sumdl_flow                  FROM                      lte_sys.[@c0]_T_QUALITYSTATISTICS_ALLUSER                  WHERE                      nettype IN (1,2)                  AND AppType IN(15,1,5,6,7,8)                  AND hour>='[@c1]'                  AND hour<='[@c2]'                  GROUP BY                      city,                      scene1)tb1          ON              tb2.city=tb1.city          AND tb2.scene1=tb1.scene1          WHERE              nettype IN (1,2)          AND AppType IN(15,1,5,6,7,8)          AND hour>='[@c1]'          AND hour<='[@c2]'          GROUP BY              tb2.city,              tb2.scene1,              tb2.AppType          UNION          SELECT              tb2.city,              CASE                  WHEN tb2.scene2=1                  THEN '高铁用户'                  WHEN tb2.scene2=2                  THEN '地铁用户'                  WHEN tb2.scene2=3                  THEN '校园用户'                  WHEN tb2.scene2=4                  THEN '商业区用户'                  WHEN tb2.scene2=5                  THEN '风景区用户'                  WHEN tb2.scene2=6                  THEN '居民区用户'                  ELSE '未知场景'              END AS data1,              CASE                  WHEN tb2.scene2=1                  THEN '高铁用户'                  WHEN tb2.scene2=2                  THEN '地铁用户'                  WHEN tb2.scene2=3                  THEN '校园用户'                  WHEN tb2.scene2=4                  THEN '商业区用户'                  WHEN tb2.scene2=5                  THEN '风景区用户'                  WHEN tb2.scene2=6                  THEN '居民区用户'                  ELSE '未知场景'              END AS data1,              ROUND(SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>0                      THEN delay                      ELSE 0                  END)/1000/60,2.0) AS data3,              ROUND(SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>0                      THEN delay                      ELSE 0                  END)/MAX(tb1.sumdelay),2.0) AS data4 ,              ROUND(SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>0                      THEN delay                      ELSE 0                  END)/1000/60,2.0) AS data5,              ROUND( SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>0                      THEN delay                      ELSE 0                  END)/MAX(tb1.sumdelay),2.0) AS data6 ,              ROUND(SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>0                      THEN dl_flow                      ELSE 0                  END)/1024/1024,2.0) AS data7,              ROUND( SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>0                      THEN dl_flow                      ELSE 0                  END)/MAX(tb1.sumdl_flow),2.0) AS data8 ,              ROUND( SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>0                      THEN dl_flow                      ELSE 0                  END)/1024/1024,2.0) AS data9,              ROUND( SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>0                      THEN dl_flow                      ELSE 0                  END)/MAX(tb1.sumdl_flow) ,2.0)AS data10 ,              ROUND(SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>0                      THEN delay                      ELSE 0                  END)/1000/60,2.0) AS data41,              ROUND(SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>0                      THEN dl_flow                      ELSE 0                  END)/1024/1024,2.0) AS data42 ,              ROUND( SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>0                      THEN dl_flow                      ELSE 0                  END)/SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>0                      THEN delay                      ELSE 0                  END)*8000/1024,2.0) AS data43,              ROUND(SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>0                      THEN delay                      ELSE 0                  END)/1000/60,2.0) AS data44,              ROUND( SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>0                      THEN dl_flow                      ELSE 0                  END)/1024/1024,2.0) AS data45 ,              ROUND( SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>0                      THEN dl_flow                      ELSE 0                  END)/SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>0                      THEN delay                      ELSE 0                  END)*8000/1024,2.0) AS data46,              ROUND(SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>0                      THEN delay                      ELSE 0                  END)/1000/60,2.0) AS data47,              ROUND( SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>0                      THEN dl_flow                      ELSE 0                  END)/1024/1024,2.0) AS data48,              ROUND(SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>0                      THEN dl_flow                      ELSE 0                  END)/SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>0                      THEN delay                      ELSE 0                  END)*8000/1024,2.0) AS data49 ,              ROUND(SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN delay                      ELSE 0                  END)/1000/60,2.0) AS data11,              ROUND(SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN dl_flow                      ELSE 0                  END)/1024/1024,2.0) AS data12,              ROUND( SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN dl_flow                      ELSE 0                  END)/SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN delay                      ELSE 0                  END)*8000/1024,2.0) AS data13,              SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END) AS data14,              SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN satisfied_sucess_xdr_count                      ELSE 0                  END) AS data15 ,              ROUND(SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN satisfied_sucess_xdr_count                      ELSE 0                  END)/SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END),2.0) AS data16,              SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END) AS data17,              SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN satisfied_speed_xdr_count                      ELSE 0                  END) AS data18 ,              ROUND(SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN satisfied_speed_xdr_count                      ELSE 0                  END)/SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END),2.0) AS data19,              ROUND(SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN satisfied_sucess_xdr_count*satisfied_speed_xdr_count                      ELSE 0                  END)/SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN satisfied_xdr_count*satisfied_xdr_count                      ELSE 0                  END),2.0) AS data20,              ROUND(SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN delay                      ELSE 0                  END)/1000/60,2.0) AS data21,              ROUND(SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN dl_flow                      ELSE 0                  END)/1024/1024,2.0) AS data22,              ROUND( SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN dl_flow                      ELSE 0                  END)/SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN delay                      ELSE 0                  END)*8000/1024,2.0) AS data23,              SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END) AS data24,              SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN satisfied_sucess_xdr_count                      ELSE 0                  END) AS data25 ,              ROUND( SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN satisfied_sucess_xdr_count                      ELSE 0                  END)/SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END),2.0) AS data26,              SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END) AS data27,              SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN satisfied_speed_xdr_count                      ELSE 0                  END) AS data28 ,              ROUND( SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN satisfied_speed_xdr_count                      ELSE 0                  END)/SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END),2.0) AS data29,              ROUND( SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN satisfied_sucess_xdr_count*satisfied_speed_xdr_count                      ELSE 0                  END)/SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN satisfied_xdr_count*satisfied_xdr_count                      ELSE 0                  END),2.0) AS data30,              ROUND( SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN delay                      ELSE 0                  END)/1000/60,2.0) AS data31,              ROUND(SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN dl_flow                      ELSE 0                  END)/1024/1024,2.0) AS data32,              ROUND(SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN dl_flow                      ELSE 0                  END)/SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN delay                      ELSE 0                  END)*8000/1024,2.0) AS data33,              SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END) AS data34,              SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN satisfied_sucess_xdr_count                      ELSE 0                  END) AS data35 ,              ROUND(SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN satisfied_sucess_xdr_count                      ELSE 0                  END)/SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END),2.0) AS data36,              SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END) AS data37,              SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN satisfied_speed_xdr_count                      ELSE 0                  END) AS data38 ,              ROUND(SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN satisfied_speed_xdr_count                      ELSE 0                  END)/SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END),2.0) AS data39,              ROUND( SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN satisfied_sucess_xdr_count*satisfied_speed_xdr_count                      ELSE 0                  END)/SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN satisfied_xdr_count*satisfied_xdr_count                      ELSE 0                  END),2.0) AS data40          FROM              lte_sys.[@c0]_T_QUALITYSTATISTICS_ALLUSER tb2          LEFT JOIN              (                  SELECT                      city,                      scene2,                      SUM(xdr_count) sumcnt,                      SUM(delay)     sumdelay,                      SUM(dl_flow)   sumdl_flow                  FROM                      lte_sys.[@c0]_T_QUALITYSTATISTICS_ALLUSER                  WHERE                      nettype IN (1,2)                  AND AppType IN(15,1,5,6,7,8)                  AND hour>='[@c1]'                  AND hour<='[@c2]'                  GROUP BY                      city,                      scene2)tb1          ON              tb2.city=tb1.city          AND tb2.scene2=tb1.scene2          WHERE              nettype IN (1,2)          AND AppType IN(15,1,5,6,7,8)          AND hour>='[@c1]'          AND hour<='[@c2]'          GROUP BY              tb2.city,              tb2.scene2          UNION          SELECT              tb2.city,              CASE                  WHEN tb2.scene2=1                  THEN '高铁用户'                  WHEN tb2.scene2=2                  THEN '地铁用户'                  WHEN tb2.scene2=3                  THEN '校园用户'                  WHEN tb2.scene2=4                  THEN '商业区用户'                  WHEN tb2.scene2=5                  THEN '风景区用户'                  WHEN tb2.scene2=6                  THEN '居民区用户'                  ELSE '未知场景'              END AS data1,              (                  CASE                      WHEN AppType=1                      THEN '即时通信'                      WHEN AppType=15                      THEN '浏览下载'                      WHEN AppType=5                      THEN '视频'                      WHEN AppType=6                      THEN '音乐'                      WHEN AppType=7                      THEN '应用商店'                      WHEN AppType=8                      THEN '游戏'                  END ) AS data2,              ROUND(SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>0                      THEN delay                      ELSE 0                  END)/1000/60,2.0) AS data3,              ROUND(SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>0                      THEN delay                      ELSE 0                  END)/MAX(tb1.sumdelay),2.0) AS data4 ,              ROUND(SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>0                      THEN delay                      ELSE 0                  END)/1000/60,2.0) AS data5,              ROUND( SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>0                      THEN delay                      ELSE 0                  END)/MAX(tb1.sumdelay),2.0) AS data6 ,              ROUND(SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>0                      THEN dl_flow                      ELSE 0                  END)/1024/1024,2.0) AS data7,              ROUND( SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>0                      THEN dl_flow                      ELSE 0                  END)/MAX(tb1.sumdl_flow),2.0) AS data8 ,              ROUND( SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>0                      THEN dl_flow                      ELSE 0                  END)/1024/1024,2.0) AS data9,              ROUND( SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>0                      THEN dl_flow                      ELSE 0                  END)/MAX(tb1.sumdl_flow) ,2.0)AS data10 ,              ROUND(SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>0                      THEN delay                      ELSE 0                  END)/1000/60,2.0) AS data41,              ROUND(SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>0                      THEN dl_flow                      ELSE 0                  END)/1024/1024,2.0) AS data42 ,              ROUND( SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>0                      THEN dl_flow                      ELSE 0                  END)/SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>0                      THEN delay                      ELSE 0                  END)*8000/1024,2.0) AS data43,              ROUND(SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>0                      THEN delay                      ELSE 0                  END)/1000/60,2.0) AS data44,              ROUND( SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>0                      THEN dl_flow                      ELSE 0                  END)/1024/1024,2.0) AS data45 ,              ROUND( SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>0                      THEN dl_flow                      ELSE 0                  END)/SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>0                      THEN delay                      ELSE 0                  END)*8000/1024,2.0) AS data46,              ROUND(SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>0                      THEN delay                      ELSE 0                  END)/1000/60,2.0) AS data47,              ROUND( SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>0                      THEN dl_flow                      ELSE 0                  END)/1024/1024,2.0) AS data48,              ROUND(SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>0                      THEN dl_flow                      ELSE 0                  END)/SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>0                      THEN delay                      ELSE 0                  END)*8000/1024,2.0) AS data49 ,              ROUND(SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN delay                      ELSE 0                  END)/1000/60,2.0) AS data11,              ROUND(SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN dl_flow                      ELSE 0                  END)/1024/1024,2.0) AS data12,              ROUND( SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN dl_flow                      ELSE 0                  END)/SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN delay                      ELSE 0                  END)*8000/1024,2.0) AS data13,              SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END) AS data14,              SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN satisfied_sucess_xdr_count                      ELSE 0                  END) AS data15 ,              ROUND(SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN satisfied_sucess_xdr_count                      ELSE 0                  END)/SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END),2.0) AS data16,              SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END) AS data17,              SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN satisfied_speed_xdr_count                      ELSE 0                  END) AS data18 ,              ROUND(SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN satisfied_speed_xdr_count                      ELSE 0                  END)/SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END),2.0) AS data19,              ROUND(SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN satisfied_sucess_xdr_count*satisfied_speed_xdr_count                      ELSE 0                  END)/SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN satisfied_xdr_count*satisfied_xdr_count                      ELSE 0                  END),2.0) AS data20,              ROUND(SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN delay                      ELSE 0                  END)/1000/60,2.0) AS data21,              ROUND(SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN dl_flow                      ELSE 0                  END)/1024/1024,2.0) AS data22,              ROUND( SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN dl_flow                      ELSE 0                  END)/SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN delay                      ELSE 0                  END)*8000/1024,2.0) AS data23,              SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END) AS data24,              SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN satisfied_sucess_xdr_count                      ELSE 0                  END) AS data25 ,              ROUND( SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN satisfied_sucess_xdr_count                      ELSE 0                  END)/SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END),2.0) AS data26,              SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END) AS data27,              SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN satisfied_speed_xdr_count                      ELSE 0                  END) AS data28 ,              ROUND( SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN satisfied_speed_xdr_count                      ELSE 0                  END)/SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END),2.0) AS data29,              ROUND( SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN satisfied_sucess_xdr_count*satisfied_speed_xdr_count                      ELSE 0                  END)/SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN satisfied_xdr_count*satisfied_xdr_count                      ELSE 0                  END),2.0) AS data30,              ROUND( SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN delay                      ELSE 0                  END)/1000/60,2.0) AS data31,              ROUND(SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN dl_flow                      ELSE 0                  END)/1024/1024,2.0) AS data32,              ROUND(SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN dl_flow                      ELSE 0                  END)/SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN delay                      ELSE 0                  END)*8000/1024,2.0) AS data33,              SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END) AS data34,              SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN satisfied_sucess_xdr_count                      ELSE 0                  END) AS data35 ,              ROUND(SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN satisfied_sucess_xdr_count                      ELSE 0                  END)/SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END),2.0) AS data36,              SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END) AS data37,              SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN satisfied_speed_xdr_count                      ELSE 0                  END) AS data38 ,              ROUND(SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN satisfied_speed_xdr_count                      ELSE 0                  END)/SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END),2.0) AS data39,              ROUND( SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN satisfied_sucess_xdr_count*satisfied_speed_xdr_count                      ELSE 0                  END)/SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN satisfied_xdr_count*satisfied_xdr_count                      ELSE 0                  END),2.0) AS data40          FROM              lte_sys.[@c0]_T_QUALITYSTATISTICS_ALLUSER tb2          LEFT JOIN              (                  SELECT                      city,                      scene2,                      SUM(xdr_count) sumcnt,                      SUM(delay)     sumdelay,                      SUM(dl_flow)   sumdl_flow                  FROM                      lte_sys.[@c0]_T_QUALITYSTATISTICS_ALLUSER                  WHERE                      nettype IN (1,2)                  AND AppType IN(15,1,5,6,7,8)                  AND hour>='[@c1]'                  AND hour<='[@c2]'                  GROUP BY                      city,                      scene2)tb1          ON              tb2.city=tb1.city          AND tb2.scene2=tb1.scene2          WHERE              nettype IN (1,2)          AND AppType IN(15,1,5,6,7,8)          AND hour>='[@c1]'          AND hour<='[@c2]'          GROUP BY              tb2.city,              tb2.scene2,              tb2.AppType          union  SELECT              tb2.city,              '室内用户' AS data1,              '室内用户' AS data2,              ROUND(SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>0                      THEN delay                      ELSE 0                  END)/1000/60,2.0) AS data3,              ROUND(SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>0                      THEN delay                      ELSE 0                  END)/MAX(tb1.sumdelay),2.0) AS data4 ,              ROUND(SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>0                      THEN delay                      ELSE 0                  END)/1000/60,2.0) AS data5,              ROUND( SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>0                      THEN delay                      ELSE 0                  END)/MAX(tb1.sumdelay),2.0) AS data6 ,              ROUND(SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>0                      THEN dl_flow                      ELSE 0                  END)/1024/1024,2.0) AS data7,              ROUND( SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>0                      THEN dl_flow                      ELSE 0                  END)/MAX(tb1.sumdl_flow),2.0) AS data8 ,              ROUND( SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>0                      THEN dl_flow                      ELSE 0                  END)/1024/1024,2.0) AS data9,              ROUND( SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>0                      THEN dl_flow                      ELSE 0                  END)/MAX(tb1.sumdl_flow) ,2.0)AS data10 ,              ROUND(SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>0                      THEN delay                      ELSE 0                  END)/1000/60,2.0) AS data41,              ROUND(SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>0                      THEN dl_flow                      ELSE 0                  END)/1024/1024,2.0) AS data42 ,              ROUND( SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>0                      THEN dl_flow                      ELSE 0                  END)/SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>0                      THEN delay                      ELSE 0                  END)*8000/1024,2.0) AS data43,              ROUND(SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>0                      THEN delay                      ELSE 0                  END)/1000/60,2.0) AS data44,              ROUND( SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>0                      THEN dl_flow                      ELSE 0                  END)/1024/1024,2.0) AS data45 ,              ROUND( SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>0                      THEN dl_flow                      ELSE 0                  END)/SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>0                      THEN delay                      ELSE 0                  END)*8000/1024,2.0) AS data46,              ROUND(SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>0                      THEN delay                      ELSE 0                  END)/1000/60,2.0) AS data47,              ROUND( SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>0                      THEN dl_flow                      ELSE 0                  END)/1024/1024,2.0) AS data48,              ROUND(SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>0                      THEN dl_flow                      ELSE 0                  END)/SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>0                      THEN delay                      ELSE 0                  END)*8000/1024,2.0) AS data49 ,              ROUND(SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN delay                      ELSE 0                  END)/1000/60,2.0) AS data11,              ROUND(SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN dl_flow                      ELSE 0                  END)/1024/1024,2.0) AS data12,              ROUND( SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN dl_flow                      ELSE 0                  END)/SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN delay                      ELSE 0                  END)*8000/1024,2.0) AS data13,              SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END) AS data14,              SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN satisfied_sucess_xdr_count                      ELSE 0                  END) AS data15 ,              ROUND(SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN satisfied_sucess_xdr_count                      ELSE 0                  END)/SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END),2.0) AS data16,              SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END) AS data17,              SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN satisfied_speed_xdr_count                      ELSE 0                  END) AS data18 ,              ROUND(SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN satisfied_speed_xdr_count                      ELSE 0                  END)/SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END),2.0) AS data19,              ROUND(SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN satisfied_sucess_xdr_count*satisfied_speed_xdr_count                      ELSE 0                  END)/SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN satisfied_xdr_count*satisfied_xdr_count                      ELSE 0                  END),2.0) AS data20,              ROUND(SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN delay                      ELSE 0                  END)/1000/60,2.0) AS data21,              ROUND(SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN dl_flow                      ELSE 0                  END)/1024/1024,2.0) AS data22,              ROUND( SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN dl_flow                      ELSE 0                  END)/SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN delay                      ELSE 0                  END)*8000/1024,2.0) AS data23,              SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END) AS data24,              SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN satisfied_sucess_xdr_count                      ELSE 0                  END) AS data25 ,              ROUND( SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN satisfied_sucess_xdr_count                      ELSE 0                  END)/SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END),2.0) AS data26,              SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END) AS data27,              SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN satisfied_speed_xdr_count                      ELSE 0                  END) AS data28 ,              ROUND( SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN satisfied_speed_xdr_count                      ELSE 0                  END)/SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END),2.0) AS data29,              ROUND( SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN satisfied_sucess_xdr_count*satisfied_speed_xdr_count                      ELSE 0                  END)/SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN satisfied_xdr_count*satisfied_xdr_count                      ELSE 0                  END),2.0) AS data30,              ROUND( SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN delay                      ELSE 0                  END)/1000/60,2.0) AS data31,              ROUND(SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN dl_flow                      ELSE 0                  END)/1024/1024,2.0) AS data32,              ROUND(SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN dl_flow                      ELSE 0                  END)/SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN delay                      ELSE 0                  END)*8000/1024,2.0) AS data33,              SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END) AS data34,              SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN satisfied_sucess_xdr_count                      ELSE 0                  END) AS data35 ,              ROUND(SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN satisfied_sucess_xdr_count                      ELSE 0                  END)/SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END),2.0) AS data36,              SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END) AS data37,              SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN satisfied_speed_xdr_count                      ELSE 0                  END) AS data38 ,              ROUND(SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN satisfied_speed_xdr_count                      ELSE 0                  END)/SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END),2.0) AS data39,              ROUND( SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN satisfied_sucess_xdr_count*satisfied_speed_xdr_count                      ELSE 0                  END)/SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN satisfied_xdr_count*satisfied_xdr_count                      ELSE 0                  END),2.0) AS data40          FROM              lte_sys.[@c0]_T_QUALITYSTATISTICS_ALLUSER tb2          LEFT JOIN              (                  SELECT                      city,                      SUM(xdr_count) sumcnt,                      SUM(delay)     sumdelay,                      SUM(dl_flow)   sumdl_flow                  FROM                      lte_sys.[@c0]_T_QUALITYSTATISTICS_ALLUSER                  WHERE                      nettype IN (1,2)                  AND AppType IN(15,1,5,6,7,8)                  AND hour>='[@c1]'                  AND hour<='[@c2]'                  AND scene1<>1                  GROUP BY                      city)tb1          ON              tb2.city=tb1.city          WHERE              nettype IN (1,2)          AND AppType IN(15,1,5,6,7,8)          AND hour>='[@c1]'          AND hour<='[@c2]'          AND scene1<>1          GROUP BY              tb2.city          UNION          SELECT              tb2.city,              '室内用户' AS data1,              (                  CASE                      WHEN AppType=1                      THEN '即时通信'                      WHEN AppType=15                      THEN '浏览下载'                      WHEN AppType=5                      THEN '视频'                      WHEN AppType=6                      THEN '音乐'                      WHEN AppType=7                      THEN '应用商店'                      WHEN AppType=8                      THEN '游戏'                  END ) AS data2,              ROUND(SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>0                      THEN delay                      ELSE 0                  END)/1000/60,2.0) AS data3,              ROUND(SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>0                      THEN delay                      ELSE 0                  END)/MAX(tb1.sumdelay),2.0) AS data4 ,              ROUND(SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>0                      THEN delay                      ELSE 0                  END)/1000/60,2.0) AS data5,              ROUND( SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>0                      THEN delay                      ELSE 0                  END)/MAX(tb1.sumdelay),2.0) AS data6 ,              ROUND(SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>0                      THEN dl_flow                      ELSE 0                  END)/1024/1024,2.0) AS data7,              ROUND( SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>0                      THEN dl_flow                      ELSE 0                  END)/MAX(tb1.sumdl_flow),2.0) AS data8 ,              ROUND( SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>0                      THEN dl_flow                      ELSE 0                  END)/1024/1024,2.0) AS data9,              ROUND( SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>0                      THEN dl_flow                      ELSE 0                  END)/MAX(tb1.sumdl_flow) ,2.0)AS data10 ,              ROUND(SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>0                      THEN delay                      ELSE 0                  END)/1000/60,2.0) AS data41,              ROUND(SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>0                      THEN dl_flow                      ELSE 0                  END)/1024/1024,2.0) AS data42 ,              ROUND( SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>0                      THEN dl_flow                      ELSE 0                  END)/SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>0                      THEN delay                      ELSE 0                  END)*8000/1024,2.0) AS data43,              ROUND(SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>0                      THEN delay                      ELSE 0                  END)/1000/60,2.0) AS data44,              ROUND( SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>0                      THEN dl_flow                      ELSE 0                  END)/1024/1024,2.0) AS data45 ,              ROUND( SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>0                      THEN dl_flow                      ELSE 0                  END)/SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>0                      THEN delay                      ELSE 0                  END)*8000/1024,2.0) AS data46,              ROUND(SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>0                      THEN delay                      ELSE 0                  END)/1000/60,2.0) AS data47,              ROUND( SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>0                      THEN dl_flow                      ELSE 0                  END)/1024/1024,2.0) AS data48,              ROUND(SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>0                      THEN dl_flow                      ELSE 0                  END)/SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>0                      THEN delay                      ELSE 0                  END)*8000/1024,2.0) AS data49 ,              ROUND(SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN delay                      ELSE 0                  END)/1000/60,2.0) AS data11,              ROUND(SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN dl_flow                      ELSE 0                  END)/1024/1024,2.0) AS data12,              ROUND( SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN dl_flow                      ELSE 0                  END)/SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN delay                      ELSE 0                  END)*8000/1024,2.0) AS data13,              SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END) AS data14,              SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN satisfied_sucess_xdr_count                      ELSE 0                  END) AS data15 ,              ROUND(SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN satisfied_sucess_xdr_count                      ELSE 0                  END)/SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END),2.0) AS data16,              SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END) AS data17,              SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN satisfied_speed_xdr_count                      ELSE 0                  END) AS data18 ,              ROUND(SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN satisfied_speed_xdr_count                      ELSE 0                  END)/SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END),2.0) AS data19,              ROUND(SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN satisfied_sucess_xdr_count*satisfied_speed_xdr_count                      ELSE 0                  END)/SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN satisfied_xdr_count*satisfied_xdr_count                      ELSE 0                  END),2.0) AS data20,              ROUND(SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN delay                      ELSE 0                  END)/1000/60,2.0) AS data21,              ROUND(SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN dl_flow                      ELSE 0                  END)/1024/1024,2.0) AS data22,              ROUND( SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN dl_flow                      ELSE 0                  END)/SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN delay                      ELSE 0                  END)*8000/1024,2.0) AS data23,              SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END) AS data24,              SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN satisfied_sucess_xdr_count                      ELSE 0                  END) AS data25 ,              ROUND( SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN satisfied_sucess_xdr_count                      ELSE 0                  END)/SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END),2.0) AS data26,              SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END) AS data27,              SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN satisfied_speed_xdr_count                      ELSE 0                  END) AS data28 ,              ROUND( SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN satisfied_speed_xdr_count                      ELSE 0                  END)/SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END),2.0) AS data29,              ROUND( SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN satisfied_sucess_xdr_count*satisfied_speed_xdr_count                      ELSE 0                  END)/SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN satisfied_xdr_count*satisfied_xdr_count                      ELSE 0                  END),2.0) AS data30,              ROUND( SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN delay                      ELSE 0                  END)/1000/60,2.0) AS data31,              ROUND(SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN dl_flow                      ELSE 0                  END)/1024/1024,2.0) AS data32,              ROUND(SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN dl_flow                      ELSE 0                  END)/SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN delay                      ELSE 0                  END)*8000/1024,2.0) AS data33,              SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END) AS data34,              SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN satisfied_sucess_xdr_count                      ELSE 0                  END) AS data35 ,              ROUND(SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN satisfied_sucess_xdr_count                      ELSE 0                  END)/SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END),2.0) AS data36,              SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END) AS data37,              SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN satisfied_speed_xdr_count                      ELSE 0                  END) AS data38 ,              ROUND(SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN satisfied_speed_xdr_count                      ELSE 0                  END)/SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END),2.0) AS data39,              ROUND( SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN satisfied_sucess_xdr_count*satisfied_speed_xdr_count                      ELSE 0                  END)/SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN satisfied_xdr_count*satisfied_xdr_count                      ELSE 0                  END),2.0) AS data40          FROM              lte_sys.[@c0]_T_QUALITYSTATISTICS_ALLUSER tb2          LEFT JOIN              (                  SELECT                      city,                      SUM(xdr_count) sumcnt,                      SUM(delay)     sumdelay,                      SUM(dl_flow)   sumdl_flow                  FROM                      lte_sys.[@c0]_T_QUALITYSTATISTICS_ALLUSER                  WHERE                      nettype IN (1,2)                  AND AppType IN(15,1,5,6,7,8)                  AND hour>='[@c1]'                  AND hour<='[@c2]'                  AND scene1<>1                  GROUP BY                      city)tb1          ON              tb2.city=tb1.city          WHERE              nettype IN (1,2)          AND AppType IN(15,1,5,6,7,8)          AND hour>='[@c1]'          AND hour<='[@c2]'          AND scene1<>1          GROUP BY              tb2.city,              tb2.AppType ) T  WHERE      t.city='[@c3]' and t.data1!='未知场景'  ORDER BY      t.data1"
      }
    }
  ]
}