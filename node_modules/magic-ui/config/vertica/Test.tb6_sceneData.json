{
  "module": "Test.tb6_sceneData",
  "flag": "vertical",
  "configs": [
    {
      "key": "Test.tb6_sceneData",
      "desc": "LTE室内外场景分析",
      "config": {
        "parameters": [
          {
            "name": "p_en",
            "columnname": "",
            "type": "string",
            "format": "",
            "conditionid": "c0",
            "symbol": ""
          },
          {
            "name": "starttime",
            "columnname": "",
            "type": "string",
            "format": "",
            "conditionid": "c1",
            "symbol": ""
          },
          {
            "name": "endtime",
            "columnname": "",
            "type": "string",
            "format": "",
            "conditionid": "c2",
            "symbol": ""
          },
          {
            "name": "scenename",
            "columnname": "",
            "type": "string",
            "format": "",
            "conditionid": "c3",
            "symbol": ""
          },
          {
            "name": "fieldname",
            "columnname": "",
            "type": "string",
            "format": "",
            "conditionid": "c4",
            "symbol": ""
          },
          {
            "name": "scenevalue",
            "columnname": "",
            "type": "string",
            "format": "",
            "conditionid": "c5",
            "symbol": ""
          }, {
            "name": "province",
            "columnname": "",
            "type":"string",
            "format": "",
            "conditionid": "c6",
            "symbol":""
          }
        ],
        "value": "SELECT      data1,      data2,      data3,      data4,      data5,      data6,      data7,      data8,      data9,      data10,      data11,      data12,      data13,      data14,      data15,      data16,      data17,      data18,      data19,      data20,      data21,      data22,      data23,      data24,      data25,      data26,      data27,      data28,      data29,      data30,      data31,      data32,      data33,      data34,      data35,      data36,      data37,      data38,      data39,      data40,      data41,      data42,      data43,      data44,      data45,      data46,      data47,      data48,      data49  FROM      (          SELECT              t1.*,              t2.*          FROM              (                  SELECT                      '全网' AS data1,                      '全网' AS data2,                      SUM(                          CASE                              WHEN nettype=1                              THEN delay                              ELSE 0                          END) AS data3,                      ROUND(SUM(                          CASE                              WHEN nettype=1                              THEN delay                              ELSE 0                          END)/MAX(tb1.sumdelay),2.0) AS data4 ,                      SUM(                          CASE                              WHEN nettype=2                              THEN delay                              ELSE 0                          END) AS data5,                      ROUND( SUM(                          CASE                              WHEN nettype=2                              THEN delay                              ELSE 0                          END)/MAX(tb1.sumdelay),2.0) AS data6 ,                      SUM(                          CASE                              WHEN nettype=1                              THEN dl_flow                              ELSE 0                          END) AS data7,                      ROUND( SUM(                          CASE                              WHEN nettype=1                              THEN dl_flow                              ELSE 0                          END)/MAX(tb1.sumdl_flow),2.0) AS data8 ,                      SUM(                          CASE                              WHEN nettype=2                              THEN dl_flow                              ELSE 0                          END) AS data9,                      ROUND( SUM(                          CASE                              WHEN nettype=2                              THEN dl_flow                              ELSE 0                          END)/MAX(tb1.sumdl_flow) ,2.0)AS data10 ,                      SUM(                          CASE                              WHEN nettype=1                              THEN delay                              ELSE 0                          END) AS data41,                      SUM(                          CASE                              WHEN nettype=1                              THEN dl_flow                              ELSE 0                          END) AS data42 ,                      ROUND( SUM(                          CASE                              WHEN nettype=1                              THEN dl_flow                              ELSE 0                          END)/SUM(                          CASE                              WHEN nettype=1                              THEN delay                              ELSE 0                          END)*8000/1024,2.0) AS data43,                      SUM(                          CASE                              WHEN nettype=2                              THEN delay                              ELSE 0                          END) AS data44,                      SUM(                          CASE                              WHEN nettype=2                              THEN dl_flow                              ELSE 0                          END) AS data45 ,                      ROUND( SUM(                          CASE                              WHEN nettype=2                              THEN dl_flow                              ELSE 0                          END)/SUM(                          CASE                              WHEN nettype=2                              THEN delay                              ELSE 0                          END)*8000/1024,2.0) AS data46,                      SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN delay                              ELSE 0                          END) AS data47,                      SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN dl_flow                              ELSE 0                          END) AS data48,                      ROUND(SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN dl_flow                              ELSE 0                          END)/SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN delay                              ELSE 0                          END)*8000/1024,2.0) AS data49                  FROM                      lte_sys.[@c0]_T_QUALITYSTATISTICS_ALLUSER tb2 ,                      (                          SELECT                              SUM(xdr_count) sumcnt,                              SUM(delay)     sumdelay,                              SUM(dl_flow)   sumdl_flow                          FROM                              lte_sys.[@c0]_T_QUALITYSTATISTICS_ALLUSER                          WHERE                              nettype IN (1,2)                          AND AppType IN(15,1,5,6,7,8)                          AND dl_flow>0                          AND hour>='[@c1]'                          AND hour<='[@c2]' )tb1                  WHERE                      nettype IN (1,2)                  AND AppType IN(15,1,5,6,7,8)                  AND dl_flow>0                  AND hour>='[@c1]'                  AND hour<='[@c2]' ) t1          LEFT JOIN              (                  SELECT                      '全网' AS ndata2,                      SUM(                          CASE                              WHEN nettype=1                              THEN delay                              ELSE 0                          END) AS data11,                      SUM(                          CASE                              WHEN nettype=1                              THEN dl_flow                              ELSE 0                          END) AS data12,                      ROUND( SUM(                          CASE                              WHEN nettype=1                              THEN dl_flow                              ELSE 0                          END)/SUM(                          CASE                              WHEN nettype=1                              THEN delay                              ELSE 0                          END)*8000/1024,2.0) AS data13,                      SUM(                          CASE                              WHEN nettype=1                              THEN satisfied_xdr_count                              ELSE 0                          END) AS data14,                      SUM(                          CASE                              WHEN nettype=1                              THEN satisfied_sucess_xdr_count                              ELSE 0                          END) AS data15 ,                      ROUND(SUM(                          CASE                              WHEN nettype=1                              THEN satisfied_sucess_xdr_count                              ELSE 0                          END)/SUM(                          CASE                              WHEN nettype=1                              THEN satisfied_xdr_count                              ELSE 0                          END),2.0) AS data16,                      SUM(                          CASE                              WHEN nettype=1                              THEN satisfied_xdr_count                              ELSE 0                          END) AS data17,                      SUM(                          CASE                              WHEN nettype=1                              THEN satisfied_speed_xdr_count                              ELSE 0                          END) AS data18 ,                      ROUND(SUM(                          CASE                              WHEN nettype=1                              THEN satisfied_speed_xdr_count                              ELSE 0                          END)/SUM(                          CASE                              WHEN nettype=1                              THEN satisfied_xdr_count                              ELSE 0                          END),2.0) AS data19,                      ROUND(SUM(                          CASE                              WHEN nettype=1                              THEN satisfied_sucess_xdr_count*satisfied_speed_xdr_count                              ELSE 0                          END)/SUM(                          CASE                              WHEN nettype=1                              THEN satisfied_xdr_count*satisfied_xdr_count                              ELSE 0                          END),2.0) AS data20,                      SUM(                          CASE                              WHEN nettype=2                              THEN delay                              ELSE 0                          END) AS data21,                      SUM(                          CASE                              WHEN nettype=2                              THEN dl_flow                              ELSE 0                          END) AS data22,                      ROUND( SUM(                          CASE                              WHEN nettype=2                              THEN dl_flow                              ELSE 0                          END)/SUM(                          CASE                              WHEN nettype=2                              THEN delay                              ELSE 0                          END)*8000/1024,2.0) AS data23,                      SUM(                          CASE                              WHEN nettype=2                              THEN satisfied_xdr_count                              ELSE 0                          END) AS data24,                      SUM(                          CASE                              WHEN nettype=2                              THEN satisfied_sucess_xdr_count                              ELSE 0                          END) AS data25 ,                      ROUND( SUM(                          CASE                              WHEN nettype=2                              THEN satisfied_sucess_xdr_count                              ELSE 0                          END)/SUM(                          CASE                              WHEN nettype=2                              THEN satisfied_xdr_count                              ELSE 0                          END),2.0) AS data26,                      SUM(                          CASE                              WHEN nettype=2                              THEN satisfied_xdr_count                              ELSE 0                          END) AS data27,                      SUM(                          CASE                              WHEN nettype=2                              THEN satisfied_speed_xdr_count                              ELSE 0                          END) AS data28 ,                      ROUND( SUM(                          CASE                              WHEN nettype=2                              THEN satisfied_speed_xdr_count                              ELSE 0                          END)/SUM(                          CASE                              WHEN nettype=2                              THEN satisfied_xdr_count                              ELSE 0                          END),2.0) AS data29,                      ROUND( SUM(                          CASE                              WHEN nettype=2                              THEN satisfied_sucess_xdr_count*satisfied_speed_xdr_count                              ELSE 0                          END)/SUM(                          CASE                              WHEN nettype=2                              THEN satisfied_xdr_count*satisfied_xdr_count                              ELSE 0                          END),2.0) AS data30,                      SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN delay                              ELSE 0                          END) AS data31,                      SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN dl_flow                              ELSE 0                          END) AS data32,                      ROUND(SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN dl_flow                              ELSE 0                          END)/SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN delay                              ELSE 0                          END)*8000/1024,2.0) AS data33,                      SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN satisfied_xdr_count                              ELSE 0                          END) AS data34,                      SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN satisfied_sucess_xdr_count                              ELSE 0                          END) AS data35 ,                      ROUND(SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN satisfied_sucess_xdr_count                              ELSE 0                          END)/SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN satisfied_xdr_count                              ELSE 0                          END),2.0) AS data36,                      SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN satisfied_xdr_count                              ELSE 0                          END) AS data37,                      SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN satisfied_speed_xdr_count                              ELSE 0                          END) AS data38 ,                      ROUND(SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN satisfied_speed_xdr_count                              ELSE 0                          END)/SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN satisfied_xdr_count                              ELSE 0                          END),2.0) AS data39,                      ROUND( SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN satisfied_sucess_xdr_count*satisfied_speed_xdr_count                              ELSE 0                          END)/SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN satisfied_xdr_count*satisfied_xdr_count                              ELSE 0                          END),2.0) AS data40                  FROM                      lte_sys.[@c0]_T_QUALITYSTATISTICS_ALLUSER tb2 ,                      (                          SELECT                              SUM(xdr_count) sumcnt,                              SUM(delay)     sumdelay,                              SUM(dl_flow)   sumdl_flow                          FROM                              lte_sys.[@c0]_T_QUALITYSTATISTICS_ALLUSER                          WHERE                              dl_flow>5120                          AND AppType IN(15,1,5,6,7,8)                          AND hour>='[@c1]'                          AND hour<='[@c2]' )tb1                  WHERE                      dl_flow>5120                  AND AppType IN(15,1,5,6,7,8)                  AND hour>='[@c1]'                  AND hour<='[@c2]' )t2          ON              t1.data2=t2.ndata2          UNION          SELECT              t1.*,              t2.*          FROM              (                  SELECT                      '全网' AS data1,                      (                          CASE                              WHEN AppType=1                              THEN '即时通信'                              WHEN AppType=15                              THEN '浏览'                              WHEN AppType=5                              THEN '视频'                              WHEN AppType=6                              THEN '音乐'                              WHEN AppType=7                              THEN '应用商店'                              WHEN AppType=8                              THEN '游戏'                          END ) AS data2,                      SUM(                          CASE                              WHEN nettype=1                              THEN delay                              ELSE 0                          END) AS data3,                      ROUND( SUM(                          CASE                              WHEN nettype=1                              THEN delay                              ELSE 0                          END)/MAX(tb1.sumdelay),2.0) AS data4 ,                      SUM(                          CASE                              WHEN nettype=2                              THEN delay                              ELSE 0                          END) AS data5,                      ROUND( SUM(                          CASE                              WHEN nettype=2                              THEN delay                              ELSE 0                          END)/MAX(tb1.sumdelay),2.0) AS data6 ,                      SUM(                          CASE                              WHEN nettype=1                              THEN dl_flow                              ELSE 0                          END) AS data7,                      ROUND(SUM(                          CASE                              WHEN nettype=1                              THEN dl_flow                              ELSE 0                          END)/MAX(tb1.sumdl_flow),2.0) AS data8 ,                      SUM(                          CASE                              WHEN nettype=2                              THEN dl_flow                              ELSE 0                          END) AS data9,                      ROUND( SUM(                          CASE                              WHEN nettype=2                              THEN dl_flow                              ELSE 0                          END)/MAX(tb1.sumdl_flow),2.0) AS data10 ,                      SUM(                          CASE                              WHEN nettype=1                              THEN delay                              ELSE 0                          END) AS data41,                      SUM(                          CASE                              WHEN nettype=1                              THEN dl_flow                              ELSE 0                          END) AS data42 ,                      ROUND( SUM(                          CASE                              WHEN nettype=1                              THEN dl_flow                              ELSE 0                          END)/SUM(                          CASE                              WHEN nettype=1                              THEN delay                              ELSE 0                          END)*8000/1024 ,2.0)AS data43,                      SUM(                          CASE                              WHEN nettype=2                              THEN delay                              ELSE 0                          END) AS data44,                      SUM(                          CASE                              WHEN nettype=2                              THEN dl_flow                              ELSE 0                          END) AS data45 ,                      ROUND(SUM(                          CASE                              WHEN nettype=2                              THEN dl_flow                              ELSE 0                          END)/SUM(                          CASE                              WHEN nettype=2                              THEN delay                              ELSE 0                          END)*8000/1024,2.0) AS data46,                      SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN delay                              ELSE 0                          END) AS data47,                      SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN dl_flow                              ELSE 0                          END) AS data48,                      ROUND(SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN dl_flow                              ELSE 0                          END)/SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN delay                              ELSE 0                          END)*8000/1024,2.0) AS data49                  FROM                      lte_sys.[@c0]_T_QUALITYSTATISTICS_ALLUSER tb2 ,                      (                          SELECT                              SUM(xdr_count) sumcnt,                              SUM(delay)     sumdelay,                              SUM(dl_flow)   sumdl_flow                          FROM                              lte_sys.[@c0]_T_QUALITYSTATISTICS_ALLUSER                          WHERE                              nettype IN (1,2)                          AND AppType IN(15,1,5,6,7,8)                          AND dl_flow>0                          AND hour>='[@c1]'                          AND hour<='[@c2]' )tb1                  WHERE                      nettype IN (1,2)                  AND AppType IN(15,1,5,6,7,8)                  AND dl_flow>0                  AND hour>='[@c1]'                  AND hour<='[@c2]'                  GROUP BY                      AppType ) t1          LEFT JOIN              (                  SELECT                      (                          CASE                              WHEN AppType=1                              THEN '即时通信'                              WHEN AppType=15                              THEN '浏览'                              WHEN AppType=5                              THEN '视频'                              WHEN AppType=6                              THEN '音乐'                              WHEN AppType=7                              THEN '应用商店'                              WHEN AppType=8                              THEN '游戏'                          END ) AS ndata2,                      SUM(                          CASE                              WHEN nettype=1                              THEN delay                              ELSE 0                          END) AS data11,                      SUM(                          CASE                              WHEN nettype=1                              THEN dl_flow                              ELSE 0                          END) AS data12,                      ROUND(SUM(                          CASE                              WHEN nettype=1                              THEN dl_flow                              ELSE 0                          END)/SUM(                          CASE                              WHEN nettype=1                              THEN delay                              ELSE 0                          END)*8000/1024,2.0) AS data13,                      SUM(                          CASE                              WHEN nettype=1                              THEN satisfied_xdr_count                              ELSE 0                          END) AS data14,                      SUM(                          CASE                              WHEN nettype=1                              THEN satisfied_sucess_xdr_count                              ELSE 0                          END) AS data15 ,                      ROUND(SUM(                          CASE                              WHEN nettype=1                              THEN satisfied_sucess_xdr_count                              ELSE 0                          END)/SUM(                          CASE                              WHEN nettype=1                              THEN satisfied_xdr_count                              ELSE 0                          END),2.0) AS data16,                      SUM(                          CASE                              WHEN nettype=1                              THEN satisfied_xdr_count                              ELSE 0                          END) AS data17,                      SUM(                          CASE                              WHEN nettype=1                              THEN satisfied_speed_xdr_count                              ELSE 0                          END) AS data18 ,                      ROUND(SUM(                          CASE                              WHEN nettype=1                              THEN satisfied_speed_xdr_count                              ELSE 0                          END)/SUM(                          CASE                              WHEN nettype=1                              THEN satisfied_xdr_count                              ELSE 0                          END),2.0) AS data19,                      ROUND(SUM(                          CASE                              WHEN nettype=1                              THEN satisfied_sucess_xdr_count*satisfied_speed_xdr_count                              ELSE 0                          END)/SUM(                          CASE                              WHEN nettype=1                              THEN satisfied_xdr_count*satisfied_xdr_count                              ELSE 0                          END),2.0) AS data20,                      SUM(                          CASE                              WHEN nettype=2                              THEN delay                              ELSE 0                          END) AS data21,                      SUM(                          CASE                              WHEN nettype=2                              THEN dl_flow                              ELSE 0                          END) AS data22,                      ROUND( SUM(                          CASE                              WHEN nettype=2                              THEN dl_flow                              ELSE 0                          END)/SUM(                          CASE                              WHEN nettype=2                              THEN delay                              ELSE 0                          END)*8000/1024,2.0) AS data23,                      SUM(                          CASE                              WHEN nettype=2                              THEN satisfied_xdr_count                              ELSE 0                          END) AS data24,                      SUM(                          CASE                              WHEN nettype=2                              THEN satisfied_sucess_xdr_count                              ELSE 0                          END) AS data25 ,                      ROUND( SUM(                          CASE                              WHEN nettype=2                              THEN satisfied_sucess_xdr_count                              ELSE 0                          END)/SUM(                          CASE                              WHEN nettype=2                              THEN satisfied_xdr_count                              ELSE 0                          END),2.0) AS data26,                      SUM(                          CASE                              WHEN nettype=2                              THEN satisfied_xdr_count                              ELSE 0                          END) AS data27,                      SUM(                          CASE                              WHEN nettype=2                              THEN satisfied_speed_xdr_count                              ELSE 0                          END) AS data28 ,                      ROUND( SUM(                          CASE                              WHEN nettype=2                              THEN satisfied_speed_xdr_count                              ELSE 0                          END)/SUM(                          CASE                              WHEN nettype=2                              THEN satisfied_xdr_count                              ELSE 0                          END),2.0) AS data29,                      ROUND(SUM(                          CASE                              WHEN nettype=2                              THEN satisfied_sucess_xdr_count*satisfied_speed_xdr_count                              ELSE 0                          END)/SUM(                          CASE                              WHEN nettype=2                              THEN satisfied_xdr_count*satisfied_xdr_count                              ELSE 0                          END),2.0) AS data30,                      SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN delay                              ELSE 0                          END) AS data31,                      SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN dl_flow                              ELSE 0                          END) AS data32,                      ROUND( SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN dl_flow                              ELSE 0                          END)/SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN delay                              ELSE 0                          END)*8000/1024,2.0) AS data33,                      SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN satisfied_xdr_count                              ELSE 0                          END) AS data34,                      SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN satisfied_sucess_xdr_count                              ELSE 0                          END) AS data35 ,                      ROUND( SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN satisfied_sucess_xdr_count                              ELSE 0                          END)/SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN satisfied_xdr_count                              ELSE 0                          END) ,2.0)AS data36,                      SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN satisfied_xdr_count                              ELSE 0                          END) AS data37,                      SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN satisfied_speed_xdr_count                              ELSE 0                          END) AS data38 ,                      ROUND(SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN satisfied_speed_xdr_count                              ELSE 0                          END)/SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN satisfied_xdr_count                              ELSE 0                          END),2.0) AS data39,                      ROUND( SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN satisfied_sucess_xdr_count*satisfied_speed_xdr_count                              ELSE 0                          END)/SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN satisfied_xdr_count*satisfied_xdr_count                              ELSE 0                          END),2.0) AS data40                  FROM                      lte_sys.[@c0]_T_QUALITYSTATISTICS_ALLUSER tb2 ,                      (                          SELECT                              SUM(xdr_count) sumcnt,                              SUM(delay)     sumdelay,                              SUM(dl_flow)   sumdl_flow                          FROM                              lte_sys.[@c0]_T_QUALITYSTATISTICS_ALLUSER                          WHERE                              dl_flow>5120                          AND AppType IN(15,1,5,6,7,8)                          AND hour>='[@c1]'                          AND hour<='[@c2]' )tb1                  WHERE                      dl_flow>5120                  AND AppType IN(15,1,5,6,7,8)                  AND hour>='[@c1]'                  AND hour<='[@c2]'                  GROUP BY                      AppType )t2          ON              t1.data2=t2.ndata2          UNION          SELECT              t1.*,              t2.*          FROM              (                  SELECT                      '室外用户' AS data1,                      '全网'   AS data2,                      SUM(                          CASE                              WHEN nettype=1                              THEN delay                              ELSE 0                          END) AS data3,                      ROUND( SUM(                          CASE                              WHEN nettype=1                              THEN delay                              ELSE 0                          END)/MAX(tb1.sumdelay),2.0) AS data4 ,                      SUM(                          CASE                              WHEN nettype=2                              THEN delay                              ELSE 0                          END) AS data5,                      ROUND( SUM(                          CASE                              WHEN nettype=2                              THEN delay                              ELSE 0                          END)/MAX(tb1.sumdelay),2.0) AS data6 ,                      SUM(                          CASE                              WHEN nettype=1                              THEN dl_flow                              ELSE 0                          END) AS data7,                      ROUND(SUM(                          CASE                              WHEN nettype=1                              THEN dl_flow                              ELSE 0                          END)/MAX(tb1.sumdl_flow),2.0) AS data8 ,                      SUM(                          CASE                              WHEN nettype=2                              THEN dl_flow                              ELSE 0                          END) AS data9,                      ROUND( SUM(                          CASE                              WHEN nettype=2                              THEN dl_flow                              ELSE 0                          END)/MAX(tb1.sumdl_flow),2.0) AS data10 ,                      SUM(                          CASE                              WHEN nettype=1                              THEN delay                              ELSE 0                          END) AS data41,                      SUM(                          CASE                              WHEN nettype=1                              THEN dl_flow                              ELSE 0                          END) AS data42 ,                      ROUND( SUM(                          CASE                              WHEN nettype=1                              THEN dl_flow                              ELSE 0                          END)/SUM(                          CASE                              WHEN nettype=1                              THEN delay                              ELSE 0                          END)*8000/1024 ,2.0)AS data43,                      SUM(                          CASE                              WHEN nettype=2                              THEN delay                              ELSE 0                          END) AS data44,                      SUM(                          CASE                              WHEN nettype=2                              THEN dl_flow                              ELSE 0                          END) AS data45 ,                      ROUND( SUM(                          CASE                              WHEN nettype=2                              THEN dl_flow                              ELSE 0                          END)/SUM(                          CASE                              WHEN nettype=2                              THEN delay                              ELSE 0                          END)*8000/1024,2.0) AS data46,                      SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN delay                              ELSE 0                          END) AS data47,                      SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN dl_flow                              ELSE 0                          END) AS data48,                      ROUND( SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN dl_flow                              ELSE 0                          END)/SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN delay                              ELSE 0                          END)*8000/1024,2.0) AS data49                  FROM                      lte_sys.[@c0]_T_QUALITYSTATISTICS_ALLUSER tb2 ,                      (                          SELECT                              SUM(xdr_count) sumcnt,                              SUM(delay)     sumdelay,                              SUM(dl_flow)   sumdl_flow                          FROM                              lte_sys.[@c0]_T_QUALITYSTATISTICS_ALLUSER                          WHERE                              nettype IN (1,2)                          AND AppType IN(15,1,5,6,7,8)                          AND hour>='[@c1]'                          AND hour<='[@c2]'                          AND dl_flow>0                          AND scene1=1 )tb1                  WHERE                      nettype IN (1,2)                  AND AppType IN(15,1,5,6,7,8)                  AND hour>='[@c1]'                  AND hour<='[@c2]'                  AND dl_flow>0                  AND scene1=1 ) t1          LEFT JOIN              (                  SELECT                      '全网' AS ndata2,                      SUM(                          CASE                              WHEN nettype=1                              THEN delay                              ELSE 0                          END) AS data11,                      SUM(                          CASE                              WHEN nettype=1                              THEN dl_flow                              ELSE 0                          END) AS data12,                      ROUND( SUM(                          CASE                              WHEN nettype=1                              THEN dl_flow                              ELSE 0                          END)/SUM(                          CASE                              WHEN nettype=1                              THEN delay                              ELSE 0                          END)*8000/1024,2.0) AS data13,                      SUM(                          CASE                              WHEN nettype=1                              THEN satisfied_xdr_count                              ELSE 0                          END) AS data14,                      SUM(                          CASE                              WHEN nettype=1                              THEN satisfied_sucess_xdr_count                              ELSE 0                          END) AS data15 ,                      ROUND(SUM(                          CASE                              WHEN nettype=1                              THEN satisfied_sucess_xdr_count                              ELSE 0                          END)/SUM(                          CASE                              WHEN nettype=1                              THEN satisfied_xdr_count                              ELSE 0                          END),2.0) AS data16,                      SUM(                          CASE                              WHEN nettype=1                              THEN satisfied_xdr_count                              ELSE 0                          END) AS data17,                      SUM(                          CASE                              WHEN nettype=1                              THEN satisfied_speed_xdr_count                              ELSE 0                          END) AS data18 ,                      ROUND( SUM(                          CASE                              WHEN nettype=1                              THEN satisfied_speed_xdr_count                              ELSE 0                          END)/SUM(                          CASE                              WHEN nettype=1                              THEN satisfied_xdr_count                              ELSE 0                          END) ,2.0)AS data19,                      ROUND( SUM(                          CASE                              WHEN nettype=1                              THEN satisfied_sucess_xdr_count*satisfied_speed_xdr_count                              ELSE 0                          END)/SUM(                          CASE                              WHEN nettype=1                              THEN satisfied_xdr_count*satisfied_xdr_count                              ELSE 0                          END),2.0) AS data20,                      SUM(                          CASE                              WHEN nettype=2                              THEN delay                              ELSE 0                          END) AS data21,                      SUM(                          CASE                              WHEN nettype=2                              THEN dl_flow                              ELSE 0                          END) AS data22,                      ROUND( SUM(                          CASE                              WHEN nettype=2                              THEN dl_flow                              ELSE 0                          END)/SUM(                          CASE                              WHEN nettype=2                              THEN delay                              ELSE 0                          END)*8000/1024,2.0) AS data23,                      SUM(                          CASE                              WHEN nettype=2                              THEN satisfied_xdr_count                              ELSE 0                          END) AS data24,                      SUM(                          CASE                              WHEN nettype=2                              THEN satisfied_sucess_xdr_count                              ELSE 0                          END) AS data25 ,                      ROUND( SUM(                          CASE                              WHEN nettype=2                              THEN satisfied_sucess_xdr_count                              ELSE 0                          END)/SUM(                          CASE                              WHEN nettype=2                              THEN satisfied_xdr_count                              ELSE 0                          END),2.0) AS data26,                      SUM(                          CASE                              WHEN nettype=2                              THEN satisfied_xdr_count                              ELSE 0                          END) AS data27,                      SUM(                          CASE                              WHEN nettype=2                              THEN satisfied_speed_xdr_count                              ELSE 0                          END) AS data28 ,                      ROUND( SUM(                          CASE                              WHEN nettype=2                              THEN satisfied_speed_xdr_count                              ELSE 0                          END)/SUM(                          CASE                              WHEN nettype=2                              THEN satisfied_xdr_count                              ELSE 0                          END),2.0) AS data29,                      ROUND( SUM(                          CASE                              WHEN nettype=2                              THEN satisfied_sucess_xdr_count*satisfied_speed_xdr_count                              ELSE 0                          END)/SUM(                          CASE                              WHEN nettype=2                              THEN satisfied_xdr_count*satisfied_xdr_count                              ELSE 0                          END),2.0) AS data30,                      SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN delay                              ELSE 0                          END) AS data31,                      SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN dl_flow                              ELSE 0                          END) AS data32,                      ROUND( SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN dl_flow                              ELSE 0                          END)/SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN delay                              ELSE 0                          END)*8000/1024,2.0) AS data33,                      SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN satisfied_xdr_count                              ELSE 0                          END) AS data34,                      SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN satisfied_sucess_xdr_count                              ELSE 0                          END) AS data35 ,                      ROUND( SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN satisfied_sucess_xdr_count                              ELSE 0                          END)/SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN satisfied_xdr_count                              ELSE 0                          END),2.0) AS data36,                      SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN satisfied_xdr_count                              ELSE 0                          END) AS data37,                      SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN satisfied_speed_xdr_count                              ELSE 0                          END) AS data38 ,                      ROUND( SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN satisfied_speed_xdr_count                              ELSE 0                          END)/SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN satisfied_xdr_count                              ELSE 0                          END),2.0) AS data39,                      ROUND( SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN satisfied_sucess_xdr_count*satisfied_speed_xdr_count                              ELSE 0                          END)/SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN satisfied_xdr_count*satisfied_xdr_count                              ELSE 0                          END) ,2.0)AS data40                  FROM                      lte_sys.[@c0]_T_QUALITYSTATISTICS_ALLUSER tb2 ,                      (                          SELECT                              SUM(xdr_count) sumcnt,                              SUM(delay)     sumdelay,                              SUM(dl_flow)   sumdl_flow                          FROM                              lte_sys.[@c0]_T_QUALITYSTATISTICS_ALLUSER                          WHERE                              dl_flow>5120                          AND AppType IN(15,1,5,6,7,8)                          AND hour>='[@c1]'                          AND hour<='[@c2]'                          AND scene1=1 )tb1                  WHERE                      dl_flow>5120                  AND AppType IN(15,1,5,6,7,8)                  AND hour>='[@c1]'                  AND hour<='[@c2]'                  AND scene1=1 )t2          ON              t1.data2=t2.ndata2          UNION          SELECT              t1.*,              t2.*          FROM              (                  SELECT                      '室外用户' AS data1,                      (                          CASE                              WHEN AppType=1                              THEN '即时通信'                              WHEN AppType=15                              THEN '浏览'                              WHEN AppType=5                              THEN '视频'                              WHEN AppType=6                              THEN '音乐'                              WHEN AppType=7                              THEN '应用商店'                              WHEN AppType=8                              THEN '游戏'                          END ) AS data2,                      SUM(                          CASE                              WHEN nettype=1                              THEN delay                              ELSE 0                          END) AS data3,                      ROUND( SUM(                          CASE                              WHEN nettype=1                              THEN delay                              ELSE 0                          END)/MAX(tb1.sumdelay),2.0) AS data4 ,                      SUM(                          CASE                              WHEN nettype=2                              THEN delay                              ELSE 0                          END) AS data5,                      ROUND( SUM(                          CASE                              WHEN nettype=2                              THEN delay                              ELSE 0                          END)/MAX(tb1.sumdelay),2.0) AS data6 ,                      SUM(                          CASE                              WHEN nettype=1                              THEN dl_flow                              ELSE 0                          END) AS data7,                      ROUND(SUM(                          CASE                              WHEN nettype=1                              THEN dl_flow                              ELSE 0                          END)/MAX(tb1.sumdl_flow),2.0) AS data8 ,                      SUM(                          CASE                              WHEN nettype=2                              THEN dl_flow                              ELSE 0                          END) AS data9,                      ROUND( SUM(                          CASE                              WHEN nettype=2                              THEN dl_flow                              ELSE 0                          END)/MAX(tb1.sumdl_flow),2.0) AS data10 ,                      SUM(                          CASE                              WHEN nettype=1                              THEN delay                              ELSE 0                          END) AS data41,                      SUM(                          CASE                              WHEN nettype=1                              THEN dl_flow                              ELSE 0                          END) AS data42 ,                      ROUND( SUM(                          CASE                              WHEN nettype=1                              THEN dl_flow                              ELSE 0                          END)/SUM(                          CASE                              WHEN nettype=1                              THEN delay                              ELSE 0                          END)*8000/1024 ,2.0)AS data43,                      SUM(                          CASE                              WHEN nettype=2                              THEN delay                              ELSE 0                          END) AS data44,                      SUM(                          CASE                              WHEN nettype=2                              THEN dl_flow                              ELSE 0                          END) AS data45 ,                      ROUND( SUM(                          CASE                              WHEN nettype=2                              THEN dl_flow                              ELSE 0                          END)/SUM(                          CASE                              WHEN nettype=2                              THEN delay                              ELSE 0                          END)*8000/1024,2.0) AS data46,                      SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN delay                              ELSE 0                          END) AS data47,                      SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN dl_flow                              ELSE 0                          END) AS data48,                      ROUND( SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN dl_flow                              ELSE 0                          END)/SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN delay                              ELSE 0                          END)*8000/1024,2.0) AS data49                  FROM                      lte_sys.[@c0]_T_QUALITYSTATISTICS_ALLUSER tb2 ,                      (                          SELECT                              SUM(xdr_count) sumcnt,                              SUM(delay)     sumdelay,                              SUM(dl_flow)   sumdl_flow                          FROM                              lte_sys.[@c0]_T_QUALITYSTATISTICS_ALLUSER                          WHERE                              nettype IN (1,2)                          AND AppType IN(15,1,5,6,7,8)                          AND hour>='[@c1]'                          AND hour<='[@c2]'                          AND dl_flow>0                          AND scene1=1 )tb1                  WHERE                      nettype IN (1,2)                  AND AppType IN(15,1,5,6,7,8)                  AND hour>='[@c1]'                  AND hour<='[@c2]'                  AND dl_flow>0                  AND scene1=1                  GROUP BY                      AppType ) t1          LEFT JOIN              (                  SELECT                      (                          CASE                              WHEN AppType=1                              THEN '即时通信'                              WHEN AppType=15                              THEN '浏览'                              WHEN AppType=5                              THEN '视频'                              WHEN AppType=6                              THEN '音乐'                              WHEN AppType=7                              THEN '应用商店'                              WHEN AppType=8                              THEN '游戏'                          END ) AS ndata2,                      SUM(                          CASE                              WHEN nettype=1                              THEN delay                              ELSE 0                          END) AS data11,                      SUM(                          CASE                              WHEN nettype=1                              THEN dl_flow                              ELSE 0                          END) AS data12,                      ROUND( SUM(                          CASE                              WHEN nettype=1                              THEN dl_flow                              ELSE 0                          END)/SUM(                          CASE                              WHEN nettype=1                              THEN delay                              ELSE 0                          END)*8000/1024,2.0) AS data13,                      SUM(                          CASE                              WHEN nettype=1                              THEN satisfied_xdr_count                              ELSE 0                          END) AS data14,                      SUM(                          CASE                              WHEN nettype=1                              THEN satisfied_sucess_xdr_count                              ELSE 0                          END) AS data15 ,                      ROUND(SUM(                          CASE                              WHEN nettype=1                              THEN satisfied_sucess_xdr_count                              ELSE 0                          END)/SUM(                          CASE                              WHEN nettype=1                              THEN satisfied_xdr_count                              ELSE 0                          END),2.0) AS data16,                      SUM(                          CASE                              WHEN nettype=1                              THEN satisfied_xdr_count                              ELSE 0                          END) AS data17,                      SUM(                          CASE                              WHEN nettype=1                              THEN satisfied_speed_xdr_count                              ELSE 0                          END) AS data18 ,                      ROUND(SUM(                          CASE                              WHEN nettype=1                              THEN satisfied_speed_xdr_count                              ELSE 0                          END)/SUM(                          CASE                              WHEN nettype=1                              THEN satisfied_xdr_count                              ELSE 0                          END),2.0) AS data19,                      ROUND(SUM(                          CASE                              WHEN nettype=1                              THEN satisfied_sucess_xdr_count*satisfied_speed_xdr_count                              ELSE 0                          END)/SUM(                          CASE                              WHEN nettype=1                              THEN satisfied_xdr_count*satisfied_xdr_count                              ELSE 0                          END),2.0) AS data20,                      SUM(                          CASE                              WHEN nettype=2                              THEN delay                              ELSE 0                          END) AS data21,                      SUM(                          CASE                              WHEN nettype=2                              THEN dl_flow                              ELSE 0                          END) AS data22,                      ROUND( SUM(                          CASE                              WHEN nettype=2                              THEN dl_flow                              ELSE 0                          END)/SUM(                          CASE                              WHEN nettype=2                              THEN delay                              ELSE 0                          END)*8000/1024,2.0) AS data23,                      SUM(                          CASE                              WHEN nettype=2                              THEN satisfied_xdr_count                              ELSE 0                          END) AS data24,                      SUM(                          CASE                              WHEN nettype=2                              THEN satisfied_sucess_xdr_count                              ELSE 0                          END) AS data25 ,                      ROUND( SUM(                          CASE                              WHEN nettype=2                              THEN satisfied_sucess_xdr_count                              ELSE 0                          END)/SUM(                          CASE                              WHEN nettype=2                              THEN satisfied_xdr_count                              ELSE 0                          END),2.0) AS data26,                      SUM(                          CASE                              WHEN nettype=2                              THEN satisfied_xdr_count                              ELSE 0                          END) AS data27,                      SUM(                          CASE                              WHEN nettype=2                              THEN satisfied_speed_xdr_count                              ELSE 0                          END) AS data28 ,                      ROUND( SUM(                          CASE                              WHEN nettype=2                              THEN satisfied_speed_xdr_count                              ELSE 0                          END)/SUM(                          CASE                              WHEN nettype=2                              THEN satisfied_xdr_count                              ELSE 0                          END),2.0) AS data29,                      ROUND( SUM(                          CASE                              WHEN nettype=2                              THEN satisfied_sucess_xdr_count*satisfied_speed_xdr_count                              ELSE 0                          END)/SUM(                          CASE                              WHEN nettype=2                              THEN satisfied_xdr_count*satisfied_xdr_count                              ELSE 0                          END),2.0) AS data30,                      SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN delay                              ELSE 0                          END) AS data31,                      SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN dl_flow                              ELSE 0                          END) AS data32,                      ROUND(SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN dl_flow                              ELSE 0                          END)/SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN delay                              ELSE 0                          END)*8000/1024,2.0) AS data33,                      SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN satisfied_xdr_count                              ELSE 0                          END) AS data34,                      SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN satisfied_sucess_xdr_count                              ELSE 0                          END) AS data35 ,                      ROUND(SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN satisfied_sucess_xdr_count                              ELSE 0                          END)/SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN satisfied_xdr_count                              ELSE 0                          END),2.0) AS data36,                      SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN satisfied_xdr_count                              ELSE 0                          END) AS data37,                      SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN satisfied_speed_xdr_count                              ELSE 0                          END) AS data38 ,                      ROUND(SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN satisfied_speed_xdr_count                              ELSE 0                          END)/SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN satisfied_xdr_count                              ELSE 0                          END),2.0) AS data39,                      ROUND( SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN satisfied_sucess_xdr_count*satisfied_speed_xdr_count                              ELSE 0                          END)/SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN satisfied_xdr_count*satisfied_xdr_count                              ELSE 0                          END),2.0) AS data40                  FROM                      lte_sys.[@c0]_T_QUALITYSTATISTICS_ALLUSER tb2 ,                      (                          SELECT                              SUM(xdr_count) sumcnt,                              SUM(delay)     sumdelay,                              SUM(dl_flow)   sumdl_flow                          FROM                              lte_sys.[@c0]_T_QUALITYSTATISTICS_ALLUSER                          WHERE                              dl_flow>5120                          AND AppType IN(15,1,5,6,7,8)                          AND hour>='[@c1]'                          AND hour<='[@c2]'                          AND scene1=1 )tb1                  WHERE                      dl_flow>5120                  AND AppType IN(15,1,5,6,7,8)                  AND hour>='[@c1]'                  AND hour<='[@c2]'                  AND scene1=1                  GROUP BY                      AppType )t2          ON              t1.data2=t2.ndata2          UNION          SELECT              t1.*,              t2.*          FROM              (                  SELECT                      '室内用户' AS data1,                      '全网'   AS data2,                      SUM(                          CASE                              WHEN nettype=1                              THEN delay                              ELSE 0                          END) AS data3,                      ROUND( SUM(                          CASE                              WHEN nettype=1                              THEN delay                              ELSE 0                          END)/MAX(tb1.sumdelay),2.0) AS data4 ,                      SUM(                          CASE                              WHEN nettype=2                              THEN delay                              ELSE 0                          END) AS data5,                      ROUND( SUM(                          CASE                              WHEN nettype=2                              THEN delay                              ELSE 0                          END)/MAX(tb1.sumdelay),2.0) AS data6 ,                      SUM(                          CASE                              WHEN nettype=1                              THEN dl_flow                              ELSE 0                          END) AS data7,                      ROUND(SUM(                          CASE                              WHEN nettype=1                              THEN dl_flow                              ELSE 0                          END)/MAX(tb1.sumdl_flow),2.0) AS data8 ,                      SUM(                          CASE                              WHEN nettype=2                              THEN dl_flow                              ELSE 0                          END) AS data9,                      ROUND( SUM(                          CASE                              WHEN nettype=2                              THEN dl_flow                              ELSE 0                          END)/MAX(tb1.sumdl_flow),2.0) AS data10 ,                      SUM(                          CASE                              WHEN nettype=1                              THEN delay                              ELSE 0                          END) AS data41,                      SUM(                          CASE                              WHEN nettype=1                              THEN dl_flow                              ELSE 0                          END) AS data42 ,                      ROUND( SUM(                          CASE                              WHEN nettype=1                              THEN dl_flow                              ELSE 0                          END)/SUM(                          CASE                              WHEN nettype=1                              THEN delay                              ELSE 0                          END)*8000/1024 ,2.0)AS data43,                      SUM(                          CASE                              WHEN nettype=2                              THEN delay                              ELSE 0                          END) AS data44,                      SUM(                          CASE                              WHEN nettype=2                              THEN dl_flow                              ELSE 0                          END) AS data45 ,                      ROUND( SUM(                          CASE                              WHEN nettype=2                              THEN dl_flow                              ELSE 0                          END)/SUM(                          CASE                              WHEN nettype=2                              THEN delay                              ELSE 0                          END)*8000/1024,2.0) AS data46,                      SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN delay                              ELSE 0                          END) AS data47,                      SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN dl_flow                              ELSE 0                          END) AS data48,                      ROUND( SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN dl_flow                              ELSE 0                          END)/SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN delay                              ELSE 0                          END)*8000/1024,2.0) AS data49                  FROM                      lte_sys.[@c0]_T_QUALITYSTATISTICS_ALLUSER tb2 ,                      (                          SELECT                              SUM(xdr_count) sumcnt,                              SUM(delay)     sumdelay,                              SUM(dl_flow)   sumdl_flow                          FROM                              lte_sys.[@c0]_T_QUALITYSTATISTICS_ALLUSER                          WHERE                              nettype IN (1,2)                          AND AppType IN(15,1,5,6,7,8)                          AND hour>='[@c1]'                          AND hour<='[@c2]'                          AND dl_flow>0                          AND scene1<>1 )tb1                  WHERE                      nettype IN (1,2)                  AND AppType IN(15,1,5,6,7,8)                  AND hour>='[@c1]'                  AND hour<='[@c2]'                  AND dl_flow>0                  AND scene1<>1 ) t1          LEFT JOIN              (                  SELECT                      '全网' AS ndata2,                      SUM(                          CASE                              WHEN nettype=1                              THEN delay                              ELSE 0                          END) AS data11,                      SUM(                          CASE                              WHEN nettype=1                              THEN dl_flow                              ELSE 0                          END) AS data12,                      ROUND( SUM(                          CASE                              WHEN nettype=1                              THEN dl_flow                              ELSE 0                          END)/SUM(                          CASE                              WHEN nettype=1                              THEN delay                              ELSE 0                          END)*8000/1024,2.0) AS data13,                      SUM(                          CASE                              WHEN nettype=1                              THEN satisfied_xdr_count                              ELSE 0                          END) AS data14,                      SUM(                          CASE                              WHEN nettype=1                              THEN satisfied_sucess_xdr_count                              ELSE 0                          END) AS data15 ,                      ROUND(SUM(                          CASE                              WHEN nettype=1                              THEN satisfied_sucess_xdr_count                              ELSE 0                          END)/SUM(                          CASE                              WHEN nettype=1                              THEN satisfied_xdr_count                              ELSE 0                          END),2.0) AS data16,                      SUM(                          CASE                              WHEN nettype=1                              THEN satisfied_xdr_count                              ELSE 0                          END) AS data17,                      SUM(                          CASE                              WHEN nettype=1                              THEN satisfied_speed_xdr_count                              ELSE 0                          END) AS data18 ,                      ROUND( SUM(                          CASE                              WHEN nettype=1                              THEN satisfied_speed_xdr_count                              ELSE 0                          END)/SUM(                          CASE                              WHEN nettype=1                              THEN satisfied_xdr_count                              ELSE 0                          END) ,2.0)AS data19,                      ROUND( SUM(                          CASE                              WHEN nettype=1                              THEN satisfied_sucess_xdr_count*satisfied_speed_xdr_count                              ELSE 0                          END)/SUM(                          CASE                              WHEN nettype=1                              THEN satisfied_xdr_count*satisfied_xdr_count                              ELSE 0                          END),2.0) AS data20,                      SUM(                          CASE                              WHEN nettype=2                              THEN delay                              ELSE 0                          END) AS data21,                      SUM(                          CASE                              WHEN nettype=2                              THEN dl_flow                              ELSE 0                          END) AS data22,                      ROUND( SUM(                          CASE                              WHEN nettype=2                              THEN dl_flow                              ELSE 0                          END)/SUM(                          CASE                              WHEN nettype=2                              THEN delay                              ELSE 0                          END)*8000/1024,2.0) AS data23,                      SUM(                          CASE                              WHEN nettype=2                              THEN satisfied_xdr_count                              ELSE 0                          END) AS data24,                      SUM(                          CASE                              WHEN nettype=2                              THEN satisfied_sucess_xdr_count                              ELSE 0                          END) AS data25 ,                      ROUND( SUM(                          CASE                              WHEN nettype=2                              THEN satisfied_sucess_xdr_count                              ELSE 0                          END)/SUM(                          CASE                              WHEN nettype=2                              THEN satisfied_xdr_count                              ELSE 0                          END),2.0) AS data26,                      SUM(                          CASE                              WHEN nettype=2                              THEN satisfied_xdr_count                              ELSE 0                          END) AS data27,                      SUM(                          CASE                              WHEN nettype=2                              THEN satisfied_speed_xdr_count                              ELSE 0                          END) AS data28 ,                      ROUND( SUM(                          CASE                              WHEN nettype=2                              THEN satisfied_speed_xdr_count                              ELSE 0                          END)/SUM(                          CASE                              WHEN nettype=2                              THEN satisfied_xdr_count                              ELSE 0                          END),2.0) AS data29,                      ROUND( SUM(                          CASE                              WHEN nettype=2                              THEN satisfied_sucess_xdr_count*satisfied_speed_xdr_count                              ELSE 0                          END)/SUM(                          CASE                              WHEN nettype=2                              THEN satisfied_xdr_count*satisfied_xdr_count                              ELSE 0                          END),2.0) AS data30,                      SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN delay                              ELSE 0                          END) AS data31,                      SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN dl_flow                              ELSE 0                          END) AS data32,                      ROUND( SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN dl_flow                              ELSE 0                          END)/SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN delay                              ELSE 0                          END)*8000/1024,2.0) AS data33,                      SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN satisfied_xdr_count                              ELSE 0                          END) AS data34,                      SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN satisfied_sucess_xdr_count                              ELSE 0                          END) AS data35 ,                      ROUND( SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN satisfied_sucess_xdr_count                              ELSE 0                          END)/SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN satisfied_xdr_count                              ELSE 0                          END),2.0) AS data36,                      SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN satisfied_xdr_count                              ELSE 0                          END) AS data37,                      SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN satisfied_speed_xdr_count                              ELSE 0                          END) AS data38 ,                      ROUND( SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN satisfied_speed_xdr_count                              ELSE 0                          END)/SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN satisfied_xdr_count                              ELSE 0                          END),2.0) AS data39,                      ROUND( SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN satisfied_sucess_xdr_count*satisfied_speed_xdr_count                              ELSE 0                          END)/SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN satisfied_xdr_count*satisfied_xdr_count                              ELSE 0                          END) ,2.0)AS data40                  FROM                      lte_sys.[@c0]_T_QUALITYSTATISTICS_ALLUSER tb2 ,                      (                          SELECT                              SUM(xdr_count) sumcnt,                              SUM(delay)     sumdelay,                              SUM(dl_flow)   sumdl_flow                          FROM                              lte_sys.[@c0]_T_QUALITYSTATISTICS_ALLUSER                          WHERE                              dl_flow>5120                          AND AppType IN(15,1,5,6,7,8)                          AND hour>='[@c1]'                          AND hour<='[@c2]'                          AND scene1<>1 )tb1                  WHERE                      dl_flow>5120                  AND AppType IN(15,1,5,6,7,8)                  AND hour>='[@c1]'                  AND hour<='[@c2]'                  AND scene1<>1 )t2          ON              t1.data2=t2.ndata2          UNION          SELECT              t1.*,              t2.*          FROM              (                  SELECT                      '室内用户' AS data1,                      (                          CASE                              WHEN AppType=1                              THEN '即时通信'                              WHEN AppType=15                              THEN '浏览'                              WHEN AppType=5                              THEN '视频'                              WHEN AppType=6                              THEN '音乐'                              WHEN AppType=7                              THEN '应用商店'                              WHEN AppType=8                              THEN '游戏'                          END ) AS data2,                      SUM(                          CASE                              WHEN nettype=1                              THEN delay                              ELSE 0                          END) AS data3,                      ROUND( SUM(                          CASE                              WHEN nettype=1                              THEN delay                              ELSE 0                          END)/MAX(tb1.sumdelay),2.0) AS data4 ,                      SUM(                          CASE                              WHEN nettype=2                              THEN delay                              ELSE 0                          END) AS data5,                      ROUND( SUM(                          CASE                              WHEN nettype=2                              THEN delay                              ELSE 0                          END)/MAX(tb1.sumdelay),2.0) AS data6 ,                      SUM(                          CASE                              WHEN nettype=1                              THEN dl_flow                              ELSE 0                          END) AS data7,                      ROUND(SUM(                          CASE                              WHEN nettype=1                              THEN dl_flow                              ELSE 0                          END)/MAX(tb1.sumdl_flow),2.0) AS data8 ,                      SUM(                          CASE                              WHEN nettype=2                              THEN dl_flow                              ELSE 0                          END) AS data9,                      ROUND( SUM(                          CASE                              WHEN nettype=2                              THEN dl_flow                              ELSE 0                          END)/MAX(tb1.sumdl_flow),2.0) AS data10 ,                      SUM(                          CASE                              WHEN nettype=1                              THEN delay                              ELSE 0                          END) AS data41,                      SUM(                          CASE                              WHEN nettype=1                              THEN dl_flow                              ELSE 0                          END) AS data42 ,                      ROUND( SUM(                          CASE                              WHEN nettype=1                              THEN dl_flow                              ELSE 0                          END)/SUM(                          CASE                              WHEN nettype=1                              THEN delay                              ELSE 0                          END)*8000/1024 ,2.0)AS data43,                      SUM(                          CASE                              WHEN nettype=2                              THEN delay                              ELSE 0                          END) AS data44,                      SUM(                          CASE                              WHEN nettype=2                              THEN dl_flow                              ELSE 0                          END) AS data45 ,                      ROUND( SUM(                          CASE                              WHEN nettype=2                              THEN dl_flow                              ELSE 0                          END)/SUM(                          CASE                              WHEN nettype=2                              THEN delay                              ELSE 0                          END)*8000/1024,2.0) AS data46,                      SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN delay                              ELSE 0                          END) AS data47,                      SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN dl_flow                              ELSE 0                          END) AS data48,                      ROUND( SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN dl_flow                              ELSE 0                          END)/SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN delay                              ELSE 0                          END)*8000/1024,2.0) AS data49                  FROM                      lte_sys.[@c0]_T_QUALITYSTATISTICS_ALLUSER tb2 ,                      (                          SELECT                              SUM(xdr_count) sumcnt,                              SUM(delay)     sumdelay,                              SUM(dl_flow)   sumdl_flow                          FROM                              lte_sys.[@c0]_T_QUALITYSTATISTICS_ALLUSER                          WHERE                              nettype IN (1,2)                          AND AppType IN(15,1,5,6,7,8)                          AND hour>='[@c1]'                          AND hour<='[@c2]'                          AND dl_flow>0                          AND scene1<>1 )tb1                  WHERE                      nettype IN (1,2)                  AND AppType IN(15,1,5,6,7,8)                  AND hour>='[@c1]'                  AND hour<='[@c2]'                  AND dl_flow>0                  AND scene1<>1                  GROUP BY                      AppType ) t1          LEFT JOIN              (                  SELECT                      (                          CASE                              WHEN AppType=1                              THEN '即时通信'                              WHEN AppType=15                              THEN '浏览'                              WHEN AppType=5                              THEN '视频'                              WHEN AppType=6                              THEN '音乐'                              WHEN AppType=7                              THEN '应用商店'                              WHEN AppType=8                              THEN '游戏'                          END ) AS ndata2,                      SUM(                          CASE                              WHEN nettype=1                              THEN delay                              ELSE 0                          END) AS data11,                      SUM(                          CASE                              WHEN nettype=1                              THEN dl_flow                              ELSE 0                          END) AS data12,                      ROUND( SUM(                          CASE                              WHEN nettype=1                              THEN dl_flow                              ELSE 0                          END)/SUM(                          CASE                              WHEN nettype=1                              THEN delay                              ELSE 0                          END)*8000/1024,2.0) AS data13,                      SUM(                          CASE                              WHEN nettype=1                              THEN satisfied_xdr_count                              ELSE 0                          END) AS data14,                      SUM(                          CASE                              WHEN nettype=1                              THEN satisfied_sucess_xdr_count                              ELSE 0                          END) AS data15 ,                      ROUND(SUM(                          CASE                              WHEN nettype=1                              THEN satisfied_sucess_xdr_count                              ELSE 0                          END)/SUM(                          CASE                              WHEN nettype=1                              THEN satisfied_xdr_count                              ELSE 0                          END),2.0) AS data16,                      SUM(                          CASE                              WHEN nettype=1                              THEN satisfied_xdr_count                              ELSE 0                          END) AS data17,                      SUM(                          CASE                              WHEN nettype=1                              THEN satisfied_speed_xdr_count                              ELSE 0                          END) AS data18 ,                      ROUND( SUM(                          CASE                              WHEN nettype=1                              THEN satisfied_speed_xdr_count                              ELSE 0                          END)/SUM(                          CASE                              WHEN nettype=1                              THEN satisfied_xdr_count                              ELSE 0                          END) ,2.0)AS data19,                      ROUND( SUM(                          CASE                              WHEN nettype=1                              THEN satisfied_sucess_xdr_count*satisfied_speed_xdr_count                              ELSE 0                          END)/SUM(                          CASE                              WHEN nettype=1                              THEN satisfied_xdr_count*satisfied_xdr_count                              ELSE 0                          END),2.0) AS data20,                      SUM(                          CASE                              WHEN nettype=2                              THEN delay                              ELSE 0                          END) AS data21,                      SUM(                          CASE                              WHEN nettype=2                              THEN dl_flow                              ELSE 0                          END) AS data22,                      ROUND( SUM(                          CASE                              WHEN nettype=2                              THEN dl_flow                              ELSE 0                          END)/SUM(                          CASE                              WHEN nettype=2                              THEN delay                              ELSE 0                          END)*8000/1024,2.0) AS data23,                      SUM(                          CASE                              WHEN nettype=2                              THEN satisfied_xdr_count                              ELSE 0                          END) AS data24,                      SUM(                          CASE                              WHEN nettype=2                              THEN satisfied_sucess_xdr_count                              ELSE 0                          END) AS data25 ,                      ROUND( SUM(                          CASE                              WHEN nettype=2                              THEN satisfied_sucess_xdr_count                              ELSE 0                          END)/SUM(                          CASE                              WHEN nettype=2                              THEN satisfied_xdr_count                              ELSE 0                          END),2.0) AS data26,                      SUM(                          CASE                              WHEN nettype=2                              THEN satisfied_xdr_count                              ELSE 0                          END) AS data27,                      SUM(                          CASE                              WHEN nettype=2                              THEN satisfied_speed_xdr_count                              ELSE 0                          END) AS data28 ,                      ROUND( SUM(                          CASE                              WHEN nettype=2                              THEN satisfied_speed_xdr_count                              ELSE 0                          END)/SUM(                          CASE                              WHEN nettype=2                              THEN satisfied_xdr_count                              ELSE 0                          END),2.0) AS data29,                      ROUND( SUM(                          CASE                              WHEN nettype=2                              THEN satisfied_sucess_xdr_count*satisfied_speed_xdr_count                              ELSE 0                          END)/SUM(                          CASE                              WHEN nettype=2                              THEN satisfied_xdr_count*satisfied_xdr_count                              ELSE 0                          END),2.0) AS data30,                      SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN delay                              ELSE 0                          END) AS data31,                      SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN dl_flow                              ELSE 0                          END) AS data32,                      ROUND( SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN dl_flow                              ELSE 0                          END)/SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN delay                              ELSE 0                          END)*8000/1024,2.0) AS data33,                      SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN satisfied_xdr_count                              ELSE 0                          END) AS data34,                      SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN satisfied_sucess_xdr_count                              ELSE 0                          END) AS data35 ,                      ROUND( SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN satisfied_sucess_xdr_count                              ELSE 0                          END)/SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN satisfied_xdr_count                              ELSE 0                          END),2.0) AS data36,                      SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN satisfied_xdr_count                              ELSE 0                          END) AS data37,                      SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN satisfied_speed_xdr_count                              ELSE 0                          END) AS data38 ,                      ROUND( SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN satisfied_speed_xdr_count                              ELSE 0                          END)/SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN satisfied_xdr_count                              ELSE 0                          END),2.0) AS data39,                      ROUND( SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN satisfied_sucess_xdr_count*satisfied_speed_xdr_count                              ELSE 0                          END)/SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN satisfied_xdr_count*satisfied_xdr_count                              ELSE 0                          END) ,2.0)AS data40                  FROM                      lte_sys.[@c0]_T_QUALITYSTATISTICS_ALLUSER tb2 ,                      (                          SELECT                              SUM(xdr_count) sumcnt,                              SUM(delay)     sumdelay,                              SUM(dl_flow)   sumdl_flow                          FROM                              lte_sys.[@c0]_T_QUALITYSTATISTICS_ALLUSER                          WHERE                              dl_flow>5120                          AND AppType IN(15,1,5,6,7,8)                          AND hour>='[@c1]'                          AND hour<='[@c2]'                          AND scene1<>1 )tb1                  WHERE                      dl_flow>5120                  AND AppType IN(15,1,5,6,7,8)                  AND hour>='[@c1]'                  AND hour<='[@c2]'                  AND scene1<>1                  GROUP BY                      AppType )t2          ON              t1.data2=t2.ndata2          UNION          SELECT              t1.*,              t2.*          FROM              (                  SELECT                      '占用室分的室内稳定用户(有室分)' AS data1,                      '全网'               AS data2,                      SUM(                          CASE                              WHEN nettype=1                              THEN delay                              ELSE 0                          END) AS data3,                      ROUND( SUM(                          CASE                              WHEN nettype=1                              THEN delay                              ELSE 0                          END)/MAX(tb1.sumdelay),2.0) AS data4 ,                      SUM(                          CASE                              WHEN nettype=2                              THEN delay                              ELSE 0                          END) AS data5,                      ROUND( SUM(                          CASE                              WHEN nettype=2                              THEN delay                              ELSE 0                          END)/MAX(tb1.sumdelay),2.0) AS data6 ,                      SUM(                          CASE                              WHEN nettype=1                              THEN dl_flow                              ELSE 0                          END) AS data7,                      ROUND(SUM(                          CASE                              WHEN nettype=1                              THEN dl_flow                              ELSE 0                          END)/MAX(tb1.sumdl_flow),2.0) AS data8 ,                      SUM(                          CASE                              WHEN nettype=2                              THEN dl_flow                              ELSE 0                          END) AS data9,                      ROUND( SUM(                          CASE                              WHEN nettype=2                              THEN dl_flow                              ELSE 0                          END)/MAX(tb1.sumdl_flow),2.0) AS data10 ,                      SUM(                          CASE                              WHEN nettype=1                              THEN delay                              ELSE 0                          END) AS data41,                      SUM(                          CASE                              WHEN nettype=1                              THEN dl_flow                              ELSE 0                          END) AS data42 ,                      ROUND( SUM(                          CASE                              WHEN nettype=1                              THEN dl_flow                              ELSE 0                          END)/SUM(                          CASE                              WHEN nettype=1                              THEN delay                              ELSE 0                          END)*8000/1024 ,2.0)AS data43,                      SUM(                          CASE                              WHEN nettype=2                              THEN delay                              ELSE 0                          END) AS data44,                      SUM(                          CASE                              WHEN nettype=2                              THEN dl_flow                              ELSE 0                          END) AS data45 ,                      ROUND( SUM(                          CASE                              WHEN nettype=2                              THEN dl_flow                              ELSE 0                          END)/SUM(                          CASE                              WHEN nettype=2                              THEN delay                              ELSE 0                          END)*8000/1024,2.0) AS data46,                      SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN delay                              ELSE 0                          END) AS data47,                      SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN dl_flow                              ELSE 0                          END) AS data48,                      ROUND( SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN dl_flow                              ELSE 0                          END)/SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN delay                              ELSE 0                          END)*8000/1024,2.0) AS data49                  FROM                      lte_sys.[@c0]_T_QUALITYSTATISTICS_ALLUSER tb2 ,                      (                          SELECT                              SUM(xdr_count) sumcnt,                              SUM(delay)     sumdelay,                              SUM(dl_flow)   sumdl_flow                          FROM                              lte_sys.[@c0]_T_QUALITYSTATISTICS_ALLUSER                          WHERE                              nettype IN (1,2)                          AND AppType IN(15,1,5,6,7,8)                          AND hour>='[@c1]'                          AND hour<='[@c2]'                          AND dl_flow>0                          AND scene1=2 )tb1                  WHERE                      nettype IN (1,2)                  AND AppType IN(15,1,5,6,7,8)                  AND hour>='[@c1]'                  AND hour<='[@c2]'                  AND dl_flow>0                  AND scene1=2 ) t1          LEFT JOIN              (                  SELECT                      '全网' AS ndata2,                      SUM(                          CASE                              WHEN nettype=1                              THEN delay                              ELSE 0                          END) AS data11,                      SUM(                          CASE                              WHEN nettype=1                              THEN dl_flow                              ELSE 0                          END) AS data12,                      ROUND( SUM(                          CASE                              WHEN nettype=1                              THEN dl_flow                              ELSE 0                          END)/SUM(                          CASE                              WHEN nettype=1                              THEN delay                              ELSE 0                          END)*8000/1024,2.0) AS data13,                      SUM(                          CASE                              WHEN nettype=1                              THEN satisfied_xdr_count                              ELSE 0                          END) AS data14,                      SUM(                          CASE                              WHEN nettype=1                              THEN satisfied_sucess_xdr_count                              ELSE 0                          END) AS data15 ,                      ROUND(SUM(                          CASE                              WHEN nettype=1                              THEN satisfied_sucess_xdr_count                              ELSE 0                          END)/SUM(                          CASE                              WHEN nettype=1                              THEN satisfied_xdr_count                              ELSE 0                          END),2.0) AS data16,                      SUM(                          CASE                              WHEN nettype=1                              THEN satisfied_xdr_count                              ELSE 0                          END) AS data17,                      SUM(                          CASE                              WHEN nettype=1                              THEN satisfied_speed_xdr_count                              ELSE 0                          END) AS data18 ,                      ROUND( SUM(                          CASE                              WHEN nettype=1                              THEN satisfied_speed_xdr_count                              ELSE 0                          END)/SUM(                          CASE                              WHEN nettype=1                              THEN satisfied_xdr_count                              ELSE 0                          END) ,2.0)AS data19,                      ROUND( SUM(                          CASE                              WHEN nettype=1                              THEN satisfied_sucess_xdr_count*satisfied_speed_xdr_count                              ELSE 0                          END)/SUM(                          CASE                              WHEN nettype=1                              THEN satisfied_xdr_count*satisfied_xdr_count                              ELSE 0                          END),2.0) AS data20,                      SUM(                          CASE                              WHEN nettype=2                              THEN delay                              ELSE 0                          END) AS data21,                      SUM(                          CASE                              WHEN nettype=2                              THEN dl_flow                              ELSE 0                          END) AS data22,                      ROUND( SUM(                          CASE                              WHEN nettype=2                              THEN dl_flow                              ELSE 0                          END)/SUM(                          CASE                              WHEN nettype=2                              THEN delay                              ELSE 0                          END)*8000/1024,2.0) AS data23,                      SUM(                          CASE                              WHEN nettype=2                              THEN satisfied_xdr_count                              ELSE 0                          END) AS data24,                      SUM(                          CASE                              WHEN nettype=2                              THEN satisfied_sucess_xdr_count                              ELSE 0                          END) AS data25 ,                      ROUND( SUM(                          CASE                              WHEN nettype=2                              THEN satisfied_sucess_xdr_count                              ELSE 0                          END)/SUM(                          CASE                              WHEN nettype=2                              THEN satisfied_xdr_count                              ELSE 0                          END),2.0) AS data26,                      SUM(                          CASE                              WHEN nettype=2                              THEN satisfied_xdr_count                              ELSE 0                          END) AS data27,                      SUM(                          CASE                              WHEN nettype=2                              THEN satisfied_speed_xdr_count                              ELSE 0                          END) AS data28 ,                      ROUND( SUM(                          CASE                              WHEN nettype=2                              THEN satisfied_speed_xdr_count                              ELSE 0                          END)/SUM(                          CASE                              WHEN nettype=2                              THEN satisfied_xdr_count                              ELSE 0                          END),2.0) AS data29,                      ROUND( SUM(                          CASE                              WHEN nettype=2                              THEN satisfied_sucess_xdr_count*satisfied_speed_xdr_count                              ELSE 0                          END)/SUM(                          CASE                              WHEN nettype=2                              THEN satisfied_xdr_count*satisfied_xdr_count                              ELSE 0                          END),2.0) AS data30,                      SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN delay                              ELSE 0                          END) AS data31,                      SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN dl_flow                              ELSE 0                          END) AS data32,                      ROUND( SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN dl_flow                              ELSE 0                          END)/SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN delay                              ELSE 0                          END)*8000/1024,2.0) AS data33,                      SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN satisfied_xdr_count                              ELSE 0                          END) AS data34,                      SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN satisfied_sucess_xdr_count                              ELSE 0                          END) AS data35 ,                      ROUND( SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN satisfied_sucess_xdr_count                              ELSE 0                          END)/SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN satisfied_xdr_count                              ELSE 0                          END),2.0) AS data36,                      SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN satisfied_xdr_count                              ELSE 0                          END) AS data37,                      SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN satisfied_speed_xdr_count                              ELSE 0                          END) AS data38 ,                      ROUND( SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN satisfied_speed_xdr_count                              ELSE 0                          END)/SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN satisfied_xdr_count                              ELSE 0                          END),2.0) AS data39,                      ROUND( SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN satisfied_sucess_xdr_count*satisfied_speed_xdr_count                              ELSE 0                          END)/SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN satisfied_xdr_count*satisfied_xdr_count                              ELSE 0                          END) ,2.0)AS data40                  FROM                      lte_sys.[@c0]_T_QUALITYSTATISTICS_ALLUSER tb2 ,                      (                          SELECT                              SUM(xdr_count) sumcnt,                              SUM(delay)     sumdelay,                              SUM(dl_flow)   sumdl_flow                          FROM                              lte_sys.[@c0]_T_QUALITYSTATISTICS_ALLUSER                          WHERE                              dl_flow>5120                          AND AppType IN(15,1,5,6,7,8)                          AND hour>='[@c1]'                          AND hour<='[@c2]'                          AND scene1=2 )tb1                  WHERE                      dl_flow>5120                  AND AppType IN(15,1,5,6,7,8)                  AND hour>='[@c1]'                  AND hour<='[@c2]'                  AND scene1=2 )t2          ON              t1.data2=t2.ndata2          UNION          SELECT              t1.*,              t2.*          FROM              (                  SELECT                      '占用室分的室内稳定用户(有室分)' AS data1,                      (                          CASE                              WHEN AppType=1                              THEN '即时通信'                              WHEN AppType=15                              THEN '浏览'                              WHEN AppType=5                              THEN '视频'                              WHEN AppType=6                              THEN '音乐'                              WHEN AppType=7                              THEN '应用商店'                              WHEN AppType=8                              THEN '游戏'                          END ) AS data2,                      SUM(                          CASE                              WHEN nettype=1                              THEN delay                              ELSE 0                          END) AS data3,                      ROUND( SUM(                          CASE                              WHEN nettype=1                              THEN delay                              ELSE 0                          END)/MAX(tb1.sumdelay),2.0) AS data4 ,                      SUM(                          CASE                              WHEN nettype=2                              THEN delay                              ELSE 0                          END) AS data5,                      ROUND( SUM(                          CASE                              WHEN nettype=2                              THEN delay                              ELSE 0                          END)/MAX(tb1.sumdelay),2.0) AS data6 ,                      SUM(                          CASE                              WHEN nettype=1                              THEN dl_flow                              ELSE 0                          END) AS data7,                      ROUND(SUM(                          CASE                              WHEN nettype=1                              THEN dl_flow                              ELSE 0                          END)/MAX(tb1.sumdl_flow),2.0) AS data8 ,                      SUM(                          CASE                              WHEN nettype=2                              THEN dl_flow                              ELSE 0                          END) AS data9,                      ROUND( SUM(                          CASE                              WHEN nettype=2                              THEN dl_flow                              ELSE 0                          END)/MAX(tb1.sumdl_flow),2.0) AS data10 ,                      SUM(                          CASE                              WHEN nettype=1                              THEN delay                              ELSE 0                          END) AS data41,                      SUM(                          CASE                              WHEN nettype=1                              THEN dl_flow                              ELSE 0                          END) AS data42 ,                      ROUND( SUM(                          CASE                              WHEN nettype=1                              THEN dl_flow                              ELSE 0                          END)/SUM(                          CASE                              WHEN nettype=1                              THEN delay                              ELSE 0                          END)*8000/1024 ,2.0)AS data43,                      SUM(                          CASE                              WHEN nettype=2                              THEN delay                              ELSE 0                          END) AS data44,                      SUM(                          CASE                              WHEN nettype=2                              THEN dl_flow                              ELSE 0                          END) AS data45 ,                      ROUND( SUM(                          CASE                              WHEN nettype=2                              THEN dl_flow                              ELSE 0                          END)/SUM(                          CASE                              WHEN nettype=2                              THEN delay                              ELSE 0                          END)*8000/1024,2.0) AS data46,                      SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN delay                              ELSE 0                          END) AS data47,                      SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN dl_flow                              ELSE 0                          END) AS data48,                      ROUND( SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN dl_flow                              ELSE 0                          END)/SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN delay                              ELSE 0                          END)*8000/1024,2.0) AS data49                  FROM                      lte_sys.[@c0]_T_QUALITYSTATISTICS_ALLUSER tb2 ,                      (                          SELECT                              SUM(xdr_count) sumcnt,                              SUM(delay)     sumdelay,                              SUM(dl_flow)   sumdl_flow                          FROM                              lte_sys.[@c0]_T_QUALITYSTATISTICS_ALLUSER                          WHERE                              nettype IN (1,2)                          AND AppType IN(15,1,5,6,7,8)                          AND hour>='[@c1]'                          AND hour<='[@c2]'                          AND dl_flow>0                          AND scene1=2 )tb1                  WHERE                      nettype IN (1,2)                  AND AppType IN(15,1,5,6,7,8)                  AND hour>='[@c1]'                  AND hour<='[@c2]'                  AND dl_flow>0                  AND scene1=2                  GROUP BY                      AppType ) t1          LEFT JOIN              (                  SELECT                      (                          CASE                              WHEN AppType=1                              THEN '即时通信'                              WHEN AppType=15                              THEN '浏览'                              WHEN AppType=5                              THEN '视频'                              WHEN AppType=6                              THEN '音乐'                              WHEN AppType=7                              THEN '应用商店'                              WHEN AppType=8                              THEN '游戏'                          END ) AS ndata2,                      SUM(                          CASE                              WHEN nettype=1                              THEN delay                              ELSE 0                          END) AS data11,                      SUM(                          CASE                              WHEN nettype=1                              THEN dl_flow                              ELSE 0                          END) AS data12,                      ROUND( SUM(                          CASE                              WHEN nettype=1                              THEN dl_flow                              ELSE 0                          END)/SUM(                          CASE                              WHEN nettype=1                              THEN delay                              ELSE 0                          END)*8000/1024,2.0) AS data13,                      SUM(                          CASE                              WHEN nettype=1                              THEN satisfied_xdr_count                              ELSE 0                          END) AS data14,                      SUM(                          CASE                              WHEN nettype=1                              THEN satisfied_sucess_xdr_count                              ELSE 0                          END) AS data15 ,                      ROUND(SUM(                          CASE                              WHEN nettype=1                              THEN satisfied_sucess_xdr_count                              ELSE 0                          END)/SUM(                          CASE                              WHEN nettype=1                              THEN satisfied_xdr_count                              ELSE 0                          END),2.0) AS data16,                      SUM(                          CASE                              WHEN nettype=1                              THEN satisfied_xdr_count                              ELSE 0                          END) AS data17,                      SUM(                          CASE                              WHEN nettype=1                              THEN satisfied_speed_xdr_count                              ELSE 0                          END) AS data18 ,                      ROUND( SUM(                          CASE                              WHEN nettype=1                              THEN satisfied_speed_xdr_count                              ELSE 0                          END)/SUM(                          CASE                              WHEN nettype=1                              THEN satisfied_xdr_count                              ELSE 0                          END) ,2.0)AS data19,                      ROUND( SUM(                          CASE                              WHEN nettype=1                              THEN satisfied_sucess_xdr_count*satisfied_speed_xdr_count                              ELSE 0                          END)/SUM(                          CASE                              WHEN nettype=1                              THEN satisfied_xdr_count*satisfied_xdr_count                              ELSE 0                          END),2.0) AS data20,                      SUM(                          CASE                              WHEN nettype=2                              THEN delay                              ELSE 0                          END) AS data21,                      SUM(                          CASE                              WHEN nettype=2                              THEN dl_flow                              ELSE 0                          END) AS data22,                      ROUND( SUM(                          CASE                              WHEN nettype=2                              THEN dl_flow                              ELSE 0                          END)/SUM(                          CASE                              WHEN nettype=2                              THEN delay                              ELSE 0                          END)*8000/1024,2.0) AS data23,                      SUM(                          CASE                              WHEN nettype=2                              THEN satisfied_xdr_count                              ELSE 0                          END) AS data24,                      SUM(                          CASE                              WHEN nettype=2                              THEN satisfied_sucess_xdr_count                              ELSE 0                          END) AS data25 ,                      ROUND( SUM(                          CASE                              WHEN nettype=2                              THEN satisfied_sucess_xdr_count                              ELSE 0                          END)/SUM(                          CASE                              WHEN nettype=2                              THEN satisfied_xdr_count                              ELSE 0                          END),2.0) AS data26,                      SUM(                          CASE                              WHEN nettype=2                              THEN satisfied_xdr_count                              ELSE 0                          END) AS data27,                      SUM(                          CASE                              WHEN nettype=2                              THEN satisfied_speed_xdr_count                              ELSE 0                          END) AS data28 ,                      ROUND( SUM(                          CASE                              WHEN nettype=2                              THEN satisfied_speed_xdr_count                              ELSE 0                          END)/SUM(                          CASE                              WHEN nettype=2                              THEN satisfied_xdr_count                              ELSE 0                          END),2.0) AS data29,                      ROUND( SUM(                          CASE                              WHEN nettype=2                              THEN satisfied_sucess_xdr_count*satisfied_speed_xdr_count                              ELSE 0                          END)/SUM(                          CASE                              WHEN nettype=2                              THEN satisfied_xdr_count*satisfied_xdr_count                              ELSE 0                          END),2.0) AS data30,                      SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN delay                              ELSE 0                          END) AS data31,                      SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN dl_flow                              ELSE 0                          END) AS data32,                      ROUND( SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN dl_flow                              ELSE 0                          END)/SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN delay                              ELSE 0                          END)*8000/1024,2.0) AS data33,                      SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN satisfied_xdr_count                              ELSE 0                          END) AS data34,                      SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN satisfied_sucess_xdr_count                              ELSE 0                          END) AS data35 ,                      ROUND( SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN satisfied_sucess_xdr_count                              ELSE 0                          END)/SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN satisfied_xdr_count                              ELSE 0                          END),2.0) AS data36,                      SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN satisfied_xdr_count                              ELSE 0                          END) AS data37,                      SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN satisfied_speed_xdr_count                              ELSE 0                          END) AS data38 ,                      ROUND( SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN satisfied_speed_xdr_count                              ELSE 0                          END)/SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN satisfied_xdr_count                              ELSE 0                          END),2.0) AS data39,                      ROUND( SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN satisfied_sucess_xdr_count*satisfied_speed_xdr_count                              ELSE 0                          END)/SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN satisfied_xdr_count*satisfied_xdr_count                              ELSE 0                          END) ,2.0)AS data40                  FROM                      lte_sys.[@c0]_T_QUALITYSTATISTICS_ALLUSER tb2 ,                      (                          SELECT                              SUM(xdr_count) sumcnt,                              SUM(delay)     sumdelay,                              SUM(dl_flow)   sumdl_flow                          FROM                              lte_sys.[@c0]_T_QUALITYSTATISTICS_ALLUSER                          WHERE                              dl_flow>5120                          AND AppType IN(15,1,5,6,7,8)                          AND hour>='[@c1]'                          AND hour<='[@c2]'                          AND scene1=2 )tb1                  WHERE                      dl_flow>5120                  AND AppType IN(15,1,5,6,7,8)                  AND hour>='[@c1]'                  AND hour<='[@c2]'                  AND scene1=2                  GROUP BY                      AppType )t2          ON              t1.data2=t2.ndata2          UNION          SELECT              t1.*,              t2.*          FROM              (                  SELECT                      '占用宏站的室内稳定用户(无室分)' AS data1,                      '全网'               AS data2,                      SUM(                          CASE                              WHEN nettype=1                              THEN delay                              ELSE 0                          END) AS data3,                      ROUND( SUM(                          CASE                              WHEN nettype=1                              THEN delay                              ELSE 0                          END)/MAX(tb1.sumdelay),2.0) AS data4 ,                      SUM(                          CASE                              WHEN nettype=2                              THEN delay                              ELSE 0                          END) AS data5,                      ROUND( SUM(                          CASE                              WHEN nettype=2                              THEN delay                              ELSE 0                          END)/MAX(tb1.sumdelay),2.0) AS data6 ,                      SUM(                          CASE                              WHEN nettype=1                              THEN dl_flow                              ELSE 0                          END) AS data7,                      ROUND(SUM(                          CASE                              WHEN nettype=1                              THEN dl_flow                              ELSE 0                          END)/MAX(tb1.sumdl_flow),2.0) AS data8 ,                      SUM(                          CASE                              WHEN nettype=2                              THEN dl_flow                              ELSE 0                          END) AS data9,                      ROUND( SUM(                          CASE                              WHEN nettype=2                              THEN dl_flow                              ELSE 0                          END)/MAX(tb1.sumdl_flow),2.0) AS data10 ,                      SUM(                          CASE                              WHEN nettype=1                              THEN delay                              ELSE 0                          END) AS data41,                      SUM(                          CASE                              WHEN nettype=1                              THEN dl_flow                              ELSE 0                          END) AS data42 ,                      ROUND( SUM(                          CASE                              WHEN nettype=1                              THEN dl_flow                              ELSE 0                          END)/SUM(                          CASE                              WHEN nettype=1                              THEN delay                              ELSE 0                          END)*8000/1024 ,2.0)AS data43,                      SUM(                          CASE                              WHEN nettype=2                              THEN delay                              ELSE 0                          END) AS data44,                      SUM(                          CASE                              WHEN nettype=2                              THEN dl_flow                              ELSE 0                          END) AS data45 ,                      ROUND( SUM(                          CASE                              WHEN nettype=2                              THEN dl_flow                              ELSE 0                          END)/SUM(                          CASE                              WHEN nettype=2                              THEN delay                              ELSE 0                          END)*8000/1024,2.0) AS data46,                      SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN delay                              ELSE 0                          END) AS data47,                      SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN dl_flow                              ELSE 0                          END) AS data48,                      ROUND( SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN dl_flow                              ELSE 0                          END)/SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN delay                              ELSE 0                          END)*8000/1024,2.0) AS data49                  FROM                      lte_sys.[@c0]_T_QUALITYSTATISTICS_ALLUSER tb2 ,                      (                          SELECT                              SUM(xdr_count) sumcnt,                              SUM(delay)     sumdelay,                              SUM(dl_flow)   sumdl_flow                          FROM                              lte_sys.[@c0]_T_QUALITYSTATISTICS_ALLUSER                          WHERE                              nettype IN (1,2)                          AND AppType IN(15,1,5,6,7,8)                          AND hour>='[@c1]'                          AND hour<='[@c2]'                          AND dl_flow>0                          AND scene1=3 )tb1                  WHERE                      nettype IN (1,2)                  AND AppType IN(15,1,5,6,7,8)                  AND hour>='[@c1]'                  AND hour<='[@c2]'                  AND dl_flow>0                  AND scene1=3 ) t1          LEFT JOIN              (                  SELECT                      '全网' AS ndata2,                      SUM(                          CASE                              WHEN nettype=1                              THEN delay                              ELSE 0                          END) AS data11,                      SUM(                          CASE                              WHEN nettype=1                              THEN dl_flow                              ELSE 0                          END) AS data12,                      ROUND( SUM(                          CASE                              WHEN nettype=1                              THEN dl_flow                              ELSE 0                          END)/SUM(                          CASE                              WHEN nettype=1                              THEN delay                              ELSE 0                          END)*8000/1024,2.0) AS data13,                      SUM(                          CASE                              WHEN nettype=1                              THEN satisfied_xdr_count                              ELSE 0                          END) AS data14,                      SUM(                          CASE                              WHEN nettype=1                              THEN satisfied_sucess_xdr_count                              ELSE 0                          END) AS data15 ,                      ROUND(SUM(                          CASE                              WHEN nettype=1                              THEN satisfied_sucess_xdr_count                              ELSE 0                          END)/SUM(                          CASE                              WHEN nettype=1                              THEN satisfied_xdr_count                              ELSE 0                          END),2.0) AS data16,                      SUM(                          CASE                              WHEN nettype=1                              THEN satisfied_xdr_count                              ELSE 0                          END) AS data17,                      SUM(                          CASE                              WHEN nettype=1                              THEN satisfied_speed_xdr_count                              ELSE 0                          END) AS data18 ,                      ROUND( SUM(                          CASE                              WHEN nettype=1                              THEN satisfied_speed_xdr_count                              ELSE 0                          END)/SUM(                          CASE                              WHEN nettype=1                              THEN satisfied_xdr_count                              ELSE 0                          END) ,2.0)AS data19,                      ROUND( SUM(                          CASE                              WHEN nettype=1                              THEN satisfied_sucess_xdr_count*satisfied_speed_xdr_count                              ELSE 0                          END)/SUM(                          CASE                              WHEN nettype=1                              THEN satisfied_xdr_count*satisfied_xdr_count                              ELSE 0                          END),2.0) AS data20,                      SUM(                          CASE                              WHEN nettype=2                              THEN delay                              ELSE 0                          END) AS data21,                      SUM(                          CASE                              WHEN nettype=2                              THEN dl_flow                              ELSE 0                          END) AS data22,                      ROUND( SUM(                          CASE                              WHEN nettype=2                              THEN dl_flow                              ELSE 0                          END)/SUM(                          CASE                              WHEN nettype=2                              THEN delay                              ELSE 0                          END)*8000/1024,2.0) AS data23,                      SUM(                          CASE                              WHEN nettype=2                              THEN satisfied_xdr_count                              ELSE 0                          END) AS data24,                      SUM(                          CASE                              WHEN nettype=2                              THEN satisfied_sucess_xdr_count                              ELSE 0                          END) AS data25 ,                      ROUND( SUM(                          CASE                              WHEN nettype=2                              THEN satisfied_sucess_xdr_count                              ELSE 0                          END)/SUM(                          CASE                              WHEN nettype=2                              THEN satisfied_xdr_count                              ELSE 0                          END),2.0) AS data26,                      SUM(                          CASE                              WHEN nettype=2                              THEN satisfied_xdr_count                              ELSE 0                          END) AS data27,                      SUM(                          CASE                              WHEN nettype=2                              THEN satisfied_speed_xdr_count                              ELSE 0                          END) AS data28 ,                      ROUND( SUM(                          CASE                              WHEN nettype=2                              THEN satisfied_speed_xdr_count                              ELSE 0                          END)/SUM(                          CASE                              WHEN nettype=2                              THEN satisfied_xdr_count                              ELSE 0                          END),2.0) AS data29,                      ROUND( SUM(                          CASE                              WHEN nettype=2                              THEN satisfied_sucess_xdr_count*satisfied_speed_xdr_count                              ELSE 0                          END)/SUM(                          CASE                              WHEN nettype=2                              THEN satisfied_xdr_count*satisfied_xdr_count                              ELSE 0                          END),2.0) AS data30,                      SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN delay                              ELSE 0                          END) AS data31,                      SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN dl_flow                              ELSE 0                          END) AS data32,                      ROUND( SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN dl_flow                              ELSE 0                          END)/SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN delay                              ELSE 0                          END)*8000/1024,2.0) AS data33,                      SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN satisfied_xdr_count                              ELSE 0                          END) AS data34,                      SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN satisfied_sucess_xdr_count                              ELSE 0                          END) AS data35 ,                      ROUND( SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN satisfied_sucess_xdr_count                              ELSE 0                          END)/SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN satisfied_xdr_count                              ELSE 0                          END),2.0) AS data36,                      SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN satisfied_xdr_count                              ELSE 0                          END) AS data37,                      SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN satisfied_speed_xdr_count                              ELSE 0                          END) AS data38 ,                      ROUND( SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN satisfied_speed_xdr_count                              ELSE 0                          END)/SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN satisfied_xdr_count                              ELSE 0                          END),2.0) AS data39,                      ROUND( SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN satisfied_sucess_xdr_count*satisfied_speed_xdr_count                              ELSE 0                          END)/SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN satisfied_xdr_count*satisfied_xdr_count                              ELSE 0                          END) ,2.0)AS data40                  FROM                      lte_sys.[@c0]_T_QUALITYSTATISTICS_ALLUSER tb2 ,                      (                          SELECT                              SUM(xdr_count) sumcnt,                              SUM(delay)     sumdelay,                              SUM(dl_flow)   sumdl_flow                          FROM                              lte_sys.[@c0]_T_QUALITYSTATISTICS_ALLUSER                          WHERE                              dl_flow>5120                          AND AppType IN(15,1,5,6,7,8)                          AND hour>='[@c1]'                          AND hour<='[@c2]'                          AND scene1=3 )tb1                  WHERE                      dl_flow>5120                  AND AppType IN(15,1,5,6,7,8)                  AND hour>='[@c1]'                  AND hour<='[@c2]'                  AND scene1=3 )t2          ON              t1.data2=t2.ndata2          UNION          SELECT              t1.*,              t2.*          FROM              (                  SELECT                      '占用宏站的室内稳定用户(无室分)' AS data1,                      (                          CASE                              WHEN AppType=1                              THEN '即时通信'                              WHEN AppType=15                              THEN '浏览'                              WHEN AppType=5                              THEN '视频'                              WHEN AppType=6                              THEN '音乐'                              WHEN AppType=7                              THEN '应用商店'                              WHEN AppType=8                              THEN '游戏'                          END ) AS data2,                      SUM(                          CASE                              WHEN nettype=1                              THEN delay                              ELSE 0                          END) AS data3,                      ROUND( SUM(                          CASE                              WHEN nettype=1                              THEN delay                              ELSE 0                          END)/MAX(tb1.sumdelay),2.0) AS data4 ,                      SUM(                          CASE                              WHEN nettype=2                              THEN delay                              ELSE 0                          END) AS data5,                      ROUND( SUM(                          CASE                              WHEN nettype=2                              THEN delay                              ELSE 0                          END)/MAX(tb1.sumdelay),2.0) AS data6 ,                      SUM(                          CASE                              WHEN nettype=1                              THEN dl_flow                              ELSE 0                          END) AS data7,                      ROUND(SUM(                          CASE                              WHEN nettype=1                              THEN dl_flow                              ELSE 0                          END)/MAX(tb1.sumdl_flow),2.0) AS data8 ,                      SUM(                          CASE                              WHEN nettype=2                              THEN dl_flow                              ELSE 0                          END) AS data9,                      ROUND( SUM(                          CASE                              WHEN nettype=2                              THEN dl_flow                              ELSE 0                          END)/MAX(tb1.sumdl_flow),2.0) AS data10 ,                      SUM(                          CASE                              WHEN nettype=1                              THEN delay                              ELSE 0                          END) AS data41,                      SUM(                          CASE                              WHEN nettype=1                              THEN dl_flow                              ELSE 0                          END) AS data42 ,                      ROUND( SUM(                          CASE                              WHEN nettype=1                              THEN dl_flow                              ELSE 0                          END)/SUM(                          CASE                              WHEN nettype=1                              THEN delay                              ELSE 0                          END)*8000/1024 ,2.0)AS data43,                      SUM(                          CASE                              WHEN nettype=2                              THEN delay                              ELSE 0                          END) AS data44,                      SUM(                          CASE                              WHEN nettype=2                              THEN dl_flow                              ELSE 0                          END) AS data45 ,                      ROUND( SUM(                          CASE                              WHEN nettype=2                              THEN dl_flow                              ELSE 0                          END)/SUM(                          CASE                              WHEN nettype=2                              THEN delay                              ELSE 0                          END)*8000/1024,2.0) AS data46,                      SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN delay                              ELSE 0                          END) AS data47,                      SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN dl_flow                              ELSE 0                          END) AS data48,                      ROUND( SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN dl_flow                              ELSE 0                          END)/SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN delay                              ELSE 0                          END)*8000/1024,2.0) AS data49                  FROM                      lte_sys.[@c0]_T_QUALITYSTATISTICS_ALLUSER tb2 ,                      (                          SELECT                              SUM(xdr_count) sumcnt,                              SUM(delay)     sumdelay,                              SUM(dl_flow)   sumdl_flow                          FROM                              lte_sys.[@c0]_T_QUALITYSTATISTICS_ALLUSER                          WHERE                              nettype IN (1,2)                          AND AppType IN(15,1,5,6,7,8)                          AND hour>='[@c1]'                          AND hour<='[@c2]'                          AND dl_flow>0                          AND scene1=3 )tb1                  WHERE                      nettype IN (1,2)                  AND AppType IN(15,1,5,6,7,8)                  AND hour>='[@c1]'                  AND hour<='[@c2]'                  AND dl_flow>0                  AND scene1=3                  GROUP BY                      AppType ) t1          LEFT JOIN              (                  SELECT                      (                          CASE                              WHEN AppType=1                              THEN '即时通信'                              WHEN AppType=15                              THEN '浏览'                              WHEN AppType=5                              THEN '视频'                              WHEN AppType=6                              THEN '音乐'                              WHEN AppType=7                              THEN '应用商店'                              WHEN AppType=8                              THEN '游戏'                          END ) AS ndata2,                      SUM(                          CASE                              WHEN nettype=1                              THEN delay                              ELSE 0                          END) AS data11,                      SUM(                          CASE                              WHEN nettype=1                              THEN dl_flow                              ELSE 0                          END) AS data12,                      ROUND( SUM(                          CASE                              WHEN nettype=1                              THEN dl_flow                              ELSE 0                          END)/SUM(                          CASE                              WHEN nettype=1                              THEN delay                              ELSE 0                          END)*8000/1024,2.0) AS data13,                      SUM(                          CASE                              WHEN nettype=1                              THEN satisfied_xdr_count                              ELSE 0                          END) AS data14,                      SUM(                          CASE                              WHEN nettype=1                              THEN satisfied_sucess_xdr_count                              ELSE 0                          END) AS data15 ,                      ROUND(SUM(                          CASE                              WHEN nettype=1                              THEN satisfied_sucess_xdr_count                              ELSE 0                          END)/SUM(                          CASE                              WHEN nettype=1                              THEN satisfied_xdr_count                              ELSE 0                          END),2.0) AS data16,                      SUM(                          CASE                              WHEN nettype=1                              THEN satisfied_xdr_count                              ELSE 0                          END) AS data17,                      SUM(                          CASE                              WHEN nettype=1                              THEN satisfied_speed_xdr_count                              ELSE 0                          END) AS data18 ,                      ROUND( SUM(                          CASE                              WHEN nettype=1                              THEN satisfied_speed_xdr_count                              ELSE 0                          END)/SUM(                          CASE                              WHEN nettype=1                              THEN satisfied_xdr_count                              ELSE 0                          END) ,2.0)AS data19,                      ROUND( SUM(                          CASE                              WHEN nettype=1                              THEN satisfied_sucess_xdr_count*satisfied_speed_xdr_count                              ELSE 0                          END)/SUM(                          CASE                              WHEN nettype=1                              THEN satisfied_xdr_count*satisfied_xdr_count                              ELSE 0                          END),2.0) AS data20,                      SUM(                          CASE                              WHEN nettype=2                              THEN delay                              ELSE 0                          END) AS data21,                      SUM(                          CASE                              WHEN nettype=2                              THEN dl_flow                              ELSE 0                          END) AS data22,                      ROUND( SUM(                          CASE                              WHEN nettype=2                              THEN dl_flow                              ELSE 0                          END)/SUM(                          CASE                              WHEN nettype=2                              THEN delay                              ELSE 0                          END)*8000/1024,2.0) AS data23,                      SUM(                          CASE                              WHEN nettype=2                              THEN satisfied_xdr_count                              ELSE 0                          END) AS data24,                      SUM(                          CASE                              WHEN nettype=2                              THEN satisfied_sucess_xdr_count                              ELSE 0                          END) AS data25 ,                      ROUND( SUM(                          CASE                              WHEN nettype=2                              THEN satisfied_sucess_xdr_count                              ELSE 0                          END)/SUM(                          CASE                              WHEN nettype=2                              THEN satisfied_xdr_count                              ELSE 0                          END),2.0) AS data26,                      SUM(                          CASE                              WHEN nettype=2                              THEN satisfied_xdr_count                              ELSE 0                          END) AS data27,                      SUM(                          CASE                              WHEN nettype=2                              THEN satisfied_speed_xdr_count                              ELSE 0                          END) AS data28 ,                      ROUND( SUM(                          CASE                              WHEN nettype=2                              THEN satisfied_speed_xdr_count                              ELSE 0                          END)/SUM(                          CASE                              WHEN nettype=2                              THEN satisfied_xdr_count                              ELSE 0                          END),2.0) AS data29,                      ROUND( SUM(                          CASE                              WHEN nettype=2                              THEN satisfied_sucess_xdr_count*satisfied_speed_xdr_count                              ELSE 0                          END)/SUM(                          CASE                              WHEN nettype=2                              THEN satisfied_xdr_count*satisfied_xdr_count                              ELSE 0                          END),2.0) AS data30,                      SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN delay                              ELSE 0                          END) AS data31,                      SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN dl_flow                              ELSE 0                          END) AS data32,                      ROUND( SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN dl_flow                              ELSE 0                          END)/SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN delay                              ELSE 0                          END)*8000/1024,2.0) AS data33,                      SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN satisfied_xdr_count                              ELSE 0                          END) AS data34,                      SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN satisfied_sucess_xdr_count                              ELSE 0                          END) AS data35 ,                      ROUND( SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN satisfied_sucess_xdr_count                              ELSE 0                          END)/SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN satisfied_xdr_count                              ELSE 0                          END),2.0) AS data36,                      SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN satisfied_xdr_count                              ELSE 0                          END) AS data37,                      SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN satisfied_speed_xdr_count                              ELSE 0                          END) AS data38 ,                      ROUND( SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN satisfied_speed_xdr_count                              ELSE 0                          END)/SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN satisfied_xdr_count                              ELSE 0                          END),2.0) AS data39,                      ROUND( SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN satisfied_sucess_xdr_count*satisfied_speed_xdr_count                              ELSE 0                          END)/SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN satisfied_xdr_count*satisfied_xdr_count                              ELSE 0                          END) ,2.0)AS data40                  FROM                      lte_sys.[@c0]_T_QUALITYSTATISTICS_ALLUSER tb2 ,                      (                          SELECT                              SUM(xdr_count) sumcnt,                              SUM(delay)     sumdelay,                              SUM(dl_flow)   sumdl_flow                          FROM                              lte_sys.[@c0]_T_QUALITYSTATISTICS_ALLUSER                          WHERE                              dl_flow>5120                          AND AppType IN(15,1,5,6,7,8)                          AND hour>='[@c1]'                          AND hour<='[@c2]'                          AND scene1=3 )tb1                  WHERE                      dl_flow>5120                  AND AppType IN(15,1,5,6,7,8)                  AND hour>='[@c1]'                  AND hour<='[@c2]'                  AND scene1=3                  GROUP BY                      AppType )t2          ON              t1.data2=t2.ndata2          UNION          SELECT              t1.*,              t2.*          FROM              (                  SELECT                      '室内稳定用户(占用宏站和室分)' AS data1,                      '全网'              AS data2,                      SUM(                          CASE                              WHEN nettype=1                              THEN delay                              ELSE 0                          END) AS data3,                      ROUND( SUM(                          CASE                              WHEN nettype=1                              THEN delay                              ELSE 0                          END)/MAX(tb1.sumdelay),2.0) AS data4 ,                      SUM(                          CASE                              WHEN nettype=2                              THEN delay                              ELSE 0                          END) AS data5,                      ROUND( SUM(                          CASE                              WHEN nettype=2                              THEN delay                              ELSE 0                          END)/MAX(tb1.sumdelay),2.0) AS data6 ,                      SUM(                          CASE                              WHEN nettype=1                              THEN dl_flow                              ELSE 0                          END) AS data7,                      ROUND(SUM(                          CASE                              WHEN nettype=1                              THEN dl_flow                              ELSE 0                          END)/MAX(tb1.sumdl_flow),2.0) AS data8 ,                      SUM(                          CASE                              WHEN nettype=2                              THEN dl_flow                              ELSE 0                          END) AS data9,                      ROUND( SUM(                          CASE                              WHEN nettype=2                              THEN dl_flow                              ELSE 0                          END)/MAX(tb1.sumdl_flow),2.0) AS data10 ,                      SUM(                          CASE                              WHEN nettype=1                              THEN delay                              ELSE 0                          END) AS data41,                      SUM(                          CASE                              WHEN nettype=1                              THEN dl_flow                              ELSE 0                          END) AS data42 ,                      ROUND( SUM(                          CASE                              WHEN nettype=1                              THEN dl_flow                              ELSE 0                          END)/SUM(                          CASE                              WHEN nettype=1                              THEN delay                              ELSE 0                          END)*8000/1024 ,2.0)AS data43,                      SUM(                          CASE                              WHEN nettype=2                              THEN delay                              ELSE 0                          END) AS data44,                      SUM(                          CASE                              WHEN nettype=2                              THEN dl_flow                              ELSE 0                          END) AS data45 ,                      ROUND( SUM(                          CASE                              WHEN nettype=2                              THEN dl_flow                              ELSE 0                          END)/SUM(                          CASE                              WHEN nettype=2                              THEN delay                              ELSE 0                          END)*8000/1024,2.0) AS data46,                      SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN delay                              ELSE 0                          END) AS data47,                      SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN dl_flow                              ELSE 0                          END) AS data48,                      ROUND( SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN dl_flow                              ELSE 0                          END)/SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN delay                              ELSE 0                          END)*8000/1024,2.0) AS data49                  FROM                      lte_sys.[@c0]_T_QUALITYSTATISTICS_ALLUSER tb2 ,                      (                          SELECT                              SUM(xdr_count) sumcnt,                              SUM(delay)     sumdelay,                              SUM(dl_flow)   sumdl_flow                          FROM                              lte_sys.[@c0]_T_QUALITYSTATISTICS_ALLUSER                          WHERE                              nettype IN (1,2)                          AND AppType IN(15,1,5,6,7,8)                          AND hour>='[@c1]'                          AND hour<='[@c2]'                          AND dl_flow>0                          AND scene1=4 )tb1                  WHERE                      nettype IN (1,2)                  AND AppType IN(15,1,5,6,7,8)                  AND hour>='[@c1]'                  AND hour<='[@c2]'                  AND dl_flow>0                  AND scene1=4 ) t1          LEFT JOIN              (                  SELECT                      '全网' AS ndata2,                      SUM(                          CASE                              WHEN nettype=1                              THEN delay                              ELSE 0                          END) AS data11,                      SUM(                          CASE                              WHEN nettype=1                              THEN dl_flow                              ELSE 0                          END) AS data12,                      ROUND( SUM(                          CASE                              WHEN nettype=1                              THEN dl_flow                              ELSE 0                          END)/SUM(                          CASE                              WHEN nettype=1                              THEN delay                              ELSE 0                          END)*8000/1024,2.0) AS data13,                      SUM(                          CASE                              WHEN nettype=1                              THEN satisfied_xdr_count                              ELSE 0                          END) AS data14,                      SUM(                          CASE                              WHEN nettype=1                              THEN satisfied_sucess_xdr_count                              ELSE 0                          END) AS data15 ,                      ROUND(SUM(                          CASE                              WHEN nettype=1                              THEN satisfied_sucess_xdr_count                              ELSE 0                          END)/SUM(                          CASE                              WHEN nettype=1                              THEN satisfied_xdr_count                              ELSE 0                          END),2.0) AS data16,                      SUM(                          CASE                              WHEN nettype=1                              THEN satisfied_xdr_count                              ELSE 0                          END) AS data17,                      SUM(                          CASE                              WHEN nettype=1                              THEN satisfied_speed_xdr_count                              ELSE 0                          END) AS data18 ,                      ROUND( SUM(                          CASE                              WHEN nettype=1                              THEN satisfied_speed_xdr_count                              ELSE 0                          END)/SUM(                          CASE                              WHEN nettype=1                              THEN satisfied_xdr_count                              ELSE 0                          END) ,2.0)AS data19,                      ROUND( SUM(                          CASE                              WHEN nettype=1                              THEN satisfied_sucess_xdr_count*satisfied_speed_xdr_count                              ELSE 0                          END)/SUM(                          CASE                              WHEN nettype=1                              THEN satisfied_xdr_count*satisfied_xdr_count                              ELSE 0                          END),2.0) AS data20,                      SUM(                          CASE                              WHEN nettype=2                              THEN delay                              ELSE 0                          END) AS data21,                      SUM(                          CASE                              WHEN nettype=2                              THEN dl_flow                              ELSE 0                          END) AS data22,                      ROUND( SUM(                          CASE                              WHEN nettype=2                              THEN dl_flow                              ELSE 0                          END)/SUM(                          CASE                              WHEN nettype=2                              THEN delay                              ELSE 0                          END)*8000/1024,2.0) AS data23,                      SUM(                          CASE                              WHEN nettype=2                              THEN satisfied_xdr_count                              ELSE 0                          END) AS data24,                      SUM(                          CASE                              WHEN nettype=2                              THEN satisfied_sucess_xdr_count                              ELSE 0                          END) AS data25 ,                      ROUND( SUM(                          CASE                              WHEN nettype=2                              THEN satisfied_sucess_xdr_count                              ELSE 0                          END)/SUM(                          CASE                              WHEN nettype=2                              THEN satisfied_xdr_count                              ELSE 0                          END),2.0) AS data26,                      SUM(                          CASE                              WHEN nettype=2                              THEN satisfied_xdr_count                              ELSE 0                          END) AS data27,                      SUM(                          CASE                              WHEN nettype=2                              THEN satisfied_speed_xdr_count                              ELSE 0                          END) AS data28 ,                      ROUND( SUM(                          CASE                              WHEN nettype=2                              THEN satisfied_speed_xdr_count                              ELSE 0                          END)/SUM(                          CASE                              WHEN nettype=2                              THEN satisfied_xdr_count                              ELSE 0                          END),2.0) AS data29,                      ROUND( SUM(                          CASE                              WHEN nettype=2                              THEN satisfied_sucess_xdr_count*satisfied_speed_xdr_count                              ELSE 0                          END)/SUM(                          CASE                              WHEN nettype=2                              THEN satisfied_xdr_count*satisfied_xdr_count                              ELSE 0                          END),2.0) AS data30,                      SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN delay                              ELSE 0                          END) AS data31,                      SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN dl_flow                              ELSE 0                          END) AS data32,                      ROUND( SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN dl_flow                              ELSE 0                          END)/SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN delay                              ELSE 0                          END)*8000/1024,2.0) AS data33,                      SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN satisfied_xdr_count                              ELSE 0                          END) AS data34,                      SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN satisfied_sucess_xdr_count                              ELSE 0                          END) AS data35 ,                      ROUND( SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN satisfied_sucess_xdr_count                              ELSE 0                          END)/SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN satisfied_xdr_count                              ELSE 0                          END),2.0) AS data36,                      SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN satisfied_xdr_count                              ELSE 0                          END) AS data37,                      SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN satisfied_speed_xdr_count                              ELSE 0                          END) AS data38 ,                      ROUND( SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN satisfied_speed_xdr_count                              ELSE 0                          END)/SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN satisfied_xdr_count                              ELSE 0                          END),2.0) AS data39,                      ROUND( SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN satisfied_sucess_xdr_count*satisfied_speed_xdr_count                              ELSE 0                          END)/SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN satisfied_xdr_count*satisfied_xdr_count                              ELSE 0                          END) ,2.0)AS data40                  FROM                      lte_sys.[@c0]_T_QUALITYSTATISTICS_ALLUSER tb2 ,                      (                          SELECT                              SUM(xdr_count) sumcnt,                              SUM(delay)     sumdelay,                              SUM(dl_flow)   sumdl_flow                          FROM                              lte_sys.[@c0]_T_QUALITYSTATISTICS_ALLUSER                          WHERE                              dl_flow>5120                          AND AppType IN(15,1,5,6,7,8)                          AND hour>='[@c1]'                          AND hour<='[@c2]'                          AND scene1=4 )tb1                  WHERE                      dl_flow>5120                  AND AppType IN(15,1,5,6,7,8)                  AND hour>='[@c1]'                  AND hour<='[@c2]'                  AND scene1=4 )t2          ON              t1.data2=t2.ndata2          UNION          SELECT              t1.*,              t2.*          FROM              (                  SELECT                      '室内稳定用户(占用宏站和室分)' AS data1,                      (                          CASE                              WHEN AppType=1                              THEN '即时通信'                              WHEN AppType=15                              THEN '浏览'                              WHEN AppType=5                              THEN '视频'                              WHEN AppType=6                              THEN '音乐'                              WHEN AppType=7                              THEN '应用商店'                              WHEN AppType=8                              THEN '游戏'                          END ) AS data2,                      SUM(                          CASE                              WHEN nettype=1                              THEN delay                              ELSE 0                          END) AS data3,                      ROUND( SUM(                          CASE                              WHEN nettype=1                              THEN delay                              ELSE 0                          END)/MAX(tb1.sumdelay),2.0) AS data4 ,                      SUM(                          CASE                              WHEN nettype=2                              THEN delay                              ELSE 0                          END) AS data5,                      ROUND( SUM(                          CASE                              WHEN nettype=2                              THEN delay                              ELSE 0                          END)/MAX(tb1.sumdelay),2.0) AS data6 ,                      SUM(                          CASE                              WHEN nettype=1                              THEN dl_flow                              ELSE 0                          END) AS data7,                      ROUND(SUM(                          CASE                              WHEN nettype=1                              THEN dl_flow                              ELSE 0                          END)/MAX(tb1.sumdl_flow),2.0) AS data8 ,                      SUM(                          CASE                              WHEN nettype=2                              THEN dl_flow                              ELSE 0                          END) AS data9,                      ROUND( SUM(                          CASE                              WHEN nettype=2                              THEN dl_flow                              ELSE 0                          END)/MAX(tb1.sumdl_flow),2.0) AS data10 ,                      SUM(                          CASE                              WHEN nettype=1                              THEN delay                              ELSE 0                          END) AS data41,                      SUM(                          CASE                              WHEN nettype=1                              THEN dl_flow                              ELSE 0                          END) AS data42 ,                      ROUND( SUM(                          CASE                              WHEN nettype=1                              THEN dl_flow                              ELSE 0                          END)/SUM(                          CASE                              WHEN nettype=1                              THEN delay                              ELSE 0                          END)*8000/1024 ,2.0)AS data43,                      SUM(                          CASE                              WHEN nettype=2                              THEN delay                              ELSE 0                          END) AS data44,                      SUM(                          CASE                              WHEN nettype=2                              THEN dl_flow                              ELSE 0                          END) AS data45 ,                      ROUND( SUM(                          CASE                              WHEN nettype=2                              THEN dl_flow                              ELSE 0                          END)/SUM(                          CASE                              WHEN nettype=2                              THEN delay                              ELSE 0                          END)*8000/1024,2.0) AS data46,                      SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN delay                              ELSE 0                          END) AS data47,                      SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN dl_flow                              ELSE 0                          END) AS data48,                      ROUND( SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN dl_flow                              ELSE 0                          END)/SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN delay                              ELSE 0                          END)*8000/1024,2.0) AS data49                  FROM                      lte_sys.[@c0]_T_QUALITYSTATISTICS_ALLUSER tb2 ,                      (                          SELECT                              SUM(xdr_count) sumcnt,                              SUM(delay)     sumdelay,                              SUM(dl_flow)   sumdl_flow                          FROM                              lte_sys.[@c0]_T_QUALITYSTATISTICS_ALLUSER                          WHERE                              nettype IN (1,2)                          AND AppType IN(15,1,5,6,7,8)                          AND hour>='[@c1]'                          AND hour<='[@c2]'                          AND dl_flow>0                          AND scene1=4 )tb1                  WHERE                      nettype IN (1,2)                  AND AppType IN(15,1,5,6,7,8)                  AND hour>='[@c1]'                  AND hour<='[@c2]'                  AND dl_flow>0                  AND scene1=4                  GROUP BY                      AppType ) t1          LEFT JOIN              (                  SELECT                      (                          CASE                              WHEN AppType=1                              THEN '即时通信'                              WHEN AppType=15                              THEN '浏览'                              WHEN AppType=5                              THEN '视频'                              WHEN AppType=6                              THEN '音乐'                              WHEN AppType=7                              THEN '应用商店'                              WHEN AppType=8                              THEN '游戏'                          END ) AS ndata2,                      SUM(                          CASE                              WHEN nettype=1                              THEN delay                              ELSE 0                          END) AS data11,                      SUM(                          CASE                              WHEN nettype=1                              THEN dl_flow                              ELSE 0                          END) AS data12,                      ROUND( SUM(                          CASE                              WHEN nettype=1                              THEN dl_flow                              ELSE 0                          END)/SUM(                          CASE                              WHEN nettype=1                              THEN delay                              ELSE 0                          END)*8000/1024,2.0) AS data13,                      SUM(                          CASE                              WHEN nettype=1                              THEN satisfied_xdr_count                              ELSE 0                          END) AS data14,                      SUM(                          CASE                              WHEN nettype=1                              THEN satisfied_sucess_xdr_count                              ELSE 0                          END) AS data15 ,                      ROUND(SUM(                          CASE                              WHEN nettype=1                              THEN satisfied_sucess_xdr_count                              ELSE 0                          END)/SUM(                          CASE                              WHEN nettype=1                              THEN satisfied_xdr_count                              ELSE 0                          END),2.0) AS data16,                      SUM(                          CASE                              WHEN nettype=1                              THEN satisfied_xdr_count                              ELSE 0                          END) AS data17,                      SUM(                          CASE                              WHEN nettype=1                              THEN satisfied_speed_xdr_count                              ELSE 0                          END) AS data18 ,                      ROUND( SUM(                          CASE                              WHEN nettype=1                              THEN satisfied_speed_xdr_count                              ELSE 0                          END)/SUM(                          CASE                              WHEN nettype=1                              THEN satisfied_xdr_count                              ELSE 0                          END) ,2.0)AS data19,                      ROUND( SUM(                          CASE                              WHEN nettype=1                              THEN satisfied_sucess_xdr_count*satisfied_speed_xdr_count                              ELSE 0                          END)/SUM(                          CASE                              WHEN nettype=1                              THEN satisfied_xdr_count*satisfied_xdr_count                              ELSE 0                          END),2.0) AS data20,                      SUM(                          CASE                              WHEN nettype=2                              THEN delay                              ELSE 0                          END) AS data21,                      SUM(                          CASE                              WHEN nettype=2                              THEN dl_flow                              ELSE 0                          END) AS data22,                      ROUND( SUM(                          CASE                              WHEN nettype=2                              THEN dl_flow                              ELSE 0                          END)/SUM(                          CASE                              WHEN nettype=2                              THEN delay                              ELSE 0                          END)*8000/1024,2.0) AS data23,                      SUM(                          CASE                              WHEN nettype=2                              THEN satisfied_xdr_count                              ELSE 0                          END) AS data24,                      SUM(                          CASE                              WHEN nettype=2                              THEN satisfied_sucess_xdr_count                              ELSE 0                          END) AS data25 ,                      ROUND( SUM(                          CASE                              WHEN nettype=2                              THEN satisfied_sucess_xdr_count                              ELSE 0                          END)/SUM(                          CASE                              WHEN nettype=2                              THEN satisfied_xdr_count                              ELSE 0                          END),2.0) AS data26,                      SUM(                          CASE                              WHEN nettype=2                              THEN satisfied_xdr_count                              ELSE 0                          END) AS data27,                      SUM(                          CASE                              WHEN nettype=2                              THEN satisfied_speed_xdr_count                              ELSE 0                          END) AS data28 ,                      ROUND( SUM(                          CASE                              WHEN nettype=2                              THEN satisfied_speed_xdr_count                              ELSE 0                          END)/SUM(                          CASE                              WHEN nettype=2                              THEN satisfied_xdr_count                              ELSE 0                          END),2.0) AS data29,                      ROUND( SUM(                          CASE                              WHEN nettype=2                              THEN satisfied_sucess_xdr_count*satisfied_speed_xdr_count                              ELSE 0                          END)/SUM(                          CASE                              WHEN nettype=2                              THEN satisfied_xdr_count*satisfied_xdr_count                              ELSE 0                          END),2.0) AS data30,                      SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN delay                              ELSE 0                          END) AS data31,                      SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN dl_flow                              ELSE 0                          END) AS data32,                      ROUND( SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN dl_flow                              ELSE 0                          END)/SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN delay                              ELSE 0                          END)*8000/1024,2.0) AS data33,                      SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN satisfied_xdr_count                              ELSE 0                          END) AS data34,                      SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN satisfied_sucess_xdr_count                              ELSE 0                          END) AS data35 ,                      ROUND( SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN satisfied_sucess_xdr_count                              ELSE 0                          END)/SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN satisfied_xdr_count                              ELSE 0                          END),2.0) AS data36,                      SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN satisfied_xdr_count                              ELSE 0                          END) AS data37,                      SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN satisfied_speed_xdr_count                              ELSE 0                          END) AS data38 ,                      ROUND( SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN satisfied_speed_xdr_count                              ELSE 0                          END)/SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN satisfied_xdr_count                              ELSE 0                          END),2.0) AS data39,                      ROUND( SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN satisfied_sucess_xdr_count*satisfied_speed_xdr_count                              ELSE 0                          END)/SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN satisfied_xdr_count*satisfied_xdr_count                              ELSE 0                          END) ,2.0)AS data40                  FROM                      lte_sys.[@c0]_T_QUALITYSTATISTICS_ALLUSER tb2 ,                      (                          SELECT                              SUM(xdr_count) sumcnt,                              SUM(delay)     sumdelay,                              SUM(dl_flow)   sumdl_flow                          FROM                              lte_sys.[@c0]_T_QUALITYSTATISTICS_ALLUSER                          WHERE                              dl_flow>5120                          AND AppType IN(15,1,5,6,7,8)                          AND hour>='[@c1]'                          AND hour<='[@c2]'                          AND scene1=4 )tb1                  WHERE                      dl_flow>5120                  AND AppType IN(15,1,5,6,7,8)                  AND hour>='[@c1]'                  AND hour<='[@c2]'                  AND scene1=4                  GROUP BY                      AppType )t2          ON              t1.data2=t2.ndata2 ) T  WHERE      t.data1='[@c3]'"
      }
    }
  ]
}