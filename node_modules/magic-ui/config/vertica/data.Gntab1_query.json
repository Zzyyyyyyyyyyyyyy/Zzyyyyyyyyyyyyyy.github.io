{
  "module": "m2",
  "flag": "vertical",
  "configs": [
    {
      "key": "query_gncitydate",
      "desc":"KPI汇总_地市时间",
      "config": {
        "parameters": [
          {
            "name": "p_en",
            "columnname": "",
            "type": "string",
            "format": "",
            "conditionid": "c0",
            "symbol": ""
          }
        ],
        "value": "SELECT DISTINCT     TBC.proname,     TBC.cityname,     to_char(TC.STARTTIME,'yyyy-mm-dd') AS city_date,     TC.city_no FROM     LTe_sys.[@c0]_T_GN_SUM_ALLFILE TC INNER JOIN     lte_sys.T_BASE_CITY TBC ON     TBC.CITY_NO=TC.CITY_NO ORDER BY     TBC.proname DESC"
      }
    } ,
    {
      "key": "query_gnfactory",
      "desc":"KPI汇总_厂家",
      "config": {
        "parameters": [
          {
            "name": "p_en",
            "columnname": "",
            "type": "string",
            "format": "",
            "conditionid": "c0",
            "symbol": ""
          }
        ],
        "value": "select distinct case when factory.EQUIPMENT is null then '未匹配' else factory.EQUIPMENT end as factory from lte_sys.[@c0]_T_GN_SUM_ALLFILE factory"
      }
    } ,
    {
      "key": "query_gnbusiness",
      "desc":"KPI汇总_业务",
      "config": {
        "parameters": [
          {
            "name": "p_en",
            "columnname": "",
            "type": "string",
            "format": "",
            "conditionid": "c0",
            "symbol": ""
          },
          {
            "name": "city_no",
            "columnname": "",
            "type": "string",
            "format": "",
            "conditionid": "city_no0",
            "symbol": ""
          }
        ],
        "value": "select DISTINCT cate.categoryid,cate.categoryname,city.city_no,city.cityname as city_name from lte_sys.[@c0]_T_BASE_CATEGORYTYPE cate inner join  lte_sys.T_BASE_CITY city on cate.city_no=city.city_no where cate.city_no in ([@city_no0])"
      }
    } ,
    {
      "key": "query_gnterminal",
      "desc":"KPI汇总_终端",
      "config": {
        "parameters": [
          {
            "name": "p_en",
            "columnname": "",
            "type": "string",
            "format": "",
            "conditionid": "c0",
            "symbol": ""
          }
        ],
        "value": "select * from lte_sys.T_BASE_TERMINAL_NETTYPE_FILETYP"
      }
    } ,
    {
      "key": "query_usersatisf",
      "desc":"KPI汇总_用户满意度",
      "config": {
        "parameters": [
          {
            "name": "p_en",
            "columnname": "",
            "type": "string",
            "format": "",
            "conditionid": "c0",
            "symbol": ""
          }
        ],
        "value": "select * from lte_sys.T_BASE_SPEED  order by id"
      }
    } ,
    {
      "key": "query_usersatisf_default",
      "desc":"KPI汇总_用户满意度_默认",
      "config": {
        "parameters": [
          {
            "name": "p_en",
            "columnname": "",
            "type": "string",
            "format": "",
            "conditionid": "c0",
            "symbol": ""
          }
        ],
        "value": "select EXPRESSION from lte_sys.T_BASE_CONDITION where id='lte_用户满意度'"
      }
    } ,
    {
      "key": "query_usersatisf_save",
      "desc":"KPI汇总_用户满意度_保存",
      "config": {
        "parameters": [
          {
            "name": "p_en",
            "columnname": "",
            "type": "string",
            "format": "",
            "conditionid": "c0",
            "symbol": ""
          },
          {
            "name": "createuser",
            "columnname": "",
            "type": "string",
            "format": "",
            "conditionid": "user0",
            "symbol": ""
          }
        ,
          {
            "name": "createdate",
            "columnname": "",
            "type": "string",
            "format": "",
            "conditionid": "time0",
            "symbol": ""
          }
        ,
          {
            "name": "expression",
            "columnname": "",
            "type": "string",
            "format": "",
            "conditionid": "exp0",
            "symbol": ""
          }
        ],
        "value": "delete from lte_sys.T_BASE_CONDITION where id='lte_用户满意度';insert into  LTE_SYS.T_BASE_CONDITION (ID, NAME, CREATEUSER, CREATEDATE, EXPRESSION) values ('lte_用户满意度', 'lte_用户满意度', '', to_timestamp('[@time0]','yyyy-mm-dd hh:mi:ss'), '[@exp0]')"
      }
    } ,
    {
      "key": "query_gntab_1",
      "desc":"KPI汇总_全国",
      "config": {
        "parameters": [
          {
            "name": "preData",
            "type":"object",
            "conditions":{
              "cnd":[
                {
                  "key":"city_no",
                  "columnname": "gn.city_no",
                  "type":"string",
                  "format": "",
                  "conditionid": "city0",
                  "symbol":"="
                },
                { "key":"starttime",
                  "columnname": "starttime",
                  "type":"string",
                  "format": "",
                  "conditionid": "time0",
                  "symbol":"in"}
              ],
              "co":"or"
            }
          },
          {
            "name": "preDatacategory",
            "type":"object",
            "conditions":{
              "cnd":[
                {
                  "key":"service",
                  "columnname": "city_no",
                  "type":"string",
                  "format": "",
                  "conditionid": "cate0",
                  "symbol":"="
                },
                { "key":"bussinesstype",
                  "columnname": "service",
                  "type":"string",
                  "format": "",
                  "conditionid": "subapp0",
                  "symbol":"in"}
              ],
              "co":"or"
            }
          },
          {
            "name": "terminal",
            "columnname": "",
            "type": "string",
            "format": "",
            "conditionid": "ter0",
            "symbol": ""
          },
          {
            "name": "factory",
            "columnname": "EQUIPMENT",
            "type": "string",
            "format": "",
            "conditionid": "fac0",
            "symbol": "="
          },
          {
            "name": "p_en",
            "columnname": "",
            "type": "string",
            "format": "",
            "conditionid": "p0",
            "symbol": ""
          }
        ],
        "value": "SELECT     '全国' AS data1,     '汇总' AS data2,     '汇总' AS data3,     ROUND(         CASE             WHEN SUM(A.VIEDODELAY)=0             THEN 0             ELSE SUM(A.VIEDOTRAFFIC)*8000/1024/SUM(A.VIEDODELAY)         END,3.0) AS data4,     ROUND(         CASE             WHEN SUM(A.WEBDELAY)=0             THEN 0             ELSE SUM(A.WEBTRAFFIC)*8000/1024/SUM(A.WEBDELAY)         END,3.0) AS data5,     ROUND(         CASE             WHEN SUM(A.IMALLCOUNT)=0             THEN 0             ELSE 100*SUM(A.IMSCOUNT)/SUM(A.IMALLCOUNT)         END,3.0) AS data6,     ROUND(         CASE             WHEN SUM(A.GAMEALLCOUNT)=0             THEN 0             ELSE 100*SUM(A.GAMESCOUNT)/SUM(A.GAMEALLCOUNT)         END,3.0) AS data7,     ROUND(         CASE             WHEN SUM(A.DLDELAY)=0             THEN 0             ELSE SUM(A.DLTRAFFIC)*8000/1024/SUM(A.DLDELAY)         END,3.0) AS data8,     ROUND(         CASE             WHEN SUM(A.PHONEDLDELAY)=0             THEN 0             ELSE SUM(A.PHONEDLTRAFFIC)*8000/1024 /SUM(A.PHONEDLDELAY)         END,3.0) AS data9,     ROUND(         CASE             WHEN SUM(A.SWKDLDELAY)=0             THEN 0             ELSE SUM(A.SWKDLTRAFFIC)*8000/1024/SUM(A.SWKDLDELAY)         END,3.0) AS data10,     ROUND(         CASE             WHEN SUM(A.MIFIDLDELAY)=0             THEN 0             ELSE SUM(A.MIFIDLTRAFFIC)*8000/1024/SUM(A.MIFIDLDELAY)         END,3.0) AS data11,     ROUND(         CASE             WHEN SUM(A.CPEDLDELAY)=0             THEN 0             ELSE SUM(A.CPEDLTRAFFIC)*8000/1024/SUM(A.CPEDLDELAY)         END,3.0) AS data12,     ROUND(         CASE             WHEN SUM(A.ULDELAY)=0             THEN 0             ELSE SUM(A.ULTRAFFIC)*8000/1024/SUM(A.ULDELAY)         END,3.0) AS data13,     ROUND(         CASE             WHEN SUM(A.PHONEULDELAY)=0             THEN 0             ELSE SUM(A.PHONEULTRAFFIC)*8000/1024 /SUM(A.PHONEULDELAY)         END,3.0) AS data14,     ROUND(         CASE             WHEN SUM(A.SWKULDELAY)=0             THEN 0             ELSE SUM(A.SWKULTRAFFIC)*8000/1024/SUM(A.SWKULDELAY)         END,3.0) AS data15,     ROUND(         CASE             WHEN SUM(A.MIFIULDELAY)=0             THEN 0             ELSE SUM(A.MIFIULTRAFFIC)*8000/1024/SUM(A.MIFIULDELAY)         END,3.0) AS data16,     ROUND(         CASE             WHEN SUM(A.CPEULDELAY)=0             THEN 0             ELSE SUM(A.CPEULTRAFFIC)*8000/1024/SUM(A.CPEULDELAY)         END,3.0) AS data17,     ROUND(         CASE             WHEN SUM(A.UL5DELAY)=0             THEN 0             ELSE SUM(A.UL5TRAFFIC)*8000/1024/SUM(A.UL5DELAY)         END,3.0) AS data18,     ROUND(         CASE             WHEN SUM(A.PHONEUL5DELAY)=0             THEN 0             ELSE SUM(A.PHONEUL5TRAFFIC)*8000/1024 /SUM(A.PHONEUL5DELAY)         END,3.0) AS data19,     ROUND(         CASE             WHEN SUM(A.SWKUL5DELAY)=0             THEN 0             ELSE SUM(A.SWKUL5TRAFFIC)*8000/1024/SUM(A.SWKUL5DELAY)         END,3.0) AS data20,     ROUND(         CASE             WHEN SUM(A.MIFIUL5DELAY)=0             THEN 0             ELSE SUM(A.MIFIUL5TRAFFIC)*8000/1024/SUM(A.MIFIUL5DELAY)         END,3.0) AS data21,     ROUND(         CASE             WHEN SUM(A.CPEUL5DELAY)=0             THEN 0             ELSE SUM(A.CPEUL5TRAFFIC)*8000/1024/SUM(A.CPEUL5DELAY)         END,3.0) AS data22,     ROUND(         CASE             WHEN SUM(A.ELDELAY)=0             THEN 0             ELSE SUM(A.DLTRAFFIC)*8000/1024/SUM(A.ELDELAY)         END,3.0) AS data23,     ROUND(         CASE             WHEN SUM(A.PHONEELDELAY)=0             THEN 0             ELSE SUM(A.PHONEDLTRAFFIC)*8000/1024 /SUM(A.PHONEELDELAY)         END,3.0) AS data24,     ROUND(         CASE             WHEN SUM(A.SWKELDELAY)=0             THEN 0             ELSE SUM(A.SWKDLTRAFFIC)*8000/1024/SUM(A.SWKELDELAY)         END,3.0) AS data25,     ROUND(         CASE             WHEN SUM(A.MIFIELDELAY)=0             THEN 0             ELSE SUM(A.MIFIDLTRAFFIC)*8000/1024/SUM(A.MIFIELDELAY)         END,3.0) AS data26,     ROUND(         CASE             WHEN SUM(A.CPEELDELAY)=0             THEN 0             ELSE SUM(A.CPEDLTRAFFIC)*8000/1024/SUM(A.CPEELDELAY)         END,3.0) AS data27,     ROUND(         CASE             WHEN SUM(A.EULDELAY)=0             THEN 0             ELSE SUM(A.ULTRAFFIC)*8000/1024/SUM(A.EULDELAY)         END,3.0) AS data28,     ROUND(         CASE             WHEN SUM(A.EPHONEULDELAY)=0             THEN 0             ELSE SUM(A.PHONEULTRAFFIC)*8000/1024 /SUM(A.EPHONEULDELAY)         END,3.0) AS data29,     ROUND(         CASE             WHEN SUM(A.ESWKULDELAY)=0             THEN 0             ELSE SUM(A.SWKULTRAFFIC)*8000/1024/SUM(A.ESWKULDELAY)         END,3.0) AS data30,     ROUND(         CASE             WHEN SUM(A.EMIFIULDELAY)=0             THEN 0             ELSE SUM(A.MIFIULTRAFFIC)*8000/1024/SUM(A.EMIFIULDELAY)         END,3.0) AS data31,     ROUND(         CASE             WHEN SUM(A.ECPEULDELAY)=0             THEN 0             ELSE SUM(A.CPEULTRAFFIC)*8000/1024/SUM(A.ECPEULDELAY)         END,3.0) AS data32,     ROUND(         CASE             WHEN SUM(A.EUL5DELAY)=0             THEN 0             ELSE SUM(A.UL5TRAFFIC)*8000/1024/SUM(A.EUL5DELAY)         END,3.0) AS data33,     ROUND(         CASE             WHEN SUM(A.EPHONEUL5DELAY)=0             THEN 0             ELSE SUM(A.PHONEUL5TRAFFIC)*8000/1024 /SUM(A.EPHONEUL5DELAY)         END,3.0) AS data34,     ROUND(         CASE             WHEN SUM(A.ESWKUL5DELAY)=0             THEN 0             ELSE SUM(A.SWKUL5TRAFFIC)*8000/1024/SUM(A.ESWKUL5DELAY)         END,3.0) AS data35,     ROUND(         CASE             WHEN SUM(A.EMIFIUL5DELAY)=0             THEN 0             ELSE SUM(A.MIFIUL5TRAFFIC)*8000/1024/SUM(A.EMIFIUL5DELAY)         END,3.0) AS data36,     ROUND(         CASE             WHEN SUM(A.ECPEUL5DELAY)=0             THEN 0             ELSE SUM(A.CPEUL5TRAFFIC)*8000/1024/SUM(A.ECPEUL5DELAY)         END,3.0) AS data37,     ROUND(         CASE             WHEN SUM(A.DLDELAY)=0             THEN 0             ELSE 100*SUM(A.DELAY1MBPSUP)/SUM(A.DLDELAY)         END,3.0) AS data38,     ROUND(         CASE             WHEN SUM(A.PHONEDLDELAY)=0             THEN 0             ELSE 100*SUM(A.PHONEDELAY1MBPSUP)/SUM(A.PHONEDLDELAY)         END,3.0) AS data39,     ROUND(         CASE             WHEN SUM(A.DLDELAY)=0             THEN 0             ELSE 100*SUM(A.DELAY4MBPSUP)/SUM(A.DLDELAY)         END,3.0) AS data40,     ROUND(         CASE             WHEN SUM(A.PHONEDLDELAY)=0             THEN 0             ELSE 100*SUM(A.PHONEDELAY4MBPSUP)/SUM(A.PHONEDLDELAY)         END,3.0) AS data41,     ROUND(         CASE             WHEN SUM(A.DLDELAY)=0             THEN 0             ELSE 100*SUM(A.DELAY10MBPSUP)/SUM(A.DLDELAY)         END,3.0) AS data42,     ROUND(         CASE             WHEN SUM(A.PHONEDLDELAY)=0             THEN 0             ELSE 100*SUM(A.PHONEDELAY10MBPSUP)/SUM(A.PHONEDLDELAY)         END,3.0) AS data43,     ROUND(         CASE             WHEN SUM(A.ULDELAY)=0             THEN 0             ELSE 100*SUM(A.UDELAY100KBPSUP)/SUM(A.ULDELAY)         END,3.0) AS data44,     ROUND(         CASE             WHEN SUM(A.PHONEULDELAY)=0             THEN 0             ELSE 100*SUM(A.UPHONEDELAY100KBPSUP)/SUM(A.PHONEULDELAY)         END,3.0) AS data45,     ROUND(         CASE             WHEN SUM(A.ULDELAY)=0             THEN 0             ELSE 100*SUM(A.UDELAY200KBPSUP)/SUM(A.ULDELAY)         END,3.0) AS data46,     ROUND(         CASE             WHEN SUM(A.PHONEULDELAY)=0             THEN 0             ELSE 100*SUM(A.UPHONEDELAY200KBPSUP)/SUM(A.PHONEULDELAY)         END,3.0) AS data47,     ROUND(         CASE             WHEN SUM(A.ULDELAY)=0             THEN 0             ELSE 100*SUM(A.UDELAY500KBPSUP)/SUM(A.ULDELAY)         END,3.0) AS data48,     ROUND(         CASE             WHEN SUM(A.PHONEULDELAY)=0             THEN 0             ELSE 100*SUM(A.UPHONEDELAY500KBPSUP)/SUM(A.PHONEULDELAY)         END,3.0) AS data49,     ROUND(         CASE             WHEN SUM(A.COUNTUP)=0             THEN 0             ELSE 100*SUM(A.COUNT1MBPSUP)/SUM(A.COUNTUP)         END,3.0) AS data50,     ROUND(         CASE             WHEN SUM(A.PHONECOUNTUP)=0             THEN 0             ELSE 100*SUM(A.PHONECOUNT1MBPSUP)/SUM(A.PHONECOUNTUP)         END,3.0) AS data51,     ROUND(         CASE             WHEN SUM(A.COUNTUP)=0             THEN 0             ELSE 100*SUM(A.COUNT4MBPSUP)/SUM(A.COUNTUP)         END,3.0) AS data52,     ROUND(         CASE             WHEN SUM(A.PHONECOUNTUP)=0             THEN 0             ELSE 100*SUM(A.PHONECOUNT4MBPSUP)/SUM(A.PHONECOUNTUP)         END,3.0) AS data53,     ROUND(         CASE             WHEN SUM(A.COUNTUP)=0             THEN 0             ELSE 100*SUM(A.COUNT10MBPSUP)/SUM(A.COUNTUP)         END,3.0) AS data54,     ROUND(         CASE             WHEN SUM(A.PHONECOUNTUP)=0             THEN 0             ELSE 100*SUM(A.PHONECOUNT10MBPSUP)/SUM(A.PHONECOUNTUP)         END,3.0) AS data55,     ROUND(         CASE             WHEN SUM(A.UCOUNTUP)=0             THEN 0             ELSE 100*SUM(A.UCOUNT100KBPSUP)/SUM(A.UCOUNTUP)         END,3.0) AS data56,     ROUND(         CASE             WHEN SUM(A.UPHONECOUNTUP)=0             THEN 0             ELSE 100*SUM(A.UPHONECOUNT100KBPSUP)/SUM(A.UPHONECOUNTUP)         END,3.0) AS data57,     ROUND(         CASE             WHEN SUM(A.UCOUNTUP)=0             THEN 0             ELSE 100*SUM(A.UCOUNT200KBPSUP)/SUM(A.UCOUNTUP)         END,3.0) AS data58,     ROUND(         CASE             WHEN SUM(A.UPHONECOUNTUP)=0             THEN 0             ELSE 100*SUM(A.UPHONECOUNT200KBPSUP)/SUM(A.UPHONECOUNTUP)         END,3.0) AS data59,     ROUND(         CASE             WHEN SUM(A.UCOUNTUP)=0             THEN 0             ELSE 100*SUM(A.UCOUNT500KBPSUP)/SUM(A.UCOUNTUP)         END,3.0) AS data60,     ROUND(         CASE             WHEN SUM(A.UPHONECOUNTUP)=0             THEN 0             ELSE 100*SUM(A.UPHONECOUNT500KBPSUP)/SUM(A.UPHONECOUNTUP)         END,3.0) AS data61 FROM     (         SELECT             CASE                 WHEN GN.SERVICE='5'                 AND GN.FILETYPE>=7                 AND GN.FACTYPE=701                 THEN GN.DLTRAFFIC                 ELSE 0             END AS VIEDOTRAFFIC,             CASE                 WHEN GN.SERVICE='5'                 AND GN.FILETYPE>=7                 AND GN.FACTYPE=701                 THEN GN.DLDELAY                 ELSE 0             END AS VIEDODELAY,             CASE                 WHEN GN.SERVICE='15'                 AND GN.FILETYPE>=7                 AND GN.FACTYPE=701                 THEN GN.DLTRAFFIC                 ELSE 0             END AS WEBTRAFFIC,             CASE                 WHEN GN.SERVICE='15'                 AND GN.FILETYPE>=7                 AND GN.FACTYPE=701THEN GN.DLDELAY                 ELSE 0             END AS WEBDELAY,             CASE                 WHEN GN.SERVICE='1'                 AND GN.FACTYPE=701                 THEN GN.SCOUNT                 ELSE 0             END AS IMSCOUNT,             CASE                 WHEN GN.SERVICE='1'                 AND GN.FACTYPE=701                 THEN GN.ALLCOUNT                 ELSE 0             END AS IMALLCOUNT,             CASE                 WHEN GN.SERVICE='8'                 AND GN.FACTYPE=701                 THEN GN.SCOUNT                 ELSE 0             END AS GAMESCOUNT,             CASE                 WHEN GN.SERVICE='8'                 AND GN.FACTYPE=701                 THEN GN.ALLCOUNT                 ELSE 0             END AS GAMEALLCOUNT,             CASE                 WHEN GN.FILETYPE>=7                 THEN GN.DLDELAY                 ELSE 0             END AS DLDELAY,             CASE                 WHEN GN.FILETYPE>=7                 THEN GN.DLTRAFFIC                 ELSE 0             END AS DLTRAFFIC,             CASE                 WHEN GN.FILETYPE>=7                 AND GN.FACTYPE=701                 THEN DLDELAY                 ELSE 0             END AS PHONEDLDELAY,             CASE                 WHEN GN.FILETYPE>=7                 AND GN.FACTYPE=701                 THEN DLTRAFFIC                 ELSE 0             END AS PHONEDLTRAFFIC,             CASE                 WHEN GN.FILETYPE>=7                 AND GN.FACTYPE=703                 THEN DLDELAY                 ELSE 0             END AS SWKDLDELAY,             CASE                 WHEN GN.FILETYPE>=7                 AND GN.FACTYPE=703                 THEN DLTRAFFIC                 ELSE 0             END AS SWKDLTRAFFIC,             CASE                 WHEN GN.FILETYPE>=7                 AND GN.FACTYPE=702                 THEN DLDELAY                 ELSE 0             END AS MIFIDLDELAY,             CASE                 WHEN GN.FILETYPE>=7                 AND GN.FACTYPE=702                 THEN DLTRAFFIC                 ELSE 0             END AS MIFIDLTRAFFIC,             CASE                 WHEN GN.FILETYPE>=7                 AND GN.FACTYPE=704                 THEN DLDELAY                 ELSE 0             END AS CPEDLDELAY,             CASE                 WHEN GN.FILETYPE>=7                 AND GN.FACTYPE=704                 THEN DLTRAFFIC                 ELSE 0             END AS CPEDLTRAFFIC,             CASE                 WHEN GN.UFILETYPE>=3                 THEN GN.ULDELAY                 ELSE 0             END AS ULDELAY,             CASE                 WHEN GN.UFILETYPE>=3                 THEN GN.ULTRAFFIC                 ELSE 0             END AS ULTRAFFIC,             CASE                 WHEN GN.UFILETYPE>=3                 AND GN.FACTYPE=701                 THEN ULDELAY                 ELSE 0             END AS PHONEULDELAY,             CASE                 WHEN GN.UFILETYPE>=3                 AND GN.FACTYPE=701                 THEN ULTRAFFIC                 ELSE 0             END AS PHONEULTRAFFIC,             CASE                 WHEN GN.UFILETYPE>=3                 AND GN.FACTYPE=703                 THEN ULDELAY                 ELSE 0             END AS SWKULDELAY,             CASE                 WHEN GN.UFILETYPE>=3                 AND GN.FACTYPE=703                 THEN ULTRAFFIC                 ELSE 0             END AS SWKULTRAFFIC,             CASE                 WHEN GN.UFILETYPE>=3                 AND GN.FACTYPE=702                 THEN ULDELAY                 ELSE 0             END AS MIFIULDELAY,             CASE                 WHEN GN.UFILETYPE>=3                 AND GN.FACTYPE=702                 THEN ULTRAFFIC                 ELSE 0             END AS MIFIULTRAFFIC,             CASE                 WHEN GN.UFILETYPE>=3                 AND GN.FACTYPE=704                 THEN ULDELAY                 ELSE 0             END AS CPEULDELAY,             CASE                 WHEN GN.UFILETYPE>=3                 AND GN.FACTYPE=704                 THEN ULTRAFFIC                 ELSE 0             END AS CPEULTRAFFIC,             CASE                 WHEN GN.UFILETYPE>=7                 THEN GN.ULDELAY                 ELSE 0             END AS UL5DELAY,             CASE                 WHEN GN.UFILETYPE>=7                 THEN GN.ULTRAFFIC                 ELSE 0             END AS UL5TRAFFIC,             CASE                 WHEN GN.UFILETYPE>=7                 AND GN.FACTYPE=701                 THEN ULDELAY                 ELSE 0             END AS PHONEUL5DELAY,             CASE                 WHEN GN.UFILETYPE>=7                 AND GN.FACTYPE=701                 THEN ULTRAFFIC                 ELSE 0             END AS PHONEUL5TRAFFIC,             CASE                 WHEN GN.UFILETYPE>=7                 AND GN.FACTYPE=703                 THEN ULDELAY                 ELSE 0             END AS SWKUL5DELAY,             CASE                 WHEN GN.UFILETYPE>=7                 AND GN.FACTYPE=703                 THEN ULTRAFFIC                 ELSE 0             END AS SWKUL5TRAFFIC,             CASE                 WHEN GN.UFILETYPE>=7                 AND GN.FACTYPE=702                 THEN ULDELAY                 ELSE 0             END AS MIFIUL5DELAY,             CASE                 WHEN GN.UFILETYPE>=7                 AND GN.FACTYPE=702                 THEN ULTRAFFIC                 ELSE 0             END AS MIFIUL5TRAFFIC,             CASE                 WHEN GN.UFILETYPE>=7                 AND GN.FACTYPE=704                 THEN ULDELAY                 ELSE 0             END AS CPEUL5DELAY,             CASE                 WHEN GN.UFILETYPE>=7                 AND GN.FACTYPE=704                 THEN ULTRAFFIC                 ELSE 0             END AS CPEUL5TRAFFIC,             CASE                 WHEN GN.FILETYPE>=7                 THEN GN.EMPTYDELAY                 ELSE 0             END AS ELDELAY,             CASE                 WHEN GN.FILETYPE>=7                 AND GN.FACTYPE=701                 THEN EMPTYDELAY                 ELSE 0             END AS PHONEELDELAY,             CASE                 WHEN GN.FILETYPE>=7                 AND GN.FACTYPE=703                 THEN EMPTYDELAY                 ELSE 0             END AS SWKELDELAY,             CASE                 WHEN GN.FILETYPE>=7                 AND GN.FACTYPE=702                 THEN EMPTYDELAY                 ELSE 0             END AS MIFIELDELAY,             CASE                 WHEN GN.FILETYPE>=7                 AND GN.FACTYPE=704                 THEN EMPTYDELAY                 ELSE 0             END AS CPEELDELAY,             CASE                 WHEN GN.UFILETYPE>=3                 THEN GN.EMPTYDELAY                 ELSE 0             END AS EULDELAY,             CASE                 WHEN GN.UFILETYPE>=3                 AND GN.FACTYPE=701                 THEN EMPTYDELAY                 ELSE 0             END AS EPHONEULDELAY,             CASE                 WHEN GN.UFILETYPE>=3                 AND GN.FACTYPE=703                 THEN EMPTYDELAY                 ELSE 0             END AS ESWKULDELAY,             CASE                 WHEN GN.UFILETYPE>=3                 AND GN.FACTYPE=702                 THEN EMPTYDELAY                 ELSE 0             END AS EMIFIULDELAY,             CASE                 WHEN GN.UFILETYPE>=3                 AND GN.FACTYPE=704                 THEN EMPTYDELAY                 ELSE 0             END AS ECPEULDELAY,             CASE                 WHEN GN.UFILETYPE>=7                 THEN GN.EMPTYDELAY                 ELSE 0             END AS EUL5DELAY,             CASE                 WHEN GN.UFILETYPE>=7                 AND GN.FACTYPE=701                 THEN EMPTYDELAY                 ELSE 0             END AS EPHONEUL5DELAY,             CASE                 WHEN GN.UFILETYPE>=7                 AND GN.FACTYPE=703                 THEN EMPTYDELAY                 ELSE 0             END AS ESWKUL5DELAY,             CASE                 WHEN GN.UFILETYPE>=7                 AND GN.FACTYPE=702                 THEN EMPTYDELAY                 ELSE 0             END AS EMIFIUL5DELAY,             CASE                 WHEN GN.UFILETYPE>=7                 AND GN.FACTYPE=704                 THEN EMPTYDELAY                 ELSE 0             END AS ECPEUL5DELAY,             CASE                 WHEN GN.FILETYPE>=7                 AND GN.LTEDOWNSPEEDGROUP>=14                 THEN GN.DLDELAY                 ELSE 0             END AS DELAY1MBPSUP,             CASE                 WHEN GN.FILETYPE>=7                 AND GN.LTEDOWNSPEEDGROUP>=20                 THEN GN.DLDELAY                 ELSE 0             END AS DELAY4MBPSUP,             CASE                 WHEN GN.FILETYPE>=7                 AND GN.LTEDOWNSPEEDGROUP>=32                 THEN GN.DLDELAY                 ELSE 0             END AS DELAY10MBPSUP,             CASE                 WHEN GN.FILETYPE>=7                 AND GN.FACTYPE=701                 AND GN.LTEDOWNSPEEDGROUP>=14                 THEN GN.DLDELAY                 ELSE 0             END AS PHONEDELAY1MBPSUP,             CASE                 WHEN GN.FILETYPE>=7                 AND GN.FACTYPE=701                 AND GN.LTEDOWNSPEEDGROUP>=20                 THEN GN.DLDELAY                 ELSE 0             END AS PHONEDELAY4MBPSUP,             CASE                 WHEN GN.FILETYPE>=7                 AND GN.FACTYPE=701                 AND GN.LTEDOWNSPEEDGROUP>=32                 THEN GN.DLDELAY                 ELSE 0             END AS PHONEDELAY10MBPSUP,             CASE                 WHEN GN.UFILETYPE>=3                 AND GN.LTEUPSPEEDGROUP>=3                 THEN GN.ULDELAY                 ELSE 0             END AS UDELAY100KBPSUP,             CASE                 WHEN GN.UFILETYPE>=3                 AND GN.LTEUPSPEEDGROUP>=5                 THEN GN.ULDELAY                 ELSE 0             END AS UDELAY200KBPSUP,             CASE                 WHEN GN.UFILETYPE>=3                 AND GN.LTEUPSPEEDGROUP>=9                 THEN GN.ULDELAY                 ELSE 0             END AS UDELAY500KBPSUP,             CASE                 WHEN GN.UFILETYPE>=3                 AND GN.FACTYPE=701                 AND GN.LTEUPSPEEDGROUP>=3                 THEN GN.ULDELAY                 ELSE 0             END AS UPHONEDELAY100KBPSUP,             CASE                 WHEN GN.UFILETYPE>=3                 AND GN.FACTYPE=701                 AND GN.LTEUPSPEEDGROUP>=5                 THEN GN.ULDELAY                 ELSE 0             END AS UPHONEDELAY200KBPSUP,             CASE                 WHEN GN.UFILETYPE>=3                 AND GN.FACTYPE=701                 AND GN.LTEUPSPEEDGROUP>=9                 THEN GN.ULDELAY                 ELSE 0             END AS UPHONEDELAY500KBPSUP,             CASE                 WHEN GN.FILETYPE>=7                 THEN GN.ALLCOUNT                 ELSE 0             END AS COUNTUP,             CASE                 WHEN GN.FILETYPE>=7                 AND GN.LTEDOWNSPEEDGROUP>=14                 THEN GN.ALLCOUNT                 ELSE 0             END AS COUNT1MBPSUP,             CASE                 WHEN GN.FILETYPE>=7                 AND GN.LTEDOWNSPEEDGROUP>=20                 THEN GN.ALLCOUNT                 ELSE 0             END AS COUNT4MBPSUP,             CASE                 WHEN GN.FILETYPE>=7                 AND GN.LTEDOWNSPEEDGROUP>=32                 THEN GN.ALLCOUNT                 ELSE 0             END AS COUNT10MBPSUP,             CASE                 WHEN GN.FILETYPE>=7                 AND GN.FACTYPE=701                 THEN GN.ALLCOUNT                 ELSE 0             END AS PHONECOUNTUP,             CASE                 WHEN GN.FILETYPE>=7                 AND GN.FACTYPE=701                 AND GN.LTEDOWNSPEEDGROUP>=14                 THEN GN.ALLCOUNT                 ELSE 0             END AS PHONECOUNT1MBPSUP,             CASE                 WHEN GN.FILETYPE>=7                 AND GN.FACTYPE=701                 AND GN.LTEDOWNSPEEDGROUP>=20                 THEN GN.ALLCOUNT                 ELSE 0             END AS PHONECOUNT4MBPSUP,             CASE                 WHEN GN.FILETYPE>=7                 AND GN.FACTYPE=701                 AND GN.LTEDOWNSPEEDGROUP>=32                 THEN GN.ALLCOUNT                 ELSE 0             END AS PHONECOUNT10MBPSUP,             CASE                 WHEN GN.UFILETYPE>=3                 THEN GN.ALLCOUNT                 ELSE 0             END AS UCOUNTUP,             CASE                 WHEN GN.UFILETYPE>=3                 AND GN.LTEUPSPEEDGROUP>=3                 THEN GN.ALLCOUNT                 ELSE 0             END AS UCOUNT100KBPSUP,             CASE                 WHEN GN.UFILETYPE>=3                 AND GN.LTEUPSPEEDGROUP>=5                 THEN GN.ALLCOUNT                 ELSE 0             END AS UCOUNT200KBPSUP,             CASE                 WHEN GN.UFILETYPE>=3                 AND GN.LTEUPSPEEDGROUP>=9                 THEN GN.ALLCOUNT                 ELSE 0             END AS UCOUNT500KBPSUP,             CASE                 WHEN GN.UFILETYPE>=3                 AND GN.FACTYPE=701                 THEN GN.ALLCOUNT                 ELSE 0             END AS UPHONECOUNTUP,             CASE                 WHEN GN.UFILETYPE>=3                 AND GN.FACTYPE=701                 AND GN.LTEUPSPEEDGROUP>=3                 THEN GN.ALLCOUNT                 ELSE 0             END AS UPHONECOUNT100KBPSUP,             CASE                 WHEN GN.UFILETYPE>=3                 AND GN.FACTYPE=701                 AND GN.LTEUPSPEEDGROUP>=5                 THEN GN.ALLCOUNT                 ELSE 0             END AS UPHONECOUNT200KBPSUP,             CASE                 WHEN GN.UFILETYPE>=3                 AND GN.FACTYPE=701                 AND GN.LTEUPSPEEDGROUP>=9                 THEN GN.ALLCOUNT                 ELSE 0             END AS UPHONECOUNT500KBPSUP         FROM             LTe_sys.[@p0]_T_GN_SUM_ALLFILE GN         WHERE             1=1 [@and] ${[@city0] [@and] [@time0]}&  [@and] [@fac0]) A UNION SELECT     '全国' AS PRONAME,     '汇总' AS CITYNAME,     CASE         WHEN A.EQUIPMENT IS NULL         THEN '未匹配'         ELSE A.EQUIPMENT     END AS EQUIPMENT,     ROUND(         CASE             WHEN SUM(A.VIEDODELAY)=0             THEN 0             ELSE SUM(A.VIEDOTRAFFIC)*8000/1024/SUM(A.VIEDODELAY)         END,3.0) AS VIEDOSPEED,     ROUND(         CASE             WHEN SUM(A.WEBDELAY)=0             THEN 0             ELSE SUM(A.WEBTRAFFIC)*8000/1024/SUM(A.WEBDELAY)         END,3.0) AS WEBSPEED,     ROUND(         CASE             WHEN SUM(A.IMALLCOUNT)=0             THEN 0             ELSE 100*SUM(A.IMSCOUNT)/SUM(A.IMALLCOUNT)         END,3.0) AS IMPER,     ROUND(         CASE             WHEN SUM(A.GAMEALLCOUNT)=0             THEN 0             ELSE 100*SUM(A.GAMESCOUNT)/SUM(A.GAMEALLCOUNT)         END,3.0) AS GAMEPER,     ROUND(         CASE             WHEN SUM(A.DLDELAY)=0             THEN 0             ELSE SUM(A.DLTRAFFIC)*8000/1024/SUM(A.DLDELAY)         END,3.0) AS DSPEED,     ROUND(         CASE             WHEN SUM(A.PHONEDLDELAY)=0             THEN 0             ELSE SUM(A.PHONEDLTRAFFIC)*8000/1024 /SUM(A.PHONEDLDELAY)         END,3.0) AS PHONEDSPEED,     ROUND(         CASE             WHEN SUM(A.SWKDLDELAY)=0             THEN 0             ELSE SUM(A.SWKDLTRAFFIC)*8000/1024/SUM(A.SWKDLDELAY)         END,3.0) AS SWKSPEED,     ROUND(         CASE             WHEN SUM(A.MIFIDLDELAY)=0             THEN 0             ELSE SUM(A.MIFIDLTRAFFIC)*8000/1024/SUM(A.MIFIDLDELAY)         END,3.0) AS MIFISPEED,     ROUND(         CASE             WHEN SUM(A.CPEDLDELAY)=0             THEN 0             ELSE SUM(A.CPEDLTRAFFIC)*8000/1024/SUM(A.CPEDLDELAY)         END,3.0) AS CPESPEED,     ROUND(         CASE             WHEN SUM(A.ULDELAY)=0             THEN 0             ELSE SUM(A.ULTRAFFIC)*8000/1024/SUM(A.ULDELAY)         END,3.0) AS USPEED,     ROUND(         CASE             WHEN SUM(A.PHONEULDELAY)=0             THEN 0             ELSE SUM(A.PHONEULTRAFFIC)*8000/1024 /SUM(A.PHONEULDELAY)         END,3.0) AS PHONEUSPEED,     ROUND(         CASE             WHEN SUM(A.SWKULDELAY)=0             THEN 0             ELSE SUM(A.SWKULTRAFFIC)*8000/1024/SUM(A.SWKULDELAY)         END,3.0) AS SWKUSPEED,     ROUND(         CASE             WHEN SUM(A.MIFIULDELAY)=0             THEN 0             ELSE SUM(A.MIFIULTRAFFIC)*8000/1024/SUM(A.MIFIULDELAY)         END,3.0) AS MIFIUSPEED,     ROUND(         CASE             WHEN SUM(A.CPEULDELAY)=0             THEN 0             ELSE SUM(A.CPEULTRAFFIC)*8000/1024/SUM(A.CPEULDELAY)         END,3.0) AS CPEUSPEED,     ROUND(         CASE             WHEN SUM(A.UL5DELAY)=0             THEN 0             ELSE SUM(A.UL5TRAFFIC)*8000/1024/SUM(A.UL5DELAY)         END,3.0) AS U5SPEED,     ROUND(         CASE             WHEN SUM(A.PHONEUL5DELAY)=0             THEN 0             ELSE SUM(A.PHONEUL5TRAFFIC)*8000/1024 /SUM(A.PHONEUL5DELAY)         END,3.0) AS PHONEU5SPEED,     ROUND(         CASE             WHEN SUM(A.SWKUL5DELAY)=0             THEN 0             ELSE SUM(A.SWKUL5TRAFFIC)*8000/1024/SUM(A.SWKUL5DELAY)         END,3.0) AS SWKU5SPEED,     ROUND(         CASE             WHEN SUM(A.MIFIUL5DELAY)=0             THEN 0             ELSE SUM(A.MIFIUL5TRAFFIC)*8000/1024/SUM(A.MIFIUL5DELAY)         END,3.0) AS MIFIU5SPEED,     ROUND(         CASE             WHEN SUM(A.CPEUL5DELAY)=0             THEN 0             ELSE SUM(A.CPEUL5TRAFFIC)*8000/1024/SUM(A.CPEUL5DELAY)         END,3.0) AS CPEU5SPEED,     ROUND(         CASE             WHEN SUM(A.ELDELAY)=0             THEN 0             ELSE SUM(A.DLTRAFFIC)*8000/1024/SUM(A.ELDELAY)         END,3.0) AS EDSPEED,     ROUND(         CASE             WHEN SUM(A.PHONEELDELAY)=0             THEN 0             ELSE SUM(A.PHONEDLTRAFFIC)*8000/1024 /SUM(A.PHONEELDELAY)         END,3.0) AS EPHONEDSPEED,     ROUND(         CASE             WHEN SUM(A.SWKELDELAY)=0             THEN 0             ELSE SUM(A.SWKDLTRAFFIC)*8000/1024/SUM(A.SWKELDELAY)         END,3.0) AS ESWKSPEED,     ROUND(         CASE             WHEN SUM(A.MIFIELDELAY)=0             THEN 0             ELSE SUM(A.MIFIDLTRAFFIC)*8000/1024/SUM(A.MIFIELDELAY)         END,3.0) AS EMIFISPEED,     ROUND(         CASE             WHEN SUM(A.CPEELDELAY)=0             THEN 0             ELSE SUM(A.CPEDLTRAFFIC)*8000/1024/SUM(A.CPEELDELAY)         END,3.0) AS ECPESPEED,     ROUND(         CASE             WHEN SUM(A.EULDELAY)=0             THEN 0             ELSE SUM(A.ULTRAFFIC)*8000/1024/SUM(A.EULDELAY)         END,3.0) AS EUSPEED,     ROUND(         CASE             WHEN SUM(A.EPHONEULDELAY)=0             THEN 0             ELSE SUM(A.PHONEULTRAFFIC)*8000/1024 /SUM(A.EPHONEULDELAY)         END,3.0) AS EPHONEUSPEED,     ROUND(         CASE             WHEN SUM(A.ESWKULDELAY)=0             THEN 0             ELSE SUM(A.SWKULTRAFFIC)*8000/1024/SUM(A.ESWKULDELAY)         END,3.0) AS ESWKUSPEED,     ROUND(         CASE             WHEN SUM(A.EMIFIULDELAY)=0             THEN 0             ELSE SUM(A.MIFIULTRAFFIC)*8000/1024/SUM(A.EMIFIULDELAY)         END,3.0) AS EMIFIUSPEED,     ROUND(         CASE             WHEN SUM(A.ECPEULDELAY)=0             THEN 0             ELSE SUM(A.CPEULTRAFFIC)*8000/1024/SUM(A.ECPEULDELAY)         END,3.0) AS ECPEUSPEED,     ROUND(         CASE             WHEN SUM(A.EUL5DELAY)=0             THEN 0             ELSE SUM(A.UL5TRAFFIC)*8000/1024/SUM(A.EUL5DELAY)         END,3.0) AS EU5SPEED,     ROUND(         CASE             WHEN SUM(A.EPHONEUL5DELAY)=0             THEN 0             ELSE SUM(A.PHONEUL5TRAFFIC)*8000/1024 /SUM(A.EPHONEUL5DELAY)         END,3.0) AS EPHONEU5SPEED,     ROUND(         CASE             WHEN SUM(A.ESWKUL5DELAY)=0             THEN 0             ELSE SUM(A.SWKUL5TRAFFIC)*8000/1024/SUM(A.ESWKUL5DELAY)         END,3.0) AS ESWKU5SPEED,     ROUND(         CASE             WHEN SUM(A.EMIFIUL5DELAY)=0             THEN 0             ELSE SUM(A.MIFIUL5TRAFFIC)*8000/1024/SUM(A.EMIFIUL5DELAY)         END,3.0) AS EMIFIU5SPEED,     ROUND(         CASE             WHEN SUM(A.ECPEUL5DELAY)=0             THEN 0             ELSE SUM(A.CPEUL5TRAFFIC)*8000/1024/SUM(A.ECPEUL5DELAY)         END,3.0) AS ECPEU5SPEED,     ROUND(         CASE             WHEN SUM(A.DLDELAY)=0             THEN 0             ELSE 100*SUM(A.DELAY1MBPSUP)/SUM(A.DLDELAY)         END,3.0) AS DSPEED1PER,     ROUND(         CASE             WHEN SUM(A.PHONEDLDELAY)=0             THEN 0             ELSE 100*SUM(A.PHONEDELAY1MBPSUP)/SUM(A.PHONEDLDELAY)         END,3.0) AS DPHONESPEED1PER,     ROUND(         CASE             WHEN SUM(A.DLDELAY)=0             THEN 0             ELSE 100*SUM(A.DELAY4MBPSUP)/SUM(A.DLDELAY)         END,3.0) AS DSPEED4PER,     ROUND(         CASE             WHEN SUM(A.PHONEDLDELAY)=0             THEN 0             ELSE 100*SUM(A.PHONEDELAY4MBPSUP)/SUM(A.PHONEDLDELAY)         END,3.0) AS DPHONESPEED4PER,     ROUND(         CASE             WHEN SUM(A.DLDELAY)=0             THEN 0             ELSE 100*SUM(A.DELAY10MBPSUP)/SUM(A.DLDELAY)         END,3.0) AS DSPEED10PER,     ROUND(         CASE             WHEN SUM(A.PHONEDLDELAY)=0             THEN 0             ELSE 100*SUM(A.PHONEDELAY10MBPSUP)/SUM(A.PHONEDLDELAY)         END,3.0) AS DPHONESPEED10PER,     ROUND(         CASE             WHEN SUM(A.ULDELAY)=0             THEN 0             ELSE 100*SUM(A.UDELAY100KBPSUP)/SUM(A.ULDELAY)         END,3.0) AS USPEED100PER,     ROUND(         CASE             WHEN SUM(A.PHONEULDELAY)=0             THEN 0             ELSE 100*SUM(A.UPHONEDELAY100KBPSUP)/SUM(A.PHONEULDELAY)         END,3.0) AS UPHONESPEED100PER,     ROUND(         CASE             WHEN SUM(A.ULDELAY)=0             THEN 0             ELSE 100*SUM(A.UDELAY200KBPSUP)/SUM(A.ULDELAY)         END,3.0) AS USPEED200PER,     ROUND(         CASE             WHEN SUM(A.PHONEULDELAY)=0             THEN 0             ELSE 100*SUM(A.UPHONEDELAY200KBPSUP)/SUM(A.PHONEULDELAY)         END,3.0) AS UPHONESPEED200PER,     ROUND(         CASE             WHEN SUM(A.ULDELAY)=0             THEN 0             ELSE 100*SUM(A.UDELAY500KBPSUP)/SUM(A.ULDELAY)         END,3.0) AS USPEED500PER,     ROUND(         CASE             WHEN SUM(A.PHONEULDELAY)=0             THEN 0             ELSE 100*SUM(A.UPHONEDELAY500KBPSUP)/SUM(A.PHONEULDELAY)         END,3.0) AS UPHONESPEED500PER,     ROUND(         CASE             WHEN SUM(A.COUNTUP)=0             THEN 0             ELSE 100*SUM(A.COUNT1MBPSUP)/SUM(A.COUNTUP)         END,3.0) AS EDSPEED1PER,     ROUND(         CASE             WHEN SUM(A.PHONECOUNTUP)=0             THEN 0             ELSE 100*SUM(A.PHONECOUNT1MBPSUP)/SUM(A.PHONECOUNTUP)         END,3.0) AS EDPHONESPEED1PER,     ROUND(         CASE             WHEN SUM(A.COUNTUP)=0             THEN 0             ELSE 100*SUM(A.COUNT4MBPSUP)/SUM(A.COUNTUP)         END,3.0) AS EDSPEED4PER,     ROUND(         CASE             WHEN SUM(A.PHONECOUNTUP)=0             THEN 0             ELSE 100*SUM(A.PHONECOUNT4MBPSUP)/SUM(A.PHONECOUNTUP)         END,3.0) AS EDPHONESPEED4PER,     ROUND(         CASE             WHEN SUM(A.COUNTUP)=0             THEN 0             ELSE 100*SUM(A.COUNT10MBPSUP)/SUM(A.COUNTUP)         END,3.0) AS EDSPEED10PER,     ROUND(         CASE             WHEN SUM(A.PHONECOUNTUP)=0             THEN 0             ELSE 100*SUM(A.PHONECOUNT10MBPSUP)/SUM(A.PHONECOUNTUP)         END,3.0) AS EDPHONESPEED10PER,     ROUND(         CASE             WHEN SUM(A.UCOUNTUP)=0             THEN 0             ELSE 100*SUM(A.UCOUNT100KBPSUP)/SUM(A.UCOUNTUP)         END,3.0) AS EUSPEED100PER,     ROUND(         CASE             WHEN SUM(A.UPHONECOUNTUP)=0             THEN 0             ELSE 100*SUM(A.UPHONECOUNT100KBPSUP)/SUM(A.UPHONECOUNTUP)         END,3.0) AS EUPHONESPEED100PER,     ROUND(         CASE             WHEN SUM(A.UCOUNTUP)=0             THEN 0             ELSE 100*SUM(A.UCOUNT200KBPSUP)/SUM(A.UCOUNTUP)         END,3.0) AS EUSPEED200PER,     ROUND(         CASE             WHEN SUM(A.UPHONECOUNTUP)=0             THEN 0             ELSE 100*SUM(A.UPHONECOUNT200KBPSUP)/SUM(A.UPHONECOUNTUP)         END,3.0) AS EUPHONESPEED200PER,     ROUND(         CASE             WHEN SUM(A.UCOUNTUP)=0             THEN 0             ELSE 100*SUM(A.UCOUNT500KBPSUP)/SUM(A.UCOUNTUP)         END,3.0) AS EUSPEED500PER,     ROUND(         CASE             WHEN SUM(A.UPHONECOUNTUP)=0             THEN 0             ELSE 100*SUM(A.UPHONECOUNT500KBPSUP)/SUM(A.UPHONECOUNTUP)         END,3.0) AS EUPHONESPEED500PER FROM     (         SELECT             GN.EQUIPMENT,             CASE                 WHEN GN.SERVICE='5'                 AND GN.FILETYPE>=7                 AND GN.FACTYPE=701                 THEN GN.DLTRAFFIC                 ELSE 0             END AS VIEDOTRAFFIC,             CASE                 WHEN GN.SERVICE='5'                 AND GN.FILETYPE>=7                 AND GN.FACTYPE=701                 THEN GN.DLDELAY                 ELSE 0             END AS VIEDODELAY,             CASE                 WHEN GN.SERVICE='15'                 AND GN.FILETYPE>=7                 AND GN.FACTYPE=701                 THEN GN.DLTRAFFIC                 ELSE 0             END AS WEBTRAFFIC,             CASE                 WHEN GN.SERVICE='15'                 AND GN.FILETYPE>=7                 AND GN.FACTYPE=701THEN GN.DLDELAY                 ELSE 0             END AS WEBDELAY,             CASE                 WHEN GN.SERVICE='1'                 AND GN.FACTYPE=701                 THEN GN.SCOUNT                 ELSE 0             END AS IMSCOUNT,             CASE                 WHEN GN.SERVICE='1'                 AND GN.FACTYPE=701                 THEN GN.ALLCOUNT                 ELSE 0             END AS IMALLCOUNT,             CASE                 WHEN GN.SERVICE='8'                 AND GN.FACTYPE=701                 THEN GN.SCOUNT                 ELSE 0             END AS GAMESCOUNT,             CASE                 WHEN GN.SERVICE='8'                 AND GN.FACTYPE=701                 THEN GN.ALLCOUNT                 ELSE 0             END AS GAMEALLCOUNT,             CASE                 WHEN GN.FILETYPE>=7                 THEN GN.DLDELAY                 ELSE 0             END AS DLDELAY,             CASE                 WHEN GN.FILETYPE>=7                 THEN GN.DLTRAFFIC                 ELSE 0             END AS DLTRAFFIC,             CASE                 WHEN GN.FILETYPE>=7                 AND GN.FACTYPE=701                 THEN DLDELAY                 ELSE 0             END AS PHONEDLDELAY,             CASE                 WHEN GN.FILETYPE>=7                 AND GN.FACTYPE=701                 THEN DLTRAFFIC                 ELSE 0             END AS PHONEDLTRAFFIC,             CASE                 WHEN GN.FILETYPE>=7                 AND GN.FACTYPE=703                 THEN DLDELAY                 ELSE 0             END AS SWKDLDELAY,             CASE                 WHEN GN.FILETYPE>=7                 AND GN.FACTYPE=703                 THEN DLTRAFFIC                 ELSE 0             END AS SWKDLTRAFFIC,             CASE                 WHEN GN.FILETYPE>=7                 AND GN.FACTYPE=702                 THEN DLDELAY                 ELSE 0             END AS MIFIDLDELAY,             CASE                 WHEN GN.FILETYPE>=7                 AND GN.FACTYPE=702                 THEN DLTRAFFIC                 ELSE 0             END AS MIFIDLTRAFFIC,             CASE                 WHEN GN.FILETYPE>=7                 AND GN.FACTYPE=704                 THEN DLDELAY                 ELSE 0             END AS CPEDLDELAY,             CASE                 WHEN GN.FILETYPE>=7                 AND GN.FACTYPE=704                 THEN DLTRAFFIC                 ELSE 0             END AS CPEDLTRAFFIC,             CASE                 WHEN GN.UFILETYPE>=3                 THEN GN.ULDELAY                 ELSE 0             END AS ULDELAY,             CASE                 WHEN GN.UFILETYPE>=3                 THEN GN.ULTRAFFIC                 ELSE 0             END AS ULTRAFFIC,             CASE                 WHEN GN.UFILETYPE>=3                 AND GN.FACTYPE=701                 THEN ULDELAY                 ELSE 0             END AS PHONEULDELAY,             CASE                 WHEN GN.UFILETYPE>=3                 AND GN.FACTYPE=701                 THEN ULTRAFFIC                 ELSE 0             END AS PHONEULTRAFFIC,             CASE                 WHEN GN.UFILETYPE>=3                 AND GN.FACTYPE=703                 THEN ULDELAY                 ELSE 0             END AS SWKULDELAY,             CASE                 WHEN GN.UFILETYPE>=3                 AND GN.FACTYPE=703                 THEN ULTRAFFIC                 ELSE 0             END AS SWKULTRAFFIC,             CASE                 WHEN GN.UFILETYPE>=3                 AND GN.FACTYPE=702                 THEN ULDELAY                 ELSE 0             END AS MIFIULDELAY,             CASE                 WHEN GN.UFILETYPE>=3                 AND GN.FACTYPE=702                 THEN ULTRAFFIC                 ELSE 0             END AS MIFIULTRAFFIC,             CASE                 WHEN GN.UFILETYPE>=3                 AND GN.FACTYPE=704                 THEN ULDELAY                 ELSE 0             END AS CPEULDELAY,             CASE                 WHEN GN.UFILETYPE>=3                 AND GN.FACTYPE=704                 THEN ULTRAFFIC                 ELSE 0             END AS CPEULTRAFFIC,             CASE                 WHEN GN.UFILETYPE>=7                 THEN GN.ULDELAY                 ELSE 0             END AS UL5DELAY,             CASE                 WHEN GN.UFILETYPE>=7                 THEN GN.ULTRAFFIC                 ELSE 0             END AS UL5TRAFFIC,             CASE                 WHEN GN.UFILETYPE>=7                 AND GN.FACTYPE=701                 THEN ULDELAY                 ELSE 0             END AS PHONEUL5DELAY,             CASE                 WHEN GN.UFILETYPE>=7                 AND GN.FACTYPE=701                 THEN ULTRAFFIC                 ELSE 0             END AS PHONEUL5TRAFFIC,             CASE                 WHEN GN.UFILETYPE>=7                 AND GN.FACTYPE=703                 THEN ULDELAY                 ELSE 0             END AS SWKUL5DELAY,             CASE                 WHEN GN.UFILETYPE>=7                 AND GN.FACTYPE=703                 THEN ULTRAFFIC                 ELSE 0             END AS SWKUL5TRAFFIC,             CASE                 WHEN GN.UFILETYPE>=7                 AND GN.FACTYPE=702                 THEN ULDELAY                 ELSE 0             END AS MIFIUL5DELAY,             CASE                 WHEN GN.UFILETYPE>=7                 AND GN.FACTYPE=702                 THEN ULTRAFFIC                 ELSE 0             END AS MIFIUL5TRAFFIC,             CASE                 WHEN GN.UFILETYPE>=7                 AND GN.FACTYPE=704                 THEN ULDELAY                 ELSE 0             END AS CPEUL5DELAY,             CASE                 WHEN GN.UFILETYPE>=7                 AND GN.FACTYPE=704                 THEN ULTRAFFIC                 ELSE 0             END AS CPEUL5TRAFFIC,             CASE                 WHEN GN.FILETYPE>=7                 THEN GN.EMPTYDELAY                 ELSE 0             END AS ELDELAY,             CASE                 WHEN GN.FILETYPE>=7                 AND GN.FACTYPE=701                 THEN EMPTYDELAY                 ELSE 0             END AS PHONEELDELAY,             CASE                 WHEN GN.FILETYPE>=7                 AND GN.FACTYPE=703                 THEN EMPTYDELAY                 ELSE 0             END AS SWKELDELAY,             CASE                 WHEN GN.FILETYPE>=7                 AND GN.FACTYPE=702                 THEN EMPTYDELAY                 ELSE 0             END AS MIFIELDELAY,             CASE                 WHEN GN.FILETYPE>=7                 AND GN.FACTYPE=704                 THEN EMPTYDELAY                 ELSE 0             END AS CPEELDELAY,             CASE                 WHEN GN.UFILETYPE>=3                 THEN GN.EMPTYDELAY                 ELSE 0             END AS EULDELAY,             CASE                 WHEN GN.UFILETYPE>=3                 AND GN.FACTYPE=701                 THEN EMPTYDELAY                 ELSE 0             END AS EPHONEULDELAY,             CASE                 WHEN GN.UFILETYPE>=3                 AND GN.FACTYPE=703                 THEN EMPTYDELAY                 ELSE 0             END AS ESWKULDELAY,             CASE                 WHEN GN.UFILETYPE>=3                 AND GN.FACTYPE=702                 THEN EMPTYDELAY                 ELSE 0             END AS EMIFIULDELAY,             CASE                 WHEN GN.UFILETYPE>=3                 AND GN.FACTYPE=704                 THEN EMPTYDELAY                 ELSE 0             END AS ECPEULDELAY,             CASE                 WHEN GN.UFILETYPE>=7                 THEN GN.EMPTYDELAY                 ELSE 0             END AS EUL5DELAY,             CASE                 WHEN GN.UFILETYPE>=7                 AND GN.FACTYPE=701                 THEN EMPTYDELAY                 ELSE 0             END AS EPHONEUL5DELAY,             CASE                 WHEN GN.UFILETYPE>=7                 AND GN.FACTYPE=703                 THEN EMPTYDELAY                 ELSE 0             END AS ESWKUL5DELAY,             CASE                 WHEN GN.UFILETYPE>=7                 AND GN.FACTYPE=702                 THEN EMPTYDELAY                 ELSE 0             END AS EMIFIUL5DELAY,             CASE                 WHEN GN.UFILETYPE>=7                 AND GN.FACTYPE=704                 THEN EMPTYDELAY                 ELSE 0             END AS ECPEUL5DELAY,             CASE                 WHEN GN.FILETYPE>=7                 AND GN.LTEDOWNSPEEDGROUP>=14                 THEN GN.DLDELAY                 ELSE 0             END AS DELAY1MBPSUP,             CASE                 WHEN GN.FILETYPE>=7                 AND GN.LTEDOWNSPEEDGROUP>=20                 THEN GN.DLDELAY                 ELSE 0             END AS DELAY4MBPSUP,             CASE                 WHEN GN.FILETYPE>=7                 AND GN.LTEDOWNSPEEDGROUP>=32                 THEN GN.DLDELAY                 ELSE 0             END AS DELAY10MBPSUP,             CASE                 WHEN GN.FILETYPE>=7                 AND GN.FACTYPE=701                 AND GN.LTEDOWNSPEEDGROUP>=14                 THEN GN.DLDELAY                 ELSE 0             END AS PHONEDELAY1MBPSUP,             CASE                 WHEN GN.FILETYPE>=7                 AND GN.FACTYPE=701                 AND GN.LTEDOWNSPEEDGROUP>=20                 THEN GN.DLDELAY                 ELSE 0             END AS PHONEDELAY4MBPSUP,             CASE                 WHEN GN.FILETYPE>=7                 AND GN.FACTYPE=701                 AND GN.LTEDOWNSPEEDGROUP>=32                 THEN GN.DLDELAY                 ELSE 0             END AS PHONEDELAY10MBPSUP,             CASE                 WHEN GN.UFILETYPE>=3                 AND GN.LTEUPSPEEDGROUP>=3                 THEN GN.ULDELAY                 ELSE 0             END AS UDELAY100KBPSUP,             CASE                 WHEN GN.UFILETYPE>=3                 AND GN.LTEUPSPEEDGROUP>=5                 THEN GN.ULDELAY                 ELSE 0             END AS UDELAY200KBPSUP,             CASE                 WHEN GN.UFILETYPE>=3                 AND GN.LTEUPSPEEDGROUP>=9                 THEN GN.ULDELAY                 ELSE 0             END AS UDELAY500KBPSUP,             CASE                 WHEN GN.UFILETYPE>=3                 AND GN.FACTYPE=701                 AND GN.LTEUPSPEEDGROUP>=3                 THEN GN.ULDELAY                 ELSE 0             END AS UPHONEDELAY100KBPSUP,             CASE                 WHEN GN.UFILETYPE>=3                 AND GN.FACTYPE=701                 AND GN.LTEUPSPEEDGROUP>=5                 THEN GN.ULDELAY                 ELSE 0             END AS UPHONEDELAY200KBPSUP,             CASE                 WHEN GN.UFILETYPE>=3                 AND GN.FACTYPE=701                 AND GN.LTEUPSPEEDGROUP>=9                 THEN GN.ULDELAY                 ELSE 0             END AS UPHONEDELAY500KBPSUP,             CASE                 WHEN GN.FILETYPE>=7                 THEN GN.ALLCOUNT                 ELSE 0             END AS COUNTUP,             CASE                 WHEN GN.FILETYPE>=7                 AND GN.LTEDOWNSPEEDGROUP>=14                 THEN GN.ALLCOUNT                 ELSE 0             END AS COUNT1MBPSUP,             CASE                 WHEN GN.FILETYPE>=7                 AND GN.LTEDOWNSPEEDGROUP>=20                 THEN GN.ALLCOUNT                 ELSE 0             END AS COUNT4MBPSUP,             CASE                 WHEN GN.FILETYPE>=7                 AND GN.LTEDOWNSPEEDGROUP>=32                 THEN GN.ALLCOUNT                 ELSE 0             END AS COUNT10MBPSUP,             CASE                 WHEN GN.FILETYPE>=7                 AND GN.FACTYPE=701                 THEN GN.ALLCOUNT                 ELSE 0             END AS PHONECOUNTUP,             CASE                 WHEN GN.FILETYPE>=7                 AND GN.FACTYPE=701                 AND GN.LTEDOWNSPEEDGROUP>=14                 THEN GN.ALLCOUNT                 ELSE 0             END AS PHONECOUNT1MBPSUP,             CASE                 WHEN GN.FILETYPE>=7                 AND GN.FACTYPE=701                 AND GN.LTEDOWNSPEEDGROUP>=20                 THEN GN.ALLCOUNT                 ELSE 0             END AS PHONECOUNT4MBPSUP,             CASE                 WHEN GN.FILETYPE>=7                 AND GN.FACTYPE=701                 AND GN.LTEDOWNSPEEDGROUP>=32                 THEN GN.ALLCOUNT                 ELSE 0             END AS PHONECOUNT10MBPSUP,             CASE                 WHEN GN.UFILETYPE>=3                 THEN GN.ALLCOUNT                 ELSE 0             END AS UCOUNTUP,             CASE                 WHEN GN.UFILETYPE>=3                 AND GN.LTEUPSPEEDGROUP>=3                 THEN GN.ALLCOUNT                 ELSE 0             END AS UCOUNT100KBPSUP,             CASE                 WHEN GN.UFILETYPE>=3                 AND GN.LTEUPSPEEDGROUP>=5                 THEN GN.ALLCOUNT                 ELSE 0             END AS UCOUNT200KBPSUP,             CASE                 WHEN GN.UFILETYPE>=3                 AND GN.LTEUPSPEEDGROUP>=9                 THEN GN.ALLCOUNT                 ELSE 0             END AS UCOUNT500KBPSUP,             CASE                 WHEN GN.UFILETYPE>=3                 AND GN.FACTYPE=701                 THEN GN.ALLCOUNT                 ELSE 0             END AS UPHONECOUNTUP,             CASE                 WHEN GN.UFILETYPE>=3                 AND GN.FACTYPE=701                 AND GN.LTEUPSPEEDGROUP>=3                 THEN GN.ALLCOUNT                 ELSE 0             END AS UPHONECOUNT100KBPSUP,             CASE                 WHEN GN.UFILETYPE>=3                 AND GN.FACTYPE=701                 AND GN.LTEUPSPEEDGROUP>=5                 THEN GN.ALLCOUNT                 ELSE 0             END AS UPHONECOUNT200KBPSUP,             CASE                 WHEN GN.UFILETYPE>=3                 AND GN.FACTYPE=701                 AND GN.LTEUPSPEEDGROUP>=9                 THEN GN.ALLCOUNT                 ELSE 0             END AS UPHONECOUNT500KBPSUP         FROM             LTe_sys.[@p0]_T_GN_SUM_ALLFILE GN         WHERE              1=1 [@and] ${[@city0] [@and] [@time0]}& [@and] [@fac0]) A GROUP BY     A.EQUIPMENT"
      }
    },
    {
      "key": "query_gntab_2",
      "desc":"KPI汇总_省",
      "config": {
        "parameters": [
          {
            "name": "preData",
            "type":"object",
            "conditions":{
              "cnd":[
                {
                  "key":"city_no",
                  "columnname": "gn.city_no",
                  "type":"string",
                  "format": "",
                  "conditionid": "city0",
                  "symbol":"="
                },
                { "key":"starttime",
                  "columnname": "starttime",
                  "type":"string",
                  "format": "",
                  "conditionid": "time0",
                  "symbol":"in"}
              ],
              "co":"or"
            }
          },
          {
            "name": "preDatacategory",
            "type":"object",
            "conditions":{
              "cnd":[
                {
                  "key":"service",
                  "columnname": "city_no",
                  "type":"string",
                  "format": "",
                  "conditionid": "cate0",
                  "symbol":"="
                },
                { "key":"bussinesstype",
                  "columnname": "service",
                  "type":"string",
                  "format": "",
                  "conditionid": "subapp0",
                  "symbol":"in"}
              ],
              "co":"or"
            }
          },
          {
            "name": "terminal",
            "columnname": "",
            "type": "string",
            "format": "",
            "conditionid": "ter0",
            "symbol": ""
          },
          {
            "name": "factory",
            "columnname": "EQUIPMENT",
            "type": "string",
            "format": "",
            "conditionid": "fac0",
            "symbol": "="
          },
          {
            "name": "p_en",
            "columnname": "",
            "type": "string",
            "format": "",
            "conditionid": "p0",
            "symbol": ""
          }
        ],
        "value": "SELECT        A.PRONAME AS data1,       '汇总' AS data2,       '汇总' AS data3,       ROUND(CASE WHEN SUM(A.VIEDODELAY)=0 THEN 0 ELSE SUM(A.VIEDOTRAFFIC)*8000/1024/SUM(A.VIEDODELAY) END,3.0) AS data4,       ROUND(CASE WHEN SUM(A.WEBDELAY)=0 THEN 0 ELSE SUM(A.WEBTRAFFIC)*8000/1024/SUM(A.WEBDELAY) END,3.0) AS data5,       ROUND(CASE WHEN SUM(A.IMALLCOUNT)=0 THEN 0 ELSE 100*SUM(A.IMSCOUNT)/SUM(A.IMALLCOUNT) END,3.0) AS data6,       ROUND(CASE WHEN SUM(A.GAMEALLCOUNT)=0 THEN 0 ELSE 100*SUM(A.GAMESCOUNT)/SUM(A.GAMEALLCOUNT) END,3.0) AS data7,        ROUND(CASE WHEN SUM(A.DLDELAY)=0 THEN 0 ELSE SUM(A.DLTRAFFIC)*8000/1024/SUM(A.DLDELAY) END,3.0) AS data8,       ROUND(CASE WHEN SUM(A.PHONEDLDELAY)=0 THEN 0 ELSE SUM(A.PHONEDLTRAFFIC)*8000/1024 /SUM(A.PHONEDLDELAY) END,3.0) AS data9,       ROUND(CASE WHEN SUM(A.SWKDLDELAY)=0 THEN 0 ELSE SUM(A.SWKDLTRAFFIC)*8000/1024/SUM(A.SWKDLDELAY) END,3.0) AS data10,       ROUND(CASE WHEN SUM(A.MIFIDLDELAY)=0 THEN 0 ELSE SUM(A.MIFIDLTRAFFIC)*8000/1024/SUM(A.MIFIDLDELAY) END,3.0) AS data11,       ROUND(CASE WHEN SUM(A.CPEDLDELAY)=0 THEN 0 ELSE SUM(A.CPEDLTRAFFIC)*8000/1024/SUM(A.CPEDLDELAY) END,3.0) AS data12,        ROUND(CASE WHEN SUM(A.ULDELAY)=0 THEN 0 ELSE SUM(A.ULTRAFFIC)*8000/1024/SUM(A.ULDELAY) END,3.0) AS data13,       ROUND(CASE WHEN SUM(A.PHONEULDELAY)=0 THEN 0 ELSE SUM(A.PHONEULTRAFFIC)*8000/1024 /SUM(A.PHONEULDELAY) END,3.0) AS data14,       ROUND(CASE WHEN SUM(A.SWKULDELAY)=0 THEN 0 ELSE SUM(A.SWKULTRAFFIC)*8000/1024/SUM(A.SWKULDELAY) END,3.0) AS data15,       ROUND(CASE WHEN SUM(A.MIFIULDELAY)=0 THEN 0 ELSE SUM(A.MIFIULTRAFFIC)*8000/1024/SUM(A.MIFIULDELAY) END,3.0) AS data16,       ROUND(CASE WHEN SUM(A.CPEULDELAY)=0 THEN 0 ELSE SUM(A.CPEULTRAFFIC)*8000/1024/SUM(A.CPEULDELAY) END,3.0) AS data17,        ROUND(CASE WHEN SUM(A.UL5DELAY)=0 THEN 0 ELSE SUM(A.UL5TRAFFIC)*8000/1024/SUM(A.UL5DELAY) END,3.0) AS data18,       ROUND(CASE WHEN SUM(A.PHONEUL5DELAY)=0 THEN 0 ELSE SUM(A.PHONEUL5TRAFFIC)*8000/1024 /SUM(A.PHONEUL5DELAY) END,3.0) AS data19,       ROUND(CASE WHEN SUM(A.SWKUL5DELAY)=0 THEN 0 ELSE SUM(A.SWKUL5TRAFFIC)*8000/1024/SUM(A.SWKUL5DELAY) END,3.0) AS data20,       ROUND(CASE WHEN SUM(A.MIFIUL5DELAY)=0 THEN 0 ELSE SUM(A.MIFIUL5TRAFFIC)*8000/1024/SUM(A.MIFIUL5DELAY) END,3.0) AS data21,       ROUND(CASE WHEN SUM(A.CPEUL5DELAY)=0 THEN 0 ELSE SUM(A.CPEUL5TRAFFIC)*8000/1024/SUM(A.CPEUL5DELAY) END,3.0) AS data22,        ROUND(CASE WHEN SUM(A.ELDELAY)=0 THEN 0 ELSE SUM(A.DLTRAFFIC)*8000/1024/SUM(A.ELDELAY) END,3.0) AS data23,       ROUND(CASE WHEN SUM(A.PHONEELDELAY)=0 THEN 0 ELSE SUM(A.PHONEDLTRAFFIC)*8000/1024 /SUM(A.PHONEELDELAY) END,3.0) AS data24,       ROUND(CASE WHEN SUM(A.SWKELDELAY)=0 THEN 0 ELSE SUM(A.SWKDLTRAFFIC)*8000/1024/SUM(A.SWKELDELAY) END,3.0) AS data25,       ROUND(CASE WHEN SUM(A.MIFIELDELAY)=0 THEN 0 ELSE SUM(A.MIFIDLTRAFFIC)*8000/1024/SUM(A.MIFIELDELAY) END,3.0) AS data26,       ROUND(CASE WHEN SUM(A.CPEELDELAY)=0 THEN 0 ELSE SUM(A.CPEDLTRAFFIC)*8000/1024/SUM(A.CPEELDELAY) END,3.0) AS data27,        ROUND(CASE WHEN SUM(A.EULDELAY)=0 THEN 0 ELSE SUM(A.ULTRAFFIC)*8000/1024/SUM(A.EULDELAY) END,3.0) AS data28,       ROUND(CASE WHEN SUM(A.EPHONEULDELAY)=0 THEN 0 ELSE SUM(A.PHONEULTRAFFIC)*8000/1024 /SUM(A.EPHONEULDELAY) END,3.0) AS data29,       ROUND(CASE WHEN SUM(A.ESWKULDELAY)=0 THEN 0 ELSE SUM(A.SWKULTRAFFIC)*8000/1024/SUM(A.ESWKULDELAY) END,3.0) AS data30,       ROUND(CASE WHEN SUM(A.EMIFIULDELAY)=0 THEN 0 ELSE SUM(A.MIFIULTRAFFIC)*8000/1024/SUM(A.EMIFIULDELAY) END,3.0) AS data31,       ROUND(CASE WHEN SUM(A.ECPEULDELAY)=0 THEN 0 ELSE SUM(A.CPEULTRAFFIC)*8000/1024/SUM(A.ECPEULDELAY) END,3.0) AS data32,        ROUND(CASE WHEN SUM(A.EUL5DELAY)=0 THEN 0 ELSE SUM(A.UL5TRAFFIC)*8000/1024/SUM(A.EUL5DELAY) END,3.0) AS data33,       ROUND(CASE WHEN SUM(A.EPHONEUL5DELAY)=0 THEN 0 ELSE SUM(A.PHONEUL5TRAFFIC)*8000/1024 /SUM(A.EPHONEUL5DELAY) END,3.0) AS data34,       ROUND(CASE WHEN SUM(A.ESWKUL5DELAY)=0 THEN 0 ELSE SUM(A.SWKUL5TRAFFIC)*8000/1024/SUM(A.ESWKUL5DELAY) END,3.0) AS data35,       ROUND(CASE WHEN SUM(A.EMIFIUL5DELAY)=0 THEN 0 ELSE SUM(A.MIFIUL5TRAFFIC)*8000/1024/SUM(A.EMIFIUL5DELAY) END,3.0) AS data36,       ROUND(CASE WHEN SUM(A.ECPEUL5DELAY)=0 THEN 0 ELSE SUM(A.CPEUL5TRAFFIC)*8000/1024/SUM(A.ECPEUL5DELAY) END,3.0) AS data37,        ROUND(CASE WHEN SUM(A.DLDELAY)=0 THEN 0 ELSE 100*SUM(A.DELAY1MBPSUP)/SUM(A.DLDELAY) END,3.0) AS data38,       ROUND(CASE WHEN SUM(A.PHONEDLDELAY)=0 THEN 0 ELSE 100*SUM(A.PHONEDELAY1MBPSUP)/SUM(A.PHONEDLDELAY) END,3.0) AS data39,       ROUND(CASE WHEN SUM(A.DLDELAY)=0 THEN 0 ELSE 100*SUM(A.DELAY4MBPSUP)/SUM(A.DLDELAY) END,3.0) AS data40,       ROUND(CASE WHEN SUM(A.PHONEDLDELAY)=0 THEN 0 ELSE 100*SUM(A.PHONEDELAY4MBPSUP)/SUM(A.PHONEDLDELAY) END,3.0) AS data41,       ROUND(CASE WHEN SUM(A.DLDELAY)=0 THEN 0 ELSE 100*SUM(A.DELAY10MBPSUP)/SUM(A.DLDELAY) END,3.0) AS data42,       ROUND(CASE WHEN SUM(A.PHONEDLDELAY)=0 THEN 0 ELSE 100*SUM(A.PHONEDELAY10MBPSUP)/SUM(A.PHONEDLDELAY) END,3.0) AS data43,        ROUND(CASE WHEN SUM(A.ULDELAY)=0 THEN 0 ELSE 100*SUM(A.UDELAY100KBPSUP)/SUM(A.ULDELAY) END,3.0) AS data44,       ROUND(CASE WHEN SUM(A.PHONEULDELAY)=0 THEN 0 ELSE 100*SUM(A.UPHONEDELAY100KBPSUP)/SUM(A.PHONEULDELAY) END,3.0) AS data45,       ROUND(CASE WHEN SUM(A.ULDELAY)=0 THEN 0 ELSE 100*SUM(A.UDELAY200KBPSUP)/SUM(A.ULDELAY) END,3.0) AS data46,       ROUND(CASE WHEN SUM(A.PHONEULDELAY)=0 THEN 0 ELSE 100*SUM(A.UPHONEDELAY200KBPSUP)/SUM(A.PHONEULDELAY) END,3.0) AS data47,       ROUND(CASE WHEN SUM(A.ULDELAY)=0 THEN 0 ELSE 100*SUM(A.UDELAY500KBPSUP)/SUM(A.ULDELAY) END,3.0) AS data48,       ROUND(CASE WHEN SUM(A.PHONEULDELAY)=0 THEN 0 ELSE 100*SUM(A.UPHONEDELAY500KBPSUP)/SUM(A.PHONEULDELAY) END,3.0) AS data49,        ROUND(CASE WHEN SUM(A.COUNTUP)=0 THEN 0 ELSE 100*SUM(A.COUNT1MBPSUP)/SUM(A.COUNTUP) END,3.0) AS data50,       ROUND(CASE WHEN SUM(A.PHONECOUNTUP)=0 THEN 0 ELSE 100*SUM(A.PHONECOUNT1MBPSUP)/SUM(A.PHONECOUNTUP) END,3.0) AS data51,       ROUND(CASE WHEN SUM(A.COUNTUP)=0 THEN 0 ELSE 100*SUM(A.COUNT4MBPSUP)/SUM(A.COUNTUP) END,3.0) AS data52,       ROUND(CASE WHEN SUM(A.PHONECOUNTUP)=0 THEN 0 ELSE 100*SUM(A.PHONECOUNT4MBPSUP)/SUM(A.PHONECOUNTUP) END,3.0) AS data53,       ROUND(CASE WHEN SUM(A.COUNTUP)=0 THEN 0 ELSE 100*SUM(A.COUNT10MBPSUP)/SUM(A.COUNTUP) END,3.0) AS data54,       ROUND(CASE WHEN SUM(A.PHONECOUNTUP)=0 THEN 0 ELSE 100*SUM(A.PHONECOUNT10MBPSUP)/SUM(A.PHONECOUNTUP) END,3.0) AS data55,        ROUND(CASE WHEN SUM(A.UCOUNTUP)=0 THEN 0 ELSE 100*SUM(A.UCOUNT100KBPSUP)/SUM(A.UCOUNTUP) END,3.0) AS data56,       ROUND(CASE WHEN SUM(A.UPHONECOUNTUP)=0 THEN 0 ELSE 100*SUM(A.UPHONECOUNT100KBPSUP)/SUM(A.UPHONECOUNTUP) END,3.0) AS data57,       ROUND(CASE WHEN SUM(A.UCOUNTUP)=0 THEN 0 ELSE 100*SUM(A.UCOUNT200KBPSUP)/SUM(A.UCOUNTUP) END,3.0) AS data58,       ROUND(CASE WHEN SUM(A.UPHONECOUNTUP)=0 THEN 0 ELSE 100*SUM(A.UPHONECOUNT200KBPSUP)/SUM(A.UPHONECOUNTUP) END,3.0) AS data59,       ROUND(CASE WHEN SUM(A.UCOUNTUP)=0 THEN 0 ELSE 100*SUM(A.UCOUNT500KBPSUP)/SUM(A.UCOUNTUP) END,3.0) AS data60,       ROUND(CASE WHEN SUM(A.UPHONECOUNTUP)=0 THEN 0 ELSE 100*SUM(A.UPHONECOUNT500KBPSUP)/SUM(A.UPHONECOUNTUP) END,3.0) AS data61       FROM (       SELECT       D.PRONAME,       CASE WHEN GN.SERVICE='5' AND GN.FILETYPE>=7 AND GN.FACTYPE=701 THEN GN.DLTRAFFIC ELSE 0 END AS VIEDOTRAFFIC,       CASE WHEN GN.SERVICE='5' AND GN.FILETYPE>=7 AND GN.FACTYPE=701 THEN GN.DLDELAY ELSE 0 END AS VIEDODELAY,       CASE WHEN GN.SERVICE='15' AND GN.FILETYPE>=7 AND GN.FACTYPE=701 THEN GN.DLTRAFFIC ELSE 0 END AS WEBTRAFFIC,       CASE WHEN GN.SERVICE='15' AND GN.FILETYPE>=7 AND GN.FACTYPE=701THEN GN.DLDELAY ELSE 0 END AS WEBDELAY,       CASE WHEN GN.SERVICE='1' AND GN.FACTYPE=701 THEN GN.SCOUNT ELSE 0 END AS IMSCOUNT,       CASE WHEN GN.SERVICE='1' AND GN.FACTYPE=701 THEN GN.ALLCOUNT ELSE 0 END AS IMALLCOUNT,       CASE WHEN GN.SERVICE='8' AND GN.FACTYPE=701 THEN GN.SCOUNT ELSE 0 END AS GAMESCOUNT,       CASE WHEN GN.SERVICE='8' AND GN.FACTYPE=701 THEN GN.ALLCOUNT ELSE 0 END AS GAMEALLCOUNT,        CASE WHEN GN.FILETYPE>=7 THEN GN.DLDELAY ELSE 0 END AS DLDELAY,       CASE WHEN GN.FILETYPE>=7 THEN GN.DLTRAFFIC ELSE 0 END AS DLTRAFFIC,       CASE WHEN GN.FILETYPE>=7 AND GN.FACTYPE=701 THEN DLDELAY ELSE 0 END AS PHONEDLDELAY,       CASE WHEN GN.FILETYPE>=7 AND GN.FACTYPE=701 THEN DLTRAFFIC ELSE 0 END AS PHONEDLTRAFFIC,       CASE WHEN GN.FILETYPE>=7 AND GN.FACTYPE=703 THEN DLDELAY ELSE 0 END AS SWKDLDELAY,       CASE WHEN GN.FILETYPE>=7 AND GN.FACTYPE=703 THEN DLTRAFFIC ELSE 0 END AS SWKDLTRAFFIC,       CASE WHEN GN.FILETYPE>=7 AND GN.FACTYPE=702 THEN DLDELAY ELSE 0 END AS MIFIDLDELAY,       CASE WHEN GN.FILETYPE>=7 AND GN.FACTYPE=702 THEN DLTRAFFIC ELSE 0 END AS MIFIDLTRAFFIC,       CASE WHEN GN.FILETYPE>=7 AND GN.FACTYPE=704 THEN DLDELAY ELSE 0 END AS CPEDLDELAY,       CASE WHEN GN.FILETYPE>=7 AND GN.FACTYPE=704 THEN DLTRAFFIC ELSE 0 END AS CPEDLTRAFFIC,        CASE WHEN GN.UFILETYPE>=3 THEN GN.ULDELAY ELSE 0 END AS ULDELAY,       CASE WHEN GN.UFILETYPE>=3 THEN GN.ULTRAFFIC ELSE 0 END AS ULTRAFFIC,       CASE WHEN GN.UFILETYPE>=3 AND GN.FACTYPE=701 THEN ULDELAY ELSE 0 END AS PHONEULDELAY,       CASE WHEN GN.UFILETYPE>=3 AND GN.FACTYPE=701 THEN ULTRAFFIC ELSE 0 END AS PHONEULTRAFFIC,       CASE WHEN GN.UFILETYPE>=3 AND GN.FACTYPE=703 THEN ULDELAY ELSE 0 END AS SWKULDELAY,       CASE WHEN GN.UFILETYPE>=3 AND GN.FACTYPE=703 THEN ULTRAFFIC ELSE 0 END AS SWKULTRAFFIC,       CASE WHEN GN.UFILETYPE>=3 AND GN.FACTYPE=702 THEN ULDELAY ELSE 0 END AS MIFIULDELAY,       CASE WHEN GN.UFILETYPE>=3 AND GN.FACTYPE=702 THEN ULTRAFFIC ELSE 0 END AS MIFIULTRAFFIC,       CASE WHEN GN.UFILETYPE>=3 AND GN.FACTYPE=704 THEN ULDELAY ELSE 0 END AS CPEULDELAY,       CASE WHEN GN.UFILETYPE>=3 AND GN.FACTYPE=704 THEN ULTRAFFIC ELSE 0 END AS CPEULTRAFFIC,        CASE WHEN GN.UFILETYPE>=7 THEN GN.ULDELAY ELSE 0 END AS UL5DELAY,       CASE WHEN GN.UFILETYPE>=7 THEN GN.ULTRAFFIC ELSE 0 END AS UL5TRAFFIC,       CASE WHEN GN.UFILETYPE>=7 AND GN.FACTYPE=701 THEN ULDELAY ELSE 0 END AS PHONEUL5DELAY,       CASE WHEN GN.UFILETYPE>=7 AND GN.FACTYPE=701 THEN ULTRAFFIC ELSE 0 END AS PHONEUL5TRAFFIC,       CASE WHEN GN.UFILETYPE>=7 AND GN.FACTYPE=703 THEN ULDELAY ELSE 0 END AS SWKUL5DELAY,       CASE WHEN GN.UFILETYPE>=7 AND GN.FACTYPE=703 THEN ULTRAFFIC ELSE 0 END AS SWKUL5TRAFFIC,       CASE WHEN GN.UFILETYPE>=7 AND GN.FACTYPE=702 THEN ULDELAY ELSE 0 END AS MIFIUL5DELAY,       CASE WHEN GN.UFILETYPE>=7 AND GN.FACTYPE=702 THEN ULTRAFFIC ELSE 0 END AS MIFIUL5TRAFFIC,       CASE WHEN GN.UFILETYPE>=7 AND GN.FACTYPE=704 THEN ULDELAY ELSE 0 END AS CPEUL5DELAY,       CASE WHEN GN.UFILETYPE>=7 AND GN.FACTYPE=704 THEN ULTRAFFIC ELSE 0 END AS CPEUL5TRAFFIC,        CASE WHEN GN.FILETYPE>=7 THEN GN.EMPTYDELAY ELSE 0 END AS ELDELAY,       CASE WHEN GN.FILETYPE>=7 AND GN.FACTYPE=701 THEN EMPTYDELAY ELSE 0 END AS PHONEELDELAY,       CASE WHEN GN.FILETYPE>=7 AND GN.FACTYPE=703 THEN EMPTYDELAY ELSE 0 END AS SWKELDELAY,       CASE WHEN GN.FILETYPE>=7 AND GN.FACTYPE=702 THEN EMPTYDELAY ELSE 0 END AS MIFIELDELAY,       CASE WHEN GN.FILETYPE>=7 AND GN.FACTYPE=704 THEN EMPTYDELAY ELSE 0 END AS CPEELDELAY,        CASE WHEN GN.UFILETYPE>=3 THEN GN.EMPTYDELAY ELSE 0 END AS EULDELAY,       CASE WHEN GN.UFILETYPE>=3 AND GN.FACTYPE=701 THEN EMPTYDELAY ELSE 0 END AS EPHONEULDELAY,       CASE WHEN GN.UFILETYPE>=3 AND GN.FACTYPE=703 THEN EMPTYDELAY ELSE 0 END AS ESWKULDELAY,       CASE WHEN GN.UFILETYPE>=3 AND GN.FACTYPE=702 THEN EMPTYDELAY ELSE 0 END AS EMIFIULDELAY,       CASE WHEN GN.UFILETYPE>=3 AND GN.FACTYPE=704 THEN EMPTYDELAY ELSE 0 END AS ECPEULDELAY,        CASE WHEN GN.UFILETYPE>=7 THEN GN.EMPTYDELAY ELSE 0 END AS EUL5DELAY,       CASE WHEN GN.UFILETYPE>=7 AND GN.FACTYPE=701 THEN EMPTYDELAY ELSE 0 END AS EPHONEUL5DELAY,       CASE WHEN GN.UFILETYPE>=7 AND GN.FACTYPE=703 THEN EMPTYDELAY ELSE 0 END AS ESWKUL5DELAY,       CASE WHEN GN.UFILETYPE>=7 AND GN.FACTYPE=702 THEN EMPTYDELAY ELSE 0 END AS EMIFIUL5DELAY,       CASE WHEN GN.UFILETYPE>=7 AND GN.FACTYPE=704 THEN EMPTYDELAY ELSE 0 END AS ECPEUL5DELAY,        CASE WHEN GN.FILETYPE>=7 AND GN.LTEDOWNSPEEDGROUP>=14 THEN GN.DLDELAY ELSE 0 END AS DELAY1MBPSUP,       CASE WHEN GN.FILETYPE>=7 AND GN.LTEDOWNSPEEDGROUP>=20 THEN GN.DLDELAY ELSE 0 END AS DELAY4MBPSUP,       CASE WHEN GN.FILETYPE>=7 AND GN.LTEDOWNSPEEDGROUP>=32 THEN GN.DLDELAY ELSE 0 END AS DELAY10MBPSUP,        CASE WHEN GN.FILETYPE>=7 AND GN.FACTYPE=701 AND GN.LTEDOWNSPEEDGROUP>=14 THEN GN.DLDELAY ELSE 0 END AS PHONEDELAY1MBPSUP,       CASE WHEN GN.FILETYPE>=7 AND GN.FACTYPE=701 AND GN.LTEDOWNSPEEDGROUP>=20 THEN GN.DLDELAY ELSE 0 END AS PHONEDELAY4MBPSUP,       CASE WHEN GN.FILETYPE>=7 AND GN.FACTYPE=701 AND GN.LTEDOWNSPEEDGROUP>=32 THEN GN.DLDELAY ELSE 0 END AS PHONEDELAY10MBPSUP,        CASE WHEN GN.UFILETYPE>=3 AND GN.LTEUPSPEEDGROUP>=3 THEN GN.ULDELAY ELSE 0 END AS UDELAY100KBPSUP,       CASE WHEN GN.UFILETYPE>=3 AND GN.LTEUPSPEEDGROUP>=5 THEN GN.ULDELAY ELSE 0 END AS UDELAY200KBPSUP,       CASE WHEN GN.UFILETYPE>=3 AND GN.LTEUPSPEEDGROUP>=9 THEN GN.ULDELAY ELSE 0 END AS UDELAY500KBPSUP,        CASE WHEN GN.UFILETYPE>=3 AND GN.FACTYPE=701 AND GN.LTEUPSPEEDGROUP>=3 THEN GN.ULDELAY ELSE 0 END AS UPHONEDELAY100KBPSUP,       CASE WHEN GN.UFILETYPE>=3 AND GN.FACTYPE=701 AND GN.LTEUPSPEEDGROUP>=5 THEN GN.ULDELAY ELSE 0 END AS UPHONEDELAY200KBPSUP,       CASE WHEN GN.UFILETYPE>=3 AND GN.FACTYPE=701 AND GN.LTEUPSPEEDGROUP>=9 THEN GN.ULDELAY ELSE 0 END AS UPHONEDELAY500KBPSUP,        CASE WHEN GN.FILETYPE>=7 THEN GN.ALLCOUNT ELSE 0 END AS COUNTUP,       CASE WHEN GN.FILETYPE>=7 AND GN.LTEDOWNSPEEDGROUP>=14 THEN GN.ALLCOUNT ELSE 0 END AS COUNT1MBPSUP,       CASE WHEN GN.FILETYPE>=7 AND GN.LTEDOWNSPEEDGROUP>=20 THEN GN.ALLCOUNT ELSE 0 END AS COUNT4MBPSUP,       CASE WHEN GN.FILETYPE>=7 AND GN.LTEDOWNSPEEDGROUP>=32 THEN GN.ALLCOUNT ELSE 0 END AS COUNT10MBPSUP,        CASE WHEN GN.FILETYPE>=7 AND GN.FACTYPE=701 THEN GN.ALLCOUNT ELSE 0 END AS PHONECOUNTUP,       CASE WHEN GN.FILETYPE>=7 AND GN.FACTYPE=701 AND GN.LTEDOWNSPEEDGROUP>=14 THEN GN.ALLCOUNT ELSE 0 END AS PHONECOUNT1MBPSUP,       CASE WHEN GN.FILETYPE>=7 AND GN.FACTYPE=701 AND GN.LTEDOWNSPEEDGROUP>=20 THEN GN.ALLCOUNT ELSE 0 END AS PHONECOUNT4MBPSUP,       CASE WHEN GN.FILETYPE>=7 AND GN.FACTYPE=701 AND GN.LTEDOWNSPEEDGROUP>=32 THEN GN.ALLCOUNT ELSE 0 END AS PHONECOUNT10MBPSUP,        CASE WHEN GN.UFILETYPE>=3 THEN GN.ALLCOUNT ELSE 0 END AS UCOUNTUP,       CASE WHEN GN.UFILETYPE>=3 AND GN.LTEUPSPEEDGROUP>=3 THEN GN.ALLCOUNT ELSE 0 END AS UCOUNT100KBPSUP,       CASE WHEN GN.UFILETYPE>=3 AND GN.LTEUPSPEEDGROUP>=5 THEN GN.ALLCOUNT ELSE 0 END AS UCOUNT200KBPSUP,       CASE WHEN GN.UFILETYPE>=3 AND GN.LTEUPSPEEDGROUP>=9 THEN GN.ALLCOUNT ELSE 0 END AS UCOUNT500KBPSUP,        CASE WHEN GN.UFILETYPE>=3 AND GN.FACTYPE=701 THEN GN.ALLCOUNT ELSE 0 END AS UPHONECOUNTUP,       CASE WHEN GN.UFILETYPE>=3 AND GN.FACTYPE=701 AND GN.LTEUPSPEEDGROUP>=3 THEN GN.ALLCOUNT ELSE 0 END AS UPHONECOUNT100KBPSUP,       CASE WHEN GN.UFILETYPE>=3 AND GN.FACTYPE=701 AND GN.LTEUPSPEEDGROUP>=5 THEN GN.ALLCOUNT ELSE 0 END AS UPHONECOUNT200KBPSUP,       CASE WHEN GN.UFILETYPE>=3 AND GN.FACTYPE=701 AND GN.LTEUPSPEEDGROUP>=9 THEN GN.ALLCOUNT ELSE 0 END AS UPHONECOUNT500KBPSUP       FROM LTE_SYS.[@p0]_T_GN_SUM_ALLFILE GN       INNER JOIN LTE_SYS.T_BASE_CITY D ON GN.CITY_NO=D.CITY_NO       WHERE             1=1 [@and] ${[@city0] [@and] [@time0]}& [@and] [@fac0]) A       GROUP BY A.PRONAME       UNION       SELECT       A.PRONAME,       '汇总' AS CITYNAME,       CASE WHEN A.EQUIPMENT IS NULL THEN '未匹配' ELSE A.EQUIPMENT END AS EQUIPMENT,       ROUND(CASE WHEN SUM(A.VIEDODELAY)=0 THEN 0 ELSE SUM(A.VIEDOTRAFFIC)*8000/1024/SUM(A.VIEDODELAY) END,3.0) AS VIEDOSPEED,       ROUND(CASE WHEN SUM(A.WEBDELAY)=0 THEN 0 ELSE SUM(A.WEBTRAFFIC)*8000/1024/SUM(A.WEBDELAY) END,3.0) AS WEBSPEED,       ROUND(CASE WHEN SUM(A.IMALLCOUNT)=0 THEN 0 ELSE 100*SUM(A.IMSCOUNT)/SUM(A.IMALLCOUNT) END,3.0) AS IMPER,       ROUND(CASE WHEN SUM(A.GAMEALLCOUNT)=0 THEN 0 ELSE 100*SUM(A.GAMESCOUNT)/SUM(A.GAMEALLCOUNT) END,3.0) AS GAMEPER,        ROUND(CASE WHEN SUM(A.DLDELAY)=0 THEN 0 ELSE SUM(A.DLTRAFFIC)*8000/1024/SUM(A.DLDELAY) END,3.0) AS DSPEED,       ROUND(CASE WHEN SUM(A.PHONEDLDELAY)=0 THEN 0 ELSE SUM(A.PHONEDLTRAFFIC)*8000/1024 /SUM(A.PHONEDLDELAY) END,3.0) AS PHONEDSPEED,       ROUND(CASE WHEN SUM(A.SWKDLDELAY)=0 THEN 0 ELSE SUM(A.SWKDLTRAFFIC)*8000/1024/SUM(A.SWKDLDELAY) END,3.0) AS SWKSPEED,       ROUND(CASE WHEN SUM(A.MIFIDLDELAY)=0 THEN 0 ELSE SUM(A.MIFIDLTRAFFIC)*8000/1024/SUM(A.MIFIDLDELAY) END,3.0) AS MIFISPEED,       ROUND(CASE WHEN SUM(A.CPEDLDELAY)=0 THEN 0 ELSE SUM(A.CPEDLTRAFFIC)*8000/1024/SUM(A.CPEDLDELAY) END,3.0) AS CPESPEED,        ROUND(CASE WHEN SUM(A.ULDELAY)=0 THEN 0 ELSE SUM(A.ULTRAFFIC)*8000/1024/SUM(A.ULDELAY) END,3.0) AS USPEED,       ROUND(CASE WHEN SUM(A.PHONEULDELAY)=0 THEN 0 ELSE SUM(A.PHONEULTRAFFIC)*8000/1024 /SUM(A.PHONEULDELAY) END,3.0) AS PHONEUSPEED,       ROUND(CASE WHEN SUM(A.SWKULDELAY)=0 THEN 0 ELSE SUM(A.SWKULTRAFFIC)*8000/1024/SUM(A.SWKULDELAY) END,3.0) AS SWKUSPEED,       ROUND(CASE WHEN SUM(A.MIFIULDELAY)=0 THEN 0 ELSE SUM(A.MIFIULTRAFFIC)*8000/1024/SUM(A.MIFIULDELAY) END,3.0) AS MIFIUSPEED,       ROUND(CASE WHEN SUM(A.CPEULDELAY)=0 THEN 0 ELSE SUM(A.CPEULTRAFFIC)*8000/1024/SUM(A.CPEULDELAY) END,3.0) AS CPEUSPEED,        ROUND(CASE WHEN SUM(A.UL5DELAY)=0 THEN 0 ELSE SUM(A.UL5TRAFFIC)*8000/1024/SUM(A.UL5DELAY) END,3.0) AS U5SPEED,       ROUND(CASE WHEN SUM(A.PHONEUL5DELAY)=0 THEN 0 ELSE SUM(A.PHONEUL5TRAFFIC)*8000/1024 /SUM(A.PHONEUL5DELAY) END,3.0) AS PHONEU5SPEED,       ROUND(CASE WHEN SUM(A.SWKUL5DELAY)=0 THEN 0 ELSE SUM(A.SWKUL5TRAFFIC)*8000/1024/SUM(A.SWKUL5DELAY) END,3.0) AS SWKU5SPEED,       ROUND(CASE WHEN SUM(A.MIFIUL5DELAY)=0 THEN 0 ELSE SUM(A.MIFIUL5TRAFFIC)*8000/1024/SUM(A.MIFIUL5DELAY) END,3.0) AS MIFIU5SPEED,       ROUND(CASE WHEN SUM(A.CPEUL5DELAY)=0 THEN 0 ELSE SUM(A.CPEUL5TRAFFIC)*8000/1024/SUM(A.CPEUL5DELAY) END,3.0) AS CPEU5SPEED,        ROUND(CASE WHEN SUM(A.ELDELAY)=0 THEN 0 ELSE SUM(A.DLTRAFFIC)*8000/1024/SUM(A.ELDELAY) END,3.0) AS EDSPEED,       ROUND(CASE WHEN SUM(A.PHONEELDELAY)=0 THEN 0 ELSE SUM(A.PHONEDLTRAFFIC)*8000/1024 /SUM(A.PHONEELDELAY) END,3.0) AS EPHONEDSPEED,       ROUND(CASE WHEN SUM(A.SWKELDELAY)=0 THEN 0 ELSE SUM(A.SWKDLTRAFFIC)*8000/1024/SUM(A.SWKELDELAY) END,3.0) AS ESWKSPEED,       ROUND(CASE WHEN SUM(A.MIFIELDELAY)=0 THEN 0 ELSE SUM(A.MIFIDLTRAFFIC)*8000/1024/SUM(A.MIFIELDELAY) END,3.0) AS EMIFISPEED,       ROUND(CASE WHEN SUM(A.CPEELDELAY)=0 THEN 0 ELSE SUM(A.CPEDLTRAFFIC)*8000/1024/SUM(A.CPEELDELAY) END,3.0) AS ECPESPEED,        ROUND(CASE WHEN SUM(A.EULDELAY)=0 THEN 0 ELSE SUM(A.ULTRAFFIC)*8000/1024/SUM(A.EULDELAY) END,3.0) AS EUSPEED,       ROUND(CASE WHEN SUM(A.EPHONEULDELAY)=0 THEN 0 ELSE SUM(A.PHONEULTRAFFIC)*8000/1024 /SUM(A.EPHONEULDELAY) END,3.0) AS EPHONEUSPEED,       ROUND(CASE WHEN SUM(A.ESWKULDELAY)=0 THEN 0 ELSE SUM(A.SWKULTRAFFIC)*8000/1024/SUM(A.ESWKULDELAY) END,3.0) AS ESWKUSPEED,       ROUND(CASE WHEN SUM(A.EMIFIULDELAY)=0 THEN 0 ELSE SUM(A.MIFIULTRAFFIC)*8000/1024/SUM(A.EMIFIULDELAY) END,3.0) AS EMIFIUSPEED,       ROUND(CASE WHEN SUM(A.ECPEULDELAY)=0 THEN 0 ELSE SUM(A.CPEULTRAFFIC)*8000/1024/SUM(A.ECPEULDELAY) END,3.0) AS ECPEUSPEED,        ROUND(CASE WHEN SUM(A.EUL5DELAY)=0 THEN 0 ELSE SUM(A.UL5TRAFFIC)*8000/1024/SUM(A.EUL5DELAY) END,3.0) AS EU5SPEED,       ROUND(CASE WHEN SUM(A.EPHONEUL5DELAY)=0 THEN 0 ELSE SUM(A.PHONEUL5TRAFFIC)*8000/1024 /SUM(A.EPHONEUL5DELAY) END,3.0) AS EPHONEU5SPEED,       ROUND(CASE WHEN SUM(A.ESWKUL5DELAY)=0 THEN 0 ELSE SUM(A.SWKUL5TRAFFIC)*8000/1024/SUM(A.ESWKUL5DELAY) END,3.0) AS ESWKU5SPEED,       ROUND(CASE WHEN SUM(A.EMIFIUL5DELAY)=0 THEN 0 ELSE SUM(A.MIFIUL5TRAFFIC)*8000/1024/SUM(A.EMIFIUL5DELAY) END,3.0) AS EMIFIU5SPEED,       ROUND(CASE WHEN SUM(A.ECPEUL5DELAY)=0 THEN 0 ELSE SUM(A.CPEUL5TRAFFIC)*8000/1024/SUM(A.ECPEUL5DELAY) END,3.0) AS ECPEU5SPEED,        ROUND(CASE WHEN SUM(A.DLDELAY)=0 THEN 0 ELSE 100*SUM(A.DELAY1MBPSUP)/SUM(A.DLDELAY) END,3.0) AS DSPEED1PER,       ROUND(CASE WHEN SUM(A.PHONEDLDELAY)=0 THEN 0 ELSE 100*SUM(A.PHONEDELAY1MBPSUP)/SUM(A.PHONEDLDELAY) END,3.0) AS DPHONESPEED1PER,       ROUND(CASE WHEN SUM(A.DLDELAY)=0 THEN 0 ELSE 100*SUM(A.DELAY4MBPSUP)/SUM(A.DLDELAY) END,3.0) AS DSPEED4PER,       ROUND(CASE WHEN SUM(A.PHONEDLDELAY)=0 THEN 0 ELSE 100*SUM(A.PHONEDELAY4MBPSUP)/SUM(A.PHONEDLDELAY) END,3.0) AS DPHONESPEED4PER,       ROUND(CASE WHEN SUM(A.DLDELAY)=0 THEN 0 ELSE 100*SUM(A.DELAY10MBPSUP)/SUM(A.DLDELAY) END,3.0) AS DSPEED10PER,       ROUND(CASE WHEN SUM(A.PHONEDLDELAY)=0 THEN 0 ELSE 100*SUM(A.PHONEDELAY10MBPSUP)/SUM(A.PHONEDLDELAY) END,3.0) AS DPHONESPEED10PER,        ROUND(CASE WHEN SUM(A.ULDELAY)=0 THEN 0 ELSE 100*SUM(A.UDELAY100KBPSUP)/SUM(A.ULDELAY) END,3.0) AS USPEED100PER,       ROUND(CASE WHEN SUM(A.PHONEULDELAY)=0 THEN 0 ELSE 100*SUM(A.UPHONEDELAY100KBPSUP)/SUM(A.PHONEULDELAY) END,3.0) AS UPHONESPEED100PER,       ROUND(CASE WHEN SUM(A.ULDELAY)=0 THEN 0 ELSE 100*SUM(A.UDELAY200KBPSUP)/SUM(A.ULDELAY) END,3.0) AS USPEED200PER,       ROUND(CASE WHEN SUM(A.PHONEULDELAY)=0 THEN 0 ELSE 100*SUM(A.UPHONEDELAY200KBPSUP)/SUM(A.PHONEULDELAY) END,3.0) AS UPHONESPEED200PER,       ROUND(CASE WHEN SUM(A.ULDELAY)=0 THEN 0 ELSE 100*SUM(A.UDELAY500KBPSUP)/SUM(A.ULDELAY) END,3.0) AS USPEED500PER,       ROUND(CASE WHEN SUM(A.PHONEULDELAY)=0 THEN 0 ELSE 100*SUM(A.UPHONEDELAY500KBPSUP)/SUM(A.PHONEULDELAY) END,3.0) AS UPHONESPEED500PER,        ROUND(CASE WHEN SUM(A.COUNTUP)=0 THEN 0 ELSE 100*SUM(A.COUNT1MBPSUP)/SUM(A.COUNTUP) END,3.0) AS EDSPEED1PER,       ROUND(CASE WHEN SUM(A.PHONECOUNTUP)=0 THEN 0 ELSE 100*SUM(A.PHONECOUNT1MBPSUP)/SUM(A.PHONECOUNTUP) END,3.0) AS EDPHONESPEED1PER,       ROUND(CASE WHEN SUM(A.COUNTUP)=0 THEN 0 ELSE 100*SUM(A.COUNT4MBPSUP)/SUM(A.COUNTUP) END,3.0) AS EDSPEED4PER,       ROUND(CASE WHEN SUM(A.PHONECOUNTUP)=0 THEN 0 ELSE 100*SUM(A.PHONECOUNT4MBPSUP)/SUM(A.PHONECOUNTUP) END,3.0) AS EDPHONESPEED4PER,       ROUND(CASE WHEN SUM(A.COUNTUP)=0 THEN 0 ELSE 100*SUM(A.COUNT10MBPSUP)/SUM(A.COUNTUP) END,3.0) AS EDSPEED10PER,       ROUND(CASE WHEN SUM(A.PHONECOUNTUP)=0 THEN 0 ELSE 100*SUM(A.PHONECOUNT10MBPSUP)/SUM(A.PHONECOUNTUP) END,3.0) AS EDPHONESPEED10PER,        ROUND(CASE WHEN SUM(A.UCOUNTUP)=0 THEN 0 ELSE 100*SUM(A.UCOUNT100KBPSUP)/SUM(A.UCOUNTUP) END,3.0) AS EUSPEED100PER,       ROUND(CASE WHEN SUM(A.UPHONECOUNTUP)=0 THEN 0 ELSE 100*SUM(A.UPHONECOUNT100KBPSUP)/SUM(A.UPHONECOUNTUP) END,3.0) AS EUPHONESPEED100PER,       ROUND(CASE WHEN SUM(A.UCOUNTUP)=0 THEN 0 ELSE 100*SUM(A.UCOUNT200KBPSUP)/SUM(A.UCOUNTUP) END,3.0) AS EUSPEED200PER,       ROUND(CASE WHEN SUM(A.UPHONECOUNTUP)=0 THEN 0 ELSE 100*SUM(A.UPHONECOUNT200KBPSUP)/SUM(A.UPHONECOUNTUP) END,3.0) AS EUPHONESPEED200PER,       ROUND(CASE WHEN SUM(A.UCOUNTUP)=0 THEN 0 ELSE 100*SUM(A.UCOUNT500KBPSUP)/SUM(A.UCOUNTUP) END,3.0) AS EUSPEED500PER,       ROUND(CASE WHEN SUM(A.UPHONECOUNTUP)=0 THEN 0 ELSE 100*SUM(A.UPHONECOUNT500KBPSUP)/SUM(A.UPHONECOUNTUP) END,3.0) AS EUPHONESPEED500PER       FROM (       SELECT       D.PRONAME,       GN.EQUIPMENT,       CASE WHEN GN.SERVICE='5' AND GN.FILETYPE>=7 AND GN.FACTYPE=701 THEN GN.DLTRAFFIC ELSE 0 END AS VIEDOTRAFFIC,       CASE WHEN GN.SERVICE='5' AND GN.FILETYPE>=7 AND GN.FACTYPE=701 THEN GN.DLDELAY ELSE 0 END AS VIEDODELAY,       CASE WHEN GN.SERVICE='15' AND GN.FILETYPE>=7 AND GN.FACTYPE=701 THEN GN.DLTRAFFIC ELSE 0 END AS WEBTRAFFIC,       CASE WHEN GN.SERVICE='15' AND GN.FILETYPE>=7 AND GN.FACTYPE=701 THEN GN.DLDELAY ELSE 0 END AS WEBDELAY,       CASE WHEN GN.SERVICE='1' AND GN.FACTYPE=701 THEN GN.SCOUNT ELSE 0 END AS IMSCOUNT,       CASE WHEN GN.SERVICE='1' AND GN.FACTYPE=701 THEN GN.ALLCOUNT ELSE 0 END AS IMALLCOUNT,       CASE WHEN GN.SERVICE='8' AND GN.FACTYPE=701 THEN GN.SCOUNT ELSE 0 END AS GAMESCOUNT,       CASE WHEN GN.SERVICE='8' AND GN.FACTYPE=701 THEN GN.ALLCOUNT ELSE 0 END AS GAMEALLCOUNT,        CASE WHEN GN.FILETYPE>=7 THEN GN.DLDELAY ELSE 0 END AS DLDELAY,       CASE WHEN GN.FILETYPE>=7 THEN GN.DLTRAFFIC ELSE 0 END AS DLTRAFFIC,       CASE WHEN GN.FILETYPE>=7 AND GN.FACTYPE=701 THEN DLDELAY ELSE 0 END AS PHONEDLDELAY,       CASE WHEN GN.FILETYPE>=7 AND GN.FACTYPE=701 THEN DLTRAFFIC ELSE 0 END AS PHONEDLTRAFFIC,       CASE WHEN GN.FILETYPE>=7 AND GN.FACTYPE=703 THEN DLDELAY ELSE 0 END AS SWKDLDELAY,       CASE WHEN GN.FILETYPE>=7 AND GN.FACTYPE=703 THEN DLTRAFFIC ELSE 0 END AS SWKDLTRAFFIC,       CASE WHEN GN.FILETYPE>=7 AND GN.FACTYPE=702 THEN DLDELAY ELSE 0 END AS MIFIDLDELAY,       CASE WHEN GN.FILETYPE>=7 AND GN.FACTYPE=702 THEN DLTRAFFIC ELSE 0 END AS MIFIDLTRAFFIC,       CASE WHEN GN.FILETYPE>=7 AND GN.FACTYPE=704 THEN DLDELAY ELSE 0 END AS CPEDLDELAY,       CASE WHEN GN.FILETYPE>=7 AND GN.FACTYPE=704 THEN DLTRAFFIC ELSE 0 END AS CPEDLTRAFFIC,        CASE WHEN GN.UFILETYPE>=3 THEN GN.ULDELAY ELSE 0 END AS ULDELAY,       CASE WHEN GN.UFILETYPE>=3 THEN GN.ULTRAFFIC ELSE 0 END AS ULTRAFFIC,       CASE WHEN GN.UFILETYPE>=3 AND GN.FACTYPE=701 THEN ULDELAY ELSE 0 END AS PHONEULDELAY,       CASE WHEN GN.UFILETYPE>=3 AND GN.FACTYPE=701 THEN ULTRAFFIC ELSE 0 END AS PHONEULTRAFFIC,       CASE WHEN GN.UFILETYPE>=3 AND GN.FACTYPE=703 THEN ULDELAY ELSE 0 END AS SWKULDELAY,       CASE WHEN GN.UFILETYPE>=3 AND GN.FACTYPE=703 THEN ULTRAFFIC ELSE 0 END AS SWKULTRAFFIC,       CASE WHEN GN.UFILETYPE>=3 AND GN.FACTYPE=702 THEN ULDELAY ELSE 0 END AS MIFIULDELAY,       CASE WHEN GN.UFILETYPE>=3 AND GN.FACTYPE=702 THEN ULTRAFFIC ELSE 0 END AS MIFIULTRAFFIC,       CASE WHEN GN.UFILETYPE>=3 AND GN.FACTYPE=704 THEN ULDELAY ELSE 0 END AS CPEULDELAY,       CASE WHEN GN.UFILETYPE>=3 AND GN.FACTYPE=704 THEN ULTRAFFIC ELSE 0 END AS CPEULTRAFFIC,        CASE WHEN GN.UFILETYPE>=7 THEN GN.ULDELAY ELSE 0 END AS UL5DELAY,       CASE WHEN GN.UFILETYPE>=7 THEN GN.ULTRAFFIC ELSE 0 END AS UL5TRAFFIC,       CASE WHEN GN.UFILETYPE>=7 AND GN.FACTYPE=701 THEN ULDELAY ELSE 0 END AS PHONEUL5DELAY,       CASE WHEN GN.UFILETYPE>=7 AND GN.FACTYPE=701 THEN ULTRAFFIC ELSE 0 END AS PHONEUL5TRAFFIC,       CASE WHEN GN.UFILETYPE>=7 AND GN.FACTYPE=703 THEN ULDELAY ELSE 0 END AS SWKUL5DELAY,       CASE WHEN GN.UFILETYPE>=7 AND GN.FACTYPE=703 THEN ULTRAFFIC ELSE 0 END AS SWKUL5TRAFFIC,       CASE WHEN GN.UFILETYPE>=7 AND GN.FACTYPE=702 THEN ULDELAY ELSE 0 END AS MIFIUL5DELAY,       CASE WHEN GN.UFILETYPE>=7 AND GN.FACTYPE=702 THEN ULTRAFFIC ELSE 0 END AS MIFIUL5TRAFFIC,       CASE WHEN GN.UFILETYPE>=7 AND GN.FACTYPE=704 THEN ULDELAY ELSE 0 END AS CPEUL5DELAY,       CASE WHEN GN.UFILETYPE>=7 AND GN.FACTYPE=704 THEN ULTRAFFIC ELSE 0 END AS CPEUL5TRAFFIC,        CASE WHEN GN.FILETYPE>=7 THEN GN.EMPTYDELAY ELSE 0 END AS ELDELAY,       CASE WHEN GN.FILETYPE>=7 AND GN.FACTYPE=701 THEN EMPTYDELAY ELSE 0 END AS PHONEELDELAY,       CASE WHEN GN.FILETYPE>=7 AND GN.FACTYPE=703 THEN EMPTYDELAY ELSE 0 END AS SWKELDELAY,       CASE WHEN GN.FILETYPE>=7 AND GN.FACTYPE=702 THEN EMPTYDELAY ELSE 0 END AS MIFIELDELAY,       CASE WHEN GN.FILETYPE>=7 AND GN.FACTYPE=704 THEN EMPTYDELAY ELSE 0 END AS CPEELDELAY,        CASE WHEN GN.UFILETYPE>=3 THEN GN.EMPTYDELAY ELSE 0 END AS EULDELAY,       CASE WHEN GN.UFILETYPE>=3 AND GN.FACTYPE=701 THEN EMPTYDELAY ELSE 0 END AS EPHONEULDELAY,       CASE WHEN GN.UFILETYPE>=3 AND GN.FACTYPE=703 THEN EMPTYDELAY ELSE 0 END AS ESWKULDELAY,       CASE WHEN GN.UFILETYPE>=3 AND GN.FACTYPE=702 THEN EMPTYDELAY ELSE 0 END AS EMIFIULDELAY,       CASE WHEN GN.UFILETYPE>=3 AND GN.FACTYPE=704 THEN EMPTYDELAY ELSE 0 END AS ECPEULDELAY,        CASE WHEN GN.UFILETYPE>=7 THEN GN.EMPTYDELAY ELSE 0 END AS EUL5DELAY,       CASE WHEN GN.UFILETYPE>=7 AND GN.FACTYPE=701 THEN EMPTYDELAY ELSE 0 END AS EPHONEUL5DELAY,       CASE WHEN GN.UFILETYPE>=7 AND GN.FACTYPE=703 THEN EMPTYDELAY ELSE 0 END AS ESWKUL5DELAY,       CASE WHEN GN.UFILETYPE>=7 AND GN.FACTYPE=702 THEN EMPTYDELAY ELSE 0 END AS EMIFIUL5DELAY,       CASE WHEN GN.UFILETYPE>=7 AND GN.FACTYPE=704 THEN EMPTYDELAY ELSE 0 END AS ECPEUL5DELAY,        CASE WHEN GN.FILETYPE>=7 AND GN.LTEDOWNSPEEDGROUP>=14 THEN GN.DLDELAY ELSE 0 END AS DELAY1MBPSUP,       CASE WHEN GN.FILETYPE>=7 AND GN.LTEDOWNSPEEDGROUP>=20 THEN GN.DLDELAY ELSE 0 END AS DELAY4MBPSUP,       CASE WHEN GN.FILETYPE>=7 AND GN.LTEDOWNSPEEDGROUP>=32 THEN GN.DLDELAY ELSE 0 END AS DELAY10MBPSUP,        CASE WHEN GN.FILETYPE>=7 AND GN.FACTYPE=701 AND GN.LTEDOWNSPEEDGROUP>=14 THEN GN.DLDELAY ELSE 0 END AS PHONEDELAY1MBPSUP,       CASE WHEN GN.FILETYPE>=7 AND GN.FACTYPE=701 AND GN.LTEDOWNSPEEDGROUP>=20 THEN GN.DLDELAY ELSE 0 END AS PHONEDELAY4MBPSUP,       CASE WHEN GN.FILETYPE>=7 AND GN.FACTYPE=701 AND GN.LTEDOWNSPEEDGROUP>=32 THEN GN.DLDELAY ELSE 0 END AS PHONEDELAY10MBPSUP,        CASE WHEN GN.UFILETYPE>=3 AND GN.LTEUPSPEEDGROUP>=3 THEN GN.ULDELAY ELSE 0 END AS UDELAY100KBPSUP,       CASE WHEN GN.UFILETYPE>=3 AND GN.LTEUPSPEEDGROUP>=5 THEN GN.ULDELAY ELSE 0 END AS UDELAY200KBPSUP,       CASE WHEN GN.UFILETYPE>=3 AND GN.LTEUPSPEEDGROUP>=9 THEN GN.ULDELAY ELSE 0 END AS UDELAY500KBPSUP,        CASE WHEN GN.UFILETYPE>=3 AND GN.FACTYPE=701 AND GN.LTEUPSPEEDGROUP>=3 THEN GN.ULDELAY ELSE 0 END AS UPHONEDELAY100KBPSUP,       CASE WHEN GN.UFILETYPE>=3 AND GN.FACTYPE=701 AND GN.LTEUPSPEEDGROUP>=5 THEN GN.ULDELAY ELSE 0 END AS UPHONEDELAY200KBPSUP,       CASE WHEN GN.UFILETYPE>=3 AND GN.FACTYPE=701 AND GN.LTEUPSPEEDGROUP>=9 THEN GN.ULDELAY ELSE 0 END AS UPHONEDELAY500KBPSUP,        CASE WHEN GN.FILETYPE>=7 THEN GN.ALLCOUNT ELSE 0 END AS COUNTUP,       CASE WHEN GN.FILETYPE>=7 AND GN.LTEDOWNSPEEDGROUP>=14 THEN GN.ALLCOUNT ELSE 0 END AS COUNT1MBPSUP,       CASE WHEN GN.FILETYPE>=7 AND GN.LTEDOWNSPEEDGROUP>=20 THEN GN.ALLCOUNT ELSE 0 END AS COUNT4MBPSUP,       CASE WHEN GN.FILETYPE>=7 AND GN.LTEDOWNSPEEDGROUP>=32 THEN GN.ALLCOUNT ELSE 0 END AS COUNT10MBPSUP,        CASE WHEN GN.FILETYPE>=7 AND GN.FACTYPE=701 THEN GN.ALLCOUNT ELSE 0 END AS PHONECOUNTUP,       CASE WHEN GN.FILETYPE>=7 AND GN.FACTYPE=701 AND GN.LTEDOWNSPEEDGROUP>=14 THEN GN.ALLCOUNT ELSE 0 END AS PHONECOUNT1MBPSUP,       CASE WHEN GN.FILETYPE>=7 AND GN.FACTYPE=701 AND GN.LTEDOWNSPEEDGROUP>=20 THEN GN.ALLCOUNT ELSE 0 END AS PHONECOUNT4MBPSUP,       CASE WHEN GN.FILETYPE>=7 AND GN.FACTYPE=701 AND GN.LTEDOWNSPEEDGROUP>=32 THEN GN.ALLCOUNT ELSE 0 END AS PHONECOUNT10MBPSUP,        CASE WHEN GN.UFILETYPE>=3 THEN GN.ALLCOUNT ELSE 0 END AS UCOUNTUP,       CASE WHEN GN.UFILETYPE>=3 AND GN.LTEUPSPEEDGROUP>=3 THEN GN.ALLCOUNT ELSE 0 END AS UCOUNT100KBPSUP,       CASE WHEN GN.UFILETYPE>=3 AND GN.LTEUPSPEEDGROUP>=5 THEN GN.ALLCOUNT ELSE 0 END AS UCOUNT200KBPSUP,       CASE WHEN GN.UFILETYPE>=3 AND GN.LTEUPSPEEDGROUP>=9 THEN GN.ALLCOUNT ELSE 0 END AS UCOUNT500KBPSUP,        CASE WHEN GN.UFILETYPE>=3 AND GN.FACTYPE=701 THEN GN.ALLCOUNT ELSE 0 END AS UPHONECOUNTUP,       CASE WHEN GN.UFILETYPE>=3 AND GN.FACTYPE=701 AND GN.LTEUPSPEEDGROUP>=3 THEN GN.ALLCOUNT ELSE 0 END AS UPHONECOUNT100KBPSUP,       CASE WHEN GN.UFILETYPE>=3 AND GN.FACTYPE=701 AND GN.LTEUPSPEEDGROUP>=5 THEN GN.ALLCOUNT ELSE 0 END AS UPHONECOUNT200KBPSUP,       CASE WHEN GN.UFILETYPE>=3 AND GN.FACTYPE=701 AND GN.LTEUPSPEEDGROUP>=9 THEN GN.ALLCOUNT ELSE 0 END AS UPHONECOUNT500KBPSUP       FROM LTE_SYS.[@p0]_T_GN_SUM_ALLFILE GN       INNER JOIN LTE_SYS.T_BASE_CITY D ON GN.CITY_NO=D.CITY_NO       WHERE             1=1 [@and] ${[@city0] [@and] [@time0]}&  [@and] [@fac0]) A       GROUP BY A.PRONAME,A.EQUIPMENT"
      }
    },
    {
      "key": "query_gntab_3",
      "desc":"KPI汇总_市",
      "config": {
        "parameters": [
          {
            "name": "preData",
            "type":"object",
            "conditions":{
              "cnd":[
                {
                  "key":"city_no",
                  "columnname": "gn.city_no",
                  "type":"string",
                  "format": "",
                  "conditionid": "city0",
                  "symbol":"="
                },
                { "key":"starttime",
                  "columnname": "starttime",
                  "type":"string",
                  "format": "",
                  "conditionid": "time0",
                  "symbol":"in"}
              ],
              "co":"or"
            }
          },
          {
            "name": "preDatacategory",
            "type":"object",
            "conditions":{
              "cnd":[
                {
                  "key":"service",
                  "columnname": "city_no",
                  "type":"string",
                  "format": "",
                  "conditionid": "cate0",
                  "symbol":"="
                },
                { "key":"bussinesstype",
                  "columnname": "service",
                  "type":"string",
                  "format": "",
                  "conditionid": "subapp0",
                  "symbol":"in"}
              ],
              "co":"or"
            }
          },
          {
            "name": "terminal",
            "columnname": "",
            "type": "string",
            "format": "",
            "conditionid": "ter0",
            "symbol": ""
          },
          {
            "name": "factory",
            "columnname": "EQUIPMENT",
            "type": "string",
            "format": "",
            "conditionid": "fac0",
            "symbol": "="
          },
          {
            "name": "p_en",
            "columnname": "",
            "type": "string",
            "format": "",
            "conditionid": "p0",
            "symbol": ""
          }
        ],
        "value": "SELECT       CITY.PRONAME as data1,       CITY.CITYNAME as data2,       '汇总' AS data3,       ROUND(CASE WHEN SUM(A.VIEDODELAY)=0 THEN 0 ELSE SUM(A.VIEDOTRAFFIC)*8000/1024/SUM(A.VIEDODELAY) END,3.0) AS data4,       ROUND(CASE WHEN SUM(A.WEBDELAY)=0 THEN 0 ELSE SUM(A.WEBTRAFFIC)*8000/1024/SUM(A.WEBDELAY) END,3.0) AS data5,       ROUND(CASE WHEN SUM(A.IMALLCOUNT)=0 THEN 0 ELSE 100*SUM(A.IMSCOUNT)/SUM(A.IMALLCOUNT) END,3.0) AS data6,       ROUND(CASE WHEN SUM(A.GAMEALLCOUNT)=0 THEN 0 ELSE 100*SUM(A.GAMESCOUNT)/SUM(A.GAMEALLCOUNT) END,3.0) AS data7,        ROUND(CASE WHEN SUM(A.DLDELAY)=0 THEN 0 ELSE SUM(A.DLTRAFFIC)*8000/1024/SUM(A.DLDELAY) END,3.0) AS data8,       ROUND(CASE WHEN SUM(A.PHONEDLDELAY)=0 THEN 0 ELSE SUM(A.PHONEDLTRAFFIC)*8000/1024 /SUM(A.PHONEDLDELAY) END,3.0) AS data9,       ROUND(CASE WHEN SUM(A.SWKDLDELAY)=0 THEN 0 ELSE SUM(A.SWKDLTRAFFIC)*8000/1024/SUM(A.SWKDLDELAY) END,3.0) AS data10,       ROUND(CASE WHEN SUM(A.MIFIDLDELAY)=0 THEN 0 ELSE SUM(A.MIFIDLTRAFFIC)*8000/1024/SUM(A.MIFIDLDELAY) END,3.0) AS data11,       ROUND(CASE WHEN SUM(A.CPEDLDELAY)=0 THEN 0 ELSE SUM(A.CPEDLTRAFFIC)*8000/1024/SUM(A.CPEDLDELAY) END,3.0) AS data12,        ROUND(CASE WHEN SUM(A.ULDELAY)=0 THEN 0 ELSE SUM(A.ULTRAFFIC)*8000/1024/SUM(A.ULDELAY) END,3.0) AS data13,       ROUND(CASE WHEN SUM(A.PHONEULDELAY)=0 THEN 0 ELSE SUM(A.PHONEULTRAFFIC)*8000/1024 /SUM(A.PHONEULDELAY) END,3.0) AS data14,       ROUND(CASE WHEN SUM(A.SWKULDELAY)=0 THEN 0 ELSE SUM(A.SWKULTRAFFIC)*8000/1024/SUM(A.SWKULDELAY) END,3.0) AS data15,       ROUND(CASE WHEN SUM(A.MIFIULDELAY)=0 THEN 0 ELSE SUM(A.MIFIULTRAFFIC)*8000/1024/SUM(A.MIFIULDELAY) END,3.0) AS data16,       ROUND(CASE WHEN SUM(A.CPEULDELAY)=0 THEN 0 ELSE SUM(A.CPEULTRAFFIC)*8000/1024/SUM(A.CPEULDELAY) END,3.0) AS data17,        ROUND(CASE WHEN SUM(A.UL5DELAY)=0 THEN 0 ELSE SUM(A.UL5TRAFFIC)*8000/1024/SUM(A.UL5DELAY) END,3.0) AS data18,       ROUND(CASE WHEN SUM(A.PHONEUL5DELAY)=0 THEN 0 ELSE SUM(A.PHONEUL5TRAFFIC)*8000/1024 /SUM(A.PHONEUL5DELAY) END,3.0) AS data19,       ROUND(CASE WHEN SUM(A.SWKUL5DELAY)=0 THEN 0 ELSE SUM(A.SWKUL5TRAFFIC)*8000/1024/SUM(A.SWKUL5DELAY) END,3.0) AS data20,       ROUND(CASE WHEN SUM(A.MIFIUL5DELAY)=0 THEN 0 ELSE SUM(A.MIFIUL5TRAFFIC)*8000/1024/SUM(A.MIFIUL5DELAY) END,3.0) AS data21,       ROUND(CASE WHEN SUM(A.CPEUL5DELAY)=0 THEN 0 ELSE SUM(A.CPEUL5TRAFFIC)*8000/1024/SUM(A.CPEUL5DELAY) END,3.0) AS data22,        ROUND(CASE WHEN SUM(A.ELDELAY)=0 THEN 0 ELSE SUM(A.DLTRAFFIC)*8000/1024/SUM(A.ELDELAY) END,3.0) AS data23,       ROUND(CASE WHEN SUM(A.PHONEELDELAY)=0 THEN 0 ELSE SUM(A.PHONEDLTRAFFIC)*8000/1024 /SUM(A.PHONEELDELAY) END,3.0) AS data24,       ROUND(CASE WHEN SUM(A.SWKELDELAY)=0 THEN 0 ELSE SUM(A.SWKDLTRAFFIC)*8000/1024/SUM(A.SWKELDELAY) END,3.0) AS data25,       ROUND(CASE WHEN SUM(A.MIFIELDELAY)=0 THEN 0 ELSE SUM(A.MIFIDLTRAFFIC)*8000/1024/SUM(A.MIFIELDELAY) END,3.0) AS data26,       ROUND(CASE WHEN SUM(A.CPEELDELAY)=0 THEN 0 ELSE SUM(A.CPEDLTRAFFIC)*8000/1024/SUM(A.CPEELDELAY) END,3.0) AS data27,        ROUND(CASE WHEN SUM(A.EULDELAY)=0 THEN 0 ELSE SUM(A.ULTRAFFIC)*8000/1024/SUM(A.EULDELAY) END,3.0) AS data28,       ROUND(CASE WHEN SUM(A.EPHONEULDELAY)=0 THEN 0 ELSE SUM(A.PHONEULTRAFFIC)*8000/1024 /SUM(A.EPHONEULDELAY) END,3.0) AS data29,       ROUND(CASE WHEN SUM(A.ESWKULDELAY)=0 THEN 0 ELSE SUM(A.SWKULTRAFFIC)*8000/1024/SUM(A.ESWKULDELAY) END,3.0) AS data30,       ROUND(CASE WHEN SUM(A.EMIFIULDELAY)=0 THEN 0 ELSE SUM(A.MIFIULTRAFFIC)*8000/1024/SUM(A.EMIFIULDELAY) END,3.0) AS data31,       ROUND(CASE WHEN SUM(A.ECPEULDELAY)=0 THEN 0 ELSE SUM(A.CPEULTRAFFIC)*8000/1024/SUM(A.ECPEULDELAY) END,3.0) AS data32,        ROUND(CASE WHEN SUM(A.EUL5DELAY)=0 THEN 0 ELSE SUM(A.UL5TRAFFIC)*8000/1024/SUM(A.EUL5DELAY) END,3.0) AS data33,       ROUND(CASE WHEN SUM(A.EPHONEUL5DELAY)=0 THEN 0 ELSE SUM(A.PHONEUL5TRAFFIC)*8000/1024 /SUM(A.EPHONEUL5DELAY) END,3.0) AS data34,       ROUND(CASE WHEN SUM(A.ESWKUL5DELAY)=0 THEN 0 ELSE SUM(A.SWKUL5TRAFFIC)*8000/1024/SUM(A.ESWKUL5DELAY) END,3.0) AS data35,       ROUND(CASE WHEN SUM(A.EMIFIUL5DELAY)=0 THEN 0 ELSE SUM(A.MIFIUL5TRAFFIC)*8000/1024/SUM(A.EMIFIUL5DELAY) END,3.0) AS data36,       ROUND(CASE WHEN SUM(A.ECPEUL5DELAY)=0 THEN 0 ELSE SUM(A.CPEUL5TRAFFIC)*8000/1024/SUM(A.ECPEUL5DELAY) END,3.0) AS data37,        ROUND(CASE WHEN SUM(A.DLDELAY)=0 THEN 0 ELSE 100*SUM(A.DELAY1MBPSUP)/SUM(A.DLDELAY) END,3.0) AS data38,       ROUND(CASE WHEN SUM(A.PHONEDLDELAY)=0 THEN 0 ELSE 100*SUM(A.PHONEDELAY1MBPSUP)/SUM(A.PHONEDLDELAY) END,3.0) AS data39,       ROUND(CASE WHEN SUM(A.DLDELAY)=0 THEN 0 ELSE 100*SUM(A.DELAY4MBPSUP)/SUM(A.DLDELAY) END,3.0) AS data40,       ROUND(CASE WHEN SUM(A.PHONEDLDELAY)=0 THEN 0 ELSE 100*SUM(A.PHONEDELAY4MBPSUP)/SUM(A.PHONEDLDELAY) END,3.0) AS data41,       ROUND(CASE WHEN SUM(A.DLDELAY)=0 THEN 0 ELSE 100*SUM(A.DELAY10MBPSUP)/SUM(A.DLDELAY) END,3.0) AS data42,       ROUND(CASE WHEN SUM(A.PHONEDLDELAY)=0 THEN 0 ELSE 100*SUM(A.PHONEDELAY10MBPSUP)/SUM(A.PHONEDLDELAY) END,3.0) AS data43,        ROUND(CASE WHEN SUM(A.ULDELAY)=0 THEN 0 ELSE 100*SUM(A.UDELAY100KBPSUP)/SUM(A.ULDELAY) END,3.0) AS data44,       ROUND(CASE WHEN SUM(A.PHONEULDELAY)=0 THEN 0 ELSE 100*SUM(A.UPHONEDELAY100KBPSUP)/SUM(A.PHONEULDELAY) END,3.0) AS data45,       ROUND(CASE WHEN SUM(A.ULDELAY)=0 THEN 0 ELSE 100*SUM(A.UDELAY200KBPSUP)/SUM(A.ULDELAY) END,3.0) AS data46,       ROUND(CASE WHEN SUM(A.PHONEULDELAY)=0 THEN 0 ELSE 100*SUM(A.UPHONEDELAY200KBPSUP)/SUM(A.PHONEULDELAY) END,3.0) AS data47,       ROUND(CASE WHEN SUM(A.ULDELAY)=0 THEN 0 ELSE 100*SUM(A.UDELAY500KBPSUP)/SUM(A.ULDELAY) END,3.0) AS data48,       ROUND(CASE WHEN SUM(A.PHONEULDELAY)=0 THEN 0 ELSE 100*SUM(A.UPHONEDELAY500KBPSUP)/SUM(A.PHONEULDELAY) END,3.0) AS data49,        ROUND(CASE WHEN SUM(A.COUNTUP)=0 THEN 0 ELSE 100*SUM(A.COUNT1MBPSUP)/SUM(A.COUNTUP) END,3.0) AS data50,       ROUND(CASE WHEN SUM(A.PHONECOUNTUP)=0 THEN 0 ELSE 100*SUM(A.PHONECOUNT1MBPSUP)/SUM(A.PHONECOUNTUP) END,3.0) AS data51,       ROUND(CASE WHEN SUM(A.COUNTUP)=0 THEN 0 ELSE 100*SUM(A.COUNT4MBPSUP)/SUM(A.COUNTUP) END,3.0) AS data52,       ROUND(CASE WHEN SUM(A.PHONECOUNTUP)=0 THEN 0 ELSE 100*SUM(A.PHONECOUNT4MBPSUP)/SUM(A.PHONECOUNTUP) END,3.0) AS data53,       ROUND(CASE WHEN SUM(A.COUNTUP)=0 THEN 0 ELSE 100*SUM(A.COUNT10MBPSUP)/SUM(A.COUNTUP) END,3.0) AS data54,       ROUND(CASE WHEN SUM(A.PHONECOUNTUP)=0 THEN 0 ELSE 100*SUM(A.PHONECOUNT10MBPSUP)/SUM(A.PHONECOUNTUP) END,3.0) AS data55,        ROUND(CASE WHEN SUM(A.UCOUNTUP)=0 THEN 0 ELSE 100*SUM(A.UCOUNT100KBPSUP)/SUM(A.UCOUNTUP) END,3.0) AS data56,       ROUND(CASE WHEN SUM(A.UPHONECOUNTUP)=0 THEN 0 ELSE 100*SUM(A.UPHONECOUNT100KBPSUP)/SUM(A.UPHONECOUNTUP) END,3.0) AS data57,       ROUND(CASE WHEN SUM(A.UCOUNTUP)=0 THEN 0 ELSE 100*SUM(A.UCOUNT200KBPSUP)/SUM(A.UCOUNTUP) END,3.0) AS data58,       ROUND(CASE WHEN SUM(A.UPHONECOUNTUP)=0 THEN 0 ELSE 100*SUM(A.UPHONECOUNT200KBPSUP)/SUM(A.UPHONECOUNTUP) END,3.0) AS data59,       ROUND(CASE WHEN SUM(A.UCOUNTUP)=0 THEN 0 ELSE 100*SUM(A.UCOUNT500KBPSUP)/SUM(A.UCOUNTUP) END,3.0) AS data60,       ROUND(CASE WHEN SUM(A.UPHONECOUNTUP)=0 THEN 0 ELSE 100*SUM(A.UPHONECOUNT500KBPSUP)/SUM(A.UPHONECOUNTUP) END,3.0) AS data61       FROM (       SELECT       GN.CITY_NO,       CASE WHEN GN.SERVICE='5' AND GN.FILETYPE>=7 AND GN.FACTYPE=701 THEN GN.DLTRAFFIC ELSE 0 END AS VIEDOTRAFFIC,       CASE WHEN GN.SERVICE='5' AND GN.FILETYPE>=7 AND GN.FACTYPE=701 THEN GN.DLDELAY ELSE 0 END AS VIEDODELAY,       CASE WHEN GN.SERVICE='15' AND GN.FILETYPE>=7 AND GN.FACTYPE=701 THEN GN.DLTRAFFIC ELSE 0 END AS WEBTRAFFIC,       CASE WHEN GN.SERVICE='15' AND GN.FILETYPE>=7 AND GN.FACTYPE=701THEN GN.DLDELAY ELSE 0 END AS WEBDELAY,       CASE WHEN GN.SERVICE='1' AND GN.FACTYPE=701 THEN GN.SCOUNT ELSE 0 END AS IMSCOUNT,       CASE WHEN GN.SERVICE='1' AND GN.FACTYPE=701 THEN GN.ALLCOUNT ELSE 0 END AS IMALLCOUNT,       CASE WHEN GN.SERVICE='8' AND GN.FACTYPE=701 THEN GN.SCOUNT ELSE 0 END AS GAMESCOUNT,       CASE WHEN GN.SERVICE='8' AND GN.FACTYPE=701 THEN GN.ALLCOUNT ELSE 0 END AS GAMEALLCOUNT,        CASE WHEN GN.FILETYPE>=7 THEN GN.DLDELAY ELSE 0 END AS DLDELAY,       CASE WHEN GN.FILETYPE>=7 THEN GN.DLTRAFFIC ELSE 0 END AS DLTRAFFIC,       CASE WHEN GN.FILETYPE>=7 AND GN.FACTYPE=701 THEN DLDELAY ELSE 0 END AS PHONEDLDELAY,       CASE WHEN GN.FILETYPE>=7 AND GN.FACTYPE=701 THEN DLTRAFFIC ELSE 0 END AS PHONEDLTRAFFIC,       CASE WHEN GN.FILETYPE>=7 AND GN.FACTYPE=703 THEN DLDELAY ELSE 0 END AS SWKDLDELAY,       CASE WHEN GN.FILETYPE>=7 AND GN.FACTYPE=703 THEN DLTRAFFIC ELSE 0 END AS SWKDLTRAFFIC,       CASE WHEN GN.FILETYPE>=7 AND GN.FACTYPE=702 THEN DLDELAY ELSE 0 END AS MIFIDLDELAY,       CASE WHEN GN.FILETYPE>=7 AND GN.FACTYPE=702 THEN DLTRAFFIC ELSE 0 END AS MIFIDLTRAFFIC,       CASE WHEN GN.FILETYPE>=7 AND GN.FACTYPE=704 THEN DLDELAY ELSE 0 END AS CPEDLDELAY,       CASE WHEN GN.FILETYPE>=7 AND GN.FACTYPE=704 THEN DLTRAFFIC ELSE 0 END AS CPEDLTRAFFIC,        CASE WHEN GN.UFILETYPE>=3 THEN GN.ULDELAY ELSE 0 END AS ULDELAY,       CASE WHEN GN.UFILETYPE>=3 THEN GN.ULTRAFFIC ELSE 0 END AS ULTRAFFIC,       CASE WHEN GN.UFILETYPE>=3 AND GN.FACTYPE=701 THEN ULDELAY ELSE 0 END AS PHONEULDELAY,       CASE WHEN GN.UFILETYPE>=3 AND GN.FACTYPE=701 THEN ULTRAFFIC ELSE 0 END AS PHONEULTRAFFIC,       CASE WHEN GN.UFILETYPE>=3 AND GN.FACTYPE=703 THEN ULDELAY ELSE 0 END AS SWKULDELAY,       CASE WHEN GN.UFILETYPE>=3 AND GN.FACTYPE=703 THEN ULTRAFFIC ELSE 0 END AS SWKULTRAFFIC,       CASE WHEN GN.UFILETYPE>=3 AND GN.FACTYPE=702 THEN ULDELAY ELSE 0 END AS MIFIULDELAY,       CASE WHEN GN.UFILETYPE>=3 AND GN.FACTYPE=702 THEN ULTRAFFIC ELSE 0 END AS MIFIULTRAFFIC,       CASE WHEN GN.UFILETYPE>=3 AND GN.FACTYPE=704 THEN ULDELAY ELSE 0 END AS CPEULDELAY,       CASE WHEN GN.UFILETYPE>=3 AND GN.FACTYPE=704 THEN ULTRAFFIC ELSE 0 END AS CPEULTRAFFIC,        CASE WHEN GN.UFILETYPE>=7 THEN GN.ULDELAY ELSE 0 END AS UL5DELAY,       CASE WHEN GN.UFILETYPE>=7 THEN GN.ULTRAFFIC ELSE 0 END AS UL5TRAFFIC,       CASE WHEN GN.UFILETYPE>=7 AND GN.FACTYPE=701 THEN ULDELAY ELSE 0 END AS PHONEUL5DELAY,       CASE WHEN GN.UFILETYPE>=7 AND GN.FACTYPE=701 THEN ULTRAFFIC ELSE 0 END AS PHONEUL5TRAFFIC,       CASE WHEN GN.UFILETYPE>=7 AND GN.FACTYPE=703 THEN ULDELAY ELSE 0 END AS SWKUL5DELAY,       CASE WHEN GN.UFILETYPE>=7 AND GN.FACTYPE=703 THEN ULTRAFFIC ELSE 0 END AS SWKUL5TRAFFIC,       CASE WHEN GN.UFILETYPE>=7 AND GN.FACTYPE=702 THEN ULDELAY ELSE 0 END AS MIFIUL5DELAY,       CASE WHEN GN.UFILETYPE>=7 AND GN.FACTYPE=702 THEN ULTRAFFIC ELSE 0 END AS MIFIUL5TRAFFIC,       CASE WHEN GN.UFILETYPE>=7 AND GN.FACTYPE=704 THEN ULDELAY ELSE 0 END AS CPEUL5DELAY,       CASE WHEN GN.UFILETYPE>=7 AND GN.FACTYPE=704 THEN ULTRAFFIC ELSE 0 END AS CPEUL5TRAFFIC,        CASE WHEN GN.FILETYPE>=7 THEN GN.EMPTYDELAY ELSE 0 END AS ELDELAY,       CASE WHEN GN.FILETYPE>=7 AND GN.FACTYPE=701 THEN EMPTYDELAY ELSE 0 END AS PHONEELDELAY,       CASE WHEN GN.FILETYPE>=7 AND GN.FACTYPE=703 THEN EMPTYDELAY ELSE 0 END AS SWKELDELAY,       CASE WHEN GN.FILETYPE>=7 AND GN.FACTYPE=702 THEN EMPTYDELAY ELSE 0 END AS MIFIELDELAY,       CASE WHEN GN.FILETYPE>=7 AND GN.FACTYPE=704 THEN EMPTYDELAY ELSE 0 END AS CPEELDELAY,        CASE WHEN GN.UFILETYPE>=3 THEN GN.EMPTYDELAY ELSE 0 END AS EULDELAY,       CASE WHEN GN.UFILETYPE>=3 AND GN.FACTYPE=701 THEN EMPTYDELAY ELSE 0 END AS EPHONEULDELAY,       CASE WHEN GN.UFILETYPE>=3 AND GN.FACTYPE=703 THEN EMPTYDELAY ELSE 0 END AS ESWKULDELAY,       CASE WHEN GN.UFILETYPE>=3 AND GN.FACTYPE=702 THEN EMPTYDELAY ELSE 0 END AS EMIFIULDELAY,       CASE WHEN GN.UFILETYPE>=3 AND GN.FACTYPE=704 THEN EMPTYDELAY ELSE 0 END AS ECPEULDELAY,        CASE WHEN GN.UFILETYPE>=7 THEN GN.EMPTYDELAY ELSE 0 END AS EUL5DELAY,       CASE WHEN GN.UFILETYPE>=7 AND GN.FACTYPE=701 THEN EMPTYDELAY ELSE 0 END AS EPHONEUL5DELAY,       CASE WHEN GN.UFILETYPE>=7 AND GN.FACTYPE=703 THEN EMPTYDELAY ELSE 0 END AS ESWKUL5DELAY,       CASE WHEN GN.UFILETYPE>=7 AND GN.FACTYPE=702 THEN EMPTYDELAY ELSE 0 END AS EMIFIUL5DELAY,       CASE WHEN GN.UFILETYPE>=7 AND GN.FACTYPE=704 THEN EMPTYDELAY ELSE 0 END AS ECPEUL5DELAY,        CASE WHEN GN.FILETYPE>=7 AND GN.LTEDOWNSPEEDGROUP>=14 THEN GN.DLDELAY ELSE 0 END AS DELAY1MBPSUP,       CASE WHEN GN.FILETYPE>=7 AND GN.LTEDOWNSPEEDGROUP>=20 THEN GN.DLDELAY ELSE 0 END AS DELAY4MBPSUP,       CASE WHEN GN.FILETYPE>=7 AND GN.LTEDOWNSPEEDGROUP>=32 THEN GN.DLDELAY ELSE 0 END AS DELAY10MBPSUP,        CASE WHEN GN.FILETYPE>=7 AND GN.FACTYPE=701 AND GN.LTEDOWNSPEEDGROUP>=14 THEN GN.DLDELAY ELSE 0 END AS PHONEDELAY1MBPSUP,       CASE WHEN GN.FILETYPE>=7 AND GN.FACTYPE=701 AND GN.LTEDOWNSPEEDGROUP>=20 THEN GN.DLDELAY ELSE 0 END AS PHONEDELAY4MBPSUP,       CASE WHEN GN.FILETYPE>=7 AND GN.FACTYPE=701 AND GN.LTEDOWNSPEEDGROUP>=32 THEN GN.DLDELAY ELSE 0 END AS PHONEDELAY10MBPSUP,        CASE WHEN GN.UFILETYPE>=3 AND GN.LTEUPSPEEDGROUP>=3 THEN GN.ULDELAY ELSE 0 END AS UDELAY100KBPSUP,       CASE WHEN GN.UFILETYPE>=3 AND GN.LTEUPSPEEDGROUP>=5 THEN GN.ULDELAY ELSE 0 END AS UDELAY200KBPSUP,       CASE WHEN GN.UFILETYPE>=3 AND GN.LTEUPSPEEDGROUP>=9 THEN GN.ULDELAY ELSE 0 END AS UDELAY500KBPSUP,        CASE WHEN GN.UFILETYPE>=3 AND GN.FACTYPE=701 AND GN.LTEUPSPEEDGROUP>=3 THEN GN.ULDELAY ELSE 0 END AS UPHONEDELAY100KBPSUP,       CASE WHEN GN.UFILETYPE>=3 AND GN.FACTYPE=701 AND GN.LTEUPSPEEDGROUP>=5 THEN GN.ULDELAY ELSE 0 END AS UPHONEDELAY200KBPSUP,       CASE WHEN GN.UFILETYPE>=3 AND GN.FACTYPE=701 AND GN.LTEUPSPEEDGROUP>=9 THEN GN.ULDELAY ELSE 0 END AS UPHONEDELAY500KBPSUP,        CASE WHEN GN.FILETYPE>=7 THEN GN.ALLCOUNT ELSE 0 END AS COUNTUP,       CASE WHEN GN.FILETYPE>=7 AND GN.LTEDOWNSPEEDGROUP>=14 THEN GN.ALLCOUNT ELSE 0 END AS COUNT1MBPSUP,       CASE WHEN GN.FILETYPE>=7 AND GN.LTEDOWNSPEEDGROUP>=20 THEN GN.ALLCOUNT ELSE 0 END AS COUNT4MBPSUP,       CASE WHEN GN.FILETYPE>=7 AND GN.LTEDOWNSPEEDGROUP>=32 THEN GN.ALLCOUNT ELSE 0 END AS COUNT10MBPSUP,        CASE WHEN GN.FILETYPE>=7 AND GN.FACTYPE=701 THEN GN.ALLCOUNT ELSE 0 END AS PHONECOUNTUP,       CASE WHEN GN.FILETYPE>=7 AND GN.FACTYPE=701 AND GN.LTEDOWNSPEEDGROUP>=14 THEN GN.ALLCOUNT ELSE 0 END AS PHONECOUNT1MBPSUP,       CASE WHEN GN.FILETYPE>=7 AND GN.FACTYPE=701 AND GN.LTEDOWNSPEEDGROUP>=20 THEN GN.ALLCOUNT ELSE 0 END AS PHONECOUNT4MBPSUP,       CASE WHEN GN.FILETYPE>=7 AND GN.FACTYPE=701 AND GN.LTEDOWNSPEEDGROUP>=32 THEN GN.ALLCOUNT ELSE 0 END AS PHONECOUNT10MBPSUP,        CASE WHEN GN.UFILETYPE>=3 THEN GN.ALLCOUNT ELSE 0 END AS UCOUNTUP,       CASE WHEN GN.UFILETYPE>=3 AND GN.LTEUPSPEEDGROUP>=3 THEN GN.ALLCOUNT ELSE 0 END AS UCOUNT100KBPSUP,       CASE WHEN GN.UFILETYPE>=3 AND GN.LTEUPSPEEDGROUP>=5 THEN GN.ALLCOUNT ELSE 0 END AS UCOUNT200KBPSUP,       CASE WHEN GN.UFILETYPE>=3 AND GN.LTEUPSPEEDGROUP>=9 THEN GN.ALLCOUNT ELSE 0 END AS UCOUNT500KBPSUP,        CASE WHEN GN.UFILETYPE>=3 AND GN.FACTYPE=701 THEN GN.ALLCOUNT ELSE 0 END AS UPHONECOUNTUP,       CASE WHEN GN.UFILETYPE>=3 AND GN.FACTYPE=701 AND GN.LTEUPSPEEDGROUP>=3 THEN GN.ALLCOUNT ELSE 0 END AS UPHONECOUNT100KBPSUP,       CASE WHEN GN.UFILETYPE>=3 AND GN.FACTYPE=701 AND GN.LTEUPSPEEDGROUP>=5 THEN GN.ALLCOUNT ELSE 0 END AS UPHONECOUNT200KBPSUP,       CASE WHEN GN.UFILETYPE>=3 AND GN.FACTYPE=701 AND GN.LTEUPSPEEDGROUP>=9 THEN GN.ALLCOUNT ELSE 0 END AS UPHONECOUNT500KBPSUP       FROM LTE_sys.[@p0]_T_GN_SUM_ALLFILE GN       WHERE             1=1 [@and] ${[@city0] [@and] [@time0]}&    [@and] [@fac0]) A       INNER JOIN lte_sys.T_BASE_CITY CITY ON CITY.CITY_NO=A.CITY_NO       GROUP BY CITY.PRONAME,CITY.CITYNAME       UNION       SELECT       CITY.PRONAME,       CITY.CITYNAME,       CASE WHEN A.EQUIPMENT IS NULL THEN '未匹配' ELSE A.EQUIPMENT END AS EQUIPMENT,       ROUND(CASE WHEN SUM(A.VIEDODELAY)=0 THEN 0 ELSE SUM(A.VIEDOTRAFFIC)*8000/1024/SUM(A.VIEDODELAY) END,3.0) AS VIEDOSPEED,       ROUND(CASE WHEN SUM(A.WEBDELAY)=0 THEN 0 ELSE SUM(A.WEBTRAFFIC)*8000/1024/SUM(A.WEBDELAY) END,3.0) AS WEBSPEED,       ROUND(CASE WHEN SUM(A.IMALLCOUNT)=0 THEN 0 ELSE 100*SUM(A.IMSCOUNT)/SUM(A.IMALLCOUNT) END,3.0) AS IMPER,       ROUND(CASE WHEN SUM(A.GAMEALLCOUNT)=0 THEN 0 ELSE 100*SUM(A.GAMESCOUNT)/SUM(A.GAMEALLCOUNT) END,3.0) AS GAMEPER,        ROUND(CASE WHEN SUM(A.DLDELAY)=0 THEN 0 ELSE SUM(A.DLTRAFFIC)*8000/1024/SUM(A.DLDELAY) END,3.0) AS DSPEED,       ROUND(CASE WHEN SUM(A.PHONEDLDELAY)=0 THEN 0 ELSE SUM(A.PHONEDLTRAFFIC)*8000/1024 /SUM(A.PHONEDLDELAY) END,3.0) AS PHONEDSPEED,       ROUND(CASE WHEN SUM(A.SWKDLDELAY)=0 THEN 0 ELSE SUM(A.SWKDLTRAFFIC)*8000/1024/SUM(A.SWKDLDELAY) END,3.0) AS SWKSPEED,       ROUND(CASE WHEN SUM(A.MIFIDLDELAY)=0 THEN 0 ELSE SUM(A.MIFIDLTRAFFIC)*8000/1024/SUM(A.MIFIDLDELAY) END,3.0) AS MIFISPEED,       ROUND(CASE WHEN SUM(A.CPEDLDELAY)=0 THEN 0 ELSE SUM(A.CPEDLTRAFFIC)*8000/1024/SUM(A.CPEDLDELAY) END,3.0) AS CPESPEED,        ROUND(CASE WHEN SUM(A.ULDELAY)=0 THEN 0 ELSE SUM(A.ULTRAFFIC)*8000/1024/SUM(A.ULDELAY) END,3.0) AS USPEED,       ROUND(CASE WHEN SUM(A.PHONEULDELAY)=0 THEN 0 ELSE SUM(A.PHONEULTRAFFIC)*8000/1024 /SUM(A.PHONEULDELAY) END,3.0) AS PHONEUSPEED,       ROUND(CASE WHEN SUM(A.SWKULDELAY)=0 THEN 0 ELSE SUM(A.SWKULTRAFFIC)*8000/1024/SUM(A.SWKULDELAY) END,3.0) AS SWKUSPEED,       ROUND(CASE WHEN SUM(A.MIFIULDELAY)=0 THEN 0 ELSE SUM(A.MIFIULTRAFFIC)*8000/1024/SUM(A.MIFIULDELAY) END,3.0) AS MIFIUSPEED,       ROUND(CASE WHEN SUM(A.CPEULDELAY)=0 THEN 0 ELSE SUM(A.CPEULTRAFFIC)*8000/1024/SUM(A.CPEULDELAY) END,3.0) AS CPEUSPEED,        ROUND(CASE WHEN SUM(A.UL5DELAY)=0 THEN 0 ELSE SUM(A.UL5TRAFFIC)*8000/1024/SUM(A.UL5DELAY) END,3.0) AS U5SPEED,       ROUND(CASE WHEN SUM(A.PHONEUL5DELAY)=0 THEN 0 ELSE SUM(A.PHONEUL5TRAFFIC)*8000/1024 /SUM(A.PHONEUL5DELAY) END,3.0) AS PHONEU5SPEED,       ROUND(CASE WHEN SUM(A.SWKUL5DELAY)=0 THEN 0 ELSE SUM(A.SWKUL5TRAFFIC)*8000/1024/SUM(A.SWKUL5DELAY) END,3.0) AS SWKU5SPEED,       ROUND(CASE WHEN SUM(A.MIFIUL5DELAY)=0 THEN 0 ELSE SUM(A.MIFIUL5TRAFFIC)*8000/1024/SUM(A.MIFIUL5DELAY) END,3.0) AS MIFIU5SPEED,       ROUND(CASE WHEN SUM(A.CPEUL5DELAY)=0 THEN 0 ELSE SUM(A.CPEUL5TRAFFIC)*8000/1024/SUM(A.CPEUL5DELAY) END,3.0) AS CPEU5SPEED,        ROUND(CASE WHEN SUM(A.ELDELAY)=0 THEN 0 ELSE SUM(A.DLTRAFFIC)*8000/1024/SUM(A.ELDELAY) END,3.0) AS EDSPEED,       ROUND(CASE WHEN SUM(A.PHONEELDELAY)=0 THEN 0 ELSE SUM(A.PHONEDLTRAFFIC)*8000/1024 /SUM(A.PHONEELDELAY) END,3.0) AS EPHONEDSPEED,       ROUND(CASE WHEN SUM(A.SWKELDELAY)=0 THEN 0 ELSE SUM(A.SWKDLTRAFFIC)*8000/1024/SUM(A.SWKELDELAY) END,3.0) AS ESWKSPEED,       ROUND(CASE WHEN SUM(A.MIFIELDELAY)=0 THEN 0 ELSE SUM(A.MIFIDLTRAFFIC)*8000/1024/SUM(A.MIFIELDELAY) END,3.0) AS EMIFISPEED,       ROUND(CASE WHEN SUM(A.CPEELDELAY)=0 THEN 0 ELSE SUM(A.CPEDLTRAFFIC)*8000/1024/SUM(A.CPEELDELAY) END,3.0) AS ECPESPEED,        ROUND(CASE WHEN SUM(A.EULDELAY)=0 THEN 0 ELSE SUM(A.ULTRAFFIC)*8000/1024/SUM(A.EULDELAY) END,3.0) AS EUSPEED,       ROUND(CASE WHEN SUM(A.EPHONEULDELAY)=0 THEN 0 ELSE SUM(A.PHONEULTRAFFIC)*8000/1024 /SUM(A.EPHONEULDELAY) END,3.0) AS EPHONEUSPEED,       ROUND(CASE WHEN SUM(A.ESWKULDELAY)=0 THEN 0 ELSE SUM(A.SWKULTRAFFIC)*8000/1024/SUM(A.ESWKULDELAY) END,3.0) AS ESWKUSPEED,       ROUND(CASE WHEN SUM(A.EMIFIULDELAY)=0 THEN 0 ELSE SUM(A.MIFIULTRAFFIC)*8000/1024/SUM(A.EMIFIULDELAY) END,3.0) AS EMIFIUSPEED,       ROUND(CASE WHEN SUM(A.ECPEULDELAY)=0 THEN 0 ELSE SUM(A.CPEULTRAFFIC)*8000/1024/SUM(A.ECPEULDELAY) END,3.0) AS ECPEUSPEED,        ROUND(CASE WHEN SUM(A.EUL5DELAY)=0 THEN 0 ELSE SUM(A.UL5TRAFFIC)*8000/1024/SUM(A.EUL5DELAY) END,3.0) AS EU5SPEED,       ROUND(CASE WHEN SUM(A.EPHONEUL5DELAY)=0 THEN 0 ELSE SUM(A.PHONEUL5TRAFFIC)*8000/1024 /SUM(A.EPHONEUL5DELAY) END,3.0) AS EPHONEU5SPEED,       ROUND(CASE WHEN SUM(A.ESWKUL5DELAY)=0 THEN 0 ELSE SUM(A.SWKUL5TRAFFIC)*8000/1024/SUM(A.ESWKUL5DELAY) END,3.0) AS ESWKU5SPEED,       ROUND(CASE WHEN SUM(A.EMIFIUL5DELAY)=0 THEN 0 ELSE SUM(A.MIFIUL5TRAFFIC)*8000/1024/SUM(A.EMIFIUL5DELAY) END,3.0) AS EMIFIU5SPEED,       ROUND(CASE WHEN SUM(A.ECPEUL5DELAY)=0 THEN 0 ELSE SUM(A.CPEUL5TRAFFIC)*8000/1024/SUM(A.ECPEUL5DELAY) END,3.0) AS ECPEU5SPEED,        ROUND(CASE WHEN SUM(A.DLDELAY)=0 THEN 0 ELSE 100*SUM(A.DELAY1MBPSUP)/SUM(A.DLDELAY) END,3.0) AS DSPEED1PER,       ROUND(CASE WHEN SUM(A.PHONEDLDELAY)=0 THEN 0 ELSE 100*SUM(A.PHONEDELAY1MBPSUP)/SUM(A.PHONEDLDELAY) END,3.0) AS DPHONESPEED1PER,       ROUND(CASE WHEN SUM(A.DLDELAY)=0 THEN 0 ELSE 100*SUM(A.DELAY4MBPSUP)/SUM(A.DLDELAY) END,3.0) AS DSPEED4PER,       ROUND(CASE WHEN SUM(A.PHONEDLDELAY)=0 THEN 0 ELSE 100*SUM(A.PHONEDELAY4MBPSUP)/SUM(A.PHONEDLDELAY) END,3.0) AS DPHONESPEED4PER,       ROUND(CASE WHEN SUM(A.DLDELAY)=0 THEN 0 ELSE 100*SUM(A.DELAY10MBPSUP)/SUM(A.DLDELAY) END,3.0) AS DSPEED10PER,       ROUND(CASE WHEN SUM(A.PHONEDLDELAY)=0 THEN 0 ELSE 100*SUM(A.PHONEDELAY10MBPSUP)/SUM(A.PHONEDLDELAY) END,3.0) AS DPHONESPEED10PER,        ROUND(CASE WHEN SUM(A.ULDELAY)=0 THEN 0 ELSE 100*SUM(A.UDELAY100KBPSUP)/SUM(A.ULDELAY) END,3.0) AS USPEED100PER,       ROUND(CASE WHEN SUM(A.PHONEULDELAY)=0 THEN 0 ELSE 100*SUM(A.UPHONEDELAY100KBPSUP)/SUM(A.PHONEULDELAY) END,3.0) AS UPHONESPEED100PER,       ROUND(CASE WHEN SUM(A.ULDELAY)=0 THEN 0 ELSE 100*SUM(A.UDELAY200KBPSUP)/SUM(A.ULDELAY) END,3.0) AS USPEED200PER,       ROUND(CASE WHEN SUM(A.PHONEULDELAY)=0 THEN 0 ELSE 100*SUM(A.UPHONEDELAY200KBPSUP)/SUM(A.PHONEULDELAY) END,3.0) AS UPHONESPEED200PER,       ROUND(CASE WHEN SUM(A.ULDELAY)=0 THEN 0 ELSE 100*SUM(A.UDELAY500KBPSUP)/SUM(A.ULDELAY) END,3.0) AS USPEED500PER,       ROUND(CASE WHEN SUM(A.PHONEULDELAY)=0 THEN 0 ELSE 100*SUM(A.UPHONEDELAY500KBPSUP)/SUM(A.PHONEULDELAY) END,3.0) AS UPHONESPEED500PER,        ROUND(CASE WHEN SUM(A.COUNTUP)=0 THEN 0 ELSE 100*SUM(A.COUNT1MBPSUP)/SUM(A.COUNTUP) END,3.0) AS EDSPEED1PER,       ROUND(CASE WHEN SUM(A.PHONECOUNTUP)=0 THEN 0 ELSE 100*SUM(A.PHONECOUNT1MBPSUP)/SUM(A.PHONECOUNTUP) END,3.0) AS EDPHONESPEED1PER,       ROUND(CASE WHEN SUM(A.COUNTUP)=0 THEN 0 ELSE 100*SUM(A.COUNT4MBPSUP)/SUM(A.COUNTUP) END,3.0) AS EDSPEED4PER,       ROUND(CASE WHEN SUM(A.PHONECOUNTUP)=0 THEN 0 ELSE 100*SUM(A.PHONECOUNT4MBPSUP)/SUM(A.PHONECOUNTUP) END,3.0) AS EDPHONESPEED4PER,       ROUND(CASE WHEN SUM(A.COUNTUP)=0 THEN 0 ELSE 100*SUM(A.COUNT10MBPSUP)/SUM(A.COUNTUP) END,3.0) AS EDSPEED10PER,       ROUND(CASE WHEN SUM(A.PHONECOUNTUP)=0 THEN 0 ELSE 100*SUM(A.PHONECOUNT10MBPSUP)/SUM(A.PHONECOUNTUP) END,3.0) AS EDPHONESPEED10PER,        ROUND(CASE WHEN SUM(A.UCOUNTUP)=0 THEN 0 ELSE 100*SUM(A.UCOUNT100KBPSUP)/SUM(A.UCOUNTUP) END,3.0) AS EUSPEED100PER,       ROUND(CASE WHEN SUM(A.UPHONECOUNTUP)=0 THEN 0 ELSE 100*SUM(A.UPHONECOUNT100KBPSUP)/SUM(A.UPHONECOUNTUP) END,3.0) AS EUPHONESPEED100PER,       ROUND(CASE WHEN SUM(A.UCOUNTUP)=0 THEN 0 ELSE 100*SUM(A.UCOUNT200KBPSUP)/SUM(A.UCOUNTUP) END,3.0) AS EUSPEED200PER,       ROUND(CASE WHEN SUM(A.UPHONECOUNTUP)=0 THEN 0 ELSE 100*SUM(A.UPHONECOUNT200KBPSUP)/SUM(A.UPHONECOUNTUP) END,3.0) AS EUPHONESPEED200PER,       ROUND(CASE WHEN SUM(A.UCOUNTUP)=0 THEN 0 ELSE 100*SUM(A.UCOUNT500KBPSUP)/SUM(A.UCOUNTUP) END,3.0) AS EUSPEED500PER,       ROUND(CASE WHEN SUM(A.UPHONECOUNTUP)=0 THEN 0 ELSE 100*SUM(A.UPHONECOUNT500KBPSUP)/SUM(A.UPHONECOUNTUP) END,3.0) AS EUPHONESPEED500PER       FROM (       SELECT       GN.CITY_NO,       GN.EQUIPMENT,       CASE WHEN GN.SERVICE='5' AND GN.FILETYPE>=7 AND GN.FACTYPE=701 THEN GN.DLTRAFFIC ELSE 0 END AS VIEDOTRAFFIC,       CASE WHEN GN.SERVICE='5' AND GN.FILETYPE>=7 AND GN.FACTYPE=701 THEN GN.DLDELAY ELSE 0 END AS VIEDODELAY,       CASE WHEN GN.SERVICE='15' AND GN.FILETYPE>=7 AND GN.FACTYPE=701 THEN GN.DLTRAFFIC ELSE 0 END AS WEBTRAFFIC,       CASE WHEN GN.SERVICE='15' AND GN.FILETYPE>=7 AND GN.FACTYPE=701THEN GN.DLDELAY ELSE 0 END AS WEBDELAY,       CASE WHEN GN.SERVICE='1' AND GN.FACTYPE=701 THEN GN.SCOUNT ELSE 0 END AS IMSCOUNT,       CASE WHEN GN.SERVICE='1' AND GN.FACTYPE=701 THEN GN.ALLCOUNT ELSE 0 END AS IMALLCOUNT,       CASE WHEN GN.SERVICE='8' AND GN.FACTYPE=701 THEN GN.SCOUNT ELSE 0 END AS GAMESCOUNT,       CASE WHEN GN.SERVICE='8' AND GN.FACTYPE=701 THEN GN.ALLCOUNT ELSE 0 END AS GAMEALLCOUNT,        CASE WHEN GN.FILETYPE>=7 THEN GN.DLDELAY ELSE 0 END AS DLDELAY,       CASE WHEN GN.FILETYPE>=7 THEN GN.DLTRAFFIC ELSE 0 END AS DLTRAFFIC,       CASE WHEN GN.FILETYPE>=7 AND GN.FACTYPE=701 THEN DLDELAY ELSE 0 END AS PHONEDLDELAY,       CASE WHEN GN.FILETYPE>=7 AND GN.FACTYPE=701 THEN DLTRAFFIC ELSE 0 END AS PHONEDLTRAFFIC,       CASE WHEN GN.FILETYPE>=7 AND GN.FACTYPE=703 THEN DLDELAY ELSE 0 END AS SWKDLDELAY,       CASE WHEN GN.FILETYPE>=7 AND GN.FACTYPE=703 THEN DLTRAFFIC ELSE 0 END AS SWKDLTRAFFIC,       CASE WHEN GN.FILETYPE>=7 AND GN.FACTYPE=702 THEN DLDELAY ELSE 0 END AS MIFIDLDELAY,       CASE WHEN GN.FILETYPE>=7 AND GN.FACTYPE=702 THEN DLTRAFFIC ELSE 0 END AS MIFIDLTRAFFIC,       CASE WHEN GN.FILETYPE>=7 AND GN.FACTYPE=704 THEN DLDELAY ELSE 0 END AS CPEDLDELAY,       CASE WHEN GN.FILETYPE>=7 AND GN.FACTYPE=704 THEN DLTRAFFIC ELSE 0 END AS CPEDLTRAFFIC,        CASE WHEN GN.UFILETYPE>=3 THEN GN.ULDELAY ELSE 0 END AS ULDELAY,       CASE WHEN GN.UFILETYPE>=3 THEN GN.ULTRAFFIC ELSE 0 END AS ULTRAFFIC,       CASE WHEN GN.UFILETYPE>=3 AND GN.FACTYPE=701 THEN ULDELAY ELSE 0 END AS PHONEULDELAY,       CASE WHEN GN.UFILETYPE>=3 AND GN.FACTYPE=701 THEN ULTRAFFIC ELSE 0 END AS PHONEULTRAFFIC,       CASE WHEN GN.UFILETYPE>=3 AND GN.FACTYPE=703 THEN ULDELAY ELSE 0 END AS SWKULDELAY,       CASE WHEN GN.UFILETYPE>=3 AND GN.FACTYPE=703 THEN ULTRAFFIC ELSE 0 END AS SWKULTRAFFIC,       CASE WHEN GN.UFILETYPE>=3 AND GN.FACTYPE=702 THEN ULDELAY ELSE 0 END AS MIFIULDELAY,       CASE WHEN GN.UFILETYPE>=3 AND GN.FACTYPE=702 THEN ULTRAFFIC ELSE 0 END AS MIFIULTRAFFIC,       CASE WHEN GN.UFILETYPE>=3 AND GN.FACTYPE=704 THEN ULDELAY ELSE 0 END AS CPEULDELAY,       CASE WHEN GN.UFILETYPE>=3 AND GN.FACTYPE=704 THEN ULTRAFFIC ELSE 0 END AS CPEULTRAFFIC,        CASE WHEN GN.UFILETYPE>=7 THEN GN.ULDELAY ELSE 0 END AS UL5DELAY,       CASE WHEN GN.UFILETYPE>=7 THEN GN.ULTRAFFIC ELSE 0 END AS UL5TRAFFIC,       CASE WHEN GN.UFILETYPE>=7 AND GN.FACTYPE=701 THEN ULDELAY ELSE 0 END AS PHONEUL5DELAY,       CASE WHEN GN.UFILETYPE>=7 AND GN.FACTYPE=701 THEN ULTRAFFIC ELSE 0 END AS PHONEUL5TRAFFIC,       CASE WHEN GN.UFILETYPE>=7 AND GN.FACTYPE=703 THEN ULDELAY ELSE 0 END AS SWKUL5DELAY,       CASE WHEN GN.UFILETYPE>=7 AND GN.FACTYPE=703 THEN ULTRAFFIC ELSE 0 END AS SWKUL5TRAFFIC,       CASE WHEN GN.UFILETYPE>=7 AND GN.FACTYPE=702 THEN ULDELAY ELSE 0 END AS MIFIUL5DELAY,       CASE WHEN GN.UFILETYPE>=7 AND GN.FACTYPE=702 THEN ULTRAFFIC ELSE 0 END AS MIFIUL5TRAFFIC,       CASE WHEN GN.UFILETYPE>=7 AND GN.FACTYPE=704 THEN ULDELAY ELSE 0 END AS CPEUL5DELAY,       CASE WHEN GN.UFILETYPE>=7 AND GN.FACTYPE=704 THEN ULTRAFFIC ELSE 0 END AS CPEUL5TRAFFIC,        CASE WHEN GN.FILETYPE>=7 THEN GN.EMPTYDELAY ELSE 0 END AS ELDELAY,       CASE WHEN GN.FILETYPE>=7 AND GN.FACTYPE=701 THEN EMPTYDELAY ELSE 0 END AS PHONEELDELAY,       CASE WHEN GN.FILETYPE>=7 AND GN.FACTYPE=703 THEN EMPTYDELAY ELSE 0 END AS SWKELDELAY,       CASE WHEN GN.FILETYPE>=7 AND GN.FACTYPE=702 THEN EMPTYDELAY ELSE 0 END AS MIFIELDELAY,       CASE WHEN GN.FILETYPE>=7 AND GN.FACTYPE=704 THEN EMPTYDELAY ELSE 0 END AS CPEELDELAY,        CASE WHEN GN.UFILETYPE>=3 THEN GN.EMPTYDELAY ELSE 0 END AS EULDELAY,       CASE WHEN GN.UFILETYPE>=3 AND GN.FACTYPE=701 THEN EMPTYDELAY ELSE 0 END AS EPHONEULDELAY,       CASE WHEN GN.UFILETYPE>=3 AND GN.FACTYPE=703 THEN EMPTYDELAY ELSE 0 END AS ESWKULDELAY,       CASE WHEN GN.UFILETYPE>=3 AND GN.FACTYPE=702 THEN EMPTYDELAY ELSE 0 END AS EMIFIULDELAY,       CASE WHEN GN.UFILETYPE>=3 AND GN.FACTYPE=704 THEN EMPTYDELAY ELSE 0 END AS ECPEULDELAY,        CASE WHEN GN.UFILETYPE>=7 THEN GN.EMPTYDELAY ELSE 0 END AS EUL5DELAY,       CASE WHEN GN.UFILETYPE>=7 AND GN.FACTYPE=701 THEN EMPTYDELAY ELSE 0 END AS EPHONEUL5DELAY,       CASE WHEN GN.UFILETYPE>=7 AND GN.FACTYPE=703 THEN EMPTYDELAY ELSE 0 END AS ESWKUL5DELAY,       CASE WHEN GN.UFILETYPE>=7 AND GN.FACTYPE=702 THEN EMPTYDELAY ELSE 0 END AS EMIFIUL5DELAY,       CASE WHEN GN.UFILETYPE>=7 AND GN.FACTYPE=704 THEN EMPTYDELAY ELSE 0 END AS ECPEUL5DELAY,        CASE WHEN GN.FILETYPE>=7 AND GN.LTEDOWNSPEEDGROUP>=14 THEN GN.DLDELAY ELSE 0 END AS DELAY1MBPSUP,       CASE WHEN GN.FILETYPE>=7 AND GN.LTEDOWNSPEEDGROUP>=20 THEN GN.DLDELAY ELSE 0 END AS DELAY4MBPSUP,       CASE WHEN GN.FILETYPE>=7 AND GN.LTEDOWNSPEEDGROUP>=32 THEN GN.DLDELAY ELSE 0 END AS DELAY10MBPSUP,        CASE WHEN GN.FILETYPE>=7 AND GN.FACTYPE=701 AND GN.LTEDOWNSPEEDGROUP>=14 THEN GN.DLDELAY ELSE 0 END AS PHONEDELAY1MBPSUP,       CASE WHEN GN.FILETYPE>=7 AND GN.FACTYPE=701 AND GN.LTEDOWNSPEEDGROUP>=20 THEN GN.DLDELAY ELSE 0 END AS PHONEDELAY4MBPSUP,       CASE WHEN GN.FILETYPE>=7 AND GN.FACTYPE=701 AND GN.LTEDOWNSPEEDGROUP>=32 THEN GN.DLDELAY ELSE 0 END AS PHONEDELAY10MBPSUP,        CASE WHEN GN.UFILETYPE>=3 AND GN.LTEUPSPEEDGROUP>=3 THEN GN.ULDELAY ELSE 0 END AS UDELAY100KBPSUP,       CASE WHEN GN.UFILETYPE>=3 AND GN.LTEUPSPEEDGROUP>=5 THEN GN.ULDELAY ELSE 0 END AS UDELAY200KBPSUP,       CASE WHEN GN.UFILETYPE>=3 AND GN.LTEUPSPEEDGROUP>=9 THEN GN.ULDELAY ELSE 0 END AS UDELAY500KBPSUP,        CASE WHEN GN.UFILETYPE>=3 AND GN.FACTYPE=701 AND GN.LTEUPSPEEDGROUP>=3 THEN GN.ULDELAY ELSE 0 END AS UPHONEDELAY100KBPSUP,       CASE WHEN GN.UFILETYPE>=3 AND GN.FACTYPE=701 AND GN.LTEUPSPEEDGROUP>=5 THEN GN.ULDELAY ELSE 0 END AS UPHONEDELAY200KBPSUP,       CASE WHEN GN.UFILETYPE>=3 AND GN.FACTYPE=701 AND GN.LTEUPSPEEDGROUP>=9 THEN GN.ULDELAY ELSE 0 END AS UPHONEDELAY500KBPSUP,        CASE WHEN GN.FILETYPE>=7 THEN GN.ALLCOUNT ELSE 0 END AS COUNTUP,       CASE WHEN GN.FILETYPE>=7 AND GN.LTEDOWNSPEEDGROUP>=14 THEN GN.ALLCOUNT ELSE 0 END AS COUNT1MBPSUP,       CASE WHEN GN.FILETYPE>=7 AND GN.LTEDOWNSPEEDGROUP>=20 THEN GN.ALLCOUNT ELSE 0 END AS COUNT4MBPSUP,       CASE WHEN GN.FILETYPE>=7 AND GN.LTEDOWNSPEEDGROUP>=32 THEN GN.ALLCOUNT ELSE 0 END AS COUNT10MBPSUP,        CASE WHEN GN.FILETYPE>=7 AND GN.FACTYPE=701 THEN GN.ALLCOUNT ELSE 0 END AS PHONECOUNTUP,       CASE WHEN GN.FILETYPE>=7 AND GN.FACTYPE=701 AND GN.LTEDOWNSPEEDGROUP>=14 THEN GN.ALLCOUNT ELSE 0 END AS PHONECOUNT1MBPSUP,       CASE WHEN GN.FILETYPE>=7 AND GN.FACTYPE=701 AND GN.LTEDOWNSPEEDGROUP>=20 THEN GN.ALLCOUNT ELSE 0 END AS PHONECOUNT4MBPSUP,       CASE WHEN GN.FILETYPE>=7 AND GN.FACTYPE=701 AND GN.LTEDOWNSPEEDGROUP>=32 THEN GN.ALLCOUNT ELSE 0 END AS PHONECOUNT10MBPSUP,        CASE WHEN GN.UFILETYPE>=3 THEN GN.ALLCOUNT ELSE 0 END AS UCOUNTUP,       CASE WHEN GN.UFILETYPE>=3 AND GN.LTEUPSPEEDGROUP>=3 THEN GN.ALLCOUNT ELSE 0 END AS UCOUNT100KBPSUP,       CASE WHEN GN.UFILETYPE>=3 AND GN.LTEUPSPEEDGROUP>=5 THEN GN.ALLCOUNT ELSE 0 END AS UCOUNT200KBPSUP,       CASE WHEN GN.UFILETYPE>=3 AND GN.LTEUPSPEEDGROUP>=9 THEN GN.ALLCOUNT ELSE 0 END AS UCOUNT500KBPSUP,        CASE WHEN GN.UFILETYPE>=3 AND GN.FACTYPE=701 THEN GN.ALLCOUNT ELSE 0 END AS UPHONECOUNTUP,       CASE WHEN GN.UFILETYPE>=3 AND GN.FACTYPE=701 AND GN.LTEUPSPEEDGROUP>=3 THEN GN.ALLCOUNT ELSE 0 END AS UPHONECOUNT100KBPSUP,       CASE WHEN GN.UFILETYPE>=3 AND GN.FACTYPE=701 AND GN.LTEUPSPEEDGROUP>=5 THEN GN.ALLCOUNT ELSE 0 END AS UPHONECOUNT200KBPSUP,       CASE WHEN GN.UFILETYPE>=3 AND GN.FACTYPE=701 AND GN.LTEUPSPEEDGROUP>=9 THEN GN.ALLCOUNT ELSE 0 END AS UPHONECOUNT500KBPSUP       FROM LTE_sys.[@p0]_T_GN_SUM_ALLFILE GN       WHERE             1=1 [@and] ${[@city0] [@and] [@time0]}&  [@and] [@fac0]) A       INNER JOIN lte_sys.T_BASE_CITY CITY ON CITY.CITY_NO=A.CITY_NO       GROUP BY CITY.PRONAME,CITY.CITYNAME,A.EQUIPMENT"
      }
    }
  ]
}