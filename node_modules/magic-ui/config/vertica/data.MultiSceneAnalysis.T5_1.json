{
  "module": "MultiSceneAnalysis.T51",
  "flag": "vertical",
  "configs": [
    {
      "key": "dataMultiSceneAnalysisT51",
      "desc": "LTE室内外场景分析-网间指标统计（不区分文件大小）",
      "config": {
        "parameters": [
          {
            "name": "p_en",
            "columnname": "",
            "type": "string",
            "format": "",
            "conditionid": "c0",
            "symbol": ""
          },
          {
            "name": "starttime",
            "columnname": "",
            "type": "string",
            "format": "",
            "conditionid": "c1",
            "symbol": ""
          },
          {
            "name": "endtime",
            "columnname": "",
            "type": "string",
            "format": "",
            "conditionid": "c2",
            "symbol": ""
          }, {
            "name": "province",
            "columnname": "",
            "type":"string",
            "format": "",
            "conditionid": "c3",
            "symbol":""
          }
        ],
      "value":"SELECT      t.city AS data1,      0         data49,      0         data50,      0         data51,      0         data52,      t.*  FROM      (          SELECT              t4.*,              t5.data53 ,              t5.data54 ,              t5.data55 ,              t5.data56 ,              t5.data57 ,              t5.data58 ,              t5.data59 ,              t5.data60 ,              t5.data61 ,              t5.data62 ,              t5.data63 ,              t5.data64 ,              t5.data65 ,              t5.data66 ,              t5.data67 ,              t5.data68 ,              t5.data69 ,              t5.data70 ,              t5.data71 ,              t5.data72 ,              t5.data73 ,              t5.data74 ,              t5.data75 ,              t5.data76 ,              t5.data77 ,              t5.data78 ,              t5.data79 ,              t5.data80 ,              t5.data81 ,              t5.data82 ,              t5.data83          FROM              (                  SELECT                      tb2.city,                      '全网' AS data2,                      SUM(                          CASE                              WHEN nettype=1                              THEN xdr_count                              ELSE 0                          END) AS data7,                      ROUND( SUM(                          CASE                              WHEN nettype=1                              THEN xdr_count                              ELSE 0                          END)/MAX(tb1.sumcnt),2.0) AS data8 ,                      SUM(                          CASE                              WHEN nettype=2                              THEN xdr_count                              ELSE 0                          END) AS data9,                      ROUND(SUM(                          CASE                              WHEN nettype=2                              THEN xdr_count                              ELSE 0                          END)/MAX(tb1.sumcnt),2.0) AS data10 ,                      ROUND( SUM(                          CASE                              WHEN nettype=1                              THEN delay                              ELSE 0                          END)/1000/60,2.0) AS data11,                      ROUND( SUM(                          CASE                              WHEN nettype=1                              THEN delay                              ELSE 0                          END)/MAX(tb1.sumdelay),2.0) AS data12 ,                      ROUND(SUM(                          CASE                              WHEN nettype=2                              THEN delay                              ELSE 0                          END)/1000/60,2.0) AS data13,                      ROUND(SUM(                          CASE                              WHEN nettype=2                              THEN delay                              ELSE 0                          END)/MAX(tb1.sumdelay),2.0) AS data14 ,                      ROUND(SUM(                          CASE                              WHEN nettype=1                              THEN dl_flow                              ELSE 0                          END)/1024/1024,2.0) AS data15,                      ROUND(SUM(                          CASE                              WHEN nettype=1                              THEN dl_flow                              ELSE 0                          END)/MAX(tb1.sumdl_flow),2.0) AS data16 ,                      ROUND( SUM(                          CASE                              WHEN nettype=2                              THEN dl_flow                              ELSE 0                          END)/1024/1024,2.0) AS data17,                      ROUND( SUM(                          CASE                              WHEN nettype=2                              THEN dl_flow                              ELSE 0                          END)/MAX(tb1.sumdl_flow),2.0) AS data18 ,                      ROUND(SUM(                          CASE                              WHEN nettype=1                              THEN delay                              ELSE 0                          END)/1000/60,2.0) AS data19,                      ROUND(SUM(                          CASE                              WHEN nettype=1                              THEN dl_flow                              ELSE 0                          END)/1024/1024,2.0) AS data20 ,                      ROUND( SUM(                          CASE                              WHEN nettype=1                              THEN dl_flow                              ELSE 0                          END)/SUM(                          CASE                              WHEN nettype=1                              THEN delay                              ELSE 0                          END)*8000/1024,2.0) AS data21,                      SUM(                          CASE                              WHEN nettype=1                              THEN satisfied_xdr_count                              ELSE 0                          END) AS data22,                      SUM(                          CASE                              WHEN nettype=1                              THEN satisfied_sucess_xdr_count                              ELSE 0                          END) AS data23 ,                      ROUND(SUM(                          CASE                              WHEN nettype=1                              THEN satisfied_sucess_xdr_count                              ELSE 0                          END)/SUM(                          CASE                              WHEN nettype=1                              THEN satisfied_xdr_count                              ELSE 0                          END),2.0) AS data24,                      SUM(                          CASE                              WHEN nettype=1                              THEN satisfied_xdr_count                              ELSE 0                          END) AS data25,                      SUM(                          CASE                              WHEN nettype=1                              THEN satisfied_speed_xdr_count                              ELSE 0                          END) AS data26 ,                      ROUND( SUM(                          CASE                              WHEN nettype=1                              THEN satisfied_speed_xdr_count                              ELSE 0                          END)/SUM(                          CASE                              WHEN nettype=1                              THEN satisfied_xdr_count                              ELSE 0                          END),2.0) AS data27,                      ROUND( SUM(                          CASE                              WHEN nettype=1                              THEN satisfied_sucess_xdr_count*satisfied_speed_xdr_count                              ELSE 0                          END)/SUM(                          CASE                              WHEN nettype=1                              THEN satisfied_xdr_count*satisfied_xdr_count                              ELSE 0                          END),2.0) AS data28,                      ROUND(SUM(                          CASE                              WHEN nettype=2                              THEN delay                              ELSE 0                          END)/1000/60,2.0) AS data29,                      ROUND(SUM(                          CASE                              WHEN nettype=2                              THEN dl_flow                              ELSE 0                          END)/1024/1024,2.0) AS data30,                      ROUND( SUM(                          CASE                              WHEN nettype=2                              THEN dl_flow                              ELSE 0                          END)/SUM(                          CASE                              WHEN nettype=2                              THEN delay                              ELSE 0                          END)*8000/1024,2.0) AS data31,                      SUM(                          CASE                              WHEN nettype=2                              THEN satisfied_xdr_count                              ELSE 0                          END) AS data32,                      SUM(                          CASE                              WHEN nettype=2                              THEN satisfied_sucess_xdr_count                              ELSE 0                          END) AS data33 ,                      ROUND( SUM(                          CASE                              WHEN nettype=2                              THEN satisfied_sucess_xdr_count                              ELSE 0                          END)/SUM(                          CASE                              WHEN nettype=2                              THEN satisfied_xdr_count                              ELSE 0                          END),2.0) AS data34,                      SUM(                          CASE                              WHEN nettype=2                              THEN satisfied_xdr_count                              ELSE 0                          END) AS data35,                      SUM(                          CASE                              WHEN nettype=2                              THEN satisfied_speed_xdr_count                              ELSE 0                          END) AS data36 ,                      ROUND( SUM(                          CASE                              WHEN nettype=2                              THEN satisfied_speed_xdr_count                              ELSE 0                          END)/SUM(                          CASE                              WHEN nettype=2                              THEN satisfied_xdr_count                              ELSE 0                          END),2.0) AS data37,                      ROUND(SUM(                          CASE                              WHEN nettype=2                              THEN satisfied_sucess_xdr_count*satisfied_speed_xdr_count                              ELSE 0                          END)/SUM(                          CASE                              WHEN nettype=2                              THEN satisfied_xdr_count*satisfied_xdr_count                              ELSE 0                          END),2.0) AS data38,                      ROUND( SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN delay                              ELSE 0                          END)/1000/60,2.0) AS data39,                      ROUND(SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN dl_flow                              ELSE 0                          END)/1024/1024,2.0) AS data40,                      ROUND(SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN dl_flow                              ELSE 0                          END)/SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN delay                              ELSE 0                          END)*8000/1024,2.0) AS data41,                      SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN satisfied_xdr_count                              ELSE 0                          END) AS data42,                      SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN satisfied_sucess_xdr_count                              ELSE 0                          END) AS data43 ,                      ROUND(SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN satisfied_sucess_xdr_count                              ELSE 0                          END)/SUM(                          CASE                              WHEN(nettype=1                                  OR  nettype=2)                              THEN satisfied_xdr_count                              ELSE 0                          END),2.0) AS data44,                      SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN satisfied_xdr_count                              ELSE 0                          END) AS data45,                      SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN satisfied_speed_xdr_count                              ELSE 0                          END) AS data46 ,                      ROUND( SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN satisfied_speed_xdr_count                              ELSE 0                          END)/SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN satisfied_xdr_count                              ELSE 0                          END),2.0) AS data47,                      ROUND( SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN satisfied_sucess_xdr_count*satisfied_speed_xdr_count                              ELSE 0                          END)/SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN satisfied_xdr_count*satisfied_xdr_count                              ELSE 0                          END),2.0) AS data48                  FROM                      lte_sys.[@c0]_T_QUALITYSTATISTICS_ALLUSER tb2                  LEFT JOIN                      (                          SELECT                              city,                              SUM(xdr_count) sumcnt,                              SUM(delay)     sumdelay,                              SUM(dl_flow)   sumdl_flow                          FROM                              lte_sys.[@c0]_T_QUALITYSTATISTICS_ALLUSER                          WHERE                              nettype IN (1,2)                          AND hour>='[@c1]'                          AND hour<='[@c2]'                          GROUP BY                              city)tb1                  ON                      tb2.city=tb1.city                  WHERE                      tb2.hour>='[@c1]'                  AND tb2.hour<='[@c2]'                  GROUP BY                      tb2.city)t4          LEFT JOIN              (                  SELECT                      tb2.city,                      '全网' AS data2,                      ROUND(SUM(                          CASE                              WHEN nettype=1                              THEN delay                              ELSE 0                          END)/1000/60,2.0) AS data53,                      ROUND( SUM(                          CASE                              WHEN nettype=1                              THEN delay                              ELSE 0                          END)/MAX(tb1.sumdelay),2.0) AS data54 ,                      ROUND(SUM(                          CASE                              WHEN nettype=2                              THEN delay                              ELSE 0                          END)/1000/60,2.0) AS data55,                      ROUND( SUM(                          CASE                              WHEN nettype=2                              THEN delay                              ELSE 0                          END)/MAX(tb1.sumdelay),2.0) AS data56 ,                      ROUND(SUM(                          CASE                              WHEN nettype=1                              THEN dl_flow                              ELSE 0                          END)/1024/1024,2.0) AS data57,                      ROUND( SUM(                          CASE                              WHEN nettype=1                              THEN dl_flow                              ELSE 0                          END)/MAX(tb1.sumdl_flow),2.0) AS data58 ,                      ROUND(SUM(                          CASE                              WHEN nettype=2                              THEN dl_flow                              ELSE 0                          END)/1024/1024,2.0) AS data59,                      ROUND( SUM(                          CASE                              WHEN nettype=2                              THEN dl_flow                              ELSE 0                          END)/MAX(tb1.sumdl_flow),2.0) AS data60 ,                      ROUND( SUM(                          CASE                              WHEN nettype=1                              THEN delay                              ELSE 0                          END)/1000/60,2.0) AS data61,                      ROUND(SUM(                          CASE                              WHEN nettype=1                              THEN dl_flow                              ELSE 0                          END)/1024/1024,2.0) AS data62 ,                      ROUND( SUM(                          CASE                              WHEN nettype=1                              THEN dl_flow                              ELSE 0                          END)/SUM(                          CASE                              WHEN nettype=1                              THEN delay                              ELSE 0                          END)*8000/1024,2.0) AS data63,                      SUM(                          CASE                              WHEN nettype=1                              THEN satisfied_xdr_count                              ELSE 0                          END) AS data64,                      SUM(                          CASE                              WHEN nettype=1                              THEN satisfied_sucess_xdr_count                              ELSE 0                          END) AS data65 ,                      ROUND(SUM(                          CASE                              WHEN nettype=1                              THEN satisfied_sucess_xdr_count                              ELSE 0                          END)/SUM(                          CASE                              WHEN nettype=1                              THEN satisfied_xdr_count                              ELSE 0                          END),2.0) AS data66,                      SUM(                          CASE                              WHEN nettype=1                              THEN satisfied_xdr_count                              ELSE 0                          END) AS data67,                      SUM(                          CASE                              WHEN nettype=1                              THEN satisfied_speed_xdr_count                              ELSE 0                          END) AS data68 ,                      ROUND( SUM(                          CASE                              WHEN nettype=1                              THEN satisfied_speed_xdr_count                              ELSE 0                          END)/SUM(                          CASE                              WHEN nettype=1                              THEN satisfied_xdr_count                              ELSE 0                          END),2.0) AS data69,                      ROUND( SUM(                          CASE                              WHEN nettype=1                              THEN satisfied_sucess_xdr_count*satisfied_speed_xdr_count                              ELSE 0                          END)/SUM(                          CASE                              WHEN nettype=1                              THEN satisfied_xdr_count*satisfied_xdr_count                              ELSE 0                          END),2.0) AS data70,                      ROUND( SUM(                          CASE                              WHEN nettype=2                              THEN delay                              ELSE 0                          END)/1000/60,2.0) AS data71,                      ROUND(SUM(                          CASE                              WHEN nettype=2                              THEN dl_flow                              ELSE 0                          END)/1024/1024,2.0) AS data72,                      ROUND( SUM(                          CASE                              WHEN nettype=2                              THEN dl_flow                              ELSE 0                          END)/SUM(                          CASE                              WHEN nettype=2                              THEN delay                              ELSE 0                          END)*8000/1024,2.0) AS data73,                      ROUND(SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN delay                              ELSE 0                          END)/1000/60,2.0) AS data74,                      ROUND(SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN dl_flow                              ELSE 0                          END)/1024/1024,2.0) AS data75,                      ROUND( SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN dl_flow                              ELSE 0                          END)/SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN delay                              ELSE 0                          END)*8000/1024,2.0) AS data76,                      SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN satisfied_xdr_count                              ELSE 0                          END) AS data77,                      SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN satisfied_sucess_xdr_count                              ELSE 0                          END) AS data78 ,                      ROUND(SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN satisfied_sucess_xdr_count                              ELSE 0                          END)/SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN satisfied_xdr_count                              ELSE 0                          END) ,2.0)AS data79,                      SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN satisfied_xdr_count                              ELSE 0                          END) AS data80,                      SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN satisfied_speed_xdr_count                              ELSE 0                          END) AS data81 ,                      ROUND( SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN satisfied_speed_xdr_count                              ELSE 0                          END)/SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN satisfied_xdr_count                              ELSE 0                          END) ,2.0)AS data82,                      ROUND( SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN satisfied_sucess_xdr_count*satisfied_speed_xdr_count                              ELSE 0                          END)/SUM(                          CASE                              WHEN nettype=1                              THEN satisfied_xdr_count*satisfied_xdr_count                              ELSE 0                          END),2.0) AS data83                  FROM                      lte_sys.[@c0]_T_QUALITYSTATISTICS_SHAREUSER tb2                  LEFT JOIN                      (                          SELECT                              city,                              SUM(xdr_count) sumcnt,                              SUM(delay)     sumdelay,                              SUM(dl_flow)   sumdl_flow                          FROM                              lte_sys.[@c0]_T_QUALITYSTATISTICS_SHAREUSER                          WHERE                              nettype IN (1,2)                          AND hour>='[@c1]'                          AND hour<='[@c2]'                          GROUP BY                              city)tb1                  ON                      tb2.city=tb1.city                  WHERE                      tb2.hour>='[@c1]'                  AND tb2.hour<='[@c2]'                  GROUP BY                      tb2.city )t5          ON              t4.data2=t5.data2          AND t4.city=t5.city          UNION          SELECT              t9.*,              t10.data53 ,              t10.data54 ,              t10.data55 ,              t10.data56 ,              t10.data57 ,              t10.data58 ,              t10.data59 ,              t10.data60 ,              t10.data61 ,              t10.data62 ,              t10.data63 ,              t10.data64 ,              t10.data65 ,              t10.data66 ,              t10.data67 ,              t10.data68 ,              t10.data69 ,              t10.data70 ,              t10.data71 ,              t10.data72 ,              t10.data73 ,              t10.data74 ,              t10.data75 ,              t10.data76 ,              t10.data77 ,              t10.data78 ,              t10.data79 ,              t10.data80 ,              t10.data81 ,              t10.data82 ,              t10.data83          FROM              (                  SELECT                      tb2.city,                      (                          CASE                              WHEN scene1=1                              THEN '室外用户'                              WHEN scene1=2                              THEN '占用室分的室内稳定用户(有室分)'                              WHEN scene1=3                              THEN '占用宏站的室内稳定用户(无室分)'                              WHEN scene1=4                              THEN '室内稳定用户(占用宏站和室分)'                              ELSE '未知场景'                          END ) AS data2,                      SUM(                          CASE                              WHEN nettype=1                              THEN xdr_count                              ELSE 0                          END) AS data7,                      ROUND( SUM(                          CASE                              WHEN nettype=1                              THEN xdr_count                              ELSE 0                          END)/MAX(tb1.sumcnt),2.0) AS data8 ,                      SUM(                          CASE                              WHEN nettype=2                              THEN xdr_count                              ELSE 0                          END) AS data9,                      ROUND(SUM(                          CASE                              WHEN nettype=2                              THEN xdr_count                              ELSE 0                          END)/MAX(tb1.sumcnt),2.0) AS data10 ,                      ROUND( SUM(                          CASE                              WHEN nettype=1                              THEN delay                              ELSE 0                          END)/1000/60,2.0) AS data11,                      ROUND( SUM(                          CASE                              WHEN nettype=1                              THEN delay                              ELSE 0                          END)/MAX(tb1.sumdelay),2.0) AS data12 ,                      ROUND(SUM(                          CASE                              WHEN nettype=2                              THEN delay                              ELSE 0                          END)/1000/60,2.0) AS data13,                      ROUND(SUM(                          CASE                              WHEN nettype=2                              THEN delay                              ELSE 0                          END)/MAX(tb1.sumdelay),2.0) AS data14 ,                      ROUND(SUM(                          CASE                              WHEN nettype=1                              THEN dl_flow                              ELSE 0                          END)/1024/1024,2.0) AS data15,                      ROUND(SUM(                          CASE                              WHEN nettype=1                              THEN dl_flow                              ELSE 0                          END)/MAX(tb1.sumdl_flow),2.0) AS data16 ,                      ROUND( SUM(                          CASE                              WHEN nettype=2                              THEN dl_flow                              ELSE 0                          END)/1024/1024,2.0) AS data17,                      ROUND( SUM(                          CASE                              WHEN nettype=2                              THEN dl_flow                              ELSE 0                          END)/MAX(tb1.sumdl_flow),2.0) AS data18 ,                      ROUND(SUM(                          CASE                              WHEN nettype=1                              THEN delay                              ELSE 0                          END)/1000/60,2.0) AS data19,                      ROUND(SUM(                          CASE                              WHEN nettype=1                              THEN dl_flow                              ELSE 0                          END)/1024/1024,2.0) AS data20 ,                      ROUND( SUM(                          CASE                              WHEN nettype=1                              THEN dl_flow                              ELSE 0                          END)/SUM(                          CASE                              WHEN nettype=1                              THEN delay                              ELSE 0                          END)*8000/1024,2.0) AS data21,                      SUM(                          CASE                              WHEN nettype=1                              THEN satisfied_xdr_count                              ELSE 0                          END) AS data22,                      SUM(                          CASE                              WHEN nettype=1                              THEN satisfied_sucess_xdr_count                              ELSE 0                          END) AS data23 ,                      ROUND(SUM(                          CASE                              WHEN nettype=1                              THEN satisfied_sucess_xdr_count                              ELSE 0                          END)/SUM(                          CASE                              WHEN nettype=1                              THEN satisfied_xdr_count                              ELSE 0                          END),2.0) AS data24,                      SUM(                          CASE                              WHEN nettype=1                              THEN satisfied_xdr_count                              ELSE 0                          END) AS data25,                      SUM(                          CASE                              WHEN nettype=1                              THEN satisfied_speed_xdr_count                              ELSE 0                          END) AS data26 ,                      ROUND( SUM(                          CASE                              WHEN nettype=1                              THEN satisfied_speed_xdr_count                              ELSE 0                          END)/SUM(                          CASE                              WHEN nettype=1                              THEN satisfied_xdr_count                              ELSE 0                          END),2.0) AS data27,                      ROUND( SUM(                          CASE                              WHEN nettype=1                              THEN satisfied_sucess_xdr_count*satisfied_speed_xdr_count                              ELSE 0                          END)/SUM(                          CASE                              WHEN nettype=1                              THEN satisfied_xdr_count*satisfied_xdr_count                              ELSE 0                          END),2.0) AS data28,                      ROUND(SUM(                          CASE                              WHEN nettype=2                              THEN delay                              ELSE 0                          END)/1000/60,2.0) AS data29,                      ROUND(SUM(                          CASE                              WHEN nettype=2                              THEN dl_flow                              ELSE 0                          END)/1024/1024,2.0) AS data30,                      ROUND( SUM(                          CASE                              WHEN nettype=2                              THEN dl_flow                              ELSE 0                          END)/SUM(                          CASE                              WHEN nettype=2                              THEN delay                              ELSE 0                          END)*8000/1024,2.0) AS data31,                      SUM(                          CASE                              WHEN nettype=2                              THEN satisfied_xdr_count                              ELSE 0                          END) AS data32,                      SUM(                          CASE                              WHEN nettype=2                              THEN satisfied_sucess_xdr_count                              ELSE 0                          END) AS data33 ,                      ROUND( SUM(                          CASE                              WHEN nettype=2                              THEN satisfied_sucess_xdr_count                              ELSE 0                          END)/SUM(                          CASE                              WHEN nettype=2                              THEN satisfied_xdr_count                              ELSE 0                          END),2.0) AS data34,                      SUM(                          CASE                              WHEN nettype=2                              THEN satisfied_xdr_count                              ELSE 0                          END) AS data35,                      SUM(                          CASE                              WHEN nettype=2                              THEN satisfied_speed_xdr_count                              ELSE 0                          END) AS data36 ,                      ROUND( SUM(                          CASE                              WHEN nettype=2                              THEN satisfied_speed_xdr_count                              ELSE 0                          END)/SUM(                          CASE                              WHEN nettype=2                              THEN satisfied_xdr_count                              ELSE 0                          END),2.0) AS data37,                      ROUND(SUM(                          CASE                              WHEN nettype=2                              THEN satisfied_sucess_xdr_count*satisfied_speed_xdr_count                              ELSE 0                          END)/SUM(                          CASE                              WHEN nettype=2                              THEN satisfied_xdr_count*satisfied_xdr_count                              ELSE 0                          END),2.0) AS data38,                      ROUND( SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN delay                              ELSE 0                          END)/1000/60,2.0) AS data39,                      ROUND(SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN dl_flow                              ELSE 0                          END)/1024/1024,2.0) AS data40,                      ROUND(SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN dl_flow                              ELSE 0                          END)/SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN delay                              ELSE 0                          END)*8000/1024,2.0) AS data41,                      SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN satisfied_xdr_count                              ELSE 0                          END) AS data42,                      SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN satisfied_sucess_xdr_count                              ELSE 0                          END) AS data43 ,                      ROUND(SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN satisfied_sucess_xdr_count                              ELSE 0                          END)/SUM(                          CASE                              WHEN(nettype=1                                  OR  nettype=2)                              THEN satisfied_xdr_count                              ELSE 0                          END),2.0) AS data44,                      SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN satisfied_xdr_count                              ELSE 0                          END) AS data45,                      SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN satisfied_speed_xdr_count                              ELSE 0                          END) AS data46 ,                      ROUND( SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN satisfied_speed_xdr_count                              ELSE 0                          END)/SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN satisfied_xdr_count                              ELSE 0                          END),2.0) AS data47,                      ROUND( SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN satisfied_sucess_xdr_count*satisfied_speed_xdr_count                              ELSE 0                          END)/SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN satisfied_xdr_count*satisfied_xdr_count                              ELSE 0                          END),2.0) AS data48                  FROM                      lte_sys.[@c0]_T_QUALITYSTATISTICS_ALLUSER tb2                  LEFT JOIN                      (                          SELECT                              city,                              SUM(xdr_count) sumcnt,                              SUM(delay)     sumdelay,                              SUM(dl_flow)   sumdl_flow                          FROM                              lte_sys.[@c0]_T_QUALITYSTATISTICS_ALLUSER                          WHERE                              nettype IN (1,2)                          AND hour>='[@c1]'                          AND hour<='[@c2]'                          GROUP BY                              city)tb1                  ON                      tb2.city=tb1.city                  WHERE                      tb2.hour>='[@c1]'                  AND tb2.hour<='[@c2]'                  GROUP BY                      tb2.city,                      tb2.scene1 )t9          LEFT JOIN              (                  SELECT                      tb2.city,                      (                          CASE                              WHEN scene1=1                              THEN '室外用户'                              WHEN scene1=2                              THEN '占用室分的室内稳定用户(有室分)'                              WHEN scene1=3                              THEN '占用宏站的室内稳定用户(无室分)'                              WHEN scene1=4                              THEN '室内稳定用户(占用宏站和室分)'                              ELSE '未知场景'                          END ) AS data2,                      ROUND(SUM(                          CASE                              WHEN nettype=1                              THEN delay                              ELSE 0                          END)/1000/60,2.0) AS data53,                      ROUND(                          CASE                              WHEN MAX(tb1.sumdelay)>0                              THEN SUM(                                      CASE                                          WHEN nettype=1                                          THEN delay                                          ELSE 0                                      END)/MAX(tb1.sumdelay)                              ELSE 0                          END ,2.0)AS data54 ,                      ROUND(SUM(                          CASE                              WHEN nettype=2                              THEN delay                              ELSE 0                          END)/1000/60,2.0) AS data55,                      ROUND(                          CASE                              WHEN MAX(tb1.sumdelay)>0                              THEN SUM(                                      CASE                                          WHEN nettype=2                                          THEN delay                                          ELSE 0                                      END)/MAX(tb1.sumdelay)                              ELSE 0                          END,2.0) AS data56 ,                      ROUND(SUM(                          CASE                              WHEN nettype=1                              THEN dl_flow                              ELSE 0                          END)/1024/1024,2.0) AS data57,                      ROUND(                          CASE                              WHEN MAX(tb1.sumdl_flow)>0                              THEN SUM(                                      CASE                                          WHEN nettype=1                                          THEN dl_flow                                          ELSE 0                                      END)/MAX(tb1.sumdl_flow)                              ELSE 0                          END,2.0) AS data58 ,                      ROUND(SUM(                          CASE                              WHEN nettype=2                              THEN dl_flow                              ELSE 0                          END)/1024/1024,2.0) AS data59,                      ROUND(                          CASE                              WHEN MAX(tb1.sumdl_flow)>0                              THEN SUM(                                      CASE                                          WHEN nettype=2                                          THEN dl_flow                                          ELSE 0                                      END)/MAX(tb1.sumdl_flow)                              ELSE 0                          END,2.0) AS data60 ,                      ROUND(SUM(                          CASE                              WHEN nettype=1                              THEN delay                              ELSE 0                          END)/1000/60,2.0) AS data61,                      ROUND(SUM(                          CASE                              WHEN nettype=1                              THEN dl_flow                              ELSE 0                          END)/1024/1024,2.0) AS data62 ,                      ROUND(                          CASE                              WHEN SUM(                                      CASE                                          WHEN nettype=1                                          THEN delay                                          ELSE 0                                      END)>0                              THEN SUM(                                      CASE                                          WHEN nettype=1                                          THEN dl_flow                                          ELSE 0                                      END)/SUM(                                      CASE                                          WHEN nettype=1                                          THEN delay                                          ELSE 0                                      END)*8000/1024                              ELSE 0                          END,2.0) AS data63,                      SUM(                          CASE                              WHEN nettype=1                              THEN satisfied_xdr_count                              ELSE 0                          END) AS data64,                      SUM(                          CASE                              WHEN nettype=1                              THEN satisfied_sucess_xdr_count                              ELSE 0                          END) AS data65 ,                      ROUND(                          CASE                              WHEN SUM(                                      CASE                                          WHEN nettype=1                                          THEN satisfied_xdr_count                                          ELSE 0                                      END) >0                              THEN SUM(                                      CASE                                          WHEN nettype=1                                          THEN satisfied_sucess_xdr_count                                          ELSE 0                                      END)/SUM(                                      CASE                                          WHEN nettype=1                                          THEN satisfied_xdr_count                                          ELSE 0                                      END)                              ELSE 0                          END ,2.0)AS data66,                      SUM(                          CASE                              WHEN nettype=1                              THEN satisfied_xdr_count                              ELSE 0                          END) AS data67,                      SUM(                          CASE                              WHEN nettype=1                              THEN satisfied_speed_xdr_count                              ELSE 0                          END) AS data68 ,                      ROUND(                          CASE                              WHEN SUM(                                      CASE                                          WHEN nettype=1                                          THEN satisfied_xdr_count                                          ELSE 0                                      END)>0                              THEN SUM(                                      CASE                                          WHEN nettype=1                                          THEN satisfied_speed_xdr_count                                          ELSE 0                                      END)/SUM(                                      CASE                                          WHEN nettype=1                                          THEN satisfied_xdr_count                                          ELSE 0                                      END)                              ELSE 0                          END,2.0) AS data69,                      ROUND(                          CASE                              WHEN SUM(                                      CASE                                          WHEN nettype=1                                          THEN satisfied_xdr_count*satisfied_xdr_count                                          ELSE 0                                      END)>0                              THEN SUM(                                      CASE                                          WHEN nettype=1                                          THEN satisfied_sucess_xdr_count*satisfied_speed_xdr_count                                          ELSE 0                                      END)/SUM(                                      CASE                                          WHEN nettype=1                                          THEN satisfied_xdr_count*satisfied_xdr_count                                          ELSE 0                                      END)                              ELSE 0                          END ,2.0)AS data70,                      ROUND(SUM(                          CASE                              WHEN nettype=2                              THEN delay                              ELSE 0                          END)/1000/60,2.0) AS data71,                      ROUND(SUM(                          CASE                              WHEN nettype=2                              THEN dl_flow                              ELSE 0                          END)/1024/1024,2.0) AS data72,                      ROUND(                          CASE                              WHEN SUM(                                      CASE                                          WHEN nettype=2                                          THEN delay                                          ELSE 0                                      END)>0                              THEN SUM(                                      CASE                                          WHEN nettype=2                                          THEN dl_flow                                          ELSE 0                                      END)/SUM(                                      CASE                                          WHEN nettype=2                                          THEN delay                                          ELSE 0                                      END)*8000/1024                              ELSE 0                          END,2.0) AS data73,                      ROUND(SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN delay                              ELSE 0                          END)/1000/60,2.0) AS data74,                      ROUND(SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN dl_flow                              ELSE 0                          END)/1024/1024,2.0) AS data75,                      ROUND(                          CASE                              WHEN SUM(                                      CASE                                          WHEN nettype=2                                          THEN delay                                          ELSE 0                                      END)>0                              THEN SUM(                                      CASE                                          WHEN (nettype=1                                              OR  nettype=2)                                          THEN dl_flow                                          ELSE 0                                      END)/SUM(                                      CASE                                          WHEN nettype=2                                          THEN delay                                          ELSE 0                                      END)*8000/1024                              ELSE 0                          END,2.0) AS data76,                      SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN satisfied_xdr_count                              ELSE 0                          END) AS data77,                      SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN satisfied_sucess_xdr_count                              ELSE 0                          END) AS data78 ,                      ROUND(                          CASE                              WHEN SUM(                                      CASE                                          WHEN (nettype=1                                              OR  nettype=2)                                          THEN satisfied_xdr_count                                          ELSE 0                                      END)>0                              THEN SUM(                                      CASE                                          WHEN (nettype=1                                              OR  nettype=2)                                          THEN satisfied_sucess_xdr_count                                          ELSE 0                                      END)/SUM(                                      CASE                                          WHEN (nettype=1                                              OR  nettype=2)                                          THEN satisfied_xdr_count                                          ELSE 0                                      END)                              ELSE 0                          END,2.0) AS data79,                      SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN satisfied_xdr_count                              ELSE 0                          END) AS data80,                      SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN satisfied_speed_xdr_count                              ELSE 0                          END) AS data81 ,                      ROUND(                          CASE                              WHEN SUM(                                      CASE                                          WHEN (nettype=1                                              OR  nettype=2)                                          THEN satisfied_xdr_count                                          ELSE 0                                      END) >0                              THEN SUM(                                      CASE                                          WHEN (nettype=1                                              OR  nettype=2)                                          THEN satisfied_speed_xdr_count                                          ELSE 0                                      END)/SUM(                                      CASE                                          WHEN (nettype=1                                              OR  nettype=2)                                          THEN satisfied_xdr_count                                          ELSE 0                                      END)                              ELSE 0                          END,2.0) AS data82,                      ROUND(                          CASE                              WHEN SUM(                                      CASE                                          WHEN (nettype=1                                              OR  nettype=2)                                          THEN satisfied_xdr_count*satisfied_xdr_count                                          ELSE 0                                      END)>0                              THEN SUM(                                      CASE                                          WHEN (nettype=1                                              OR  nettype=2)                                          THEN satisfied_sucess_xdr_count*satisfied_speed_xdr_count                                          ELSE 0                                      END)/SUM(                                      CASE                                          WHEN (nettype=1                                              OR  nettype=2)                                          THEN satisfied_xdr_count*satisfied_xdr_count                                          ELSE 0                                      END)                              ELSE 0                          END,2.0) AS data83                  FROM                      lte_sys.[@c0]_T_QUALITYSTATISTICS_SHAREUSER tb2                  LEFT JOIN                      (                          SELECT                              city,                              SUM(xdr_count) sumcnt,                              SUM(delay)     sumdelay,                              SUM(dl_flow)   sumdl_flow                          FROM                              lte_sys.[@c0]_T_QUALITYSTATISTICS_SHAREUSER                          WHERE                              nettype IN (1,2)                          AND hour>='[@c1]'                          AND hour<='[@c2]'                          GROUP BY                              city)tb1                  ON                      tb2.city=tb1.city                  WHERE                      tb2.hour>='[@c1]'                  AND tb2.hour<='[@c2]'                  GROUP BY                      tb2.city,                      tb2.scene1 )t10          ON              t9.data2=t10.data2          AND t9.city=t10.city          UNION          SELECT              t14.*,              t15.data53 ,              t15.data54 ,              t15.data55 ,              t15.data56 ,              t15.data57 ,              t15.data58 ,              t15.data59 ,              t15.data60 ,              t15.data61 ,              t15.data62 ,              t15.data63 ,              t15.data64 ,              t15.data65 ,              t15.data66 ,              t15.data67 ,              t15.data68 ,              t15.data69 ,              t15.data70 ,              t15.data71 ,              t15.data72 ,              t15.data73 ,              t15.data74 ,              t15.data75 ,              t15.data76 ,              t15.data77 ,              t15.data78 ,              t15.data79 ,              t15.data80 ,              t15.data81 ,              t15.data82 ,              t15.data83          FROM              (                  SELECT                      tb2.city,                      CASE                          WHEN tb2.SCENE2=1                          THEN '高铁用户'                          WHEN tb2.SCENE2=2                          THEN '地铁用户'                          WHEN tb2.SCENE2=3                          THEN '校园用户'                          WHEN tb2.SCENE2=4                          THEN '商业区用户'                          WHEN tb2.SCENE2=5                          THEN '风景区用户'                          WHEN tb2.SCENE2=6                          THEN '居民区用户'                          WHEN tb2.SCENE2=7                          THEN '高速公路'                          ELSE '未知场景'                      END AS DATA2,                      SUM(                          CASE                              WHEN nettype=1                              THEN xdr_count                              ELSE 0                          END) AS data7,                      ROUND( SUM(                          CASE                              WHEN nettype=1                              THEN xdr_count                              ELSE 0                          END)/MAX(tb1.sumcnt),2.0) AS data8 ,                      SUM(                          CASE                              WHEN nettype=2                              THEN xdr_count                              ELSE 0                          END) AS data9,                      ROUND(SUM(                          CASE                              WHEN nettype=2                              THEN xdr_count                              ELSE 0                          END)/MAX(tb1.sumcnt),2.0) AS data10 ,                      ROUND( SUM(                          CASE                              WHEN nettype=1                              THEN delay                              ELSE 0                          END)/1000/60,2.0) AS data11,                      ROUND( SUM(                          CASE                              WHEN nettype=1                              THEN delay                              ELSE 0                          END)/MAX(tb1.sumdelay),2.0) AS data12 ,                      ROUND(SUM(                          CASE                              WHEN nettype=2                              THEN delay                              ELSE 0                          END)/1000/60,2.0) AS data13,                      ROUND(SUM(                          CASE                              WHEN nettype=2                              THEN delay                              ELSE 0                          END)/MAX(tb1.sumdelay),2.0) AS data14 ,                      ROUND(SUM(                          CASE                              WHEN nettype=1                              THEN dl_flow                              ELSE 0                          END)/1024/1024,2.0) AS data15,                      ROUND(SUM(                          CASE                              WHEN nettype=1                              THEN dl_flow                              ELSE 0                          END)/MAX(tb1.sumdl_flow),2.0) AS data16 ,                      ROUND( SUM(                          CASE                              WHEN nettype=2                              THEN dl_flow                              ELSE 0                          END)/1024/1024,2.0) AS data17,                      ROUND( SUM(                          CASE                              WHEN nettype=2                              THEN dl_flow                              ELSE 0                          END)/MAX(tb1.sumdl_flow),2.0) AS data18 ,                      ROUND(SUM(                          CASE                              WHEN nettype=1                              THEN delay                              ELSE 0                          END)/1000/60,2.0) AS data19,                      ROUND(SUM(                          CASE                              WHEN nettype=1                              THEN dl_flow                              ELSE 0                          END)/1024/1024,2.0) AS data20 ,                      ROUND( SUM(                          CASE                              WHEN nettype=1                              THEN dl_flow                              ELSE 0                          END)/SUM(                          CASE                              WHEN nettype=1                              THEN delay                              ELSE 0                          END)*8000/1024,2.0) AS data21,                      SUM(                          CASE                              WHEN nettype=1                              THEN satisfied_xdr_count                              ELSE 0                          END) AS data22,                      SUM(                          CASE                              WHEN nettype=1                              THEN satisfied_sucess_xdr_count                              ELSE 0                          END) AS data23 ,                      ROUND(SUM(                          CASE                              WHEN nettype=1                              THEN satisfied_sucess_xdr_count                              ELSE 0                          END)/SUM(                          CASE                              WHEN nettype=1                              THEN satisfied_xdr_count                              ELSE 0                          END),2.0) AS data24,                      SUM(                          CASE                              WHEN nettype=1                              THEN satisfied_xdr_count                              ELSE 0                          END) AS data25,                      SUM(                          CASE                              WHEN nettype=1                              THEN satisfied_speed_xdr_count                              ELSE 0                          END) AS data26 ,                      ROUND( SUM(                          CASE                              WHEN nettype=1                              THEN satisfied_speed_xdr_count                              ELSE 0                          END)/SUM(                          CASE                              WHEN nettype=1                              THEN satisfied_xdr_count                              ELSE 0                          END),2.0) AS data27,                      ROUND( SUM(                          CASE                              WHEN nettype=1                              THEN satisfied_sucess_xdr_count*satisfied_speed_xdr_count                              ELSE 0                          END)/SUM(                          CASE                              WHEN nettype=1                              THEN satisfied_xdr_count*satisfied_xdr_count                              ELSE 0                          END),2.0) AS data28,                      ROUND(SUM(                          CASE                              WHEN nettype=2                              THEN delay                              ELSE 0                          END)/1000/60,2.0) AS data29,                      ROUND(SUM(                          CASE                              WHEN nettype=2                              THEN dl_flow                              ELSE 0                          END)/1024/1024,2.0) AS data30,                      ROUND( SUM(                          CASE                              WHEN nettype=2                              THEN dl_flow                              ELSE 0                          END)/SUM(                          CASE                              WHEN nettype=2                              THEN delay                              ELSE 0                          END)*8000/1024,2.0) AS data31,                      SUM(                          CASE                              WHEN nettype=2                              THEN satisfied_xdr_count                              ELSE 0                          END) AS data32,                      SUM(                          CASE                              WHEN nettype=2                              THEN satisfied_sucess_xdr_count                              ELSE 0                          END) AS data33 ,                      ROUND( SUM(                          CASE                              WHEN nettype=2                              THEN satisfied_sucess_xdr_count                              ELSE 0                          END)/SUM(                          CASE                              WHEN nettype=2                              THEN satisfied_xdr_count                              ELSE 0                          END),2.0) AS data34,                      SUM(                          CASE                              WHEN nettype=2                              THEN satisfied_xdr_count                              ELSE 0                          END) AS data35,                      SUM(                          CASE                              WHEN nettype=2                              THEN satisfied_speed_xdr_count                              ELSE 0                          END) AS data36 ,                      ROUND( SUM(                          CASE                              WHEN nettype=2                              THEN satisfied_speed_xdr_count                              ELSE 0                          END)/SUM(                          CASE                              WHEN nettype=2                              THEN satisfied_xdr_count                              ELSE 0                          END),2.0) AS data37,                      ROUND(SUM(                          CASE                              WHEN nettype=2                              THEN satisfied_sucess_xdr_count*satisfied_speed_xdr_count                              ELSE 0                          END)/SUM(                          CASE                              WHEN nettype=2                              THEN satisfied_xdr_count*satisfied_xdr_count                              ELSE 0                          END),2.0) AS data38,                      ROUND( SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN delay                              ELSE 0                          END)/1000/60,2.0) AS data39,                      ROUND(SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN dl_flow                              ELSE 0                          END)/1024/1024,2.0) AS data40,                      ROUND(SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN dl_flow                              ELSE 0                          END)/SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN delay                              ELSE 0                          END)*8000/1024,2.0) AS data41,                      SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN satisfied_xdr_count                              ELSE 0                          END) AS data42,                      SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN satisfied_sucess_xdr_count                              ELSE 0                          END) AS data43 ,                      ROUND(SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN satisfied_sucess_xdr_count                              ELSE 0                          END)/SUM(                          CASE                              WHEN(nettype=1                                  OR  nettype=2)                              THEN satisfied_xdr_count                              ELSE 0                          END),2.0) AS data44,                      SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN satisfied_xdr_count                              ELSE 0                          END) AS data45,                      SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN satisfied_speed_xdr_count                              ELSE 0                          END) AS data46 ,                      ROUND( SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN satisfied_speed_xdr_count                              ELSE 0                          END)/SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN satisfied_xdr_count                              ELSE 0                          END),2.0) AS data47,                      ROUND( SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN satisfied_sucess_xdr_count*satisfied_speed_xdr_count                              ELSE 0                          END)/SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN satisfied_xdr_count*satisfied_xdr_count                              ELSE 0                          END),2.0) AS data48                  FROM                      lte_sys.[@c0]_T_QUALITYSTATISTICS_ALLUSER tb2                  LEFT JOIN                      (                          SELECT                              city,                              SUM(xdr_count) sumcnt,                              SUM(delay)     sumdelay,                              SUM(dl_flow)   sumdl_flow                          FROM                              lte_sys.[@c0]_T_QUALITYSTATISTICS_ALLUSER                          WHERE                              nettype IN (1,2)                          AND hour>='[@c1]'                          AND hour<='[@c2]'                          GROUP BY                              city)tb1                  ON                      tb2.city=tb1.city                  WHERE                      tb2.hour>='[@c1]'                  AND tb2.hour<='[@c2]'                  GROUP BY                      tb2.city,                      tb2.scene2 )t14          LEFT JOIN              (                  SELECT                      tb2.city,                      CASE                          WHEN tb2.SCENE2=1                          THEN '高铁用户'                          WHEN tb2.SCENE2=2                          THEN '地铁用户'                          WHEN tb2.SCENE2=3                          THEN '校园用户'                          WHEN tb2.SCENE2=4                          THEN '商业区用户'                          WHEN tb2.SCENE2=5                          THEN '风景区用户'                          WHEN tb2.SCENE2=6                          THEN '居民区用户'                          WHEN tb2.SCENE2=7                          THEN '高速公路'                          ELSE '未知场景'                      END AS DATA2,                      ROUND(SUM(                          CASE                              WHEN nettype=1                              THEN delay                              ELSE 0                          END)/1000/60,2.0) AS data53,                      ROUND(                          CASE                              WHEN MAX(tb1.sumdelay)>0                              THEN SUM(                                      CASE                                          WHEN nettype=1                                          THEN delay                                          ELSE 0                                      END)/MAX(tb1.sumdelay)                              ELSE 0                          END ,2.0)AS data54 ,                      ROUND(SUM(                          CASE                              WHEN nettype=2                              THEN delay                              ELSE 0                          END)/1000/60,2.0) AS data55,                      ROUND(                          CASE                              WHEN MAX(tb1.sumdelay)>0                              THEN SUM(                                      CASE                                          WHEN nettype=2                                          THEN delay                                          ELSE 0                                      END)/MAX(tb1.sumdelay)                              ELSE 0                          END,2.0) AS data56 ,                      ROUND(SUM(                          CASE                              WHEN nettype=1                              THEN dl_flow                              ELSE 0                          END)/1024/1024,2.0) AS data57,                      ROUND(                          CASE                              WHEN MAX(tb1.sumdl_flow)>0                              THEN SUM(                                      CASE                                          WHEN nettype=1                                          THEN dl_flow                                          ELSE 0                                      END)/MAX(tb1.sumdl_flow)                              ELSE 0                          END,2.0) AS data58 ,                      ROUND(SUM(                          CASE                              WHEN nettype=2                              THEN dl_flow                              ELSE 0                          END)/1024/1024,2.0) AS data59,                      ROUND(                          CASE                              WHEN MAX(tb1.sumdl_flow)>0                              THEN SUM(                                      CASE                                          WHEN nettype=2                                          THEN dl_flow                                          ELSE 0                                      END)/MAX(tb1.sumdl_flow)                              ELSE 0                          END,2.0) AS data60 ,                      ROUND(SUM(                          CASE                              WHEN nettype=1                              THEN delay                              ELSE 0                          END)/1000/60,2.0) AS data61,                      ROUND(SUM(                          CASE                              WHEN nettype=1                              THEN dl_flow                              ELSE 0                          END)/1024/1024,2.0) AS data62 ,                      ROUND(                          CASE                              WHEN SUM(                                      CASE                                          WHEN nettype=1                                          THEN delay                                          ELSE 0                                      END)>0                              THEN SUM(                                      CASE                                          WHEN nettype=1                                          THEN dl_flow                                          ELSE 0                                      END)/SUM(                                      CASE                                          WHEN nettype=1                                          THEN delay                                          ELSE 0                                      END)*8000/1024                              ELSE 0                          END,2.0) AS data63,                      SUM(                          CASE                              WHEN nettype=1                              THEN satisfied_xdr_count                              ELSE 0                          END) AS data64,                      SUM(                          CASE                              WHEN nettype=1                              THEN satisfied_sucess_xdr_count                              ELSE 0                          END) AS data65 ,                      ROUND(                          CASE                              WHEN SUM(                                      CASE                                          WHEN nettype=1                                          THEN satisfied_xdr_count                                          ELSE 0                                      END) >0                              THEN SUM(                                      CASE                                          WHEN nettype=1                                          THEN satisfied_sucess_xdr_count                                          ELSE 0                                      END)/SUM(                                      CASE                                          WHEN nettype=1                                          THEN satisfied_xdr_count                                          ELSE 0                                      END)                              ELSE 0                          END ,2.0)AS data66,                      SUM(                          CASE                              WHEN nettype=1                              THEN satisfied_xdr_count                              ELSE 0                          END) AS data67,                      SUM(                          CASE                              WHEN nettype=1                              THEN satisfied_speed_xdr_count                              ELSE 0                          END) AS data68 ,                      ROUND(                          CASE                              WHEN SUM(                                      CASE                                          WHEN nettype=1                                          THEN satisfied_xdr_count                                          ELSE 0                                      END)>0                              THEN SUM(                                      CASE                                          WHEN nettype=1                                          THEN satisfied_speed_xdr_count                                          ELSE 0                                      END)/SUM(                                      CASE                                          WHEN nettype=1                                          THEN satisfied_xdr_count                                          ELSE 0                                      END)                              ELSE 0                          END,2.0) AS data69,                      ROUND(                          CASE                              WHEN SUM(                                      CASE                                          WHEN nettype=1                                          THEN satisfied_xdr_count*satisfied_xdr_count                                          ELSE 0                                      END)>0                              THEN SUM(                                      CASE                                          WHEN nettype=1                                          THEN satisfied_sucess_xdr_count*satisfied_speed_xdr_count                                          ELSE 0                                      END)/SUM(                                      CASE                                          WHEN nettype=1                                          THEN satisfied_xdr_count*satisfied_xdr_count                                          ELSE 0                                      END)                              ELSE 0                          END ,2.0)AS data70,                      ROUND(SUM(                          CASE                              WHEN nettype=2                              THEN delay                              ELSE 0                          END)/1000/60,2.0) AS data71,                      ROUND(SUM(                          CASE                              WHEN nettype=2                              THEN dl_flow                              ELSE 0                          END)/1024/1024,2.0) AS data72,                      ROUND(                          CASE                              WHEN SUM(                                      CASE                                          WHEN nettype=2                                          THEN delay                                          ELSE 0                                      END)>0                              THEN SUM(                                      CASE                                          WHEN nettype=2                                          THEN dl_flow                                          ELSE 0                                      END)/SUM(                                      CASE                                          WHEN nettype=2                                          THEN delay                                          ELSE 0                                      END)*8000/1024                              ELSE 0                          END,2.0) AS data73,                      ROUND(SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN delay                              ELSE 0                          END)/1000/60,2.0) AS data74,                      ROUND(SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN dl_flow                              ELSE 0                          END)/1024/1024,2.0) AS data75,                      ROUND(                          CASE                              WHEN SUM(                                      CASE                                          WHEN nettype=2                                          THEN delay                                          ELSE 0                                      END)>0                              THEN SUM(                                      CASE                                          WHEN (nettype=1                                              OR  nettype=2)                                          THEN dl_flow                                          ELSE 0                                      END)/SUM(                                      CASE                                          WHEN nettype=2                                          THEN delay                                          ELSE 0                                      END)*8000/1024                              ELSE 0                          END,2.0) AS data76,                      SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN satisfied_xdr_count                              ELSE 0                          END) AS data77,                      SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN satisfied_sucess_xdr_count                              ELSE 0                          END) AS data78 ,                      ROUND(                          CASE                              WHEN SUM(                                      CASE                                          WHEN (nettype=1                                              OR  nettype=2)                                          THEN satisfied_xdr_count                                          ELSE 0                                      END)>0                              THEN SUM(                                      CASE                                          WHEN (nettype=1                                              OR  nettype=2)                                          THEN satisfied_sucess_xdr_count                                          ELSE 0                                      END)/SUM(                                      CASE                                          WHEN (nettype=1                                              OR  nettype=2)                                          THEN satisfied_xdr_count                                          ELSE 0                                      END)                              ELSE 0                          END,2.0) AS data79,                      SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN satisfied_xdr_count                              ELSE 0                          END) AS data80,                      SUM(                          CASE                              WHEN (nettype=1                                  OR  nettype=2)                              THEN satisfied_speed_xdr_count                              ELSE 0                          END) AS data81 ,                      ROUND(                          CASE                              WHEN SUM(                                      CASE                                          WHEN (nettype=1                                              OR  nettype=2)                                          THEN satisfied_xdr_count                                          ELSE 0                                      END) >0                              THEN SUM(                                      CASE                                          WHEN (nettype=1                                              OR  nettype=2)                                          THEN satisfied_speed_xdr_count                                          ELSE 0                                      END)/SUM(                                      CASE                                          WHEN (nettype=1                                              OR  nettype=2)                                          THEN satisfied_xdr_count                                          ELSE 0                                      END)                              ELSE 0                          END,2.0) AS data82,                      ROUND(                          CASE                              WHEN SUM(                                      CASE                                          WHEN (nettype=1                                              OR  nettype=2)                                          THEN satisfied_xdr_count*satisfied_xdr_count                                          ELSE 0                                      END)>0                              THEN SUM(                                      CASE                                          WHEN (nettype=1                                              OR  nettype=2)                                          THEN satisfied_sucess_xdr_count*satisfied_speed_xdr_count                                          ELSE 0                                      END)/SUM(                                      CASE                                          WHEN (nettype=1                                              OR  nettype=2)                                          THEN satisfied_xdr_count*satisfied_xdr_count                                          ELSE 0                                      END)                              ELSE 0                          END ,2.0)AS data83                  FROM                      lte_sys.[@c0]_T_QUALITYSTATISTICS_SHAREUSER tb2                  LEFT JOIN                      (                          SELECT                              city,                              SUM(xdr_count) sumcnt,                              SUM(delay)     sumdelay,                              SUM(dl_flow)   sumdl_flow                          FROM                              lte_sys.[@c0]_T_QUALITYSTATISTICS_SHAREUSER                          WHERE                              nettype IN (1,2)                          AND hour>='[@c1]'                          AND hour<='[@c2]'                          GROUP BY                              city)tb1                  ON                      tb2.city=tb1.city                  WHERE                      tb2.hour>='[@c1]'                  AND tb2.hour<='[@c2]'                  GROUP BY                      tb2.city ,                      tb2.scene2 )t15          ON              t14.data2=t15.data2          AND t14.city=t15.city)T  WHERE      t.city='[@c3]' and t.data2!='未知场景'"
      }
    }
  ]
}