{
  "module": "MultiSceneAnalysis.T4",
  "flag": "vertical",
  "configs": [
    {
      "key": "dataMultiSceneAnalysisT4",
      "desc": "LTE室内外场景分析-LTE网络业务模型",
      "config": {
        "parameters": [
          {
            "name": "p_en",
            "columnname": "",
            "type": "string",
            "format": "",
            "conditionid": "c0",
            "symbol": ""
          },
          {
            "name": "starttime",
            "columnname": "",
            "type": "string",
            "format": "",
            "conditionid": "c1",
            "symbol": ""
          },
          {
            "name": "endtime",
            "columnname": "",
            "type": "string",
            "format": "",
            "conditionid": "c2",
            "symbol": ""
          }, {
            "name": "province",
            "columnname": "",
            "type":"string",
            "format": "",
            "conditionid": "c3",
            "symbol":""
          }
        ],
        "value": "SELECT      distinct t.*  FROM      (          SELECT              apt.CATEGORYNAME    AS data1,              apt.BUSSINESSNAME AS data2,              sc.*,              sc1.*,              sc2.*,              sc3.*,              sc4.*,              sc5.*,              sc6.*,              sc8.*          FROM              (                  SELECT                      t1.city as city_1,                      '全网'                                     nettype ,                      AppType                                  data_apptype ,                      AppSubType                               data_appsubtype ,                      SUM(dl_flow)                                 data3 ,                      ROUND(SUM(dl_flow)/MAX(t2.dl_flow1),2.0)     data4 ,                      SUM(xdr_count)                               data5 ,                      ROUND(SUM(xdr_count)/MAX(t2.xdr_count1),2.0) data6 ,                      SUM(delay)                                   data7 ,                      ROUND(SUM(delay)/MAX(t2.delay1),2.0)         data8                  FROM                      lte_sys.[@c0]_T_QUALITYSTATISTICS_ALLUSER t1                  LEFT JOIN                      (                          SELECT                              city,                              SUM(delay)     delay1,                              SUM(xdr_count) xdr_count1 ,                              SUM(dl_flow)   dl_flow1                          FROM                              lte_sys.[@c0]_T_QUALITYSTATISTICS_ALLUSER                          WHERE                              hour>='[@c1]'                          AND hour<='[@c2]'                          GROUP BY                              city) t2                  ON                      t1.city=t2.city                  WHERE                      t1.hour>='[@c1]'                  AND t1.hour<='[@c2]'                  GROUP BY                      t1.city,                      t1.AppType,                      t1.AppSubType) sc          LEFT JOIN              (                  SELECT                      t1.city,                      '室外用户'                                    nettype ,                      AppType                                   data9 ,                      AppSubType                                data10 ,                      SUM(dl_flow)                               data11 ,                      ROUND( SUM(dl_flow)/MAX(t2.dl_flow1),2.0)    cell12 ,                      SUM(xdr_count)                               data13 ,                      ROUND(SUM(xdr_count)/MAX(t2.xdr_count1),2.0) data14 ,                      SUM(delay)                                   data15 ,                      ROUND(SUM(delay)/MAX(t2.delay1),2.0)         data16                  FROM                      lte_sys.[@c0]_T_QUALITYSTATISTICS_ALLUSER t1                  LEFT JOIN                      (                          SELECT                              city,                              SUM(delay)     delay1,                              SUM(xdr_count) xdr_count1 ,                              SUM(dl_flow)   dl_flow1                          FROM                              lte_sys.[@c0]_T_QUALITYSTATISTICS_ALLUSER                          WHERE                              scene1=1                          AND hour>='[@c1]'                          AND hour<='[@c2]'                          GROUP BY                              city) t2                  ON                      t1.city=t2.city                  WHERE                      t1.scene1=1                  AND t1.hour>='[@c1]'                  AND t1.hour<='[@c2]'                  GROUP BY                      t1.city,                      t1.AppType,                      t1.AppSubType ) sc1          ON              sc.city_1=sc1.city          AND sc.data_apptype=sc1.data9          AND sc.data_appsubtype=sc1.data10          LEFT JOIN              (                  SELECT                      t1.city,                      '室内用户'                                     nettype ,                      AppType                                    data17 ,                      AppSubType                                 data18 ,                      SUM(dl_flow)                               data19 ,                      ROUND( SUM(dl_flow)/MAX(t2.dl_flow1) ,2.0)    data20 ,                      SUM(xdr_count)                                data21 ,                      ROUND( SUM(xdr_count)/MAX(t2.xdr_count1),2.0) data22 ,                      SUM(delay)                                    data23 ,                      ROUND( SUM(delay)/MAX(t2.delay1) ,2.0)        data24                  FROM                      lte_sys.[@c0]_T_QUALITYSTATISTICS_ALLUSER t1                  LEFT JOIN                      (                          SELECT                              city,                              SUM(delay)     delay1,                              SUM(xdr_count) xdr_count1 ,                              SUM(dl_flow)   dl_flow1                          FROM                              lte_sys.[@c0]_T_QUALITYSTATISTICS_ALLUSER                          WHERE                              scene1 IN (2,3,4)                          AND hour>='[@c1]'                          AND hour<='[@c2]'                          GROUP BY                              city ) t2                  ON                      t1.city=t2.city                  WHERE                      t1.scene1 IN (2,3,4)                  AND t1.hour>='[@c1]'                  AND t1.hour<='[@c2]'                  GROUP BY                      t1.city,                      t1.AppType,                      t1.AppSubType,                      scene1 ) sc2          ON              sc1.city=sc2.city          AND sc.data_apptype=sc2.data17          AND sc.data_appsubtype=sc2.data18          LEFT JOIN              (                  SELECT                      t1.city,                      '地铁用户'                                    nettype ,                      AppType                                   data25,                      AppSubType                                data26 ,                      SUM(dl_flow)                               data27 ,                      ROUND( SUM(dl_flow)/MAX(t2.dl_flow1),2.0)    data28 ,                      SUM(xdr_count)                               data29 ,                      ROUND(SUM(xdr_count)/MAX(t2.xdr_count1),2.0) data30 ,                      SUM(delay)                                   data31 ,                      ROUND( SUM(delay)/MAX(t2.delay1),2.0)        data32                  FROM                      lte_sys.[@c0]_T_QUALITYSTATISTICS_ALLUSER t1                  LEFT JOIN                      (                          SELECT                              city,                              SUM(delay)     delay1,                              SUM(xdr_count) xdr_count1 ,                              SUM(dl_flow)   dl_flow1                          FROM                              lte_sys.[@c0]_T_QUALITYSTATISTICS_ALLUSER                          WHERE                              scene2 =2                          AND hour>='[@c1]'                          AND hour<='[@c2]'                          GROUP BY                              city ) t2                  ON                      t1.city=t2.city                  WHERE                      t1.scene2 =2                  AND t1.hour>='[@c1]'                  AND t1.hour<='[@c2]'                  GROUP BY                      t1.city,                      t1.AppType,                      t1.AppSubType ) sc3          ON              sc2.city=sc3.city          AND sc.data_apptype=sc3.data25          AND sc.data_appsubtype=sc3.data26          LEFT JOIN              (                  SELECT                      t1.city,                      '高铁用户'                                   nettype ,                      AppType                                  data33 ,                      AppSubType                                data34 ,                      SUM(dl_flow)                                data35 ,                      ROUND(SUM(dl_flow)/MAX(t2.dl_flow1),2.0)     data36 ,                      SUM(xdr_count)                               data37 ,                      ROUND(SUM(xdr_count)/MAX(t2.xdr_count1),2.0) data38 ,                      SUM(delay)                                   data39 ,                      ROUND(SUM(delay)/MAX(t2.delay1),2.0)         data40                  FROM                      lte_sys.[@c0]_T_QUALITYSTATISTICS_ALLUSER t1                  LEFT JOIN                      (                          SELECT                              city,                              SUM(delay)     delay1,                              SUM(xdr_count) xdr_count1 ,                              SUM(dl_flow)   dl_flow1                          FROM                              lte_sys.[@c0]_T_QUALITYSTATISTICS_ALLUSER                          WHERE                              scene2 =1                          AND hour>='[@c1]'                          AND hour<='[@c2]'                          GROUP BY                              city) t2                  ON                      t1.city=t2.city                  WHERE                      t1.scene2 =1                  AND t1.hour>='[@c1]'                  AND t1.hour<='[@c2]'                  GROUP BY                      t1.city,                      t1.AppType,                      t1.AppSubType ) sc4          ON              sc3.city=sc4.city          AND sc.data_apptype=sc4.data33          AND sc.data_appsubtype=sc4.data34          LEFT JOIN              (                  SELECT                      t1.city,                      '校园用户'                                    nettype ,                      AppType                                   data41 ,                      AppSubType                                data42 ,                      SUM(dl_flow)                               data43 ,                      ROUND( SUM(dl_flow)/MAX(t2.dl_flow1),2.0)     data44 ,                      SUM(xdr_count)                                data45 ,                      ROUND( SUM(xdr_count)/MAX(t2.xdr_count1),2.0) data46 ,                      SUM(delay)                                    data47 ,                      ROUND( SUM(delay)/MAX(t2.delay1),2.0)         data48                  FROM                      lte_sys.[@c0]_T_QUALITYSTATISTICS_ALLUSER t1                  LEFT JOIN                      (                          SELECT                              city,                              SUM(delay)     delay1,                              SUM(xdr_count) xdr_count1 ,                              SUM(dl_flow)   dl_flow1                          FROM                              lte_sys.[@c0]_T_QUALITYSTATISTICS_ALLUSER                          WHERE                              scene2 =3                          AND hour>='[@c1]'                          AND hour<='[@c2]'                          GROUP BY                              city) t2                  ON                      t1.city=t2.city                  WHERE                      t1.scene2 =3                  AND t1.hour>='[@c1]'                  AND t1.hour<='[@c2]'                  GROUP BY                      t1.city,                      t1.AppType,                      t1.AppSubType ) sc5          ON              sc4.city=sc5.city          AND sc.data_apptype=sc5.data41          AND sc.data_appsubtype=sc5.data42          LEFT JOIN              (                  SELECT                      t1.city,                      '商业用户'                                   nettype ,                      AppType                                  data49 ,                      AppSubType                                data50 ,                      SUM(dl_flow)                                data51 ,                      ROUND(SUM(dl_flow)/MAX(t2.dl_flow1),2.0)      data52 ,                      SUM(xdr_count)                                data53 ,                      ROUND( SUM(xdr_count)/MAX(t2.xdr_count1),2.0) data54 ,                      SUM(delay)                                    data55 ,                      ROUND(SUM(delay)/MAX(t2.delay1) ,2.0)         data56                  FROM                      lte_sys.[@c0]_T_QUALITYSTATISTICS_ALLUSER t1                  LEFT JOIN                      (                          SELECT                              city,                              SUM(delay)     delay1,                              SUM(xdr_count) xdr_count1 ,                              SUM(dl_flow)   dl_flow1                          FROM                              lte_sys.[@c0]_T_QUALITYSTATISTICS_ALLUSER                          WHERE                              scene2 =4                          AND hour>='[@c1]'                          AND hour<='[@c2]'                          GROUP BY                              city) t2                  ON                      t1.city=t2.city                  WHERE                      t1.scene2 =4                  AND t1.hour>='[@c1]'                  AND t1.hour<='[@c2]'                  GROUP BY                      t1.city,                      t1.AppType,                      t1.AppSubType ) sc6          ON              sc5.city=sc6.city          AND sc.data_apptype=sc6.data49          AND sc.data_appsubtype=sc6.data50          LEFT JOIN              (                  SELECT                      t1.city,                      '风景用户'                                    nettype ,                      AppType                                   data57 ,                      AppSubType                                data58 ,                      SUM(dl_flow)                               data59 ,                      ROUND( SUM(dl_flow)/MAX(t2.dl_flow1),2.0)     data60 ,                      SUM(xdr_count)                                data61 ,                      ROUND( SUM(xdr_count)/MAX(t2.xdr_count1),2.0) data62 ,                      SUM(delay)                                    data63 ,                      ROUND(SUM(delay)/MAX(t2.delay1),2.0)          data64                  FROM                      lte_sys.[@c0]_T_QUALITYSTATISTICS_ALLUSER t1                  LEFT JOIN                      (                          SELECT                              city,                              SUM(delay)     delay1,                              SUM(xdr_count) xdr_count1 ,                              SUM(dl_flow)   dl_flow1                          FROM                              lte_sys.[@c0]_T_QUALITYSTATISTICS_ALLUSER                          WHERE                              scene2 =5                          AND hour>='[@c1]'                          AND hour<='[@c2]'                          GROUP BY                              city) t2                  ON                      t1.city=t2.city                  WHERE                      t1.scene2 =5                  AND t1.hour>='[@c1]'                  AND t1.hour<='[@c2]'                  GROUP BY                      t1.city,                      t1.AppType,                      t1.AppSubType ) sc7          ON              sc6.city=sc7.city          AND sc.data_apptype=sc7.data57          AND sc.data_appsubtype=sc7.data58          LEFT JOIN              (                  SELECT                      t1.city,                      '居民用户'                                     nettype ,                      AppType                                    data65 ,                      AppSubType                                 data66 ,                      SUM(dl_flow)                               data67 ,                      ROUND( SUM(dl_flow)/MAX(t2.dl_flow1) ,2.0)    data68 ,                      SUM(xdr_count)                                data69 ,                      ROUND( SUM(xdr_count)/MAX(t2.xdr_count1),2.0) data70 ,                      SUM(delay)                                    data71 ,                      ROUND( SUM(delay)/MAX(t2.delay1) ,2.0)        data72                  FROM                      lte_sys.[@c0]_T_QUALITYSTATISTICS_ALLUSER t1                  LEFT JOIN                      (                          SELECT                              city,                              SUM(delay)     delay1,                              SUM(xdr_count) xdr_count1 ,                              SUM(dl_flow)   dl_flow1                          FROM                              lte_sys.[@c0]_T_QUALITYSTATISTICS_ALLUSER                          WHERE                              scene2 =6                          AND hour>='[@c1]'                          AND hour<='[@c2]'                          GROUP BY                              city) t2                  ON                      t1.city=t2.city                  WHERE                      t1.scene2 =6                  AND t1.hour>='[@c1]'                  AND t1.hour<='[@c2]'                  GROUP BY                      t1.city,                      t1.AppType,                      t1.AppSubType ) sc8          ON              sc7.city=sc8.city          AND sc.data_apptype=sc8.data65          AND sc.data_appsubtype=sc8.data66          INNER JOIN              lte_sys.[@c0]_T_BASE_CATEGORYTYPE apt          ON              sc.data_AppType=apt.CATEGORYID          AND sc.data_AppSubType=apt.BUSSINESSTYPE)t  WHERE      t.city_1='[@c3]'"
      }
    }
  ]
}