{
  "module": "overallquality",
  "flag": "vertical",
  "configs": [
    {
      "key": "sence_tb2",
      "desc": "获取表3LTE网内业务指标统计（按场景）",
      "config": {
        "parameters": [
          {
            "name": "p_en",
            "columnname": "",
            "type": "string",
            "format": "",
            "conditionid": "c0",
            "symbol": ""
          },
          {
            "name": "starttime",
            "columnname": "",
            "type": "string",
            "format": "",
            "conditionid": "c1",
            "symbol": ""
          },
          {
            "name": "endtime",
            "columnname": "",
            "type": "string",
            "format": "",
            "conditionid": "c2",
            "symbol": ""
          },
          {
            "name": "province",
            "columnname": "",
            "type": "string",
            "format": "",
            "conditionid": "c3",
            "symbol": ""
          }
        ],
        "value": "SELECT      t.*  FROM      (          SELECT              qu.city AS data1,              '全网'    AS data2,              ROUND(                  CASE                      WHEN SUM(qu.tcp_count)>0                      THEN SUM(qu.tcp_ack_delay)/SUM(qu.tcp_count)                      ELSE 0                  END,2.0) AS data5,              ROUND(                  CASE                      WHEN SUM(qu.tcp_count)>0                      THEN SUM(qu.tcp_res_delay)/SUM(qu.tcp_count)                      ELSE 0                  END,2.0)                                AS data7,              ''                                          AS data9,              ''                                          AS data11,              ''                                          AS data13,              ''                                          AS data15,              ''                                          AS data17,              ''                                          AS data19,              ROUND(SUM(qu.dl_flow_500)/1024/1024,2.0)    AS data21,              ROUND(SUM(qu.dl_ack_delay_500)/1000/60,2.0) AS data22,              ROUND(                  CASE                      WHEN SUM(qu.dl_ack_delay_500)>0                      THEN SUM(qu.dl_flow_500)*8000/1024/SUM(qu.dl_ack_delay_500)                      ELSE 0                  END,2.0) AS data23,              ROUND(                  CASE                      WHEN SUM(qu.xdr_count)>0                      THEN SUM(qu.ack_delay)/SUM(qu.xdr_count)                      ELSE 0                  END,2.0)          AS data25,              SUM(qu.xdr_count)     AS data27 ,              SUM(qu.success_count) AS data28,              ROUND(                  CASE                      WHEN SUM(qu.xdr_count)>0                      THEN SUM(qu.success_count)/SUM(qu.xdr_count)                      ELSE 0                  END,2.0)                      AS data29,              SUM(qu.satisfied_xdr_count)       AS data31,              SUM(qu.satisfied_speed_xdr_count) AS data32,              ROUND(                  CASE                      WHEN SUM(qu.satisfied_xdr_count)>0                      THEN SUM(qu.satisfied_speed_xdr_count)/SUM(qu.satisfied_xdr_count)                      ELSE 0                  END,2.0)                       AS data33,              SUM(QU.satisfied_xdr_count)        AS data34 ,              SUM(QU.satisfied_sucess_xdr_count) AS data35,              ROUND(                  CASE                      WHEN SUM(qu.satisfied_xdr_count)>0                      THEN SUM(qu.satisfied_sucess_xdr_count)/SUM(qu.satisfied_xdr_count)                      ELSE 0                  END,2.0) AS data36,              ROUND(SUM(QU.satisfied_speed_xdr_count)/SUM(QU.satisfied_xdr_count)*(SUM              (QU.satisfied_sucess_xdr_count)/SUM(QU.satisfied_xdr_count)),2.0) AS data37,              ROUND(SUM(QU.delay)/1000/60,2.0)                                  AS data39,              ROUND(SUM(qu.dl_flow)/1024/1024,2.0)                              AS data40,              ROUND(                  CASE                      WHEN SUM(qu.delay)>0                      THEN SUM(qu.dl_flow)*8000/1024/SUM(qu.delay)                      ELSE 0                  END,2.0)                             AS data41,              ROUND(SUM(QU.dl_delay_500)/1000/60,2.0)  AS data43 ,              ROUND(SUM(QU.dl_flow_500)/1024/1024,2.0) AS data44,              ROUND(                  CASE                      WHEN SUM(qu.dl_delay_500)>0                      THEN SUM(qu.dl_flow_500)*8000/1024/SUM(qu.dl_delay_500)                      ELSE 0                  END,2.0)                         AS data45,              ROUND(SUM(QU.delay)/1000/60,2.0)     AS data47,              ROUND(SUM(QU.ul_flow)/1024/1024,2.0) AS data48 ,              ROUND(                  CASE                      WHEN SUM(qu.delay)>0                      THEN SUM(qu.ul_flow)/SUM(qu.delay)                      ELSE 0                  END,2.0)                             AS data49,              ROUND(SUM(QU.ul_delay_200)/1000/60,2.0)  AS data51,              ROUND(SUM(QU.ul_flow_200)/1024/1024,2.0) AS data52,              ROUND(                  CASE                      WHEN SUM(qu.ul_delay_200)>0                      THEN SUM(qu.ul_flow_200)*8000/1024/SUM(qu.ul_delay_200)                      ELSE 0                  END,2.0)                             AS data53,              ROUND(SUM(QU.dl_delay_500)/1000/60,2.0)  AS data55,              ROUND(SUM(QU.ul_flow_500)/1024/1024,2.0) AS data56,              ROUND(                  CASE                      WHEN SUM(qu.dl_delay_500)>0                      THEN SUM(qu.ul_flow_500)/SUM(qu.dl_delay_500)                      ELSE 0                  END,2.0) AS data57,              ''           AS data58,              ''           AS data59,              ''           AS data60,              ''           AS data61          FROM              lte_sys.[@c0]_T_QUALITYSTATISTICS_ALLUSER QU          WHERE              nettype=1          AND qu.hour>='[@c1]'          AND qu.hour<='[@c2]'          GROUP BY              qu.city          UNION ALL          SELECT              qu.city AS data1,              CASE                  WHEN qu.scene1=1                  THEN '室外用户'                  WHEN qu.scene1=2                  THEN '占用室分的室内稳定用户(有室分)'                  WHEN qu.scene1=3                  THEN '占用宏站的室内稳定用户(无室分)'                  WHEN qu.scene1=4                  THEN '室内稳定用户(占用宏站和室分)'                  ELSE '未知场景'              END AS data2,              ROUND(                  CASE                      WHEN SUM(qu.tcp_count)>0                      THEN SUM(qu.tcp_ack_delay)/SUM(qu.tcp_count)                      ELSE 0                  END,2.0) AS data5,              ROUND(                  CASE                      WHEN SUM(qu.tcp_count)>0                      THEN SUM(qu.tcp_res_delay)/SUM(qu.tcp_count)                      ELSE 0                  END,2.0)                                AS data7,              ''                                          AS data9,              ''                                          AS data11,              ''                                          AS data13,              ''                                          AS data15,              ''                                          AS data17,              ''                                          AS data19,              ROUND(SUM(qu.dl_flow_500)/1024/1024,2.0)    AS data21,              ROUND(SUM(qu.dl_ack_delay_500)/1000/60,2.0) AS data22,              ROUND(                  CASE                      WHEN SUM(qu.dl_ack_delay_500)>0                      THEN SUM(qu.dl_flow_500)*8000/1024/SUM(qu.dl_ack_delay_500)                      ELSE 0                  END,2.0) AS speed500,              ROUND(                  CASE                      WHEN SUM(qu.xdr_count)>0                      THEN SUM(qu.ack_delay)/SUM(qu.xdr_count)                      ELSE 0                  END,2.0)          AS data25,              SUM(qu.xdr_count)     AS data27 ,              SUM(qu.success_count) AS data28,              ROUND(                  CASE                      WHEN SUM(qu.xdr_count)>0                      THEN SUM(qu.success_count)/SUM(qu.xdr_count)                      ELSE 0                  END,2.0)                      AS data29,              SUM(qu.satisfied_xdr_count)       AS data31,              SUM(qu.satisfied_speed_xdr_count) AS data32,              ROUND(                  CASE                      WHEN SUM(qu.satisfied_xdr_count)>0                      THEN SUM(qu.satisfied_speed_xdr_count)/SUM(qu.satisfied_xdr_count)                      ELSE 0                  END,2.0)                       AS data33,              SUM(QU.satisfied_xdr_count)        AS data34 ,              SUM(QU.satisfied_sucess_xdr_count) AS data35,              ROUND(                  CASE                      WHEN SUM(qu.satisfied_xdr_count)>0                      THEN SUM(qu.satisfied_sucess_xdr_count)/SUM(qu.satisfied_xdr_count)                      ELSE 0                  END,2.0) AS data36,              ROUND(SUM(QU.satisfied_speed_xdr_count)/SUM(QU.satisfied_xdr_count)*(SUM              (QU.satisfied_sucess_xdr_count)/SUM(QU.satisfied_xdr_count)),2.0) AS data37,              ROUND(SUM(QU.delay)/1000/60,2.0)                                  AS data39,              ROUND(SUM(qu.dl_flow)/1024/1024,2.0)                              AS data40,              ROUND(                  CASE                      WHEN SUM(qu.delay)>0                      THEN SUM(qu.dl_flow)*8000/1024/SUM(qu.delay)                      ELSE 0                  END,2.0)                             AS data41,              ROUND(SUM(QU.dl_delay_500)/1000/60,2.0)  AS data43 ,              ROUND(SUM(QU.dl_flow_500)/1024/1024,2.0) AS data44,              ROUND(                  CASE                      WHEN SUM(qu.dl_delay_500)>0                      THEN SUM(qu.dl_flow_500)*8000/1024/SUM(qu.dl_delay_500)                      ELSE 0                  END,2.0)                         AS data45,              ROUND(SUM(QU.delay)/1000/60,2.0)     AS data47,              ROUND(SUM(QU.ul_flow)/1024/1024,2.0) AS data48 ,              ROUND(                  CASE                      WHEN SUM(qu.delay)>0                      THEN SUM(qu.ul_flow)*8000/1024/SUM(qu.delay)                      ELSE 0                  END,2.0)                             AS data49,              ROUND(SUM(QU.ul_delay_200)/1000/60,2.0)  AS data51,              ROUND(SUM(QU.ul_flow_200)/1024/1024,2.0) AS data52,              ROUND(                  CASE                      WHEN SUM(qu.ul_delay_200)>0                      THEN SUM(qu.ul_flow_200)*8000/1024/SUM(qu.ul_delay_200)                      ELSE 0                  END,2.0)                             AS data53,              ROUND(SUM(QU.dl_delay_500)/1000/60,2.0)  AS data55,              ROUND(SUM(QU.ul_flow_500)/1024/1024,2.0) AS data56,              ROUND(                  CASE                      WHEN SUM(qu.dl_delay_500)>0                      THEN SUM(qu.ul_flow_500)*8000/1024/SUM(qu.dl_delay_500)                      ELSE 0                  END,2.0) AS data57,              ''           AS data58,              ''           AS data59,              ''           AS data60,              ''           AS data61          FROM              lte_sys.[@c0]_T_QUALITYSTATISTICS_ALLUSER QU          WHERE              nettype=1          AND qu.hour>='[@c1]'          AND qu.hour<='[@c2]'          GROUP BY              qu.city,              qu.scene1          UNION ALL          SELECT              qu.city AS data1,              CASE                  WHEN qu.scene2=1                  THEN '高铁用户'                  WHEN qu.scene2=2                  THEN '地铁用户'                  WHEN qu.scene2=3                  THEN '校园用户'                  WHEN qu.scene2=4                  THEN '商业区用户'                  WHEN qu.scene2=5                  THEN '风景区用户'                  WHEN qu.scene2=6                  THEN '居民区用户'                  ELSE '未知场景'              END AS data2,              ROUND(                  CASE                      WHEN SUM(qu.tcp_count)>0                      THEN SUM(qu.tcp_ack_delay)/SUM(qu.tcp_count)                      ELSE 0                  END,2.0) AS tcp_ack_delay,              ROUND(                  CASE                      WHEN SUM(qu.tcp_count)>0                      THEN SUM(qu.tcp_res_delay)/SUM(qu.tcp_count)                      ELSE 0                  END,2.0)                               AS tcp_ack_delay,              ''                                          AS DNSDelay,              ''                                       AS DNSQuerySuccessRate ,              ''                                          AS AttachDelay,              ''                                       AS AttachRequestSuccessRate,              ''                                       AS EPSDefaultDelay,              ''                                       AS EPSDefaultDelayRate,              ROUND(SUM(qu.dl_flow_500)/1024/1024,2.0)    AS dl_flow_500,              ROUND(SUM(qu.dl_ack_delay_500)/1000/60,2.0) AS dl_ack_delay_500,              ROUND(                  CASE                      WHEN SUM(qu.dl_ack_delay_500)>0                      THEN SUM(qu.dl_flow_500)*8000/1024/SUM(qu.dl_ack_delay_500)                      ELSE 0                  END,2.0) AS speed500,              ROUND(                  CASE                      WHEN SUM(qu.xdr_count)>0                      THEN SUM(qu.ack_delay)/SUM(qu.xdr_count)                      ELSE 0                  END,2.0)          AS tcp_ack_delay,              SUM(qu.xdr_count)     AS request_count ,              SUM(qu.success_count) AS success_count,              ROUND(                  CASE                      WHEN SUM(qu.xdr_count)>0                      THEN SUM(qu.success_count)/SUM(qu.xdr_count)                      ELSE 0                  END,2.0)                      AS request_success,              SUM(qu.satisfied_xdr_count)       AS sessioncount,              SUM(qu.satisfied_speed_xdr_count) AS USERACCEPTPER,              ROUND(                  CASE                      WHEN SUM(qu.satisfied_xdr_count)>0                      THEN SUM(qu.satisfied_speed_xdr_count)/SUM(qu.satisfied_xdr_count)                      ELSE 0                  END,2.0)                       AS USERACCEPTPERPPT,              SUM(QU.satisfied_xdr_count)        AS request_count_1 ,              SUM(QU.satisfied_sucess_xdr_count) AS success_count_1,              ROUND(                  CASE                      WHEN SUM(qu.satisfied_xdr_count)>0                      THEN SUM(qu.satisfied_sucess_xdr_count)/SUM(qu.satisfied_xdr_count)                      ELSE 0                  END,2.0) AS request_success_1,              ROUND(SUM(QU.satisfied_speed_xdr_count)/SUM(QU.satisfied_xdr_count)*(SUM              (QU.satisfied_sucess_xdr_count)/SUM(QU.satisfied_xdr_count)),2.0) AS USERACCEPT,              ROUND(SUM(QU.delay)/1000/60,2.0)                                  AS DELAY_1,              ROUND(SUM(qu.dl_flow)/1024/1024,2.0)                              AS dl_flow_1,              ROUND(                  CASE                      WHEN SUM(qu.delay)>0                      THEN SUM(qu.dl_flow)*8000/1024/SUM(qu.delay)                      ELSE 0                  END,2.0)                             AS SPEED_1,              ROUND(SUM(QU.dl_delay_500)/1000/60,2.0)  AS DELAY500 ,              ROUND(SUM(QU.dl_flow_500)/1024/1024,2.0) AS FLOW500,              ROUND(                  CASE                      WHEN SUM(qu.dl_delay_500)>0                      THEN SUM(qu.dl_flow_500)*8000/1024/SUM(qu.dl_delay_500)                      ELSE 0                  END,2.0)                         AS SPEED500_1,              ROUND(SUM(QU.delay)/1000/60,2.0)     AS DELAY_2,              ROUND(SUM(QU.ul_flow)/1024/1024,2.0) AS ULDELAY500 ,              ROUND(                  CASE                      WHEN SUM(qu.delay)>0                      THEN SUM(qu.ul_flow)*8000/1024/SUM(qu.delay)                      ELSE 0                  END,2.0)                             AS SPEED_2,              ROUND(SUM(QU.ul_delay_200)/1000/60,2.0)  AS DELAY200,              ROUND(SUM(QU.ul_flow_200)/1024/1024,2.0) AS ULFLOW200,              ROUND(                  CASE                      WHEN SUM(qu.ul_delay_200)>0                      THEN SUM(qu.ul_flow_200)*8000/1024/SUM(qu.ul_delay_200)                      ELSE 0                  END,2.0)                             AS SPEED200,              ROUND(SUM(QU.dl_delay_500)/1000/60,2.0)  AS dl_delay_500,              ROUND(SUM(QU.ul_flow_500)/1024/1024,2.0) AS ul_flow_500,              ROUND(                  CASE                      WHEN SUM(qu.dl_delay_500)>0                      THEN SUM(qu.ul_flow_500)*8000/1024/SUM(qu.dl_delay_500)                      ELSE 0                  END,2.0) AS SPEED500_3,              ''           AS Cell1,              ''           AS Cell2,              ''           AS Cell3,              ''           AS Cell4          FROM              lte_sys.[@c0]_T_QUALITYSTATISTICS_ALLUSER QU          WHERE              nettype=1          AND qu.hour>='[@c1]'          AND qu.hour<='[@c2]'          GROUP BY              qu.city,              qu.scene2 )t  WHERE      data1='[@c3]'  AND data2!='未知场景'  ORDER BY      data2"
      }
    },
    {
      "key": "apptyep_seance_tb2",
      "desc": "获取表3LTE网内业务指标统计（按某个场景下的大类业务）",
      "config": {
        "parameters": [
          {
            "name": "p_en",
            "columnname": "",
            "type": "string",
            "format": "",
            "conditionid": "c0",
            "symbol": ""
          },
          {
            "name": "starttime",
            "columnname": "",
            "type": "string",
            "format": "",
            "conditionid": "c1",
            "symbol": ""
          },
          {
            "name": "endtime",
            "columnname": "",
            "type": "string",
            "format": "",
            "conditionid": "c2",
            "symbol": ""
          },
          {
            "name": "province",
            "columnname": "",
            "type": "string",
            "format": "",
            "conditionid": "c3",
            "symbol": ""
          },
          {
            "name": "sencename",
            "columnname": "",
            "type": "string",
            "format": "",
            "conditionid": "c4",
            "symbol": ""
          }
        ],
        "value": "SELECT DISTINCT      apt.CATEGORYNAME AS data3,      t.*  FROM      (          SELECT              qu.city    AS data1,              '全网'       AS data2,              qu.AppType AS data3_1,              ROUND(                  CASE                      WHEN SUM(qu.tcp_count)>0                      THEN SUM(qu.tcp_ack_delay)/SUM(qu.tcp_count)                      ELSE 0                  END,2.0) AS data5,              ROUND(                  CASE                      WHEN SUM(qu.tcp_count)>0                      THEN SUM(qu.tcp_res_delay)/SUM(qu.tcp_count)                      ELSE 0                  END,2.0)                                AS data7,              ''                                          AS data9,              ''                                          AS data11,              ''                                          AS data13,              ''                                          AS data15,              ''                                          AS data17,              ''                                          AS data19,              ROUND(SUM(qu.dl_flow_500)/1024/1024,2.0)    AS data21,              ROUND(SUM(qu.dl_ack_delay_500)/1000/60,2.0) AS data22,              ROUND(                  CASE                      WHEN SUM(qu.dl_ack_delay_500)>0                      THEN SUM(qu.dl_flow_500)*8000/1024/SUM(qu.dl_ack_delay_500)                      ELSE 0                  END,2.0) AS data23,              ROUND(                  CASE                      WHEN SUM(qu.xdr_count)>0                      THEN SUM(qu.ack_delay)/SUM(qu.xdr_count)                      ELSE 0                  END,2.0)          AS data25,              SUM(qu.xdr_count)     AS data27 ,              SUM(qu.success_count) AS data28,              ROUND(                  CASE                      WHEN SUM(qu.xdr_count)>0                      THEN SUM(qu.success_count)/SUM(qu.xdr_count)                      ELSE 0                  END,2.0)                      AS data29,              SUM(qu.satisfied_xdr_count)       AS data31,              SUM(qu.satisfied_speed_xdr_count) AS data32,              ROUND(                  CASE                      WHEN SUM(qu.satisfied_xdr_count)>0                      THEN SUM(qu.satisfied_speed_xdr_count)/SUM(qu.satisfied_xdr_count)                      ELSE 0                  END,2.0)                       AS data33,              SUM(QU.satisfied_xdr_count)        AS data34 ,              SUM(QU.satisfied_sucess_xdr_count) AS data35,              ROUND(                  CASE                      WHEN SUM(qu.satisfied_xdr_count)>0                      THEN SUM(qu.satisfied_sucess_xdr_count)/SUM(qu.satisfied_xdr_count)                      ELSE 0                  END,2.0) AS data36,              ROUND(SUM(QU.satisfied_speed_xdr_count)/SUM(QU.satisfied_xdr_count)*(SUM              (QU.satisfied_sucess_xdr_count)/SUM(QU.satisfied_xdr_count)),2.0) AS data37,              ROUND(SUM(QU.delay)/1000/60,2.0)                                  AS data39,              ROUND(SUM(qu.dl_flow)/1024/1024,2.0)                              AS data40,              ROUND(                  CASE                      WHEN SUM(qu.delay)>0                      THEN SUM(qu.dl_flow)*8000/1024/SUM(qu.delay)                      ELSE 0                  END,2.0)                             AS data41,              ROUND(SUM(QU.dl_delay_500)/1000/60,2.0)  AS data43 ,              ROUND(SUM(QU.dl_flow_500)/1024/1024,2.0) AS data44,              ROUND(                  CASE                      WHEN SUM(qu.dl_delay_500)>0                      THEN SUM(qu.dl_flow_500)*8000/1024/SUM(qu.dl_delay_500)                      ELSE 0                  END,2.0)                         AS data45,              ROUND(SUM(QU.delay)/1000/60,2.0)     AS data47,              ROUND(SUM(QU.ul_flow)/1024/1024,2.0) AS data48 ,              ROUND(                  CASE                      WHEN SUM(qu.delay)>0                      THEN SUM(qu.ul_flow)/SUM(qu.delay)                      ELSE 0                  END,2.0)                             AS data49,              ROUND(SUM(QU.ul_delay_200)/1000/60,2.0)  AS data51,              ROUND(SUM(QU.ul_flow_200)/1024/1024,2.0) AS data52,              ROUND(                  CASE                      WHEN SUM(qu.ul_delay_200)>0                      THEN SUM(qu.ul_flow_200)*8000/1024/SUM(qu.ul_delay_200)                      ELSE 0                  END,2.0)                             AS data53,              ROUND(SUM(QU.dl_delay_500)/1000/60,2.0)  AS data55,              ROUND(SUM(QU.ul_flow_500)/1024/1024,2.0) AS data56,              ROUND(                  CASE                      WHEN SUM(qu.dl_delay_500)>0                      THEN SUM(qu.ul_flow_500)/SUM(qu.dl_delay_500)                      ELSE 0                  END,2.0) AS data57,              ''           AS data58,              ''           AS data59,              ''           AS data60,              ''           AS data61          FROM              lte_sys.[@c0]_T_QUALITYSTATISTICS_ALLUSER QU          WHERE              nettype=1          AND qu.hour>='[@c1]'          AND qu.hour<='[@c2]'          GROUP BY              qu.city,              qu.AppType          UNION ALL          SELECT              qu.city AS data1,              CASE                  WHEN qu.scene1=1                  THEN '室外用户'                  WHEN qu.scene1=2                  THEN '占用室分的室内稳定用户(有室分)'                  WHEN qu.scene1=3                  THEN '占用宏站的室内稳定用户(无室分)'                  WHEN qu.scene1=4                  THEN '室内稳定用户(占用宏站和室分)'                  ELSE '未知场景'              END        AS data2,              qu.AppType AS data3,              ROUND(                  CASE                      WHEN SUM(qu.tcp_count)>0                      THEN SUM(qu.tcp_ack_delay)/SUM(qu.tcp_count)                      ELSE 0                  END,2.0) AS data5,              ROUND(                  CASE                      WHEN SUM(qu.tcp_count)>0                      THEN SUM(qu.tcp_res_delay)/SUM(qu.tcp_count)                      ELSE 0                  END,2.0)                                AS data7,              ''                                          AS data9,              ''                                          AS data11,              ''                                          AS data13,              ''                                          AS data15,              ''                                          AS data17,              ''                                          AS data19,              ROUND(SUM(qu.dl_flow_500)/1024/1024,2.0)    AS data21,              ROUND(SUM(qu.dl_ack_delay_500)/1000/60,2.0) AS data22,              ROUND(                  CASE                      WHEN SUM(qu.dl_ack_delay_500)>0                      THEN SUM(qu.dl_flow_500)*8000/1024/SUM(qu.dl_ack_delay_500)                      ELSE 0                  END,2.0) AS speed500,              ROUND(                  CASE                      WHEN SUM(qu.xdr_count)>0                      THEN SUM(qu.ack_delay)/SUM(qu.xdr_count)                      ELSE 0                  END,2.0)          AS data25,              SUM(qu.xdr_count)     AS data27 ,              SUM(qu.success_count) AS data28,              ROUND(                  CASE                      WHEN SUM(qu.xdr_count)>0                      THEN SUM(qu.success_count)/SUM(qu.xdr_count)                      ELSE 0                  END,2.0)                      AS data29,              SUM(qu.satisfied_xdr_count)       AS data31,              SUM(qu.satisfied_speed_xdr_count) AS data32,              ROUND(                  CASE                      WHEN SUM(qu.satisfied_xdr_count)>0                      THEN SUM(qu.satisfied_speed_xdr_count)/SUM(qu.satisfied_xdr_count)                      ELSE 0                  END,2.0)                       AS data33,              SUM(QU.satisfied_xdr_count)        AS data34 ,              SUM(QU.satisfied_sucess_xdr_count) AS data35,              ROUND(                  CASE                      WHEN SUM(qu.satisfied_xdr_count)>0                      THEN SUM(qu.satisfied_sucess_xdr_count)/SUM(qu.satisfied_xdr_count)                      ELSE 0                  END,2.0) AS data36,              ROUND(SUM(QU.satisfied_speed_xdr_count)/SUM(QU.satisfied_xdr_count)*(SUM              (QU.satisfied_sucess_xdr_count)/SUM(QU.satisfied_xdr_count)),2.0) AS data37,              ROUND(SUM(QU.delay)/1000/60,2.0)                                  AS data39,              ROUND(SUM(qu.dl_flow)/1024/1024,2.0)                              AS data40,              ROUND(                  CASE                      WHEN SUM(qu.delay)>0                      THEN SUM(qu.dl_flow)*8000/1024/SUM(qu.delay)                      ELSE 0                  END,2.0)                             AS data41,              ROUND(SUM(QU.dl_delay_500)/1000/60,2.0)  AS data43 ,              ROUND(SUM(QU.dl_flow_500)/1024/1024,2.0) AS data44,              ROUND(                  CASE                      WHEN SUM(qu.dl_delay_500)>0                      THEN SUM(qu.dl_flow_500)*8000/1024/SUM(qu.dl_delay_500)                      ELSE 0                  END,2.0)                         AS data45,              ROUND(SUM(QU.delay)/1000/60,2.0)     AS data47,              ROUND(SUM(QU.ul_flow)/1024/1024,2.0) AS data48 ,              ROUND(                  CASE                      WHEN SUM(qu.delay)>0                      THEN SUM(qu.ul_flow)*8000/1024/SUM(qu.delay)                      ELSE 0                  END,2.0)                             AS data49,              ROUND(SUM(QU.ul_delay_200)/1000/60,2.0)  AS data51,              ROUND(SUM(QU.ul_flow_200)/1024/1024,2.0) AS data52,              ROUND(                  CASE                      WHEN SUM(qu.ul_delay_200)>0                      THEN SUM(qu.ul_flow_200)*8000/1024/SUM(qu.ul_delay_200)                      ELSE 0                  END,2.0)                             AS data53,              ROUND(SUM(QU.dl_delay_500)/1000/60,2.0)  AS data55,              ROUND(SUM(QU.ul_flow_500)/1024/1024,2.0) AS data56,              ROUND(                  CASE                      WHEN SUM(qu.dl_delay_500)>0                      THEN SUM(qu.ul_flow_500)*8000/1024/SUM(qu.dl_delay_500)                      ELSE 0                  END,2.0) AS data57,              ''           AS data58,              ''           AS data59,              ''           AS data60,              ''           AS data61          FROM              lte_sys.[@c0]_T_QUALITYSTATISTICS_ALLUSER QU          WHERE              nettype=1          AND qu.hour>='[@c1]'          AND qu.hour<='[@c2]'          GROUP BY              qu.city,              qu.scene1,              qu.AppType          UNION ALL          SELECT              qu.city AS data1,              CASE                  WHEN qu.scene2=1                  THEN '高铁用户'                  WHEN qu.scene2=2                  THEN '地铁用户'                  WHEN qu.scene2=3                  THEN '校园用户'                  WHEN qu.scene2=4                  THEN '商业区用户'                  WHEN qu.scene2=5                  THEN '风景区用户'                  WHEN qu.scene2=6                  THEN '居民区用户'                  ELSE '未知场景'              END        AS data2,              qu.AppType AS data3,              ROUND(                  CASE                      WHEN SUM(qu.tcp_count)>0                      THEN SUM(qu.tcp_ack_delay)/SUM(qu.tcp_count)                      ELSE 0                  END,2.0) AS tcp_ack_delay,              ROUND(                  CASE                      WHEN SUM(qu.tcp_count)>0                      THEN SUM(qu.tcp_res_delay)/SUM(qu.tcp_count)                      ELSE 0                  END,2.0)                               AS tcp_ack_delay,              ''                                          AS DNSDelay,              ''                                       AS DNSQuerySuccessRate ,              ''                                          AS AttachDelay,              ''                                       AS AttachRequestSuccessRate,              ''                                       AS EPSDefaultDelay,              ''                                       AS EPSDefaultDelayRate,              ROUND(SUM(qu.dl_flow_500)/1024/1024,2.0)    AS dl_flow_500,              ROUND(SUM(qu.dl_ack_delay_500)/1000/60,2.0) AS dl_ack_delay_500,              ROUND(                  CASE                      WHEN SUM(qu.dl_ack_delay_500)>0                      THEN SUM(qu.dl_flow_500)*8000/1024/SUM(qu.dl_ack_delay_500)                      ELSE 0                  END,2.0) AS speed500,              ROUND(                  CASE                      WHEN SUM(qu.xdr_count)>0                      THEN SUM(qu.ack_delay)/SUM(qu.xdr_count)                      ELSE 0                  END,2.0)          AS tcp_ack_delay,              SUM(qu.xdr_count)     AS request_count ,              SUM(qu.success_count) AS success_count,              ROUND(                  CASE                      WHEN SUM(qu.xdr_count)>0                      THEN SUM(qu.success_count)/SUM(qu.xdr_count)                      ELSE 0                  END,2.0)                      AS request_success,              SUM(qu.satisfied_xdr_count)       AS sessioncount,              SUM(qu.satisfied_speed_xdr_count) AS USERACCEPTPER,              ROUND(                  CASE                      WHEN SUM(qu.satisfied_xdr_count)>0                      THEN SUM(qu.satisfied_speed_xdr_count)/SUM(qu.satisfied_xdr_count)                      ELSE 0                  END,2.0)                       AS USERACCEPTPERPPT,              SUM(QU.satisfied_xdr_count)        AS request_count_1 ,              SUM(QU.satisfied_sucess_xdr_count) AS success_count_1,              ROUND(                  CASE                      WHEN SUM(qu.satisfied_xdr_count)>0                      THEN SUM(qu.satisfied_sucess_xdr_count)/SUM(qu.satisfied_xdr_count)                      ELSE 0                  END,2.0) AS request_success_1,              ROUND(SUM(QU.satisfied_speed_xdr_count)/SUM(QU.satisfied_xdr_count)*(SUM              (QU.satisfied_sucess_xdr_count)/SUM(QU.satisfied_xdr_count)),2.0) AS USERACCEPT,              ROUND(SUM(QU.delay)/1000/60,2.0)                                  AS DELAY_1,              ROUND(SUM(qu.dl_flow)/1024/1024,2.0)                              AS dl_flow_1,              ROUND(                  CASE                      WHEN SUM(qu.delay)>0                      THEN SUM(qu.dl_flow)*8000/1024/SUM(qu.delay)                      ELSE 0                  END,2.0)                             AS SPEED_1,              ROUND(SUM(QU.dl_delay_500)/1000/60,2.0)  AS DELAY500 ,              ROUND(SUM(QU.dl_flow_500)/1024/1024,2.0) AS FLOW500,              ROUND(                  CASE                      WHEN SUM(qu.dl_delay_500)>0                      THEN SUM(qu.dl_flow_500)*8000/1024/SUM(qu.dl_delay_500)                      ELSE 0                  END,2.0)                         AS SPEED500_1,              ROUND(SUM(QU.delay)/1000/60,2.0)     AS DELAY_2,              ROUND(SUM(QU.ul_flow)/1024/1024,2.0) AS ULDELAY500 ,              ROUND(                  CASE                      WHEN SUM(qu.delay)>0                      THEN SUM(qu.ul_flow)*8000/1024/SUM(qu.delay)                      ELSE 0                  END,2.0)                             AS SPEED_2,              ROUND(SUM(QU.ul_delay_200)/1000/60,2.0)  AS DELAY200,              ROUND(SUM(QU.ul_flow_200)/1024/1024,2.0) AS ULFLOW200,              ROUND(                  CASE                      WHEN SUM(qu.ul_delay_200)>0                      THEN SUM(qu.ul_flow_200)*8000/1024/SUM(qu.ul_delay_200)                      ELSE 0                  END,2.0)                             AS SPEED200,              ROUND(SUM(QU.dl_delay_500)/1000/60,2.0)  AS dl_delay_500,              ROUND(SUM(QU.ul_flow_500)/1024/1024,2.0) AS ul_flow_500,              ROUND(                  CASE                      WHEN SUM(qu.dl_delay_500)>0                      THEN SUM(qu.ul_flow_500)*8000/1024/SUM(qu.dl_delay_500)                      ELSE 0                  END,2.0) AS SPEED500_3,              ''           AS Cell1,              ''           AS Cell2,              ''           AS Cell3,              ''           AS Cell4          FROM              lte_sys.[@c0]_T_QUALITYSTATISTICS_ALLUSER QU          WHERE              nettype=1          AND qu.hour>='[@c1]'          AND qu.hour<='[@c2]'          GROUP BY              qu.city,              qu.scene2,              qu.AppType)t  INNER JOIN      lte_sys.[@c0]_T_BASE_CATEGORYTYPE apt  ON      t.data3_1=apt.CATEGORYID  WHERE      data1='[@c3]'  AND data2='[@c4]'"
      }
    },
    {
      "key": "apptype_tb2",
      "desc": "获取表3LTE网内业务指标统计（按大类业务）",
      "config": {
        "parameters": [
          {
            "name": "p_en",
            "columnname": "",
            "type": "string",
            "format": "",
            "conditionid": "c0",
            "symbol": ""
          },
          {
            "name": "starttime",
            "columnname": "",
            "type": "string",
            "format": "",
            "conditionid": "c1",
            "symbol": ""
          },
          {
            "name": "endtime",
            "columnname": "",
            "type": "string",
            "format": "",
            "conditionid": "c2",
            "symbol": ""
          },
          {
            "name": "province",
            "columnname": "",
            "type": "string",
            "format": "",
            "conditionid": "c3",
            "symbol": ""
          }
        ],
        "value": "SELECT DISTINCT      apt.CATEGORYNAME AS data3,      t.*  FROM      (          SELECT              qu.city    AS data1,              qu.AppType AS data3_1,              ROUND(                  CASE                      WHEN SUM(qu.tcp_count)>0                      THEN SUM(qu.tcp_ack_delay)/SUM(qu.tcp_count)                      ELSE 0                  END,2.0) AS data5,              ROUND(                  CASE                      WHEN SUM(qu.tcp_count)>0                      THEN SUM(qu.tcp_res_delay)/SUM(qu.tcp_count)                      ELSE 0                  END,2.0)                                AS data7,              ''                                          AS data9,              ''                                          AS data11,              ''                                          AS data13,              ''                                          AS data15,              ''                                          AS data17,              ''                                          AS data19,              ROUND(SUM(qu.dl_flow_500)/1024/1024,2.0)    AS data21,              ROUND(SUM(qu.dl_ack_delay_500)/1000/60,2.0) AS data22,              ROUND(                  CASE                      WHEN SUM(qu.dl_ack_delay_500)>0                      THEN SUM(qu.dl_flow_500)*8000/1024/SUM(qu.dl_ack_delay_500)                      ELSE 0                  END,2.0) AS data23,              ROUND(                  CASE                      WHEN SUM(qu.xdr_count)>0                      THEN SUM(qu.ack_delay)/SUM(qu.xdr_count)                      ELSE 0                  END,2.0)          AS data25,              SUM(qu.xdr_count)     AS data27 ,              SUM(qu.success_count) AS data28,              ROUND(                  CASE                      WHEN SUM(qu.xdr_count)>0                      THEN SUM(qu.success_count)/SUM(qu.xdr_count)                      ELSE 0                  END,2.0)                      AS data29,              SUM(qu.satisfied_xdr_count)       AS data31,              SUM(qu.satisfied_speed_xdr_count) AS data32,              ROUND(                  CASE                      WHEN SUM(qu.satisfied_xdr_count)>0                      THEN SUM(qu.satisfied_speed_xdr_count)/SUM(qu.satisfied_xdr_count)                      ELSE 0                  END,2.0)                       AS data33,              SUM(QU.satisfied_xdr_count)        AS data34 ,              SUM(QU.satisfied_sucess_xdr_count) AS data35,              ROUND(                  CASE                      WHEN SUM(qu.satisfied_xdr_count)>0                      THEN SUM(qu.satisfied_sucess_xdr_count)/SUM(qu.satisfied_xdr_count)                      ELSE 0                  END,2.0) AS data36,              ROUND(SUM(QU.satisfied_speed_xdr_count)/SUM(QU.satisfied_xdr_count)*(SUM              (QU.satisfied_sucess_xdr_count)/SUM(QU.satisfied_xdr_count)),2.0) AS data37,              ROUND(SUM(QU.delay)/1000/60,2.0)                                  AS data39,              ROUND(SUM(qu.dl_flow)/1024/1024,2.0)                              AS data40,              ROUND(                  CASE                      WHEN SUM(qu.delay)>0                      THEN SUM(qu.dl_flow)*8000/1024/SUM(qu.delay)                      ELSE 0                  END,2.0)                             AS data41,              ROUND(SUM(QU.dl_delay_500)/1000/60,2.0)  AS data43 ,              ROUND(SUM(QU.dl_flow_500)/1024/1024,2.0) AS data44,              ROUND(                  CASE                      WHEN SUM(qu.dl_delay_500)>0                      THEN SUM(qu.dl_flow_500)*8000/1024/SUM(qu.dl_delay_500)                      ELSE 0                  END,2.0)                         AS data45,              ROUND(SUM(QU.delay)/1000/60,2.0)     AS data47,              ROUND(SUM(QU.ul_flow)/1024/1024,2.0) AS data48 ,              ROUND(                  CASE                      WHEN SUM(qu.delay)>0                      THEN SUM(qu.ul_flow)/SUM(qu.delay)                      ELSE 0                  END,2.0)                             AS data49,              ROUND(SUM(QU.ul_delay_200)/1000/60,2.0)  AS data51,              ROUND(SUM(QU.ul_flow_200)/1024/1024,2.0) AS data52,              ROUND(                  CASE                      WHEN SUM(qu.ul_delay_200)>0                      THEN SUM(qu.ul_flow_200)*8000/1024/SUM(qu.ul_delay_200)                      ELSE 0                  END,2.0)                             AS data53,              ROUND(SUM(QU.dl_delay_500)/1000/60,2.0)  AS data55,              ROUND(SUM(QU.ul_flow_500)/1024/1024,2.0) AS data56,              ROUND(                  CASE                      WHEN SUM(qu.dl_delay_500)>0                      THEN SUM(qu.ul_flow_500)/SUM(qu.dl_delay_500)                      ELSE 0                  END,2.0) AS data57,              ''           AS data58,              ''           AS data59,              ''           AS data60,              ''           AS data61          FROM              lte_sys.[@c0]_T_QUALITYSTATISTICS_ALLUSER QU          WHERE              nettype=1          AND qu.hour>='[@c1]'          AND qu.hour<='[@c2]'          GROUP BY              qu.city,              qu.AppType)t  INNER JOIN      lte_sys.[@c0]_T_BASE_CATEGORYTYPE apt  ON      t.data3_1=apt.CATEGORYID  WHERE      data1='[@c3]'  ORDER BY      data3_1"
      }
    },
    {
      "key": "seance_apptype_tb2",
      "desc": "获取表3LTE网内业务指标统计（按某个大类业务下的场景）",
      "config": {
        "parameters": [
          {
            "name": "p_en",
            "columnname": "",
            "type": "string",
            "format": "",
            "conditionid": "c0",
            "symbol": ""
          },
          {
            "name": "starttime",
            "columnname": "",
            "type": "string",
            "format": "",
            "conditionid": "c1",
            "symbol": ""
          },
          {
            "name": "endtime",
            "columnname": "",
            "type": "string",
            "format": "",
            "conditionid": "c2",
            "symbol": ""
          },
          {
            "name": "province",
            "columnname": "",
            "type": "string",
            "format": "",
            "conditionid": "c3",
            "symbol": ""
          },
          {
            "name": "apptype",
            "columnname": "",
            "type": "string",
            "format": "",
            "conditionid": "c4",
            "symbol": ""
          }
        ],
        "value": "SELECT DISTINCT      apt.CATEGORYNAME AS data3,      t.*  FROM      (          SELECT              qu.city    AS data1,              '全网'       AS data2,              qu.AppType AS data3_1,              ROUND(                  CASE                      WHEN SUM(qu.tcp_count)>0                      THEN SUM(qu.tcp_ack_delay)/SUM(qu.tcp_count)                      ELSE 0                  END,2.0) AS data5,              ROUND(                  CASE                      WHEN SUM(qu.tcp_count)>0                      THEN SUM(qu.tcp_res_delay)/SUM(qu.tcp_count)                      ELSE 0                  END,2.0)                                AS data7,              ''                                          AS data9,              ''                                          AS data11,              ''                                          AS data13,              ''                                          AS data15,              ''                                          AS data17,              ''                                          AS data19,              ROUND(SUM(qu.dl_flow_500)/1024/1024,2.0)    AS data21,              ROUND(SUM(qu.dl_ack_delay_500)/1000/60,2.0) AS data22,              ROUND(                  CASE                      WHEN SUM(qu.dl_ack_delay_500)>0                      THEN SUM(qu.dl_flow_500)*8000/1024/SUM(qu.dl_ack_delay_500)                      ELSE 0                  END,2.0) AS data23,              ROUND(                  CASE                      WHEN SUM(qu.xdr_count)>0                      THEN SUM(qu.ack_delay)/SUM(qu.xdr_count)                      ELSE 0                  END,2.0)          AS data25,              SUM(qu.xdr_count)     AS data27 ,              SUM(qu.success_count) AS data28,              ROUND(                  CASE                      WHEN SUM(qu.xdr_count)>0                      THEN SUM(qu.success_count)/SUM(qu.xdr_count)                      ELSE 0                  END,2.0)                      AS data29,              SUM(qu.satisfied_xdr_count)       AS data31,              SUM(qu.satisfied_speed_xdr_count) AS data32,              ROUND(                  CASE                      WHEN SUM(qu.satisfied_xdr_count)>0                      THEN SUM(qu.satisfied_speed_xdr_count)/SUM(qu.satisfied_xdr_count)                      ELSE 0                  END,2.0)                       AS data33,              SUM(QU.satisfied_xdr_count)        AS data34 ,              SUM(QU.satisfied_sucess_xdr_count) AS data35,              ROUND(                  CASE                      WHEN SUM(qu.satisfied_xdr_count)>0                      THEN SUM(qu.satisfied_sucess_xdr_count)/SUM(qu.satisfied_xdr_count)                      ELSE 0                  END,2.0) AS data36,              ROUND(SUM(QU.satisfied_speed_xdr_count)/SUM(QU.satisfied_xdr_count)*(SUM              (QU.satisfied_sucess_xdr_count)/SUM(QU.satisfied_xdr_count)),2.0) AS data37,              ROUND(SUM(QU.delay)/1000/60,2.0)                                  AS data39,              ROUND(SUM(qu.dl_flow)/1024/1024,2.0)                              AS data40,              ROUND(                  CASE                      WHEN SUM(qu.delay)>0                      THEN SUM(qu.dl_flow)*8000/1024/SUM(qu.delay)                      ELSE 0                  END,2.0)                             AS data41,              ROUND(SUM(QU.dl_delay_500)/1000/60,2.0)  AS data43 ,              ROUND(SUM(QU.dl_flow_500)/1024/1024,2.0) AS data44,              ROUND(                  CASE                      WHEN SUM(qu.dl_delay_500)>0                      THEN SUM(qu.dl_flow_500)*8000/1024/SUM(qu.dl_delay_500)                      ELSE 0                  END,2.0)                         AS data45,              ROUND(SUM(QU.delay)/1000/60,2.0)     AS data47,              ROUND(SUM(QU.ul_flow)/1024/1024,2.0) AS data48 ,              ROUND(                  CASE                      WHEN SUM(qu.delay)>0                      THEN SUM(qu.ul_flow)/SUM(qu.delay)                      ELSE 0                  END,2.0)                             AS data49,              ROUND(SUM(QU.ul_delay_200)/1000/60,2.0)  AS data51,              ROUND(SUM(QU.ul_flow_200)/1024/1024,2.0) AS data52,              ROUND(                  CASE                      WHEN SUM(qu.ul_delay_200)>0                      THEN SUM(qu.ul_flow_200)*8000/1024/SUM(qu.ul_delay_200)                      ELSE 0                  END,2.0)                             AS data53,              ROUND(SUM(QU.dl_delay_500)/1000/60,2.0)  AS data55,              ROUND(SUM(QU.ul_flow_500)/1024/1024,2.0) AS data56,              ROUND(                  CASE                      WHEN SUM(qu.dl_delay_500)>0                      THEN SUM(qu.ul_flow_500)/SUM(qu.dl_delay_500)                      ELSE 0                  END,2.0) AS data57,              ''           AS data58,              ''           AS data59,              ''           AS data60,              ''           AS data61          FROM              lte_sys.[@c0]_T_QUALITYSTATISTICS_ALLUSER QU          WHERE              nettype=1          AND qu.hour>='[@c1]'          AND qu.hour<='[@c2]'          GROUP BY              qu.city,              qu.AppType          UNION ALL          SELECT              qu.city AS data1,              CASE                  WHEN qu.scene1=1                  THEN '室外用户'                  WHEN qu.scene1=2                  THEN '占用室分的室内稳定用户(有室分)'                  WHEN qu.scene1=3                  THEN '占用宏站的室内稳定用户(无室分)'                  WHEN qu.scene1=4                  THEN '室内稳定用户(占用宏站和室分)'                  ELSE '未知场景'              END        AS data2,              qu.AppType AS data3,              ROUND(                  CASE                      WHEN SUM(qu.tcp_count)>0                      THEN SUM(qu.tcp_ack_delay)/SUM(qu.tcp_count)                      ELSE 0                  END,2.0) AS data5,              ROUND(                  CASE                      WHEN SUM(qu.tcp_count)>0                      THEN SUM(qu.tcp_res_delay)/SUM(qu.tcp_count)                      ELSE 0                  END,2.0)                                AS data7,              ''                                          AS data9,              ''                                          AS data11,              ''                                          AS data13,              ''                                          AS data15,              ''                                          AS data17,              ''                                          AS data19,              ROUND(SUM(qu.dl_flow_500)/1024/1024,2.0)    AS data21,              ROUND(SUM(qu.dl_ack_delay_500)/1000/60,2.0) AS data22,              ROUND(                  CASE                      WHEN SUM(qu.dl_ack_delay_500)>0                      THEN SUM(qu.dl_flow_500)*8000/1024/SUM(qu.dl_ack_delay_500)                      ELSE 0                  END,2.0) AS speed500,              ROUND(                  CASE                      WHEN SUM(qu.xdr_count)>0                      THEN SUM(qu.ack_delay)/SUM(qu.xdr_count)                      ELSE 0                  END,2.0)          AS data25,              SUM(qu.xdr_count)     AS data27 ,              SUM(qu.success_count) AS data28,              ROUND(                  CASE                      WHEN SUM(qu.xdr_count)>0                      THEN SUM(qu.success_count)/SUM(qu.xdr_count)                      ELSE 0                  END,2.0)                      AS data29,              SUM(qu.satisfied_xdr_count)       AS data31,              SUM(qu.satisfied_speed_xdr_count) AS data32,              ROUND(                  CASE                      WHEN SUM(qu.satisfied_xdr_count)>0                      THEN SUM(qu.satisfied_speed_xdr_count)/SUM(qu.satisfied_xdr_count)                      ELSE 0                  END,2.0)                       AS data33,              SUM(QU.satisfied_xdr_count)        AS data34 ,              SUM(QU.satisfied_sucess_xdr_count) AS data35,              ROUND(                  CASE                      WHEN SUM(qu.satisfied_xdr_count)>0                      THEN SUM(qu.satisfied_sucess_xdr_count)/SUM(qu.satisfied_xdr_count)                      ELSE 0                  END,2.0) AS data36,              ROUND(SUM(QU.satisfied_speed_xdr_count)/SUM(QU.satisfied_xdr_count)*(SUM              (QU.satisfied_sucess_xdr_count)/SUM(QU.satisfied_xdr_count)),2.0) AS data37,              ROUND(SUM(QU.delay)/1000/60,2.0)                                  AS data39,              ROUND(SUM(qu.dl_flow)/1024/1024,2.0)                              AS data40,              ROUND(                  CASE                      WHEN SUM(qu.delay)>0                      THEN SUM(qu.dl_flow)*8000/1024/SUM(qu.delay)                      ELSE 0                  END,2.0)                             AS data41,              ROUND(SUM(QU.dl_delay_500)/1000/60,2.0)  AS data43 ,              ROUND(SUM(QU.dl_flow_500)/1024/1024,2.0) AS data44,              ROUND(                  CASE                      WHEN SUM(qu.dl_delay_500)>0                      THEN SUM(qu.dl_flow_500)*8000/1024/SUM(qu.dl_delay_500)                      ELSE 0                  END,2.0)                         AS data45,              ROUND(SUM(QU.delay)/1000/60,2.0)     AS data47,              ROUND(SUM(QU.ul_flow)/1024/1024,2.0) AS data48 ,              ROUND(                  CASE                      WHEN SUM(qu.delay)>0                      THEN SUM(qu.ul_flow)*8000/1024/SUM(qu.delay)                      ELSE 0                  END,2.0)                             AS data49,              ROUND(SUM(QU.ul_delay_200)/1000/60,2.0)  AS data51,              ROUND(SUM(QU.ul_flow_200)/1024/1024,2.0) AS data52,              ROUND(                  CASE                      WHEN SUM(qu.ul_delay_200)>0                      THEN SUM(qu.ul_flow_200)*8000/1024/SUM(qu.ul_delay_200)                      ELSE 0                  END,2.0)                             AS data53,              ROUND(SUM(QU.dl_delay_500)/1000/60,2.0)  AS data55,              ROUND(SUM(QU.ul_flow_500)/1024/1024,2.0) AS data56,              ROUND(                  CASE                      WHEN SUM(qu.dl_delay_500)>0                      THEN SUM(qu.ul_flow_500)*8000/1024/SUM(qu.dl_delay_500)                      ELSE 0                  END,2.0) AS data57,              ''           AS data58,              ''           AS data59,              ''           AS data60,              ''           AS data61          FROM              lte_sys.[@c0]_T_QUALITYSTATISTICS_ALLUSER QU          WHERE              nettype=1          AND qu.hour>='[@c1]'          AND qu.hour<='[@c2]'          GROUP BY              qu.city,              qu.scene1,              qu.AppType          UNION ALL          SELECT              qu.city AS data1,              CASE                  WHEN qu.scene2=1                  THEN '高铁用户'                  WHEN qu.scene2=2                  THEN '地铁用户'                  WHEN qu.scene2=3                  THEN '校园用户'                  WHEN qu.scene2=4                  THEN '商业区用户'                  WHEN qu.scene2=5                  THEN '风景区用户'                  WHEN qu.scene2=6                  THEN '居民区用户'                  ELSE '未知场景'              END        AS data2,              qu.AppType AS data3,              ROUND(                  CASE                      WHEN SUM(qu.tcp_count)>0                      THEN SUM(qu.tcp_ack_delay)/SUM(qu.tcp_count)                      ELSE 0                  END,2.0) AS tcp_ack_delay,              ROUND(                  CASE                      WHEN SUM(qu.tcp_count)>0                      THEN SUM(qu.tcp_res_delay)/SUM(qu.tcp_count)                      ELSE 0                  END,2.0)                               AS tcp_ack_delay,              ''                                          AS DNSDelay,              ''                                       AS DNSQuerySuccessRate ,              ''                                          AS AttachDelay,              ''                                       AS AttachRequestSuccessRate,              ''                                       AS EPSDefaultDelay,              ''                                       AS EPSDefaultDelayRate,              ROUND(SUM(qu.dl_flow_500)/1024/1024,2.0)    AS dl_flow_500,              ROUND(SUM(qu.dl_ack_delay_500)/1000/60,2.0) AS dl_ack_delay_500,              ROUND(                  CASE                      WHEN SUM(qu.dl_ack_delay_500)>0                      THEN SUM(qu.dl_flow_500)*8000/1024/SUM(qu.dl_ack_delay_500)                      ELSE 0                  END,2.0) AS speed500,              ROUND(                  CASE                      WHEN SUM(qu.xdr_count)>0                      THEN SUM(qu.ack_delay)/SUM(qu.xdr_count)                      ELSE 0                  END,2.0)          AS tcp_ack_delay,              SUM(qu.xdr_count)     AS request_count ,              SUM(qu.success_count) AS success_count,              ROUND(                  CASE                      WHEN SUM(qu.xdr_count)>0                      THEN SUM(qu.success_count)/SUM(qu.xdr_count)                      ELSE 0                  END,2.0)                      AS request_success,              SUM(qu.satisfied_xdr_count)       AS sessioncount,              SUM(qu.satisfied_speed_xdr_count) AS USERACCEPTPER,              ROUND(                  CASE                      WHEN SUM(qu.satisfied_xdr_count)>0                      THEN SUM(qu.satisfied_speed_xdr_count)/SUM(qu.satisfied_xdr_count)                      ELSE 0                  END,2.0)                       AS USERACCEPTPERPPT,              SUM(QU.satisfied_xdr_count)        AS request_count_1 ,              SUM(QU.satisfied_sucess_xdr_count) AS success_count_1,              ROUND(                  CASE                      WHEN SUM(qu.satisfied_xdr_count)>0                      THEN SUM(qu.satisfied_sucess_xdr_count)/SUM(qu.satisfied_xdr_count)                      ELSE 0                  END,2.0) AS request_success_1,              ROUND(SUM(QU.satisfied_speed_xdr_count)/SUM(QU.satisfied_xdr_count)*(SUM              (QU.satisfied_sucess_xdr_count)/SUM(QU.satisfied_xdr_count)),2.0) AS USERACCEPT,              ROUND(SUM(QU.delay)/1000/60,2.0)                                  AS DELAY_1,              ROUND(SUM(qu.dl_flow)/1024/1024,2.0)                              AS dl_flow_1,              ROUND(                  CASE                      WHEN SUM(qu.delay)>0                      THEN SUM(qu.dl_flow)*8000/1024/SUM(qu.delay)                      ELSE 0                  END,2.0)                             AS SPEED_1,              ROUND(SUM(QU.dl_delay_500)/1000/60,2.0)  AS DELAY500 ,              ROUND(SUM(QU.dl_flow_500)/1024/1024,2.0) AS FLOW500,              ROUND(                  CASE                      WHEN SUM(qu.dl_delay_500)>0                      THEN SUM(qu.dl_flow_500)*8000/1024/SUM(qu.dl_delay_500)                      ELSE 0                  END,2.0)                         AS SPEED500_1,              ROUND(SUM(QU.delay)/1000/60,2.0)     AS DELAY_2,              ROUND(SUM(QU.ul_flow)/1024/1024,2.0) AS ULDELAY500 ,              ROUND(                  CASE                      WHEN SUM(qu.delay)>0                      THEN SUM(qu.ul_flow)*8000/1024/SUM(qu.delay)                      ELSE 0                  END,2.0)                             AS SPEED_2,              ROUND(SUM(QU.ul_delay_200)/1000/60,2.0)  AS DELAY200,              ROUND(SUM(QU.ul_flow_200)/1024/1024,2.0) AS ULFLOW200,              ROUND(                  CASE                      WHEN SUM(qu.ul_delay_200)>0                      THEN SUM(qu.ul_flow_200)*8000/1024/SUM(qu.ul_delay_200)                      ELSE 0                  END,2.0)                             AS SPEED200,              ROUND(SUM(QU.dl_delay_500)/1000/60,2.0)  AS dl_delay_500,              ROUND(SUM(QU.ul_flow_500)/1024/1024,2.0) AS ul_flow_500,              ROUND(                  CASE                      WHEN SUM(qu.dl_delay_500)>0                      THEN SUM(qu.ul_flow_500)*8000/1024/SUM(qu.dl_delay_500)                      ELSE 0                  END,2.0) AS SPEED500_3,              ''           AS Cell1,              ''           AS Cell2,              ''           AS Cell3,              ''           AS Cell4          FROM              lte_sys.[@c0]_T_QUALITYSTATISTICS_ALLUSER QU          WHERE              nettype=1          AND qu.hour>='[@c1]'          AND qu.hour<='[@c2]'          GROUP BY              qu.city,              qu.scene2,              qu.AppType)t  INNER JOIN      lte_sys.[@c0]_T_BASE_CATEGORYTYPE apt  ON      t.data3_1=apt.CATEGORYID  WHERE      data1='[@c3]'  AND apt.CATEGORYNAME='[@c4]'  AND data2<>'未知场景'"
      }
    },
    {
      "key": "sence_tb3",
      "desc": "获取表4LTE网络业务模型（按场景）",
      "config": {
        "parameters": [
          {
            "name": "p_en",
            "columnname": "",
            "type": "string",
            "format": "",
            "conditionid": "c0",
            "symbol": ""
          },
          {
            "name": "starttime",
            "columnname": "",
            "type": "string",
            "format": "",
            "conditionid": "c1",
            "symbol": ""
          },
          {
            "name": "endtime",
            "columnname": "",
            "type": "string",
            "format": "",
            "conditionid": "c2",
            "symbol": ""
          },
          {
            "name": "province",
            "columnname": "",
            "type": "string",
            "format": "",
            "conditionid": "c3",
            "symbol": ""
          }
        ],
        "value": "SELECT      t.*  FROM      (          SELECT              city                              AS data1,              '全网'                                 data2 ,              ROUND(SUM(dl_flow)/1024/1024,2.0)    data3 ,              1                                    data4 ,              SUM(xdr_count)                       data5 ,              1                                    data6 ,              ROUND(SUM(delay)/1000/60,2.0)        data7 ,              1                                    data8          FROM              lte_sys.[@c0]_T_QUALITYSTATISTICS_ALLUSER t1          WHERE              nettype=1          AND t1.hour>='[@c1]'          AND t1.hour<='[@c2]'          GROUP BY              city          UNION          SELECT              aa.city AS data1,              CASE                  WHEN aa.scene1=1                  THEN '室外用户'                  WHEN aa.scene1=2                  THEN '占用室分的室内稳定用户(有室分)'                  WHEN aa.scene1=3                  THEN '占用宏站的室内稳定用户(无室分)'                  WHEN aa.scene1=4                  THEN '室内稳定用户(占用宏站和室分)'                  ELSE '未知场景'              END                                           AS data2,              ROUND(SUM(aa.dl_flow)/1024/1024,2.0)                       AS data3,              ROUND(SUM(AA.dl_flow)/(SUM(SUM(AA.dl_flow)) OVER()),3.0)     AS data4,              SUM(AA.xdr_count)                                            AS data5,              ROUND(SUM(AA.xdr_count)/(SUM(SUM(AA.xdr_count)) OVER()),3.0) AS data6,              ROUND(SUM(AA.DELAY)/1000/60,2.0)                             AS data7,              ROUND(SUM(AA.DELAY)/(SUM(SUM(AA.DELAY)) OVER()),3.0)         AS data8          FROM              (                  SELECT                      city,                      scene1,                      dl_flow,                      xdr_count,                      delay                  FROM                      lte_sys.[@c0]_T_QUALITYSTATISTICS_ALLUSER                  WHERE                      nettype=1                  AND hour>='[@c1]'                  AND hour<='[@c2]') AA          GROUP BY              aa.city,              AA.scene1          UNION          SELECT              aa.city AS data1,              CASE                  WHEN aa.scene2=1                  THEN '高铁用户'                  WHEN aa.scene2=2                  THEN '地铁用户'                  WHEN aa.scene2=3                  THEN '校园用户'                  WHEN aa.scene2=4                  THEN '商业区用户'                  WHEN aa.scene2=5                  THEN '风景区用户'                  WHEN aa.scene2=6                  THEN '居民区用户'                  WHEN aa.scene2=7                  THEN '高速公路'                  ELSE '未知场景'              END                                           AS data2,              ROUND(SUM(aa.dl_flow)/1024/1024,2.0)                       AS data3,              ROUND(SUM(AA.dl_flow)/(SUM(SUM(AA.dl_flow)) OVER()),3.0)     AS data4,              SUM(AA.xdr_count)                                            AS data5,              ROUND(SUM(AA.xdr_count)/(SUM(SUM(AA.xdr_count)) OVER()),3.0) AS data6,              ROUND(SUM(AA.DELAY)/1000/60,2.0)                             AS data7,              ROUND(SUM(AA.DELAY)/(SUM(SUM(AA.DELAY)) OVER()),3.0)         AS data8          FROM              (                  SELECT                      city,                      scene2,                      dl_flow,                      xdr_count,                      delay                  FROM                      lte_sys.[@c0]_T_QUALITYSTATISTICS_ALLUSER                  WHERE                      nettype=1                  AND hour>='[@c1]'                  AND hour<='[@c2]') AA          GROUP BY              aa.city,              AA.scene2 )t  WHERE      data1='[@c3]'  AND data2!='未知场景'"
      }
    },
    {
      "key": "apptyep_seance_tb3",
      "desc": "获取表4LTE网络业务模型（按某个场景下的大类业务）",
      "config": {
        "parameters": [
          {
            "name": "p_en",
            "columnname": "",
            "type": "string",
            "format": "",
            "conditionid": "c0",
            "symbol": ""
          },
          {
            "name": "starttime",
            "columnname": "",
            "type": "string",
            "format": "",
            "conditionid": "c1",
            "symbol": ""
          },
          {
            "name": "endtime",
            "columnname": "",
            "type": "string",
            "format": "",
            "conditionid": "c2",
            "symbol": ""
          },
          {
            "name": "province",
            "columnname": "",
            "type": "string",
            "format": "",
            "conditionid": "c3",
            "symbol": ""
          },
          {
            "name": "sencename",
            "columnname": "",
            "type": "string",
            "format": "",
            "conditionid": "c4",
            "symbol": ""
          }
        ],
        "value": "SELECT DISTINCT      APT.CATEGORYNAME AS DATA3_1,      t.data3,t.data4,t.data5,t.data6,t.data7,t.data8  FROM      (          SELECT              CITY                              AS DATA1,              '全网'                                 DATA2 ,              T1.APPTYPE                        AS DATA3_1,              ROUND(SUM(DL_FLOW)/1024/1024,2.0)    DATA3 ,              1                                    DATA4 ,              SUM(XDR_COUNT)                       DATA5 ,              1                                    DATA6 ,              ROUND(SUM(DELAY)/1000/60,2.0)        DATA7 ,              1                                    DATA8          FROM              LTE_SYS.[@c0]_T_QUALITYSTATISTICS_ALLUSER T1          WHERE              NETTYPE=1          AND T1.HOUR>='[@c1]'          AND T1.HOUR<='[@c2]'          GROUP BY              T1.CITY,              T1.APPTYPE          UNION          SELECT              AA.CITY AS DATA1,              CASE                  WHEN AA.SCENE1=1                  THEN '室外用户'                  WHEN AA.SCENE1=2                  THEN '占用室分的室内稳定用户(有室分)'                  WHEN AA.SCENE1=3                  THEN '占用宏站的室内稳定用户(无室分)'                  WHEN AA.SCENE1=4                  THEN '室内稳定用户(占用宏站和室分)'                  ELSE '未知场景'              END                                           AS DATA2,              AA.APPTYPE                                         AS DATA3_1,              ROUND(SUM(AA.DL_FLOW)/1024/1024,2.0)                       AS DATA3,              ROUND(SUM(AA.DL_FLOW)/(SUM(SUM(AA.DL_FLOW)) OVER()),3.0)     AS DATA4,              SUM(AA.XDR_COUNT)                                            AS DATA5,              ROUND(SUM(AA.XDR_COUNT)/(SUM(SUM(AA.XDR_COUNT)) OVER()),3.0) AS DATA6,              ROUND(SUM(AA.DELAY)/1000/60,2.0)                             AS DATA7,              ROUND(SUM(AA.DELAY)/(SUM(SUM(AA.DELAY)) OVER()),3.0)         AS DATA8          FROM              (                  SELECT                      CITY,                      SCENE1,                      APPTYPE,                      DL_FLOW,                      XDR_COUNT,                      DELAY                  FROM                      LTE_SYS.[@c0]_T_QUALITYSTATISTICS_ALLUSER                  WHERE                      NETTYPE=1                  AND HOUR>='[@c1]'                  AND HOUR<='[@c2]') AA          GROUP BY              AA.CITY,              AA.SCENE1,              AA.APPTYPE          UNION          SELECT              AA.CITY AS DATA1,              CASE                  WHEN AA.SCENE2=1                  THEN '高铁用户'                  WHEN AA.SCENE2=2                  THEN '地铁用户'                  WHEN AA.SCENE2=3                  THEN '校园用户'                  WHEN AA.SCENE2=4                  THEN '商业区用户'                  WHEN AA.SCENE2=5                  THEN '风景区用户'                  WHEN AA.SCENE2=6                  THEN '居民区用户'                  WHEN AA.SCENE2=7                  THEN '高速公路'                  ELSE '未知场景'              END                                           AS DATA2,              AA.APPTYPE                                         AS DATA3_1,              ROUND(SUM(AA.DL_FLOW)/1024/1024,2.0)                       AS DATA3,              ROUND(SUM(AA.DL_FLOW)/(SUM(SUM(AA.DL_FLOW)) OVER()),3.0)     AS DATA4,              SUM(AA.XDR_COUNT)                                            AS DATA5,              ROUND(SUM(AA.XDR_COUNT)/(SUM(SUM(AA.XDR_COUNT)) OVER()),3.0) AS DATA6,              ROUND(SUM(AA.DELAY)/1000/60,2.0)                             AS DATA7,              ROUND(SUM(AA.DELAY)/(SUM(SUM(AA.DELAY)) OVER()),3.0)         AS DATA8          FROM              (                  SELECT                      CITY,                      SCENE2,                      APPTYPE,                      DL_FLOW,                      XDR_COUNT,                      DELAY                  FROM                      LTE_SYS.[@c0]_T_QUALITYSTATISTICS_ALLUSER                  WHERE                      NETTYPE=1                  AND HOUR>='[@c1]'                  AND HOUR<='[@c2]') AA          GROUP BY              AA.CITY,              AA.SCENE2,              AA.APPTYPE )T  INNER JOIN      LTE_SYS.[@c0]_T_BASE_CATEGORYTYPE APT  ON      T.DATA3_1=APT.CATEGORYID  WHERE      DATA1='[@c3]'  AND DATA2='[@c4]'"
      }
    },
    {
      "key": "apptype_tb3",
      "desc": "获取表4LTE网络业务模型（按大类业务）",
      "config": {
        "parameters": [
          {
            "name": "p_en",
            "columnname": "",
            "type": "string",
            "format": "",
            "conditionid": "c0",
            "symbol": ""
          },
          {
            "name": "starttime",
            "columnname": "",
            "type": "string",
            "format": "",
            "conditionid": "c1",
            "symbol": ""
          },
          {
            "name": "endtime",
            "columnname": "",
            "type": "string",
            "format": "",
            "conditionid": "c2",
            "symbol": ""
          },
          {
            "name": "province",
            "columnname": "",
            "type": "string",
            "format": "",
            "conditionid": "c3",
            "symbol": ""
          }
        ],
        "value": "SELECT DISTINCT      apt.CATEGORYNAME AS data2,      t.*  FROM      (          SELECT              aa.city                                           AS data1,              aa.APPTYPE                                         AS data3_1,              ROUND(SUM(aa.dl_flow)/1024/1024,2.0)                       AS data3,              ROUND(SUM(AA.dl_flow)/(SUM(SUM(AA.dl_flow)) OVER()),3.0)     AS data4,              SUM(AA.xdr_count)                                            AS data5,              ROUND(SUM(AA.xdr_count)/(SUM(SUM(AA.xdr_count)) OVER()),3.0) AS data6,              ROUND(SUM(AA.DELAY)/1000/60,2.0)                             AS data7,              ROUND(SUM(AA.DELAY)/(SUM(SUM(AA.DELAY)) OVER()),3.0)         AS data8          FROM              (                  SELECT                      city,                      APPTYPE,                      dl_flow,                      xdr_count,                      delay                  FROM                      lte_sys.[@c0]_T_QUALITYSTATISTICS_ALLUSER                  WHERE                      nettype=1                  AND hour>='[@c1]'                  AND hour<='[@c2]') AA          GROUP BY              aa.city,              AA.APPTYPE )t  INNER JOIN      LTE_SYS.[@c0]_T_BASE_CATEGORYTYPE APT  ON      T.data3_1=APT.CATEGORYID  WHERE      data1='[@c3]'"
      }
    },
    {
      "key": "seance_apptype_tb3",
      "desc": "获取表4LTE网络业务模型（按某个大类业务下的场景）",
      "config": {
        "parameters": [
          {
            "name": "p_en",
            "columnname": "",
            "type": "string",
            "format": "",
            "conditionid": "c0",
            "symbol": ""
          },
          {
            "name": "starttime",
            "columnname": "",
            "type": "string",
            "format": "",
            "conditionid": "c1",
            "symbol": ""
          },
          {
            "name": "endtime",
            "columnname": "",
            "type": "string",
            "format": "",
            "conditionid": "c2",
            "symbol": ""
          },
          {
            "name": "province",
            "columnname": "",
            "type": "string",
            "format": "",
            "conditionid": "c3",
            "symbol": ""
          },
          {
            "name": "apptype",
            "columnname": "",
            "type": "string",
            "format": "",
            "conditionid": "c4",
            "symbol": ""
          }
        ],
        "value": "SELECT DISTINCT      APT.CATEGORYNAME AS DATA3_1,      T.*  FROM      (          SELECT              CITY                              AS DATA1,              '全网'                                 DATA2 ,              T1.APPTYPE                        AS DATA3_1,              ROUND(SUM(DL_FLOW)/1024/1024,2.0)    DATA3 ,              1                                    DATA4 ,              SUM(XDR_COUNT)                       DATA5 ,              1                                    DATA6 ,              ROUND(SUM(DELAY)/1000/60,2.0)        DATA7 ,              1                                    DATA8          FROM              LTE_SYS.[@c0]_T_QUALITYSTATISTICS_ALLUSER T1          WHERE              NETTYPE=1          AND T1.HOUR>='[@c1]'          AND T1.HOUR<='[@c2]'          GROUP BY              T1.CITY,              T1.APPTYPE          UNION          SELECT              AA.CITY AS DATA1,              CASE                  WHEN AA.SCENE1=1                  THEN '室外用户'                  WHEN AA.SCENE1=2                  THEN '占用室分的室内稳定用户(有室分)'                  WHEN AA.SCENE1=3                  THEN '占用宏站的室内稳定用户(无室分)'                  WHEN AA.SCENE1=4                  THEN '室内稳定用户(占用宏站和室分)'                  ELSE '未知场景'              END                                           AS DATA2,              AA.APPTYPE                                         AS DATA3_1,              ROUND(SUM(AA.DL_FLOW)/1024/1024,2.0)                       AS DATA3,              ROUND(SUM(AA.DL_FLOW)/(SUM(SUM(AA.DL_FLOW)) OVER()),3.0)     AS DATA4,              SUM(AA.XDR_COUNT)                                            AS DATA5,              ROUND(SUM(AA.XDR_COUNT)/(SUM(SUM(AA.XDR_COUNT)) OVER()),3.0) AS DATA6,              ROUND(SUM(AA.DELAY)/1000/60,2.0)                             AS DATA7,              ROUND(SUM(AA.DELAY)/(SUM(SUM(AA.DELAY)) OVER()),3.0)         AS DATA8          FROM              (                  SELECT                      CITY,                      SCENE1,                      APPTYPE,                      DL_FLOW,                      XDR_COUNT,                      DELAY                  FROM                      LTE_SYS.[@c0]_T_QUALITYSTATISTICS_ALLUSER                  WHERE                      NETTYPE=1                  AND HOUR>='[@c1]'                  AND HOUR<='[@c2]') AA          GROUP BY              AA.CITY,              AA.SCENE1,              AA.APPTYPE          UNION          SELECT              AA.CITY AS DATA1,              CASE                  WHEN AA.SCENE2=1                  THEN '高铁用户'                  WHEN AA.SCENE2=2                  THEN '地铁用户'                  WHEN AA.SCENE2=3                  THEN '校园用户'                  WHEN AA.SCENE2=4                  THEN '商业区用户'                  WHEN AA.SCENE2=5                  THEN '风景区用户'                  WHEN AA.SCENE2=6                  THEN '居民区用户'                  WHEN AA.SCENE2=7                  THEN '高速公路'                  ELSE '未知场景'              END                                           AS DATA2,              AA.APPTYPE                                         AS DATA3_1,              ROUND(SUM(AA.DL_FLOW)/1024/1024,2.0)                       AS DATA3,              ROUND(SUM(AA.DL_FLOW)/(SUM(SUM(AA.DL_FLOW)) OVER()),3.0)     AS DATA4,              SUM(AA.XDR_COUNT)                                            AS DATA5,              ROUND(SUM(AA.XDR_COUNT)/(SUM(SUM(AA.XDR_COUNT)) OVER()),3.0) AS DATA6,              ROUND(SUM(AA.DELAY)/1000/60,2.0)                             AS DATA7,              ROUND(SUM(AA.DELAY)/(SUM(SUM(AA.DELAY)) OVER()),3.0)         AS DATA8          FROM              (                  SELECT                      CITY,                      SCENE2,                      APPTYPE,                      DL_FLOW,                      XDR_COUNT,                      DELAY                  FROM                      LTE_SYS.[@c0]_T_QUALITYSTATISTICS_ALLUSER                  WHERE                      NETTYPE=1                  AND HOUR>='[@c1]'                  AND HOUR<='[@c2]') AA          GROUP BY              AA.CITY,              AA.SCENE2,              AA.APPTYPE )T  INNER JOIN      LTE_SYS.[@c0]_T_BASE_CATEGORYTYPE APT  ON      T.DATA3_1=APT.CATEGORYID  WHERE      DATA1='[@c3]'  AND APT.CATEGORYNAME='[@c4]'  AND data2<>'未知场景'"
      }
    },

    {
      "key": "sence_tb6",
      "desc": "获取表6网间业务指标统计（按场景）",
      "config": {
        "parameters": [
          {
            "name": "p_en",
            "columnname": "",
            "type": "string",
            "format": "",
            "conditionid": "c0",
            "symbol": ""
          },
          {
            "name": "starttime",
            "columnname": "",
            "type": "string",
            "format": "",
            "conditionid": "c1",
            "symbol": ""
          },
          {
            "name": "endtime",
            "columnname": "",
            "type": "string",
            "format": "",
            "conditionid": "c2",
            "symbol": ""
          },
          {
            "name": "province",
            "columnname": "",
            "type": "string",
            "format": "",
            "conditionid": "c3",
            "symbol": ""
          }
        ],
        "value": "SELECT      city,      data1,      data2,      data3,      data4,      data5,      data6,      data7,      data8,      data9,      data10,      data11,      data12,      data13,      data14,      data15,      data16,      data17,      data18,      data19,      data20,      data21,      data22,      data23,      data24,      data25,      data26,      data27,      data28,      data29,      data30,      data31,      data32,      data33,      data34,      data35,      data36,      data37,      data38,      data39,      data40,      data41,      data42,      data43,      data44,      data45,      data46,      data47,      data48,      data49  FROM      (          SELECT              tb2.city,              '全网' AS data1,              '全网' AS data2,              ROUND(SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>0                      THEN delay                      ELSE 0                  END)/1000/60,2.0) AS data3,              ROUND(SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>0                      THEN delay                      ELSE 0                  END)/MAX(tb1.sumdelay),2.0) AS data4 ,              ROUND(SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>0                      THEN delay                      ELSE 0                  END)/1000/60,2.0) AS data5,              ROUND( SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>0                      THEN delay                      ELSE 0                  END)/MAX(tb1.sumdelay),2.0) AS data6 ,              ROUND(SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>0                      THEN dl_flow                      ELSE 0                  END)/1024/1024,2.0) AS data7,              ROUND( SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>0                      THEN dl_flow                      ELSE 0                  END)/MAX(tb1.sumdl_flow),2.0) AS data8 ,              ROUND( SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>0                      THEN dl_flow                      ELSE 0                  END)/1024/1024,2.0) AS data9,              ROUND( SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>0                      THEN dl_flow                      ELSE 0                  END)/MAX(tb1.sumdl_flow) ,2.0)AS data10 ,              ROUND(SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>0                      THEN delay                      ELSE 0                  END)/1000/60,2.0) AS data41,              ROUND(SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>0                      THEN dl_flow                      ELSE 0                  END)/1024/1024,2.0) AS data42 ,              ROUND( SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>0                      THEN dl_flow                      ELSE 0                  END)/SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>0                      THEN delay                      ELSE 0                  END)*8000/1024,2.0) AS data43,              ROUND(SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>0                      THEN delay                      ELSE 0                  END)/1000/60,2.0) AS data44,              ROUND( SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>0                      THEN dl_flow                      ELSE 0                  END)/1024/1024,2.0) AS data45 ,              ROUND( SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>0                      THEN dl_flow                      ELSE 0                  END)/SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>0                      THEN delay                      ELSE 0                  END)*8000/1024,2.0) AS data46,              ROUND(SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>0                      THEN delay                      ELSE 0                  END)/1000/60,2.0) AS data47,              ROUND( SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>0                      THEN dl_flow                      ELSE 0                  END)/1024/1024,2.0) AS data48,              ROUND(SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>0                      THEN dl_flow                      ELSE 0                  END)/SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>0                      THEN delay                      ELSE 0                  END)*8000/1024,2.0) AS data49 ,              ROUND(SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN delay                      ELSE 0                  END)/1000/60,2.0) AS data11,              ROUND(SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN dl_flow                      ELSE 0                  END)/1024/1024,2.0) AS data12,              ROUND( SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN dl_flow                      ELSE 0                  END)/SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN delay                      ELSE 0                  END)*8000/1024,2.0) AS data13,              SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END) AS data14,              SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN satisfied_sucess_xdr_count                      ELSE 0                  END) AS data15 ,              ROUND(SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN satisfied_sucess_xdr_count                      ELSE 0                  END)/SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END),2.0) AS data16,              SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END) AS data17,              SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN satisfied_speed_xdr_count                      ELSE 0                  END) AS data18 ,              ROUND(SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN satisfied_speed_xdr_count                      ELSE 0                  END)/SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END),2.0) AS data19,              ROUND(SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN satisfied_sucess_xdr_count*satisfied_speed_xdr_count                      ELSE 0                  END)/SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN satisfied_xdr_count*satisfied_xdr_count                      ELSE 0                  END),2.0) AS data20,              ROUND(SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN delay                      ELSE 0                  END)/1000/60,2.0) AS data21,              ROUND(SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN dl_flow                      ELSE 0                  END)/1024/1024,2.0) AS data22,              ROUND( SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN dl_flow                      ELSE 0                  END)/SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN delay                      ELSE 0                  END)*8000/1024,2.0) AS data23,              SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END) AS data24,              SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN satisfied_sucess_xdr_count                      ELSE 0                  END) AS data25 ,              ROUND( SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN satisfied_sucess_xdr_count                      ELSE 0                  END)/SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END),2.0) AS data26,              SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END) AS data27,              SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN satisfied_speed_xdr_count                      ELSE 0                  END) AS data28 ,              ROUND( SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN satisfied_speed_xdr_count                      ELSE 0                  END)/SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END),2.0) AS data29,              ROUND( SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN satisfied_sucess_xdr_count*satisfied_speed_xdr_count                      ELSE 0                  END)/SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN satisfied_xdr_count*satisfied_xdr_count                      ELSE 0                  END),2.0) AS data30,              ROUND( SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN delay                      ELSE 0                  END)/1000/60,2.0) AS data31,              ROUND(SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN dl_flow                      ELSE 0                  END)/1024/1024,2.0) AS data32,              ROUND(SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN dl_flow                      ELSE 0                  END)/SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN delay                      ELSE 0                  END)*8000/1024,2.0) AS data33,              SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END) AS data34,              SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN satisfied_sucess_xdr_count                      ELSE 0                  END) AS data35 ,              ROUND(SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN satisfied_sucess_xdr_count                      ELSE 0                  END)/SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END),2.0) AS data36,              SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END) AS data37,              SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN satisfied_speed_xdr_count                      ELSE 0                  END) AS data38 ,              ROUND(SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN satisfied_speed_xdr_count                      ELSE 0                  END)/SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END),2.0) AS data39,              ROUND( SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN satisfied_sucess_xdr_count*satisfied_speed_xdr_count                      ELSE 0                  END)/SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN satisfied_xdr_count*satisfied_xdr_count                      ELSE 0                  END),2.0) AS data40          FROM              lte_sys.[@c0]_T_QUALITYSTATISTICS_ALLUSER tb2          LEFT JOIN              (                  SELECT                      city,                      SUM(xdr_count) sumcnt,                      SUM(delay)     sumdelay,                      SUM(dl_flow)   sumdl_flow                  FROM                      lte_sys.[@c0]_T_QUALITYSTATISTICS_ALLUSER                  WHERE                      nettype IN (1,2)                  AND AppType IN(15,1,5,6,7,8)                  AND hour>='[@c1]'                  AND hour<='[@c2]'                  GROUP BY                      city)tb1          ON              tb2.city=tb1.city          WHERE              nettype IN (1,2)          AND AppType IN(15,1,5,6,7,8)          AND hour>='[@c1]'          AND hour<='[@c2]'          GROUP BY              tb2.city          UNION          SELECT              tb2.city,              CASE                  WHEN tb2.scene1=1                  THEN '室外用户'                  WHEN tb2.scene1=2                  THEN '占用室分的室内稳定用户(有室分)'                  WHEN tb2.scene1=3                  THEN '占用宏站的室内稳定用户(无室分)'                  WHEN tb2.scene1=4                  THEN '室内稳定用户(占用宏站和室分)'                  ELSE '未知场景'              END AS data1,              CASE                  WHEN tb2.scene1=1                  THEN '室外用户'                  WHEN tb2.scene1=2                  THEN '占用室分的室内稳定用户(有室分)'                  WHEN tb2.scene1=3                  THEN '占用宏站的室内稳定用户(无室分)'                  WHEN tb2.scene1=4                  THEN '室内稳定用户(占用宏站和室分)'                  ELSE '未知场景'              END AS data2,              ROUND(SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>0                      THEN delay                      ELSE 0                  END)/1000/60,2.0) AS data3,              ROUND(SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>0                      THEN delay                      ELSE 0                  END)/MAX(tb1.sumdelay),2.0) AS data4 ,              ROUND(SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>0                      THEN delay                      ELSE 0                  END)/1000/60,2.0) AS data5,              ROUND( SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>0                      THEN delay                      ELSE 0                  END)/MAX(tb1.sumdelay),2.0) AS data6 ,              ROUND(SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>0                      THEN dl_flow                      ELSE 0                  END)/1024/1024,2.0) AS data7,              ROUND( SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>0                      THEN dl_flow                      ELSE 0                  END)/MAX(tb1.sumdl_flow),2.0) AS data8 ,              ROUND( SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>0                      THEN dl_flow                      ELSE 0                  END)/1024/1024,2.0) AS data9,              ROUND( SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>0                      THEN dl_flow                      ELSE 0                  END)/MAX(tb1.sumdl_flow) ,2.0)AS data10 ,              ROUND(SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>0                      THEN delay                      ELSE 0                  END)/1000/60,2.0) AS data41,              ROUND(SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>0                      THEN dl_flow                      ELSE 0                  END)/1024/1024,2.0) AS data42 ,              ROUND( SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>0                      THEN dl_flow                      ELSE 0                  END)/SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>0                      THEN delay                      ELSE 0                  END)*8000/1024,2.0) AS data43,              ROUND(SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>0                      THEN delay                      ELSE 0                  END)/1000/60,2.0) AS data44,              ROUND( SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>0                      THEN dl_flow                      ELSE 0                  END)/1024/1024,2.0) AS data45 ,              ROUND( SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>0                      THEN dl_flow                      ELSE 0                  END)/SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>0                      THEN delay                      ELSE 0                  END)*8000/1024,2.0) AS data46,              ROUND(SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>0                      THEN delay                      ELSE 0                  END)/1000/60,2.0) AS data47,              ROUND( SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>0                      THEN dl_flow                      ELSE 0                  END)/1024/1024,2.0) AS data48,              ROUND(SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>0                      THEN dl_flow                      ELSE 0                  END)/SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>0                      THEN delay                      ELSE 0                  END)*8000/1024,2.0) AS data49 ,              ROUND(SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN delay                      ELSE 0                  END)/1000/60,2.0) AS data11,              ROUND(SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN dl_flow                      ELSE 0                  END)/1024/1024,2.0) AS data12,              ROUND( SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN dl_flow                      ELSE 0                  END)/SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN delay                      ELSE 0                  END)*8000/1024,2.0) AS data13,              SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END) AS data14,              SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN satisfied_sucess_xdr_count                      ELSE 0                  END) AS data15 ,              ROUND(SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN satisfied_sucess_xdr_count                      ELSE 0                  END)/SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END),2.0) AS data16,              SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END) AS data17,              SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN satisfied_speed_xdr_count                      ELSE 0                  END) AS data18 ,              ROUND(SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN satisfied_speed_xdr_count                      ELSE 0                  END)/SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END),2.0) AS data19,              ROUND(SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN satisfied_sucess_xdr_count*satisfied_speed_xdr_count                      ELSE 0                  END)/SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN satisfied_xdr_count*satisfied_xdr_count                      ELSE 0                  END),2.0) AS data20,              ROUND(SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN delay                      ELSE 0                  END)/1000/60,2.0) AS data21,              ROUND(SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN dl_flow                      ELSE 0                  END)/1024/1024,2.0) AS data22,              ROUND( SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN dl_flow                      ELSE 0                  END)/SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN delay                      ELSE 0                  END)*8000/1024,2.0) AS data23,              SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END) AS data24,              SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN satisfied_sucess_xdr_count                      ELSE 0                  END) AS data25 ,              ROUND( SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN satisfied_sucess_xdr_count                      ELSE 0                  END)/SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END),2.0) AS data26,              SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END) AS data27,              SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN satisfied_speed_xdr_count                      ELSE 0                  END) AS data28 ,              ROUND( SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN satisfied_speed_xdr_count                      ELSE 0                  END)/SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END),2.0) AS data29,              ROUND( SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN satisfied_sucess_xdr_count*satisfied_speed_xdr_count                      ELSE 0                  END)/SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN satisfied_xdr_count*satisfied_xdr_count                      ELSE 0                  END),2.0) AS data30,              ROUND( SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN delay                      ELSE 0                  END)/1000/60,2.0) AS data31,              ROUND(SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN dl_flow                      ELSE 0                  END)/1024/1024,2.0) AS data32,              ROUND(SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN dl_flow                      ELSE 0                  END)/SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN delay                      ELSE 0                  END)*8000/1024,2.0) AS data33,              SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END) AS data34,              SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN satisfied_sucess_xdr_count                      ELSE 0                  END) AS data35 ,              ROUND(SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN satisfied_sucess_xdr_count                      ELSE 0                  END)/SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END),2.0) AS data36,              SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END) AS data37,              SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN satisfied_speed_xdr_count                      ELSE 0                  END) AS data38 ,              ROUND(SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN satisfied_speed_xdr_count                      ELSE 0                  END)/SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END),2.0) AS data39,              ROUND( SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN satisfied_sucess_xdr_count*satisfied_speed_xdr_count                      ELSE 0                  END)/SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN satisfied_xdr_count*satisfied_xdr_count                      ELSE 0                  END),2.0) AS data40          FROM              lte_sys.[@c0]_T_QUALITYSTATISTICS_ALLUSER tb2          LEFT JOIN              (                  SELECT                      city,                      scene1,                      SUM(xdr_count) sumcnt,                      SUM(delay)     sumdelay,                      SUM(dl_flow)   sumdl_flow                  FROM                      lte_sys.[@c0]_T_QUALITYSTATISTICS_ALLUSER                  WHERE                      nettype IN (1,2)                  AND AppType IN(15,1,5,6,7,8)                  AND hour>='[@c1]'                  AND hour<='[@c2]'                  GROUP BY                      city,                      scene1)tb1          ON              tb2.city=tb1.city          AND tb2.scene1=tb1.scene1          WHERE              nettype IN (1,2)          AND AppType IN(15,1,5,6,7,8)          AND hour>='[@c1]'          AND hour<='[@c2]'          GROUP BY              tb2.city,              tb2.scene1          UNION          SELECT              tb2.city,              CASE                  WHEN tb2.scene2=1                  THEN '高铁用户'                  WHEN tb2.scene2=2                  THEN '地铁用户'                  WHEN tb2.scene2=3                  THEN '校园用户'                  WHEN tb2.scene2=4                  THEN '商业区用户'                  WHEN tb2.scene2=5                  THEN '风景区用户'                  WHEN tb2.scene2=6                  THEN '居民区用户'                  ELSE '未知场景'              END AS data1,              CASE                  WHEN tb2.scene2=1                  THEN '高铁用户'                  WHEN tb2.scene2=2                  THEN '地铁用户'                  WHEN tb2.scene2=3                  THEN '校园用户'                  WHEN tb2.scene2=4                  THEN '商业区用户'                  WHEN tb2.scene2=5                  THEN '风景区用户'                  WHEN tb2.scene2=6                  THEN '居民区用户'                  ELSE '未知场景'              END AS data1,              ROUND(SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>0                      THEN delay                      ELSE 0                  END)/1000/60,2.0) AS data3,              ROUND(SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>0                      THEN delay                      ELSE 0                  END)/MAX(tb1.sumdelay),2.0) AS data4 ,              ROUND(SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>0                      THEN delay                      ELSE 0                  END)/1000/60,2.0) AS data5,              ROUND( SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>0                      THEN delay                      ELSE 0                  END)/MAX(tb1.sumdelay),2.0) AS data6 ,              ROUND(SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>0                      THEN dl_flow                      ELSE 0                  END)/1024/1024,2.0) AS data7,              ROUND( SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>0                      THEN dl_flow                      ELSE 0                  END)/MAX(tb1.sumdl_flow),2.0) AS data8 ,              ROUND( SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>0                      THEN dl_flow                      ELSE 0                  END)/1024/1024,2.0) AS data9,              ROUND( SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>0                      THEN dl_flow                      ELSE 0                  END)/MAX(tb1.sumdl_flow) ,2.0)AS data10 ,              ROUND(SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>0                      THEN delay                      ELSE 0                  END)/1000/60,2.0) AS data41,              ROUND(SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>0                      THEN dl_flow                      ELSE 0                  END)/1024/1024,2.0) AS data42 ,              ROUND( SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>0                      THEN dl_flow                      ELSE 0                  END)/SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>0                      THEN delay                      ELSE 0                  END)*8000/1024,2.0) AS data43,              ROUND(SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>0                      THEN delay                      ELSE 0                  END)/1000/60,2.0) AS data44,              ROUND( SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>0                      THEN dl_flow                      ELSE 0                  END)/1024/1024,2.0) AS data45 ,              ROUND( SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>0                      THEN dl_flow                      ELSE 0                  END)/SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>0                      THEN delay                      ELSE 0                  END)*8000/1024,2.0) AS data46,              ROUND(SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>0                      THEN delay                      ELSE 0                  END)/1000/60,2.0) AS data47,              ROUND( SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>0                      THEN dl_flow                      ELSE 0                  END)/1024/1024,2.0) AS data48,              ROUND(SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>0                      THEN dl_flow                      ELSE 0                  END)/SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>0                      THEN delay                      ELSE 0                  END)*8000/1024,2.0) AS data49 ,              ROUND(SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN delay                      ELSE 0                  END)/1000/60,2.0) AS data11,              ROUND(SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN dl_flow                      ELSE 0                  END)/1024/1024,2.0) AS data12,              ROUND( SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN dl_flow                      ELSE 0                  END)/SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN delay                      ELSE 0                  END)*8000/1024,2.0) AS data13,              SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END) AS data14,              SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN satisfied_sucess_xdr_count                      ELSE 0                  END) AS data15 ,              ROUND(SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN satisfied_sucess_xdr_count                      ELSE 0                  END)/SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END),2.0) AS data16,              SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END) AS data17,              SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN satisfied_speed_xdr_count                      ELSE 0                  END) AS data18 ,              ROUND(SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN satisfied_speed_xdr_count                      ELSE 0                  END)/SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END),2.0) AS data19,              ROUND(SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN satisfied_sucess_xdr_count*satisfied_speed_xdr_count                      ELSE 0                  END)/SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN satisfied_xdr_count*satisfied_xdr_count                      ELSE 0                  END),2.0) AS data20,              ROUND(SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN delay                      ELSE 0                  END)/1000/60,2.0) AS data21,              ROUND(SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN dl_flow                      ELSE 0                  END)/1024/1024,2.0) AS data22,              ROUND( SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN dl_flow                      ELSE 0                  END)/SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN delay                      ELSE 0                  END)*8000/1024,2.0) AS data23,              SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END) AS data24,              SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN satisfied_sucess_xdr_count                      ELSE 0                  END) AS data25 ,              ROUND( SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN satisfied_sucess_xdr_count                      ELSE 0                  END)/SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END),2.0) AS data26,              SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END) AS data27,              SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN satisfied_speed_xdr_count                      ELSE 0                  END) AS data28 ,              ROUND( SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN satisfied_speed_xdr_count                      ELSE 0                  END)/SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END),2.0) AS data29,              ROUND( SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN satisfied_sucess_xdr_count*satisfied_speed_xdr_count                      ELSE 0                  END)/SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN satisfied_xdr_count*satisfied_xdr_count                      ELSE 0                  END),2.0) AS data30,              ROUND( SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN delay                      ELSE 0                  END)/1000/60,2.0) AS data31,              ROUND(SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN dl_flow                      ELSE 0                  END)/1024/1024,2.0) AS data32,              ROUND(SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN dl_flow                      ELSE 0                  END)/SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN delay                      ELSE 0                  END)*8000/1024,2.0) AS data33,              SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END) AS data34,              SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN satisfied_sucess_xdr_count                      ELSE 0                  END) AS data35 ,              ROUND(SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN satisfied_sucess_xdr_count                      ELSE 0                  END)/SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END),2.0) AS data36,              SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END) AS data37,              SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN satisfied_speed_xdr_count                      ELSE 0                  END) AS data38 ,              ROUND(SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN satisfied_speed_xdr_count                      ELSE 0                  END)/SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END),2.0) AS data39,              ROUND( SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN satisfied_sucess_xdr_count*satisfied_speed_xdr_count                      ELSE 0                  END)/SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN satisfied_xdr_count*satisfied_xdr_count                      ELSE 0                  END),2.0) AS data40          FROM              lte_sys.[@c0]_T_QUALITYSTATISTICS_ALLUSER tb2          LEFT JOIN              (                  SELECT                      city,                      scene2,                      SUM(xdr_count) sumcnt,                      SUM(delay)     sumdelay,                      SUM(dl_flow)   sumdl_flow                  FROM                      lte_sys.[@c0]_T_QUALITYSTATISTICS_ALLUSER                  WHERE                      nettype IN (1,2)                  AND AppType IN(15,1,5,6,7,8)                  AND hour>='[@c1]'                  AND hour<='[@c2]'                  GROUP BY                      city,                      scene2)tb1          ON              tb2.city=tb1.city          AND tb2.scene2=tb1.scene2          WHERE              nettype IN (1,2)          AND AppType IN(15,1,5,6,7,8)          AND hour>='[@c1]'          AND hour<='[@c2]'          GROUP BY              tb2.city,              tb2.scene2          UNION          SELECT              tb2.city,              '室内用户' AS data1,              '室内用户' AS data2,              ROUND(SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>0                      THEN delay                      ELSE 0                  END)/1000/60,2.0) AS data3,              ROUND(SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>0                      THEN delay                      ELSE 0                  END)/MAX(tb1.sumdelay),2.0) AS data4 ,              ROUND(SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>0                      THEN delay                      ELSE 0                  END)/1000/60,2.0) AS data5,              ROUND( SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>0                      THEN delay                      ELSE 0                  END)/MAX(tb1.sumdelay),2.0) AS data6 ,              ROUND(SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>0                      THEN dl_flow                      ELSE 0                  END)/1024/1024,2.0) AS data7,              ROUND( SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>0                      THEN dl_flow                      ELSE 0                  END)/MAX(tb1.sumdl_flow),2.0) AS data8 ,              ROUND( SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>0                      THEN dl_flow                      ELSE 0                  END)/1024/1024,2.0) AS data9,              ROUND( SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>0                      THEN dl_flow                      ELSE 0                  END)/MAX(tb1.sumdl_flow) ,2.0)AS data10 ,              ROUND(SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>0                      THEN delay                      ELSE 0                  END)/1000/60,2.0) AS data41,              ROUND(SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>0                      THEN dl_flow                      ELSE 0                  END)/1024/1024,2.0) AS data42 ,              ROUND( SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>0                      THEN dl_flow                      ELSE 0                  END)/SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>0                      THEN delay                      ELSE 0                  END)*8000/1024,2.0) AS data43,              ROUND(SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>0                      THEN delay                      ELSE 0                  END)/1000/60,2.0) AS data44,              ROUND( SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>0                      THEN dl_flow                      ELSE 0                  END)/1024/1024,2.0) AS data45 ,              ROUND( SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>0                      THEN dl_flow                      ELSE 0                  END)/SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>0                      THEN delay                      ELSE 0                  END)*8000/1024,2.0) AS data46,              ROUND(SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>0                      THEN delay                      ELSE 0                  END)/1000/60,2.0) AS data47,              ROUND( SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>0                      THEN dl_flow                      ELSE 0                  END)/1024/1024,2.0) AS data48,              ROUND(SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>0                      THEN dl_flow                      ELSE 0                  END)/SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>0                      THEN delay                      ELSE 0                  END)*8000/1024,2.0) AS data49 ,              ROUND(SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN delay                      ELSE 0                  END)/1000/60,2.0) AS data11,              ROUND(SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN dl_flow                      ELSE 0                  END)/1024/1024,2.0) AS data12,              ROUND( SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN dl_flow                      ELSE 0                  END)/SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN delay                      ELSE 0                  END)*8000/1024,2.0) AS data13,              SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END) AS data14,              SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN satisfied_sucess_xdr_count                      ELSE 0                  END) AS data15 ,              ROUND(SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN satisfied_sucess_xdr_count                      ELSE 0                  END)/SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END),2.0) AS data16,              SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END) AS data17,              SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN satisfied_speed_xdr_count                      ELSE 0                  END) AS data18 ,              ROUND(SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN satisfied_speed_xdr_count                      ELSE 0                  END)/SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END),2.0) AS data19,              ROUND(SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN satisfied_sucess_xdr_count*satisfied_speed_xdr_count                      ELSE 0                  END)/SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN satisfied_xdr_count*satisfied_xdr_count                      ELSE 0                  END),2.0) AS data20,              ROUND(SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN delay                      ELSE 0                  END)/1000/60,2.0) AS data21,              ROUND(SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN dl_flow                      ELSE 0                  END)/1024/1024,2.0) AS data22,              ROUND( SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN dl_flow                      ELSE 0                  END)/SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN delay                      ELSE 0                  END)*8000/1024,2.0) AS data23,              SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END) AS data24,              SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN satisfied_sucess_xdr_count                      ELSE 0                  END) AS data25 ,              ROUND( SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN satisfied_sucess_xdr_count                      ELSE 0                  END)/SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END),2.0) AS data26,              SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END) AS data27,              SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN satisfied_speed_xdr_count                      ELSE 0                  END) AS data28 ,              ROUND( SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN satisfied_speed_xdr_count                      ELSE 0                  END)/SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END),2.0) AS data29,              ROUND( SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN satisfied_sucess_xdr_count*satisfied_speed_xdr_count                      ELSE 0                  END)/SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN satisfied_xdr_count*satisfied_xdr_count                      ELSE 0                  END),2.0) AS data30,              ROUND( SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN delay                      ELSE 0                  END)/1000/60,2.0) AS data31,              ROUND(SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN dl_flow                      ELSE 0                  END)/1024/1024,2.0) AS data32,              ROUND(SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN dl_flow                      ELSE 0                  END)/SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN delay                      ELSE 0                  END)*8000/1024,2.0) AS data33,              SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END) AS data34,              SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN satisfied_sucess_xdr_count                      ELSE 0                  END) AS data35 ,              ROUND(SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN satisfied_sucess_xdr_count                      ELSE 0                  END)/SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END),2.0) AS data36,              SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END) AS data37,              SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN satisfied_speed_xdr_count                      ELSE 0                  END) AS data38 ,              ROUND(SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN satisfied_speed_xdr_count                      ELSE 0                  END)/SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END),2.0) AS data39,              ROUND( SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN satisfied_sucess_xdr_count*satisfied_speed_xdr_count                      ELSE 0                  END)/SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN satisfied_xdr_count*satisfied_xdr_count                      ELSE 0                  END),2.0) AS data40          FROM              lte_sys.[@c0]_T_QUALITYSTATISTICS_ALLUSER tb2          LEFT JOIN              (                  SELECT                      city,                      SUM(xdr_count) sumcnt,                      SUM(delay)     sumdelay,                      SUM(dl_flow)   sumdl_flow                  FROM                      lte_sys.[@c0]_T_QUALITYSTATISTICS_ALLUSER                  WHERE                      nettype IN (1,2)                  AND AppType IN(15,1,5,6,7,8)                  AND hour>='[@c1]'                  AND hour<='[@c2]'                  AND scene1<>1                  GROUP BY                      city)tb1          ON              tb2.city=tb1.city          WHERE              nettype IN (1,2)          AND AppType IN(15,1,5,6,7,8)          AND hour>='[@c1]'          AND hour<='[@c2]'          AND scene1<>1          GROUP BY              tb2.city ) T  WHERE      t.city='[@c3]'  AND t.data1!='未知场景'  ORDER BY      t.data1"
      }
    },
    {
      "key": "apptyep_seance_tb6",
      "desc": "获取表6网间业务指标统计（按某个场景下的大类业务）",
      "config": {
        "parameters": [
          {
            "name": "p_en",
            "columnname": "",
            "type": "string",
            "format": "",
            "conditionid": "c0",
            "symbol": ""
          },
          {
            "name": "starttime",
            "columnname": "",
            "type": "string",
            "format": "",
            "conditionid": "c1",
            "symbol": ""
          },
          {
            "name": "endtime",
            "columnname": "",
            "type": "string",
            "format": "",
            "conditionid": "c2",
            "symbol": ""
          },
          {
            "name": "province",
            "columnname": "",
            "type": "string",
            "format": "",
            "conditionid": "c3",
            "symbol": ""
          },
          {
            "name": "sencename",
            "columnname": "",
            "type": "string",
            "format": "",
            "conditionid": "c4",
            "symbol": ""
          }
        ],
        "value": "SELECT      city,      data1,      data2,      data3,      data4,      data5,      data6,      data7,      data8,      data9,      data10,      data11,      data12,      data13,      data14,      data15,      data16,      data17,      data18,      data19,      data20,      data21,      data22,      data23,      data24,      data25,      data26,      data27,      data28,      data29,      data30,      data31,      data32,      data33,      data34,      data35,      data36,      data37,      data38,      data39,      data40,      data41,      data42,      data43,      data44,      data45,      data46,      data47,      data48,      data49  FROM      (          SELECT              tb2.city,              '全网' AS data1,              (                  CASE                      WHEN AppType=1                      THEN '即时通信'                      WHEN AppType=15                      THEN '浏览下载'                      WHEN AppType=5                      THEN '视频'                      WHEN AppType=6                      THEN '音乐'                      WHEN AppType=7                      THEN '应用商店'                      WHEN AppType=8                      THEN '游戏'                  END ) AS data2,              ROUND(SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>0                      THEN delay                      ELSE 0                  END)/1000/60,2.0) AS data3,              ROUND(SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>0                      THEN delay                      ELSE 0                  END)/MAX(tb1.sumdelay),2.0) AS data4 ,              ROUND(SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>0                      THEN delay                      ELSE 0                  END)/1000/60,2.0) AS data5,              ROUND( SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>0                      THEN delay                      ELSE 0                  END)/MAX(tb1.sumdelay),2.0) AS data6 ,              ROUND(SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>0                      THEN dl_flow                      ELSE 0                  END)/1024/1024,2.0) AS data7,              ROUND( SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>0                      THEN dl_flow                      ELSE 0                  END)/MAX(tb1.sumdl_flow),2.0) AS data8 ,              ROUND( SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>0                      THEN dl_flow                      ELSE 0                  END)/1024/1024,2.0) AS data9,              ROUND( SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>0                      THEN dl_flow                      ELSE 0                  END)/MAX(tb1.sumdl_flow) ,2.0)AS data10 ,              ROUND(SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>0                      THEN delay                      ELSE 0                  END)/1000/60,2.0) AS data41,              ROUND(SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>0                      THEN dl_flow                      ELSE 0                  END)/1024/1024,2.0) AS data42 ,              ROUND( SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>0                      THEN dl_flow                      ELSE 0                  END)/SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>0                      THEN delay                      ELSE 0                  END)*8000/1024,2.0) AS data43,              ROUND(SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>0                      THEN delay                      ELSE 0                  END)/1000/60,2.0) AS data44,              ROUND( SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>0                      THEN dl_flow                      ELSE 0                  END)/1024/1024,2.0) AS data45 ,              ROUND( SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>0                      THEN dl_flow                      ELSE 0                  END)/SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>0                      THEN delay                      ELSE 0                  END)*8000/1024,2.0) AS data46,              ROUND(SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>0                      THEN delay                      ELSE 0                  END)/1000/60,2.0) AS data47,              ROUND( SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>0                      THEN dl_flow                      ELSE 0                  END)/1024/1024,2.0) AS data48,              ROUND(SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>0                      THEN dl_flow                      ELSE 0                  END)/SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>0                      THEN delay                      ELSE 0                  END)*8000/1024,2.0) AS data49 ,              ROUND(SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN delay                      ELSE 0                  END)/1000/60,2.0) AS data11,              ROUND(SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN dl_flow                      ELSE 0                  END)/1024/1024,2.0) AS data12,              ROUND( SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN dl_flow                      ELSE 0                  END)/SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN delay                      ELSE 0                  END)*8000/1024,2.0) AS data13,              SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END) AS data14,              SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN satisfied_sucess_xdr_count                      ELSE 0                  END) AS data15 ,              ROUND(SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN satisfied_sucess_xdr_count                      ELSE 0                  END)/SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END),2.0) AS data16,              SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END) AS data17,              SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN satisfied_speed_xdr_count                      ELSE 0                  END) AS data18 ,              ROUND(SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN satisfied_speed_xdr_count                      ELSE 0                  END)/SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END),2.0) AS data19,              ROUND(SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN satisfied_sucess_xdr_count*satisfied_speed_xdr_count                      ELSE 0                  END)/SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN satisfied_xdr_count*satisfied_xdr_count                      ELSE 0                  END),2.0) AS data20,              ROUND(SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN delay                      ELSE 0                  END)/1000/60,2.0) AS data21,              ROUND(SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN dl_flow                      ELSE 0                  END)/1024/1024,2.0) AS data22,              ROUND( SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN dl_flow                      ELSE 0                  END)/SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN delay                      ELSE 0                  END)*8000/1024,2.0) AS data23,              SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END) AS data24,              SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN satisfied_sucess_xdr_count                      ELSE 0                  END) AS data25 ,              ROUND( SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN satisfied_sucess_xdr_count                      ELSE 0                  END)/SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END),2.0) AS data26,              SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END) AS data27,              SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN satisfied_speed_xdr_count                      ELSE 0                  END) AS data28 ,              ROUND( SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN satisfied_speed_xdr_count                      ELSE 0                  END)/SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END),2.0) AS data29,              ROUND( SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN satisfied_sucess_xdr_count*satisfied_speed_xdr_count                      ELSE 0                  END)/SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN satisfied_xdr_count*satisfied_xdr_count                      ELSE 0                  END),2.0) AS data30,              ROUND( SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN delay                      ELSE 0                  END)/1000/60,2.0) AS data31,              ROUND(SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN dl_flow                      ELSE 0                  END)/1024/1024,2.0) AS data32,              ROUND(SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN dl_flow                      ELSE 0                  END)/SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN delay                      ELSE 0                  END)*8000/1024,2.0) AS data33,              SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END) AS data34,              SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN satisfied_sucess_xdr_count                      ELSE 0                  END) AS data35 ,              ROUND(SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN satisfied_sucess_xdr_count                      ELSE 0                  END)/SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END),2.0) AS data36,              SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END) AS data37,              SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN satisfied_speed_xdr_count                      ELSE 0                  END) AS data38 ,              ROUND(SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN satisfied_speed_xdr_count                      ELSE 0                  END)/SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END),2.0) AS data39,              ROUND( SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN satisfied_sucess_xdr_count*satisfied_speed_xdr_count                      ELSE 0                  END)/SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN satisfied_xdr_count*satisfied_xdr_count                      ELSE 0                  END),2.0) AS data40          FROM              lte_sys.[@c0]_T_QUALITYSTATISTICS_ALLUSER tb2          LEFT JOIN              (                  SELECT                      city,                      SUM(xdr_count) sumcnt,                      SUM(delay)     sumdelay,                      SUM(dl_flow)   sumdl_flow                  FROM                      lte_sys.[@c0]_T_QUALITYSTATISTICS_ALLUSER                  WHERE                      nettype IN (1,2)                  AND AppType IN(15,1,5,6,7,8)                  AND hour>='[@c1]'                  AND hour<='[@c2]'                  GROUP BY                      city)tb1          ON              tb2.city=tb1.city          WHERE              nettype IN (1,2)          AND AppType IN(15,1,5,6,7,8)          AND hour>='[@c1]'          AND hour<='[@c2]'          GROUP BY              tb2.city,              tb2.AppType          UNION          SELECT              tb2.city,              CASE                  WHEN tb2.scene1=1                  THEN '室外用户'                  WHEN tb2.scene1=2                  THEN '占用室分的室内稳定用户(有室分)'                  WHEN tb2.scene1=3                  THEN '占用宏站的室内稳定用户(无室分)'                  WHEN tb2.scene1=4                  THEN '室内稳定用户(占用宏站和室分)'                  ELSE '未知场景'              END AS data1,              (                  CASE                      WHEN AppType=1                      THEN '即时通信'                      WHEN AppType=15                      THEN '浏览下载'                      WHEN AppType=5                      THEN '视频'                      WHEN AppType=6                      THEN '音乐'                      WHEN AppType=7                      THEN '应用商店'                      WHEN AppType=8                      THEN '游戏'                  END ) AS data2,              ROUND(SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>0                      THEN delay                      ELSE 0                  END)/1000/60,2.0) AS data3,              ROUND(SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>0                      THEN delay                      ELSE 0                  END)/MAX(tb1.sumdelay),2.0) AS data4 ,              ROUND(SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>0                      THEN delay                      ELSE 0                  END)/1000/60,2.0) AS data5,              ROUND( SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>0                      THEN delay                      ELSE 0                  END)/MAX(tb1.sumdelay),2.0) AS data6 ,              ROUND(SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>0                      THEN dl_flow                      ELSE 0                  END)/1024/1024,2.0) AS data7,              ROUND( SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>0                      THEN dl_flow                      ELSE 0                  END)/MAX(tb1.sumdl_flow),2.0) AS data8 ,              ROUND( SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>0                      THEN dl_flow                      ELSE 0                  END)/1024/1024,2.0) AS data9,              ROUND( SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>0                      THEN dl_flow                      ELSE 0                  END)/MAX(tb1.sumdl_flow) ,2.0)AS data10 ,              ROUND(SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>0                      THEN delay                      ELSE 0                  END)/1000/60,2.0) AS data41,              ROUND(SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>0                      THEN dl_flow                      ELSE 0                  END)/1024/1024,2.0) AS data42 ,              ROUND( SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>0                      THEN dl_flow                      ELSE 0                  END)/SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>0                      THEN delay                      ELSE 0                  END)*8000/1024,2.0) AS data43,              ROUND(SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>0                      THEN delay                      ELSE 0                  END)/1000/60,2.0) AS data44,              ROUND( SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>0                      THEN dl_flow                      ELSE 0                  END)/1024/1024,2.0) AS data45 ,              ROUND( SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>0                      THEN dl_flow                      ELSE 0                  END)/SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>0                      THEN delay                      ELSE 0                  END)*8000/1024,2.0) AS data46,              ROUND(SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>0                      THEN delay                      ELSE 0                  END)/1000/60,2.0) AS data47,              ROUND( SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>0                      THEN dl_flow                      ELSE 0                  END)/1024/1024,2.0) AS data48,              ROUND(SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>0                      THEN dl_flow                      ELSE 0                  END)/SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>0                      THEN delay                      ELSE 0                  END)*8000/1024,2.0) AS data49 ,              ROUND(SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN delay                      ELSE 0                  END)/1000/60,2.0) AS data11,              ROUND(SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN dl_flow                      ELSE 0                  END)/1024/1024,2.0) AS data12,              ROUND( SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN dl_flow                      ELSE 0                  END)/SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN delay                      ELSE 0                  END)*8000/1024,2.0) AS data13,              SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END) AS data14,              SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN satisfied_sucess_xdr_count                      ELSE 0                  END) AS data15 ,              ROUND(SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN satisfied_sucess_xdr_count                      ELSE 0                  END)/SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END),2.0) AS data16,              SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END) AS data17,              SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN satisfied_speed_xdr_count                      ELSE 0                  END) AS data18 ,              ROUND(SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN satisfied_speed_xdr_count                      ELSE 0                  END)/SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END),2.0) AS data19,              ROUND(SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN satisfied_sucess_xdr_count*satisfied_speed_xdr_count                      ELSE 0                  END)/SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN satisfied_xdr_count*satisfied_xdr_count                      ELSE 0                  END),2.0) AS data20,              ROUND(SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN delay                      ELSE 0                  END)/1000/60,2.0) AS data21,              ROUND(SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN dl_flow                      ELSE 0                  END)/1024/1024,2.0) AS data22,              ROUND( SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN dl_flow                      ELSE 0                  END)/SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN delay                      ELSE 0                  END)*8000/1024,2.0) AS data23,              SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END) AS data24,              SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN satisfied_sucess_xdr_count                      ELSE 0                  END) AS data25 ,              ROUND( SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN satisfied_sucess_xdr_count                      ELSE 0                  END)/SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END),2.0) AS data26,              SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END) AS data27,              SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN satisfied_speed_xdr_count                      ELSE 0                  END) AS data28 ,              ROUND( SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN satisfied_speed_xdr_count                      ELSE 0                  END)/SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END),2.0) AS data29,              ROUND( SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN satisfied_sucess_xdr_count*satisfied_speed_xdr_count                      ELSE 0                  END)/SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN satisfied_xdr_count*satisfied_xdr_count                      ELSE 0                  END),2.0) AS data30,              ROUND( SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN delay                      ELSE 0                  END)/1000/60,2.0) AS data31,              ROUND(SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN dl_flow                      ELSE 0                  END)/1024/1024,2.0) AS data32,              ROUND(SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN dl_flow                      ELSE 0                  END)/SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN delay                      ELSE 0                  END)*8000/1024,2.0) AS data33,              SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END) AS data34,              SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN satisfied_sucess_xdr_count                      ELSE 0                  END) AS data35 ,              ROUND(SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN satisfied_sucess_xdr_count                      ELSE 0                  END)/SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END),2.0) AS data36,              SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END) AS data37,              SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN satisfied_speed_xdr_count                      ELSE 0                  END) AS data38 ,              ROUND(SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN satisfied_speed_xdr_count                      ELSE 0                  END)/SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END),2.0) AS data39,              ROUND( SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN satisfied_sucess_xdr_count*satisfied_speed_xdr_count                      ELSE 0                  END)/SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN satisfied_xdr_count*satisfied_xdr_count                      ELSE 0                  END),2.0) AS data40          FROM              lte_sys.[@c0]_T_QUALITYSTATISTICS_ALLUSER tb2          LEFT JOIN              (                  SELECT                      city,                      scene1,                      SUM(xdr_count) sumcnt,                      SUM(delay)     sumdelay,                      SUM(dl_flow)   sumdl_flow                  FROM                      lte_sys.[@c0]_T_QUALITYSTATISTICS_ALLUSER                  WHERE                      nettype IN (1,2)                  AND AppType IN(15,1,5,6,7,8)                  AND hour>='[@c1]'                  AND hour<='[@c2]'                  GROUP BY                      city,                      scene1)tb1          ON              tb2.city=tb1.city          AND tb2.scene1=tb1.scene1          WHERE              nettype IN (1,2)          AND AppType IN(15,1,5,6,7,8)          AND hour>='[@c1]'          AND hour<='[@c2]'          GROUP BY              tb2.city,              tb2.scene1,              tb2.AppType          UNION          SELECT              tb2.city,              CASE                  WHEN tb2.scene2=1                  THEN '高铁用户'                  WHEN tb2.scene2=2                  THEN '地铁用户'                  WHEN tb2.scene2=3                  THEN '校园用户'                  WHEN tb2.scene2=4                  THEN '商业区用户'                  WHEN tb2.scene2=5                  THEN '风景区用户'                  WHEN tb2.scene2=6                  THEN '居民区用户'                  ELSE '未知场景'              END AS data1,              (                  CASE                      WHEN AppType=1                      THEN '即时通信'                      WHEN AppType=15                      THEN '浏览下载'                      WHEN AppType=5                      THEN '视频'                      WHEN AppType=6                      THEN '音乐'                      WHEN AppType=7                      THEN '应用商店'                      WHEN AppType=8                      THEN '游戏'                  END ) AS data2,              ROUND(SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>0                      THEN delay                      ELSE 0                  END)/1000/60,2.0) AS data3,              ROUND(SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>0                      THEN delay                      ELSE 0                  END)/MAX(tb1.sumdelay),2.0) AS data4 ,              ROUND(SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>0                      THEN delay                      ELSE 0                  END)/1000/60,2.0) AS data5,              ROUND( SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>0                      THEN delay                      ELSE 0                  END)/MAX(tb1.sumdelay),2.0) AS data6 ,              ROUND(SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>0                      THEN dl_flow                      ELSE 0                  END)/1024/1024,2.0) AS data7,              ROUND( SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>0                      THEN dl_flow                      ELSE 0                  END)/MAX(tb1.sumdl_flow),2.0) AS data8 ,              ROUND( SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>0                      THEN dl_flow                      ELSE 0                  END)/1024/1024,2.0) AS data9,              ROUND( SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>0                      THEN dl_flow                      ELSE 0                  END)/MAX(tb1.sumdl_flow) ,2.0)AS data10 ,              ROUND(SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>0                      THEN delay                      ELSE 0                  END)/1000/60,2.0) AS data41,              ROUND(SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>0                      THEN dl_flow                      ELSE 0                  END)/1024/1024,2.0) AS data42 ,              ROUND( SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>0                      THEN dl_flow                      ELSE 0                  END)/SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>0                      THEN delay                      ELSE 0                  END)*8000/1024,2.0) AS data43,              ROUND(SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>0                      THEN delay                      ELSE 0                  END)/1000/60,2.0) AS data44,              ROUND( SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>0                      THEN dl_flow                      ELSE 0                  END)/1024/1024,2.0) AS data45 ,              ROUND( SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>0                      THEN dl_flow                      ELSE 0                  END)/SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>0                      THEN delay                      ELSE 0                  END)*8000/1024,2.0) AS data46,              ROUND(SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>0                      THEN delay                      ELSE 0                  END)/1000/60,2.0) AS data47,              ROUND( SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>0                      THEN dl_flow                      ELSE 0                  END)/1024/1024,2.0) AS data48,              ROUND(SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>0                      THEN dl_flow                      ELSE 0                  END)/SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>0                      THEN delay                      ELSE 0                  END)*8000/1024,2.0) AS data49 ,              ROUND(SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN delay                      ELSE 0                  END)/1000/60,2.0) AS data11,              ROUND(SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN dl_flow                      ELSE 0                  END)/1024/1024,2.0) AS data12,              ROUND( SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN dl_flow                      ELSE 0                  END)/SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN delay                      ELSE 0                  END)*8000/1024,2.0) AS data13,              SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END) AS data14,              SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN satisfied_sucess_xdr_count                      ELSE 0                  END) AS data15 ,              ROUND(SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN satisfied_sucess_xdr_count                      ELSE 0                  END)/SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END),2.0) AS data16,              SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END) AS data17,              SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN satisfied_speed_xdr_count                      ELSE 0                  END) AS data18 ,              ROUND(SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN satisfied_speed_xdr_count                      ELSE 0                  END)/SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END),2.0) AS data19,              ROUND(SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN satisfied_sucess_xdr_count*satisfied_speed_xdr_count                      ELSE 0                  END)/SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN satisfied_xdr_count*satisfied_xdr_count                      ELSE 0                  END),2.0) AS data20,              ROUND(SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN delay                      ELSE 0                  END)/1000/60,2.0) AS data21,              ROUND(SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN dl_flow                      ELSE 0                  END)/1024/1024,2.0) AS data22,              ROUND( SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN dl_flow                      ELSE 0                  END)/SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN delay                      ELSE 0                  END)*8000/1024,2.0) AS data23,              SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END) AS data24,              SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN satisfied_sucess_xdr_count                      ELSE 0                  END) AS data25 ,              ROUND( SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN satisfied_sucess_xdr_count                      ELSE 0                  END)/SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END),2.0) AS data26,              SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END) AS data27,              SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN satisfied_speed_xdr_count                      ELSE 0                  END) AS data28 ,              ROUND( SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN satisfied_speed_xdr_count                      ELSE 0                  END)/SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END),2.0) AS data29,              ROUND( SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN satisfied_sucess_xdr_count*satisfied_speed_xdr_count                      ELSE 0                  END)/SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN satisfied_xdr_count*satisfied_xdr_count                      ELSE 0                  END),2.0) AS data30,              ROUND( SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN delay                      ELSE 0                  END)/1000/60,2.0) AS data31,              ROUND(SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN dl_flow                      ELSE 0                  END)/1024/1024,2.0) AS data32,              ROUND(SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN dl_flow                      ELSE 0                  END)/SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN delay                      ELSE 0                  END)*8000/1024,2.0) AS data33,              SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END) AS data34,              SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN satisfied_sucess_xdr_count                      ELSE 0                  END) AS data35 ,              ROUND(SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN satisfied_sucess_xdr_count                      ELSE 0                  END)/SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END),2.0) AS data36,              SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END) AS data37,              SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN satisfied_speed_xdr_count                      ELSE 0                  END) AS data38 ,              ROUND(SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN satisfied_speed_xdr_count                      ELSE 0                  END)/SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END),2.0) AS data39,              ROUND( SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN satisfied_sucess_xdr_count*satisfied_speed_xdr_count                      ELSE 0                  END)/SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN satisfied_xdr_count*satisfied_xdr_count                      ELSE 0                  END),2.0) AS data40          FROM              lte_sys.[@c0]_T_QUALITYSTATISTICS_ALLUSER tb2          LEFT JOIN              (                  SELECT                      city,                      scene2,                      SUM(xdr_count) sumcnt,                      SUM(delay)     sumdelay,                      SUM(dl_flow)   sumdl_flow                  FROM                      lte_sys.[@c0]_T_QUALITYSTATISTICS_ALLUSER                  WHERE                      nettype IN (1,2)                  AND AppType IN(15,1,5,6,7,8)                  AND hour>='[@c1]'                  AND hour<='[@c2]'                  GROUP BY                      city,                      scene2)tb1          ON              tb2.city=tb1.city          AND tb2.scene2=tb1.scene2          WHERE              nettype IN (1,2)          AND AppType IN(15,1,5,6,7,8)          AND hour>='[@c1]'          AND hour<='[@c2]'          GROUP BY              tb2.city,              tb2.scene2,              tb2.AppType          UNION          SELECT              tb2.city,              '室内用户' AS data1,              (                  CASE                      WHEN AppType=1                      THEN '即时通信'                      WHEN AppType=15                      THEN '浏览下载'                      WHEN AppType=5                      THEN '视频'                      WHEN AppType=6                      THEN '音乐'                      WHEN AppType=7                      THEN '应用商店'                      WHEN AppType=8                      THEN '游戏'                  END ) AS data2,              ROUND(SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>0                      THEN delay                      ELSE 0                  END)/1000/60,2.0) AS data3,              ROUND(SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>0                      THEN delay                      ELSE 0                  END)/MAX(tb1.sumdelay),2.0) AS data4 ,              ROUND(SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>0                      THEN delay                      ELSE 0                  END)/1000/60,2.0) AS data5,              ROUND( SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>0                      THEN delay                      ELSE 0                  END)/MAX(tb1.sumdelay),2.0) AS data6 ,              ROUND(SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>0                      THEN dl_flow                      ELSE 0                  END)/1024/1024,2.0) AS data7,              ROUND( SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>0                      THEN dl_flow                      ELSE 0                  END)/MAX(tb1.sumdl_flow),2.0) AS data8 ,              ROUND( SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>0                      THEN dl_flow                      ELSE 0                  END)/1024/1024,2.0) AS data9,              ROUND( SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>0                      THEN dl_flow                      ELSE 0                  END)/MAX(tb1.sumdl_flow) ,2.0)AS data10 ,              ROUND(SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>0                      THEN delay                      ELSE 0                  END)/1000/60,2.0) AS data41,              ROUND(SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>0                      THEN dl_flow                      ELSE 0                  END)/1024/1024,2.0) AS data42 ,              ROUND( SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>0                      THEN dl_flow                      ELSE 0                  END)/SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>0                      THEN delay                      ELSE 0                  END)*8000/1024,2.0) AS data43,              ROUND(SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>0                      THEN delay                      ELSE 0                  END)/1000/60,2.0) AS data44,              ROUND( SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>0                      THEN dl_flow                      ELSE 0                  END)/1024/1024,2.0) AS data45 ,              ROUND( SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>0                      THEN dl_flow                      ELSE 0                  END)/SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>0                      THEN delay                      ELSE 0                  END)*8000/1024,2.0) AS data46,              ROUND(SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>0                      THEN delay                      ELSE 0                  END)/1000/60,2.0) AS data47,              ROUND( SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>0                      THEN dl_flow                      ELSE 0                  END)/1024/1024,2.0) AS data48,              ROUND(SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>0                      THEN dl_flow                      ELSE 0                  END)/SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>0                      THEN delay                      ELSE 0                  END)*8000/1024,2.0) AS data49 ,              ROUND(SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN delay                      ELSE 0                  END)/1000/60,2.0) AS data11,              ROUND(SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN dl_flow                      ELSE 0                  END)/1024/1024,2.0) AS data12,              ROUND( SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN dl_flow                      ELSE 0                  END)/SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN delay                      ELSE 0                  END)*8000/1024,2.0) AS data13,              SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END) AS data14,              SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN satisfied_sucess_xdr_count                      ELSE 0                  END) AS data15 ,              ROUND(SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN satisfied_sucess_xdr_count                      ELSE 0                  END)/SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END),2.0) AS data16,              SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END) AS data17,              SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN satisfied_speed_xdr_count                      ELSE 0                  END) AS data18 ,              ROUND(SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN satisfied_speed_xdr_count                      ELSE 0                  END)/SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END),2.0) AS data19,              ROUND(SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN satisfied_sucess_xdr_count*satisfied_speed_xdr_count                      ELSE 0                  END)/SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN satisfied_xdr_count*satisfied_xdr_count                      ELSE 0                  END),2.0) AS data20,              ROUND(SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN delay                      ELSE 0                  END)/1000/60,2.0) AS data21,              ROUND(SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN dl_flow                      ELSE 0                  END)/1024/1024,2.0) AS data22,              ROUND( SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN dl_flow                      ELSE 0                  END)/SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN delay                      ELSE 0                  END)*8000/1024,2.0) AS data23,              SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END) AS data24,              SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN satisfied_sucess_xdr_count                      ELSE 0                  END) AS data25 ,              ROUND( SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN satisfied_sucess_xdr_count                      ELSE 0                  END)/SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END),2.0) AS data26,              SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END) AS data27,              SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN satisfied_speed_xdr_count                      ELSE 0                  END) AS data28 ,              ROUND( SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN satisfied_speed_xdr_count                      ELSE 0                  END)/SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END),2.0) AS data29,              ROUND( SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN satisfied_sucess_xdr_count*satisfied_speed_xdr_count                      ELSE 0                  END)/SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN satisfied_xdr_count*satisfied_xdr_count                      ELSE 0                  END),2.0) AS data30,              ROUND( SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN delay                      ELSE 0                  END)/1000/60,2.0) AS data31,              ROUND(SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN dl_flow                      ELSE 0                  END)/1024/1024,2.0) AS data32,              ROUND(SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN dl_flow                      ELSE 0                  END)/SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN delay                      ELSE 0                  END)*8000/1024,2.0) AS data33,              SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END) AS data34,              SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN satisfied_sucess_xdr_count                      ELSE 0                  END) AS data35 ,              ROUND(SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN satisfied_sucess_xdr_count                      ELSE 0                  END)/SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END),2.0) AS data36,              SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END) AS data37,              SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN satisfied_speed_xdr_count                      ELSE 0                  END) AS data38 ,              ROUND(SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN satisfied_speed_xdr_count                      ELSE 0                  END)/SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END),2.0) AS data39,              ROUND( SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN satisfied_sucess_xdr_count*satisfied_speed_xdr_count                      ELSE 0                  END)/SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN satisfied_xdr_count*satisfied_xdr_count                      ELSE 0                  END),2.0) AS data40          FROM              lte_sys.[@c0]_T_QUALITYSTATISTICS_ALLUSER tb2          LEFT JOIN              (                  SELECT                      city,                      SUM(xdr_count) sumcnt,                      SUM(delay)     sumdelay,                      SUM(dl_flow)   sumdl_flow                  FROM                      lte_sys.[@c0]_T_QUALITYSTATISTICS_ALLUSER                  WHERE                      nettype IN (1,2)                  AND AppType IN(15,1,5,6,7,8)                  AND hour>='[@c1]'                  AND hour<='[@c2]'                  AND scene1<>1                  GROUP BY                      city)tb1          ON              tb2.city=tb1.city          WHERE              nettype IN (1,2)          AND AppType IN(15,1,5,6,7,8)          AND hour>='[@c1]'          AND hour<='[@c2]'          AND scene1<>1          GROUP BY              tb2.city,              tb2.AppType ) T  WHERE      t.city='[@c3]'  AND t.data1='[@c4]'  ORDER BY      t.data2"
      }
    },
    {
      "key": "apptype_tb6",
      "desc": "获取表6网间业务指标统计（按大类业务）",
      "config": {
        "parameters": [
          {
            "name": "p_en",
            "columnname": "",
            "type": "string",
            "format": "",
            "conditionid": "c0",
            "symbol": ""
          },
          {
            "name": "starttime",
            "columnname": "",
            "type": "string",
            "format": "",
            "conditionid": "c1",
            "symbol": ""
          },
          {
            "name": "endtime",
            "columnname": "",
            "type": "string",
            "format": "",
            "conditionid": "c2",
            "symbol": ""
          },
          {
            "name": "province",
            "columnname": "",
            "type": "string",
            "format": "",
            "conditionid": "c3",
            "symbol": ""
          }
        ],
        "value": "SELECT      tb2.city,      (          CASE              WHEN AppType=1              THEN '即时通信'              WHEN AppType=15              THEN '浏览下载'              WHEN AppType=5              THEN '视频'              WHEN AppType=6              THEN '音乐'              WHEN AppType=7              THEN '应用商店'              WHEN AppType=8              THEN '游戏'          END ) AS data2,      ROUND(SUM(          CASE              WHEN nettype=1              AND dl_flow>0              THEN delay              ELSE 0          END)/1000/60,2.0) AS data3,      ROUND(SUM(          CASE              WHEN nettype=1              AND dl_flow>0              THEN delay              ELSE 0          END)/MAX(tb1.sumdelay),2.0) AS data4 ,      ROUND(SUM(          CASE              WHEN nettype=2              AND dl_flow>0              THEN delay              ELSE 0          END)/1000/60,2.0) AS data5,      ROUND( SUM(          CASE              WHEN nettype=2              AND dl_flow>0              THEN delay              ELSE 0          END)/MAX(tb1.sumdelay),2.0) AS data6 ,      ROUND(SUM(          CASE              WHEN nettype=1              AND dl_flow>0              THEN dl_flow              ELSE 0          END)/1024/1024,2.0) AS data7,      ROUND( SUM(          CASE              WHEN nettype=1              AND dl_flow>0              THEN dl_flow              ELSE 0          END)/MAX(tb1.sumdl_flow),2.0) AS data8 ,      ROUND( SUM(          CASE              WHEN nettype=2              AND dl_flow>0              THEN dl_flow              ELSE 0          END)/1024/1024,2.0) AS data9,      ROUND( SUM(          CASE              WHEN nettype=2              AND dl_flow>0              THEN dl_flow              ELSE 0          END)/MAX(tb1.sumdl_flow) ,2.0)AS data10 ,      ROUND(SUM(          CASE              WHEN nettype=1              AND dl_flow>0              THEN delay              ELSE 0          END)/1000/60,2.0) AS data41,      ROUND(SUM(          CASE              WHEN nettype=1              AND dl_flow>0              THEN dl_flow              ELSE 0          END)/1024/1024,2.0) AS data42 ,      ROUND( SUM(          CASE              WHEN nettype=1              AND dl_flow>0              THEN dl_flow              ELSE 0          END)/SUM(          CASE              WHEN nettype=1              AND dl_flow>0              THEN delay              ELSE 0          END)*8000/1024,2.0) AS data43,      ROUND(SUM(          CASE              WHEN nettype=2              AND dl_flow>0              THEN delay              ELSE 0          END)/1000/60,2.0) AS data44,      ROUND( SUM(          CASE              WHEN nettype=2              AND dl_flow>0              THEN dl_flow              ELSE 0          END)/1024/1024,2.0) AS data45 ,      ROUND( SUM(          CASE              WHEN nettype=2              AND dl_flow>0              THEN dl_flow              ELSE 0          END)/SUM(          CASE              WHEN nettype=2              AND dl_flow>0              THEN delay              ELSE 0          END)*8000/1024,2.0) AS data46,      ROUND(SUM(          CASE              WHEN (nettype=1                  OR  nettype=2)              AND dl_flow>0              THEN delay              ELSE 0          END)/1000/60,2.0) AS data47,      ROUND( SUM(          CASE              WHEN (nettype=1                  OR  nettype=2)              AND dl_flow>0              THEN dl_flow              ELSE 0          END)/1024/1024,2.0) AS data48,      ROUND(SUM(          CASE              WHEN (nettype=1                  OR  nettype=2)              AND dl_flow>0              THEN dl_flow              ELSE 0          END)/SUM(          CASE              WHEN (nettype=1                  OR  nettype=2)              AND dl_flow>0              THEN delay              ELSE 0          END)*8000/1024,2.0) AS data49 ,      ROUND(SUM(          CASE              WHEN nettype=1              AND dl_flow>5120              THEN delay              ELSE 0          END)/1000/60,2.0) AS data11,      ROUND(SUM(          CASE              WHEN nettype=1              AND dl_flow>5120              THEN dl_flow              ELSE 0          END)/1024/1024,2.0) AS data12,      ROUND( SUM(          CASE              WHEN nettype=1              AND dl_flow>5120              THEN dl_flow              ELSE 0          END)/SUM(          CASE              WHEN nettype=1              AND dl_flow>5120              THEN delay              ELSE 0          END)*8000/1024,2.0) AS data13,      SUM(          CASE              WHEN nettype=1              AND dl_flow>5120              THEN satisfied_xdr_count              ELSE 0          END) AS data14,      SUM(          CASE              WHEN nettype=1              AND dl_flow>5120              THEN satisfied_sucess_xdr_count              ELSE 0          END) AS data15 ,      ROUND(SUM(          CASE              WHEN nettype=1              AND dl_flow>5120              THEN satisfied_sucess_xdr_count              ELSE 0          END)/SUM(          CASE              WHEN nettype=1              AND dl_flow>5120              THEN satisfied_xdr_count              ELSE 0          END),2.0) AS data16,      SUM(          CASE              WHEN nettype=1              AND dl_flow>5120              THEN satisfied_xdr_count              ELSE 0          END) AS data17,      SUM(          CASE              WHEN nettype=1              AND dl_flow>5120              THEN satisfied_speed_xdr_count              ELSE 0          END) AS data18 ,      ROUND(SUM(          CASE              WHEN nettype=1              AND dl_flow>5120              THEN satisfied_speed_xdr_count              ELSE 0          END)/SUM(          CASE              WHEN nettype=1              AND dl_flow>5120              THEN satisfied_xdr_count              ELSE 0          END),2.0) AS data19,      ROUND(SUM(          CASE              WHEN nettype=1              AND dl_flow>5120              THEN satisfied_sucess_xdr_count*satisfied_speed_xdr_count              ELSE 0          END)/SUM(          CASE              WHEN nettype=1              AND dl_flow>5120              THEN satisfied_xdr_count*satisfied_xdr_count              ELSE 0          END),2.0) AS data20,      ROUND(SUM(          CASE              WHEN nettype=2              AND dl_flow>5120              THEN delay              ELSE 0          END)/1000/60,2.0) AS data21,      ROUND(SUM(          CASE              WHEN nettype=2              AND dl_flow>5120              THEN dl_flow              ELSE 0          END)/1024/1024,2.0) AS data22,      ROUND( SUM(          CASE              WHEN nettype=2              AND dl_flow>5120              THEN dl_flow              ELSE 0          END)/SUM(          CASE              WHEN nettype=2              AND dl_flow>5120              THEN delay              ELSE 0          END)*8000/1024,2.0) AS data23,      SUM(          CASE              WHEN nettype=2              AND dl_flow>5120              THEN satisfied_xdr_count              ELSE 0          END) AS data24,      SUM(          CASE              WHEN nettype=2              AND dl_flow>5120              THEN satisfied_sucess_xdr_count              ELSE 0          END) AS data25 ,      ROUND( SUM(          CASE              WHEN nettype=2              AND dl_flow>5120              THEN satisfied_sucess_xdr_count              ELSE 0          END)/SUM(          CASE              WHEN nettype=2              AND dl_flow>5120              THEN satisfied_xdr_count              ELSE 0          END),2.0) AS data26,      SUM(          CASE              WHEN nettype=2              AND dl_flow>5120              THEN satisfied_xdr_count              ELSE 0          END) AS data27,      SUM(          CASE              WHEN nettype=2              AND dl_flow>5120              THEN satisfied_speed_xdr_count              ELSE 0          END) AS data28 ,      ROUND( SUM(          CASE              WHEN nettype=2              AND dl_flow>5120              THEN satisfied_speed_xdr_count              ELSE 0          END)/SUM(          CASE              WHEN nettype=2              AND dl_flow>5120              THEN satisfied_xdr_count              ELSE 0          END),2.0) AS data29,      ROUND( SUM(          CASE              WHEN nettype=2              AND dl_flow>5120              THEN satisfied_sucess_xdr_count*satisfied_speed_xdr_count              ELSE 0          END)/SUM(          CASE              WHEN nettype=2              AND dl_flow>5120              THEN satisfied_xdr_count*satisfied_xdr_count              ELSE 0          END),2.0) AS data30,      ROUND( SUM(          CASE              WHEN (nettype=1                  OR  nettype=2)              AND dl_flow>5120              THEN delay              ELSE 0          END)/1000/60,2.0) AS data31,      ROUND(SUM(          CASE              WHEN (nettype=1                  OR  nettype=2)              AND dl_flow>5120              THEN dl_flow              ELSE 0          END)/1024/1024,2.0) AS data32,      ROUND(SUM(          CASE              WHEN (nettype=1                  OR  nettype=2)              AND dl_flow>5120              THEN dl_flow              ELSE 0          END)/SUM(          CASE              WHEN (nettype=1                  OR  nettype=2)              AND dl_flow>5120              THEN delay              ELSE 0          END)*8000/1024,2.0) AS data33,      SUM(          CASE              WHEN (nettype=1                  OR  nettype=2)              AND dl_flow>5120              THEN satisfied_xdr_count              ELSE 0          END) AS data34,      SUM(          CASE              WHEN (nettype=1                  OR  nettype=2)              AND dl_flow>5120              THEN satisfied_sucess_xdr_count              ELSE 0          END) AS data35 ,      ROUND(SUM(          CASE              WHEN (nettype=1                  OR  nettype=2)              AND dl_flow>5120              THEN satisfied_sucess_xdr_count              ELSE 0          END)/SUM(          CASE              WHEN (nettype=1                  OR  nettype=2)              AND dl_flow>5120              THEN satisfied_xdr_count              ELSE 0          END),2.0) AS data36,      SUM(          CASE              WHEN (nettype=1                  OR  nettype=2)              AND dl_flow>5120              THEN satisfied_xdr_count              ELSE 0          END) AS data37,      SUM(          CASE              WHEN (nettype=1                  OR  nettype=2)              AND dl_flow>5120              THEN satisfied_speed_xdr_count              ELSE 0          END) AS data38 ,      ROUND(SUM(          CASE              WHEN (nettype=1                  OR  nettype=2)              AND dl_flow>5120              THEN satisfied_speed_xdr_count              ELSE 0          END)/SUM(          CASE              WHEN (nettype=1                  OR  nettype=2)              AND dl_flow>5120              THEN satisfied_xdr_count              ELSE 0          END),2.0) AS data39,      ROUND( SUM(          CASE              WHEN (nettype=1                  OR  nettype=2)              AND dl_flow>5120              THEN satisfied_sucess_xdr_count*satisfied_speed_xdr_count              ELSE 0          END)/SUM(          CASE              WHEN (nettype=1                  OR  nettype=2)              AND dl_flow>5120              THEN satisfied_xdr_count*satisfied_xdr_count              ELSE 0          END),2.0) AS data40  FROM      lte_sys.[@c0]_T_QUALITYSTATISTICS_ALLUSER tb2  LEFT JOIN      (          SELECT              city,              SUM(xdr_count) sumcnt,              SUM(delay)     sumdelay,              SUM(dl_flow)   sumdl_flow          FROM              lte_sys.[@c0]_T_QUALITYSTATISTICS_ALLUSER          WHERE              nettype IN (1,2)          AND AppType IN(15,1,5,6,7,8)          AND hour>='[@c1]'          AND hour<='[@c2]'          GROUP BY              city)tb1  ON      tb2.city=tb1.city  WHERE      nettype IN (1,2)  AND AppType IN(15,1,5,6,7,8)  AND hour>='[@c1]'  AND hour<='[@c2]'  AND tb2.city='[@c3]'  GROUP BY      tb2.city,      tb2.AppType"
      }
    },
    {
      "key": "seance_apptype_tb6",
      "desc": "获取表6网间业务指标统计（按某个大类业务下的场景）",
      "config": {
        "parameters": [
          {
            "name": "p_en",
            "columnname": "",
            "type": "string",
            "format": "",
            "conditionid": "c0",
            "symbol": ""
          },
          {
            "name": "starttime",
            "columnname": "",
            "type": "string",
            "format": "",
            "conditionid": "c1",
            "symbol": ""
          },
          {
            "name": "endtime",
            "columnname": "",
            "type": "string",
            "format": "",
            "conditionid": "c2",
            "symbol": ""
          },
          {
            "name": "province",
            "columnname": "",
            "type": "string",
            "format": "",
            "conditionid": "c3",
            "symbol": ""
          },
          {
            "name": "apptype",
            "columnname": "",
            "type": "string",
            "format": "",
            "conditionid": "c4",
            "symbol": ""
          }
        ],
        "value": "SELECT      city,      data1,      data2,      data3,      data4,      data5,      data6,      data7,      data8,      data9,      data10,      data11,      data12,      data13,      data14,      data15,      data16,      data17,      data18,      data19,      data20,      data21,      data22,      data23,      data24,      data25,      data26,      data27,      data28,      data29,      data30,      data31,      data32,      data33,      data34,      data35,      data36,      data37,      data38,      data39,      data40,      data41,      data42,      data43,      data44,      data45,      data46,      data47,      data48,      data49  FROM      (          SELECT              tb2.city,              '全网' AS data1,              (                  CASE                      WHEN AppType=1                      THEN '即时通信'                      WHEN AppType=15                      THEN '浏览下载'                      WHEN AppType=5                      THEN '视频'                      WHEN AppType=6                      THEN '音乐'                      WHEN AppType=7                      THEN '应用商店'                      WHEN AppType=8                      THEN '游戏'                  END ) AS data2,              ROUND(SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>0                      THEN delay                      ELSE 0                  END)/1000/60,2.0) AS data3,              ROUND(SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>0                      THEN delay                      ELSE 0                  END)/MAX(tb1.sumdelay),2.0) AS data4 ,              ROUND(SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>0                      THEN delay                      ELSE 0                  END)/1000/60,2.0) AS data5,              ROUND( SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>0                      THEN delay                      ELSE 0                  END)/MAX(tb1.sumdelay),2.0) AS data6 ,              ROUND(SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>0                      THEN dl_flow                      ELSE 0                  END)/1024/1024,2.0) AS data7,              ROUND( SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>0                      THEN dl_flow                      ELSE 0                  END)/MAX(tb1.sumdl_flow),2.0) AS data8 ,              ROUND( SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>0                      THEN dl_flow                      ELSE 0                  END)/1024/1024,2.0) AS data9,              ROUND( SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>0                      THEN dl_flow                      ELSE 0                  END)/MAX(tb1.sumdl_flow) ,2.0)AS data10 ,              ROUND(SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>0                      THEN delay                      ELSE 0                  END)/1000/60,2.0) AS data41,              ROUND(SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>0                      THEN dl_flow                      ELSE 0                  END)/1024/1024,2.0) AS data42 ,              ROUND( SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>0                      THEN dl_flow                      ELSE 0                  END)/SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>0                      THEN delay                      ELSE 0                  END)*8000/1024,2.0) AS data43,              ROUND(SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>0                      THEN delay                      ELSE 0                  END)/1000/60,2.0) AS data44,              ROUND( SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>0                      THEN dl_flow                      ELSE 0                  END)/1024/1024,2.0) AS data45 ,              ROUND( SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>0                      THEN dl_flow                      ELSE 0                  END)/SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>0                      THEN delay                      ELSE 0                  END)*8000/1024,2.0) AS data46,              ROUND(SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>0                      THEN delay                      ELSE 0                  END)/1000/60,2.0) AS data47,              ROUND( SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>0                      THEN dl_flow                      ELSE 0                  END)/1024/1024,2.0) AS data48,              ROUND(SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>0                      THEN dl_flow                      ELSE 0                  END)/SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>0                      THEN delay                      ELSE 0                  END)*8000/1024,2.0) AS data49 ,              ROUND(SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN delay                      ELSE 0                  END)/1000/60,2.0) AS data11,              ROUND(SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN dl_flow                      ELSE 0                  END)/1024/1024,2.0) AS data12,              ROUND( SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN dl_flow                      ELSE 0                  END)/SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN delay                      ELSE 0                  END)*8000/1024,2.0) AS data13,              SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END) AS data14,              SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN satisfied_sucess_xdr_count                      ELSE 0                  END) AS data15 ,              ROUND(SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN satisfied_sucess_xdr_count                      ELSE 0                  END)/SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END),2.0) AS data16,              SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END) AS data17,              SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN satisfied_speed_xdr_count                      ELSE 0                  END) AS data18 ,              ROUND(SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN satisfied_speed_xdr_count                      ELSE 0                  END)/SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END),2.0) AS data19,              ROUND(SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN satisfied_sucess_xdr_count*satisfied_speed_xdr_count                      ELSE 0                  END)/SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN satisfied_xdr_count*satisfied_xdr_count                      ELSE 0                  END),2.0) AS data20,              ROUND(SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN delay                      ELSE 0                  END)/1000/60,2.0) AS data21,              ROUND(SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN dl_flow                      ELSE 0                  END)/1024/1024,2.0) AS data22,              ROUND( SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN dl_flow                      ELSE 0                  END)/SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN delay                      ELSE 0                  END)*8000/1024,2.0) AS data23,              SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END) AS data24,              SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN satisfied_sucess_xdr_count                      ELSE 0                  END) AS data25 ,              ROUND( SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN satisfied_sucess_xdr_count                      ELSE 0                  END)/SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END),2.0) AS data26,              SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END) AS data27,              SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN satisfied_speed_xdr_count                      ELSE 0                  END) AS data28 ,              ROUND( SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN satisfied_speed_xdr_count                      ELSE 0                  END)/SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END),2.0) AS data29,              ROUND( SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN satisfied_sucess_xdr_count*satisfied_speed_xdr_count                      ELSE 0                  END)/SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN satisfied_xdr_count*satisfied_xdr_count                      ELSE 0                  END),2.0) AS data30,              ROUND( SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN delay                      ELSE 0                  END)/1000/60,2.0) AS data31,              ROUND(SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN dl_flow                      ELSE 0                  END)/1024/1024,2.0) AS data32,              ROUND(SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN dl_flow                      ELSE 0                  END)/SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN delay                      ELSE 0                  END)*8000/1024,2.0) AS data33,              SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END) AS data34,              SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN satisfied_sucess_xdr_count                      ELSE 0                  END) AS data35 ,              ROUND(SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN satisfied_sucess_xdr_count                      ELSE 0                  END)/SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END),2.0) AS data36,              SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END) AS data37,              SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN satisfied_speed_xdr_count                      ELSE 0                  END) AS data38 ,              ROUND(SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN satisfied_speed_xdr_count                      ELSE 0                  END)/SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END),2.0) AS data39,              ROUND( SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN satisfied_sucess_xdr_count*satisfied_speed_xdr_count                      ELSE 0                  END)/SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN satisfied_xdr_count*satisfied_xdr_count                      ELSE 0                  END),2.0) AS data40          FROM              lte_sys.[@c0]_T_QUALITYSTATISTICS_ALLUSER tb2          LEFT JOIN              (                  SELECT                      city,                      SUM(xdr_count) sumcnt,                      SUM(delay)     sumdelay,                      SUM(dl_flow)   sumdl_flow                  FROM                      lte_sys.[@c0]_T_QUALITYSTATISTICS_ALLUSER                  WHERE                      nettype IN (1,2)                  AND AppType IN(15,1,5,6,7,8)                  AND hour>='[@c1]'                  AND hour<='[@c2]'                  GROUP BY                      city)tb1          ON              tb2.city=tb1.city          WHERE              nettype IN (1,2)          AND AppType IN(15,1,5,6,7,8)          AND hour>='[@c1]'          AND hour<='[@c2]'          GROUP BY              tb2.city,              tb2.AppType          UNION          SELECT              tb2.city,              CASE                  WHEN tb2.scene1=1                  THEN '室外用户'                  WHEN tb2.scene1=2                  THEN '占用室分的室内稳定用户(有室分)'                  WHEN tb2.scene1=3                  THEN '占用宏站的室内稳定用户(无室分)'                  WHEN tb2.scene1=4                  THEN '室内稳定用户(占用宏站和室分)'                  ELSE '未知场景'              END AS data1,              (                  CASE                      WHEN AppType=1                      THEN '即时通信'                      WHEN AppType=15                      THEN '浏览下载'                      WHEN AppType=5                      THEN '视频'                      WHEN AppType=6                      THEN '音乐'                      WHEN AppType=7                      THEN '应用商店'                      WHEN AppType=8                      THEN '游戏'                  END ) AS data2,              ROUND(SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>0                      THEN delay                      ELSE 0                  END)/1000/60,2.0) AS data3,              ROUND(SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>0                      THEN delay                      ELSE 0                  END)/MAX(tb1.sumdelay),2.0) AS data4 ,              ROUND(SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>0                      THEN delay                      ELSE 0                  END)/1000/60,2.0) AS data5,              ROUND( SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>0                      THEN delay                      ELSE 0                  END)/MAX(tb1.sumdelay),2.0) AS data6 ,              ROUND(SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>0                      THEN dl_flow                      ELSE 0                  END)/1024/1024,2.0) AS data7,              ROUND( SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>0                      THEN dl_flow                      ELSE 0                  END)/MAX(tb1.sumdl_flow),2.0) AS data8 ,              ROUND( SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>0                      THEN dl_flow                      ELSE 0                  END)/1024/1024,2.0) AS data9,              ROUND( SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>0                      THEN dl_flow                      ELSE 0                  END)/MAX(tb1.sumdl_flow) ,2.0)AS data10 ,              ROUND(SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>0                      THEN delay                      ELSE 0                  END)/1000/60,2.0) AS data41,              ROUND(SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>0                      THEN dl_flow                      ELSE 0                  END)/1024/1024,2.0) AS data42 ,              ROUND( SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>0                      THEN dl_flow                      ELSE 0                  END)/SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>0                      THEN delay                      ELSE 0                  END)*8000/1024,2.0) AS data43,              ROUND(SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>0                      THEN delay                      ELSE 0                  END)/1000/60,2.0) AS data44,              ROUND( SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>0                      THEN dl_flow                      ELSE 0                  END)/1024/1024,2.0) AS data45 ,              ROUND( SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>0                      THEN dl_flow                      ELSE 0                  END)/SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>0                      THEN delay                      ELSE 0                  END)*8000/1024,2.0) AS data46,              ROUND(SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>0                      THEN delay                      ELSE 0                  END)/1000/60,2.0) AS data47,              ROUND( SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>0                      THEN dl_flow                      ELSE 0                  END)/1024/1024,2.0) AS data48,              ROUND(SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>0                      THEN dl_flow                      ELSE 0                  END)/SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>0                      THEN delay                      ELSE 0                  END)*8000/1024,2.0) AS data49 ,              ROUND(SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN delay                      ELSE 0                  END)/1000/60,2.0) AS data11,              ROUND(SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN dl_flow                      ELSE 0                  END)/1024/1024,2.0) AS data12,              ROUND( SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN dl_flow                      ELSE 0                  END)/SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN delay                      ELSE 0                  END)*8000/1024,2.0) AS data13,              SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END) AS data14,              SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN satisfied_sucess_xdr_count                      ELSE 0                  END) AS data15 ,              ROUND(SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN satisfied_sucess_xdr_count                      ELSE 0                  END)/SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END),2.0) AS data16,              SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END) AS data17,              SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN satisfied_speed_xdr_count                      ELSE 0                  END) AS data18 ,              ROUND(SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN satisfied_speed_xdr_count                      ELSE 0                  END)/SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END),2.0) AS data19,              ROUND(SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN satisfied_sucess_xdr_count*satisfied_speed_xdr_count                      ELSE 0                  END)/SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN satisfied_xdr_count*satisfied_xdr_count                      ELSE 0                  END),2.0) AS data20,              ROUND(SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN delay                      ELSE 0                  END)/1000/60,2.0) AS data21,              ROUND(SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN dl_flow                      ELSE 0                  END)/1024/1024,2.0) AS data22,              ROUND( SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN dl_flow                      ELSE 0                  END)/SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN delay                      ELSE 0                  END)*8000/1024,2.0) AS data23,              SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END) AS data24,              SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN satisfied_sucess_xdr_count                      ELSE 0                  END) AS data25 ,              ROUND( SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN satisfied_sucess_xdr_count                      ELSE 0                  END)/SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END),2.0) AS data26,              SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END) AS data27,              SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN satisfied_speed_xdr_count                      ELSE 0                  END) AS data28 ,              ROUND( SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN satisfied_speed_xdr_count                      ELSE 0                  END)/SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END),2.0) AS data29,              ROUND( SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN satisfied_sucess_xdr_count*satisfied_speed_xdr_count                      ELSE 0                  END)/SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN satisfied_xdr_count*satisfied_xdr_count                      ELSE 0                  END),2.0) AS data30,              ROUND( SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN delay                      ELSE 0                  END)/1000/60,2.0) AS data31,              ROUND(SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN dl_flow                      ELSE 0                  END)/1024/1024,2.0) AS data32,              ROUND(SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN dl_flow                      ELSE 0                  END)/SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN delay                      ELSE 0                  END)*8000/1024,2.0) AS data33,              SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END) AS data34,              SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN satisfied_sucess_xdr_count                      ELSE 0                  END) AS data35 ,              ROUND(SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN satisfied_sucess_xdr_count                      ELSE 0                  END)/SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END),2.0) AS data36,              SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END) AS data37,              SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN satisfied_speed_xdr_count                      ELSE 0                  END) AS data38 ,              ROUND(SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN satisfied_speed_xdr_count                      ELSE 0                  END)/SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END),2.0) AS data39,              ROUND( SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN satisfied_sucess_xdr_count*satisfied_speed_xdr_count                      ELSE 0                  END)/SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN satisfied_xdr_count*satisfied_xdr_count                      ELSE 0                  END),2.0) AS data40          FROM              lte_sys.[@c0]_T_QUALITYSTATISTICS_ALLUSER tb2          LEFT JOIN              (                  SELECT                      city,                      scene1,                      SUM(xdr_count) sumcnt,                      SUM(delay)     sumdelay,                      SUM(dl_flow)   sumdl_flow                  FROM                      lte_sys.[@c0]_T_QUALITYSTATISTICS_ALLUSER                  WHERE                      nettype IN (1,2)                  AND AppType IN(15,1,5,6,7,8)                  AND hour>='[@c1]'                  AND hour<='[@c2]'                  GROUP BY                      city,                      scene1)tb1          ON              tb2.city=tb1.city          AND tb2.scene1=tb1.scene1          WHERE              nettype IN (1,2)          AND AppType IN(15,1,5,6,7,8)          AND hour>='[@c1]'          AND hour<='[@c2]'          GROUP BY              tb2.city,              tb2.scene1,              tb2.AppType          UNION          SELECT              tb2.city,              CASE                  WHEN tb2.scene2=1                  THEN '高铁用户'                  WHEN tb2.scene2=2                  THEN '地铁用户'                  WHEN tb2.scene2=3                  THEN '校园用户'                  WHEN tb2.scene2=4                  THEN '商业区用户'                  WHEN tb2.scene2=5                  THEN '风景区用户'                  WHEN tb2.scene2=6                  THEN '居民区用户'                  ELSE '未知场景'              END AS data1,              (                  CASE                      WHEN AppType=1                      THEN '即时通信'                      WHEN AppType=15                      THEN '浏览下载'                      WHEN AppType=5                      THEN '视频'                      WHEN AppType=6                      THEN '音乐'                      WHEN AppType=7                      THEN '应用商店'                      WHEN AppType=8                      THEN '游戏'                  END ) AS data2,              ROUND(SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>0                      THEN delay                      ELSE 0                  END)/1000/60,2.0) AS data3,              ROUND(SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>0                      THEN delay                      ELSE 0                  END)/MAX(tb1.sumdelay),2.0) AS data4 ,              ROUND(SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>0                      THEN delay                      ELSE 0                  END)/1000/60,2.0) AS data5,              ROUND( SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>0                      THEN delay                      ELSE 0                  END)/MAX(tb1.sumdelay),2.0) AS data6 ,              ROUND(SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>0                      THEN dl_flow                      ELSE 0                  END)/1024/1024,2.0) AS data7,              ROUND( SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>0                      THEN dl_flow                      ELSE 0                  END)/MAX(tb1.sumdl_flow),2.0) AS data8 ,              ROUND( SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>0                      THEN dl_flow                      ELSE 0                  END)/1024/1024,2.0) AS data9,              ROUND( SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>0                      THEN dl_flow                      ELSE 0                  END)/MAX(tb1.sumdl_flow) ,2.0)AS data10 ,              ROUND(SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>0                      THEN delay                      ELSE 0                  END)/1000/60,2.0) AS data41,              ROUND(SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>0                      THEN dl_flow                      ELSE 0                  END)/1024/1024,2.0) AS data42 ,              ROUND( SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>0                      THEN dl_flow                      ELSE 0                  END)/SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>0                      THEN delay                      ELSE 0                  END)*8000/1024,2.0) AS data43,              ROUND(SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>0                      THEN delay                      ELSE 0                  END)/1000/60,2.0) AS data44,              ROUND( SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>0                      THEN dl_flow                      ELSE 0                  END)/1024/1024,2.0) AS data45 ,              ROUND( SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>0                      THEN dl_flow                      ELSE 0                  END)/SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>0                      THEN delay                      ELSE 0                  END)*8000/1024,2.0) AS data46,              ROUND(SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>0                      THEN delay                      ELSE 0                  END)/1000/60,2.0) AS data47,              ROUND( SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>0                      THEN dl_flow                      ELSE 0                  END)/1024/1024,2.0) AS data48,              ROUND(SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>0                      THEN dl_flow                      ELSE 0                  END)/SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>0                      THEN delay                      ELSE 0                  END)*8000/1024,2.0) AS data49 ,              ROUND(SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN delay                      ELSE 0                  END)/1000/60,2.0) AS data11,              ROUND(SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN dl_flow                      ELSE 0                  END)/1024/1024,2.0) AS data12,              ROUND( SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN dl_flow                      ELSE 0                  END)/SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN delay                      ELSE 0                  END)*8000/1024,2.0) AS data13,              SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END) AS data14,              SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN satisfied_sucess_xdr_count                      ELSE 0                  END) AS data15 ,              ROUND(SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN satisfied_sucess_xdr_count                      ELSE 0                  END)/SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END),2.0) AS data16,              SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END) AS data17,              SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN satisfied_speed_xdr_count                      ELSE 0                  END) AS data18 ,              ROUND(SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN satisfied_speed_xdr_count                      ELSE 0                  END)/SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END),2.0) AS data19,              ROUND(SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN satisfied_sucess_xdr_count*satisfied_speed_xdr_count                      ELSE 0                  END)/SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN satisfied_xdr_count*satisfied_xdr_count                      ELSE 0                  END),2.0) AS data20,              ROUND(SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN delay                      ELSE 0                  END)/1000/60,2.0) AS data21,              ROUND(SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN dl_flow                      ELSE 0                  END)/1024/1024,2.0) AS data22,              ROUND( SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN dl_flow                      ELSE 0                  END)/SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN delay                      ELSE 0                  END)*8000/1024,2.0) AS data23,              SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END) AS data24,              SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN satisfied_sucess_xdr_count                      ELSE 0                  END) AS data25 ,              ROUND( SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN satisfied_sucess_xdr_count                      ELSE 0                  END)/SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END),2.0) AS data26,              SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END) AS data27,              SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN satisfied_speed_xdr_count                      ELSE 0                  END) AS data28 ,              ROUND( SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN satisfied_speed_xdr_count                      ELSE 0                  END)/SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END),2.0) AS data29,              ROUND( SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN satisfied_sucess_xdr_count*satisfied_speed_xdr_count                      ELSE 0                  END)/SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN satisfied_xdr_count*satisfied_xdr_count                      ELSE 0                  END),2.0) AS data30,              ROUND( SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN delay                      ELSE 0                  END)/1000/60,2.0) AS data31,              ROUND(SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN dl_flow                      ELSE 0                  END)/1024/1024,2.0) AS data32,              ROUND(SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN dl_flow                      ELSE 0                  END)/SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN delay                      ELSE 0                  END)*8000/1024,2.0) AS data33,              SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END) AS data34,              SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN satisfied_sucess_xdr_count                      ELSE 0                  END) AS data35 ,              ROUND(SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN satisfied_sucess_xdr_count                      ELSE 0                  END)/SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END),2.0) AS data36,              SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END) AS data37,              SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN satisfied_speed_xdr_count                      ELSE 0                  END) AS data38 ,              ROUND(SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN satisfied_speed_xdr_count                      ELSE 0                  END)/SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END),2.0) AS data39,              ROUND( SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN satisfied_sucess_xdr_count*satisfied_speed_xdr_count                      ELSE 0                  END)/SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN satisfied_xdr_count*satisfied_xdr_count                      ELSE 0                  END),2.0) AS data40          FROM              lte_sys.[@c0]_T_QUALITYSTATISTICS_ALLUSER tb2          LEFT JOIN              (                  SELECT                      city,                      scene2,                      SUM(xdr_count) sumcnt,                      SUM(delay)     sumdelay,                      SUM(dl_flow)   sumdl_flow                  FROM                      lte_sys.[@c0]_T_QUALITYSTATISTICS_ALLUSER                  WHERE                      nettype IN (1,2)                  AND AppType IN(15,1,5,6,7,8)                  AND hour>='[@c1]'                  AND hour<='[@c2]'                  GROUP BY                      city,                      scene2)tb1          ON              tb2.city=tb1.city          AND tb2.scene2=tb1.scene2          WHERE              nettype IN (1,2)          AND AppType IN(15,1,5,6,7,8)          AND hour>='[@c1]'          AND hour<='[@c2]'          GROUP BY              tb2.city,              tb2.scene2,              tb2.AppType          UNION          SELECT              tb2.city,              '室内用户' AS data1,              (                  CASE                      WHEN AppType=1                      THEN '即时通信'                      WHEN AppType=15                      THEN '浏览下载'                      WHEN AppType=5                      THEN '视频'                      WHEN AppType=6                      THEN '音乐'                      WHEN AppType=7                      THEN '应用商店'                      WHEN AppType=8                      THEN '游戏'                  END ) AS data2,              ROUND(SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>0                      THEN delay                      ELSE 0                  END)/1000/60,2.0) AS data3,              ROUND(SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>0                      THEN delay                      ELSE 0                  END)/MAX(tb1.sumdelay),2.0) AS data4 ,              ROUND(SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>0                      THEN delay                      ELSE 0                  END)/1000/60,2.0) AS data5,              ROUND( SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>0                      THEN delay                      ELSE 0                  END)/MAX(tb1.sumdelay),2.0) AS data6 ,              ROUND(SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>0                      THEN dl_flow                      ELSE 0                  END)/1024/1024,2.0) AS data7,              ROUND( SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>0                      THEN dl_flow                      ELSE 0                  END)/MAX(tb1.sumdl_flow),2.0) AS data8 ,              ROUND( SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>0                      THEN dl_flow                      ELSE 0                  END)/1024/1024,2.0) AS data9,              ROUND( SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>0                      THEN dl_flow                      ELSE 0                  END)/MAX(tb1.sumdl_flow) ,2.0)AS data10 ,              ROUND(SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>0                      THEN delay                      ELSE 0                  END)/1000/60,2.0) AS data41,              ROUND(SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>0                      THEN dl_flow                      ELSE 0                  END)/1024/1024,2.0) AS data42 ,              ROUND( SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>0                      THEN dl_flow                      ELSE 0                  END)/SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>0                      THEN delay                      ELSE 0                  END)*8000/1024,2.0) AS data43,              ROUND(SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>0                      THEN delay                      ELSE 0                  END)/1000/60,2.0) AS data44,              ROUND( SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>0                      THEN dl_flow                      ELSE 0                  END)/1024/1024,2.0) AS data45 ,              ROUND( SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>0                      THEN dl_flow                      ELSE 0                  END)/SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>0                      THEN delay                      ELSE 0                  END)*8000/1024,2.0) AS data46,              ROUND(SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>0                      THEN delay                      ELSE 0                  END)/1000/60,2.0) AS data47,              ROUND( SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>0                      THEN dl_flow                      ELSE 0                  END)/1024/1024,2.0) AS data48,              ROUND(SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>0                      THEN dl_flow                      ELSE 0                  END)/SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>0                      THEN delay                      ELSE 0                  END)*8000/1024,2.0) AS data49 ,              ROUND(SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN delay                      ELSE 0                  END)/1000/60,2.0) AS data11,              ROUND(SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN dl_flow                      ELSE 0                  END)/1024/1024,2.0) AS data12,              ROUND( SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN dl_flow                      ELSE 0                  END)/SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN delay                      ELSE 0                  END)*8000/1024,2.0) AS data13,              SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END) AS data14,              SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN satisfied_sucess_xdr_count                      ELSE 0                  END) AS data15 ,              ROUND(SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN satisfied_sucess_xdr_count                      ELSE 0                  END)/SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END),2.0) AS data16,              SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END) AS data17,              SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN satisfied_speed_xdr_count                      ELSE 0                  END) AS data18 ,              ROUND(SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN satisfied_speed_xdr_count                      ELSE 0                  END)/SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END),2.0) AS data19,              ROUND(SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN satisfied_sucess_xdr_count*satisfied_speed_xdr_count                      ELSE 0                  END)/SUM(                  CASE                      WHEN nettype=1                      AND dl_flow>5120                      THEN satisfied_xdr_count*satisfied_xdr_count                      ELSE 0                  END),2.0) AS data20,              ROUND(SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN delay                      ELSE 0                  END)/1000/60,2.0) AS data21,              ROUND(SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN dl_flow                      ELSE 0                  END)/1024/1024,2.0) AS data22,              ROUND( SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN dl_flow                      ELSE 0                  END)/SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN delay                      ELSE 0                  END)*8000/1024,2.0) AS data23,              SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END) AS data24,              SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN satisfied_sucess_xdr_count                      ELSE 0                  END) AS data25 ,              ROUND( SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN satisfied_sucess_xdr_count                      ELSE 0                  END)/SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END),2.0) AS data26,              SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END) AS data27,              SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN satisfied_speed_xdr_count                      ELSE 0                  END) AS data28 ,              ROUND( SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN satisfied_speed_xdr_count                      ELSE 0                  END)/SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END),2.0) AS data29,              ROUND( SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN satisfied_sucess_xdr_count*satisfied_speed_xdr_count                      ELSE 0                  END)/SUM(                  CASE                      WHEN nettype=2                      AND dl_flow>5120                      THEN satisfied_xdr_count*satisfied_xdr_count                      ELSE 0                  END),2.0) AS data30,              ROUND( SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN delay                      ELSE 0                  END)/1000/60,2.0) AS data31,              ROUND(SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN dl_flow                      ELSE 0                  END)/1024/1024,2.0) AS data32,              ROUND(SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN dl_flow                      ELSE 0                  END)/SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN delay                      ELSE 0                  END)*8000/1024,2.0) AS data33,              SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END) AS data34,              SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN satisfied_sucess_xdr_count                      ELSE 0                  END) AS data35 ,              ROUND(SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN satisfied_sucess_xdr_count                      ELSE 0                  END)/SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END),2.0) AS data36,              SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END) AS data37,              SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN satisfied_speed_xdr_count                      ELSE 0                  END) AS data38 ,              ROUND(SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN satisfied_speed_xdr_count                      ELSE 0                  END)/SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN satisfied_xdr_count                      ELSE 0                  END),2.0) AS data39,              ROUND( SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN satisfied_sucess_xdr_count*satisfied_speed_xdr_count                      ELSE 0                  END)/SUM(                  CASE                      WHEN (nettype=1                          OR  nettype=2)                      AND dl_flow>5120                      THEN satisfied_xdr_count*satisfied_xdr_count                      ELSE 0                  END),2.0) AS data40          FROM              lte_sys.[@c0]_T_QUALITYSTATISTICS_ALLUSER tb2          LEFT JOIN              (                  SELECT                      city,                      SUM(xdr_count) sumcnt,                      SUM(delay)     sumdelay,                      SUM(dl_flow)   sumdl_flow                  FROM                      lte_sys.[@c0]_T_QUALITYSTATISTICS_ALLUSER                  WHERE                      nettype IN (1,2)                  AND AppType IN(15,1,5,6,7,8)                  AND hour>='[@c1]'                  AND hour<='[@c2]'                  AND scene1<>1                  GROUP BY                      city)tb1          ON              tb2.city=tb1.city          WHERE              nettype IN (1,2)          AND AppType IN(15,1,5,6,7,8)          AND hour>='[@c1]'          AND hour<='[@c2]'          AND scene1<>1          GROUP BY              tb2.city,              tb2.AppType ) T  WHERE      t.city='[@c3]'  AND t.data2='[@c4]'  ORDER BY      t.data1"
      }
    }
  ]
}