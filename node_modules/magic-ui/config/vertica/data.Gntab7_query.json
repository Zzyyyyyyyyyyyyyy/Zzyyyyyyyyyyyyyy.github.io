{
  "module": "m2",
  "flag": "vertical",
  "configs": [
    {
      "key": "query_gntab7_1",
      "desc": "占比分析-上行_全国",
      "config": {
        "parameters": [
          {
            "name": "preData",
            "type": "object",
            "conditions": {
              "cnd": [
                {
                  "key": "city_no",
                  "columnname": "gn.city_no",
                  "type": "string",
                  "format": "",
                  "conditionid": "city0",
                  "symbol": "="
                },
                {
                  "key": "starttime",
                  "columnname": "starttime",
                  "type": "string",
                  "format": "",
                  "conditionid": "time0",
                  "symbol": "in"
                }
              ],
              "co": "or"
            }
          },
          {
            "name": "preDatacategory",
            "type": "object",
            "conditions": {
              "cnd": [
                {
                  "key": "service",
                  "columnname": "gn.city_no",
                  "type": "string",
                  "format": "",
                  "conditionid": "cate0",
                  "symbol": "="
                },
                {
                  "key": "bussinesstype",
                  "columnname": "service",
                  "type": "string",
                  "format": "",
                  "conditionid": "subapp0",
                  "symbol": "in"
                }
              ],
              "co": "or"
            }
          },
          {
            "name": "preDataterminal",
            "type": "projects",
            "conditions": [
              {
                "key": "terminal",
                "columnname": "",
                "type": "string",
                "format": "",
                "conditionid": "terminal0",
                "symbol": ""
              },
              {
                "key": "terminalname",
                "columnname": "",
                "type": "string",
                "format": "",
                "conditionid": "terminalname0",
                "symbol": ""
              },
              {
                "key": "filetypename",
                "columnname": "",
                "type": "string",
                "format": "",
                "conditionid": "filetypename",
                "symbol": ""
              }
            ]
          },
          {
            "name": "p_en",
            "columnname": "",
            "type": "string",
            "format": "",
            "conditionid": "p0",
            "symbol": ""
          },
          {
            "name": "factory",
            "columnname": "EQUIPMENT",
            "type": "string",
            "format": "",
            "conditionid": "fac0",
            "symbol": "="
          }
        ],
        "value": "SELECT       '全国' PRONAME,       '汇总' CITYNAME,       '汇总' AS EQUIPMENT,       '[@terminalname0]' TERMINAL,       '[@filetypename]' FILETYPE,       '' CATEGORY,       '' BUSINESS,       ROUND(CASE WHEN SUM(T.DELAY)=0 THEN NULL ELSE SUM(T.ULTRAFFIC)*8000/1024/SUM(T.DELAY) END,3.0) DOWNSPEED,       ROUND(SUM(T.DELAY)/1000,3.0) DOWNDELAY,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 1, T.DELAY/1000, NULL)),3.0) DOWNDELAY1,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 2, T.DELAY/1000, NULL)),3.0) DOWNDELAY2,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 3, T.DELAY/1000, NULL)),3.0) DOWNDELAY3,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 4, T.DELAY/1000, NULL)),3.0) DOWNDELAY4,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 5, T.DELAY/1000, NULL)),3.0) DOWNDELAY5,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 6, T.DELAY/1000, NULL)),3.0) DOWNDELAY6,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 7, T.DELAY/1000, NULL)),3.0) DOWNDELAY7,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 8, T.DELAY/1000, NULL)),3.0) DOWNDELAY8,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 9, T.DELAY/1000, NULL)),3.0) DOWNDELAY9,        MAX(DECODE(T.LTEUPSPEEDGROUP, 1, T.RATIO_DELAY1, NULL)) DOWNDELAYPER1,       MAX(DECODE(T.LTEUPSPEEDGROUP, 2, T.RATIO_DELAY1, NULL)) DOWNDELAYPER2,       MAX(DECODE(T.LTEUPSPEEDGROUP, 3, T.RATIO_DELAY1, NULL)) DOWNDELAYPER3,       MAX(DECODE(T.LTEUPSPEEDGROUP, 4, T.RATIO_DELAY1, NULL)) DOWNDELAYPER4,       MAX(DECODE(T.LTEUPSPEEDGROUP, 5, T.RATIO_DELAY1, NULL)) DOWNDELAYPER5,       MAX(DECODE(T.LTEUPSPEEDGROUP, 6, T.RATIO_DELAY1, NULL)) DOWNDELAYPER6,       MAX(DECODE(T.LTEUPSPEEDGROUP, 7, T.RATIO_DELAY1, NULL)) DOWNDELAYPER7,       MAX(DECODE(T.LTEUPSPEEDGROUP, 8, T.RATIO_DELAY1, NULL)) DOWNDELAYPER8,       MAX(DECODE(T.LTEUPSPEEDGROUP, 9, T.RATIO_DELAY1, NULL)) DOWNDELAYPER9,       SUM(T.ALLCOUNT) DOWNREQUEST,       MAX(DECODE(T.LTEUPSPEEDGROUP, 1, T.ALLCOUNT, NULL)) DOWNREQUEST1,       MAX(DECODE(T.LTEUPSPEEDGROUP, 2, T.ALLCOUNT, NULL)) DOWNREQUEST2,       MAX(DECODE(T.LTEUPSPEEDGROUP, 3, T.ALLCOUNT, NULL)) DOWNREQUEST3,       MAX(DECODE(T.LTEUPSPEEDGROUP, 4, T.ALLCOUNT, NULL)) DOWNREQUEST4,       MAX(DECODE(T.LTEUPSPEEDGROUP, 5, T.ALLCOUNT, NULL)) DOWNREQUEST5,       MAX(DECODE(T.LTEUPSPEEDGROUP, 6, T.ALLCOUNT, NULL)) DOWNREQUEST6,       MAX(DECODE(T.LTEUPSPEEDGROUP, 7, T.ALLCOUNT, NULL)) DOWNREQUEST7,       MAX(DECODE(T.LTEUPSPEEDGROUP, 8, T.ALLCOUNT, NULL)) DOWNREQUEST8,       MAX(DECODE(T.LTEUPSPEEDGROUP, 9, T.ALLCOUNT, NULL)) DOWNREQUEST9,        MAX(DECODE(T.LTEUPSPEEDGROUP, 1, T.RATIO_ALLCOUNT, NULL)) DOWNREQUESTPER1,       MAX(DECODE(T.LTEUPSPEEDGROUP, 2, T.RATIO_ALLCOUNT, NULL)) DOWNREQUESTPER2,       MAX(DECODE(T.LTEUPSPEEDGROUP, 3, T.RATIO_ALLCOUNT, NULL)) DOWNREQUESTPER3,       MAX(DECODE(T.LTEUPSPEEDGROUP, 4, T.RATIO_ALLCOUNT, NULL)) DOWNREQUESTPER4,       MAX(DECODE(T.LTEUPSPEEDGROUP, 5, T.RATIO_ALLCOUNT, NULL)) DOWNREQUESTPER5,       MAX(DECODE(T.LTEUPSPEEDGROUP, 6, T.RATIO_ALLCOUNT, NULL)) DOWNREQUESTPER6,       MAX(DECODE(T.LTEUPSPEEDGROUP, 7, T.RATIO_ALLCOUNT, NULL)) DOWNREQUESTPER7,       MAX(DECODE(T.LTEUPSPEEDGROUP, 8, T.RATIO_ALLCOUNT, NULL)) DOWNREQUESTPER8,       MAX(DECODE(T.LTEUPSPEEDGROUP, 9, T.RATIO_ALLCOUNT, NULL)) DOWNREQUESTPER9,        ROUND(SUM(T.ULTRAFFIC/1024/1024), 3.0) DOWNTRAFFIC,        ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 1, T.ULTRAFFIC/1024/1024, NULL)),3.0) DOWNTRAFFIC1,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 2, T.ULTRAFFIC/1024/1024, NULL)),3.0) DOWNTRAFFIC2,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 3, T.ULTRAFFIC/1024/1024, NULL)),3.0) DOWNTRAFFIC3,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 4, T.ULTRAFFIC/1024/1024, NULL)),3.0) DOWNTRAFFIC4,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 5, T.ULTRAFFIC/1024/1024, NULL)),3.0) DOWNTRAFFIC5,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 6, T.ULTRAFFIC/1024/1024, NULL)),3.0) DOWNTRAFFIC6,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 7, T.ULTRAFFIC/1024/1024, NULL)),3.0) DOWNTRAFFIC7,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 8, T.ULTRAFFIC/1024/1024, NULL)),3.0) DOWNTRAFFIC8,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 9, T.ULTRAFFIC/1024/1024, NULL)),3.0) DOWNTRAFFIC9,        MAX(DECODE(T.LTEUPSPEEDGROUP, 1, T.RATIO_ULTRAFFIC, NULL)) DOWNTRAFFICPER1,       MAX(DECODE(T.LTEUPSPEEDGROUP, 2, T.RATIO_ULTRAFFIC, NULL)) DOWNTRAFFICPER2,       MAX(DECODE(T.LTEUPSPEEDGROUP, 3, T.RATIO_ULTRAFFIC, NULL)) DOWNTRAFFICPER3,       MAX(DECODE(T.LTEUPSPEEDGROUP, 4, T.RATIO_ULTRAFFIC, NULL)) DOWNTRAFFICPER4,       MAX(DECODE(T.LTEUPSPEEDGROUP, 5, T.RATIO_ULTRAFFIC, NULL)) DOWNTRAFFICPER5,       MAX(DECODE(T.LTEUPSPEEDGROUP, 6, T.RATIO_ULTRAFFIC, NULL)) DOWNTRAFFICPER6,       MAX(DECODE(T.LTEUPSPEEDGROUP, 7, T.RATIO_ULTRAFFIC, NULL)) DOWNTRAFFICPER7,       MAX(DECODE(T.LTEUPSPEEDGROUP, 8, T.RATIO_ULTRAFFIC, NULL)) DOWNTRAFFICPER8,       MAX(DECODE(T.LTEUPSPEEDGROUP, 9, T.RATIO_ULTRAFFIC, NULL)) DOWNTRAFFICPER9       FROM (       SELECT       GN.LTEUPSPEEDGROUP,       SUM(GN.ALLCOUNT) ALLCOUNT,       ROUND(100*SUM(GN.ALLCOUNT)/SUM(SUM(GN.ALLCOUNT)) OVER(),3.0) RATIO_ALLCOUNT,       SUM(GN.ULDELAY) DELAY,       ROUND(100*SUM(GN.ULDELAY)/SUM(SUM(GN.ULDELAY)) OVER(),3.0) RATIO_DELAY1,       SUM(GN.ULTRAFFIC) ULTRAFFIC,       ROUND(100*SUM(GN.ULTRAFFIC)/SUM(SUM(GN.ULTRAFFIC)) OVER(),3.0) RATIO_ULTRAFFIC       FROM lte_sys.[@p0]_T_GN_SUM_ALLFILE GN       WHERE 1=1 [@and] ${[@city0] [@and] [@time0]}& [@and] ${[@cate0] [@and] [@subapp0]}& [@and] [@terminal0] [@and] [@fac0]       GROUP BY GN.LTEUPSPEEDGROUP       ) T       UNION       SELECT       '全国' PRONAME,       '汇总' CITYNAME,       CASE WHEN T.EQUIPMENT IS NULL THEN '未匹配' ELSE T.EQUIPMENT END AS EQUIPMENT,       '[@terminalname0]' TERMINAL,       '[@filetypename]' FILETYPE,       '' CATEGORY,       '' BUSINESS,       ROUND(CASE WHEN SUM(T.DELAY)=0 THEN NULL ELSE SUM(T.ULTRAFFIC)*8000/1024/SUM(T.DELAY) END,3.0) DOWNSPEED,       ROUND(SUM(T.DELAY)/1000,3.0) DOWNDELAY,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 1, T.DELAY/1000, NULL)),3.0) DOWNDELAY1,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 2, T.DELAY/1000, NULL)),3.0) DOWNDELAY2,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 3, T.DELAY/1000, NULL)),3.0) DOWNDELAY3,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 4, T.DELAY/1000, NULL)),3.0) DOWNDELAY4,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 5, T.DELAY/1000, NULL)),3.0) DOWNDELAY5,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 6, T.DELAY/1000, NULL)),3.0) DOWNDELAY6,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 7, T.DELAY/1000, NULL)),3.0) DOWNDELAY7,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 8, T.DELAY/1000, NULL)),3.0) DOWNDELAY8,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 9, T.DELAY/1000, NULL)),3.0) DOWNDELAY9,        MAX(DECODE(T.LTEUPSPEEDGROUP, 1, T.RATIO_DELAY1, NULL)) DOWNDELAYPER1,       MAX(DECODE(T.LTEUPSPEEDGROUP, 2, T.RATIO_DELAY1, NULL)) DOWNDELAYPER2,       MAX(DECODE(T.LTEUPSPEEDGROUP, 3, T.RATIO_DELAY1, NULL)) DOWNDELAYPER3,       MAX(DECODE(T.LTEUPSPEEDGROUP, 4, T.RATIO_DELAY1, NULL)) DOWNDELAYPER4,       MAX(DECODE(T.LTEUPSPEEDGROUP, 5, T.RATIO_DELAY1, NULL)) DOWNDELAYPER5,       MAX(DECODE(T.LTEUPSPEEDGROUP, 6, T.RATIO_DELAY1, NULL)) DOWNDELAYPER6,       MAX(DECODE(T.LTEUPSPEEDGROUP, 7, T.RATIO_DELAY1, NULL)) DOWNDELAYPER7,       MAX(DECODE(T.LTEUPSPEEDGROUP, 8, T.RATIO_DELAY1, NULL)) DOWNDELAYPER8,       MAX(DECODE(T.LTEUPSPEEDGROUP, 9, T.RATIO_DELAY1, NULL)) DOWNDELAYPER9,       SUM(T.ALLCOUNT) DOWNREQUEST,       MAX(DECODE(T.LTEUPSPEEDGROUP, 1, T.ALLCOUNT, NULL)) DOWNREQUEST1,       MAX(DECODE(T.LTEUPSPEEDGROUP, 2, T.ALLCOUNT, NULL)) DOWNREQUEST2,       MAX(DECODE(T.LTEUPSPEEDGROUP, 3, T.ALLCOUNT, NULL)) DOWNREQUEST3,       MAX(DECODE(T.LTEUPSPEEDGROUP, 4, T.ALLCOUNT, NULL)) DOWNREQUEST4,       MAX(DECODE(T.LTEUPSPEEDGROUP, 5, T.ALLCOUNT, NULL)) DOWNREQUEST5,       MAX(DECODE(T.LTEUPSPEEDGROUP, 6, T.ALLCOUNT, NULL)) DOWNREQUEST6,       MAX(DECODE(T.LTEUPSPEEDGROUP, 7, T.ALLCOUNT, NULL)) DOWNREQUEST7,       MAX(DECODE(T.LTEUPSPEEDGROUP, 8, T.ALLCOUNT, NULL)) DOWNREQUEST8,       MAX(DECODE(T.LTEUPSPEEDGROUP, 9, T.ALLCOUNT, NULL)) DOWNREQUEST9,        MAX(DECODE(T.LTEUPSPEEDGROUP, 1, T.RATIO_ALLCOUNT, NULL)) DOWNREQUESTPER1,       MAX(DECODE(T.LTEUPSPEEDGROUP, 2, T.RATIO_ALLCOUNT, NULL)) DOWNREQUESTPER2,       MAX(DECODE(T.LTEUPSPEEDGROUP, 3, T.RATIO_ALLCOUNT, NULL)) DOWNREQUESTPER3,       MAX(DECODE(T.LTEUPSPEEDGROUP, 4, T.RATIO_ALLCOUNT, NULL)) DOWNREQUESTPER4,       MAX(DECODE(T.LTEUPSPEEDGROUP, 5, T.RATIO_ALLCOUNT, NULL)) DOWNREQUESTPER5,       MAX(DECODE(T.LTEUPSPEEDGROUP, 6, T.RATIO_ALLCOUNT, NULL)) DOWNREQUESTPER6,       MAX(DECODE(T.LTEUPSPEEDGROUP, 7, T.RATIO_ALLCOUNT, NULL)) DOWNREQUESTPER7,       MAX(DECODE(T.LTEUPSPEEDGROUP, 8, T.RATIO_ALLCOUNT, NULL)) DOWNREQUESTPER8,       MAX(DECODE(T.LTEUPSPEEDGROUP, 9, T.RATIO_ALLCOUNT, NULL)) DOWNREQUESTPER9,        ROUND(SUM(T.ULTRAFFIC/1024/1024), 3.0) DOWNTRAFFIC,        ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 1, T.ULTRAFFIC/1024/1024, NULL)),3.0) DOWNTRAFFIC1,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 2, T.ULTRAFFIC/1024/1024, NULL)),3.0) DOWNTRAFFIC2,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 3, T.ULTRAFFIC/1024/1024, NULL)),3.0) DOWNTRAFFIC3,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 4, T.ULTRAFFIC/1024/1024, NULL)),3.0) DOWNTRAFFIC4,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 5, T.ULTRAFFIC/1024/1024, NULL)),3.0) DOWNTRAFFIC5,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 6, T.ULTRAFFIC/1024/1024, NULL)),3.0) DOWNTRAFFIC6,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 7, T.ULTRAFFIC/1024/1024, NULL)),3.0) DOWNTRAFFIC7,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 8, T.ULTRAFFIC/1024/1024, NULL)),3.0) DOWNTRAFFIC8,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 9, T.ULTRAFFIC/1024/1024, NULL)),3.0) DOWNTRAFFIC9,        MAX(DECODE(T.LTEUPSPEEDGROUP, 1, T.RATIO_ULTRAFFIC, NULL)) DOWNTRAFFICPER1,       MAX(DECODE(T.LTEUPSPEEDGROUP, 2, T.RATIO_ULTRAFFIC, NULL)) DOWNTRAFFICPER2,       MAX(DECODE(T.LTEUPSPEEDGROUP, 3, T.RATIO_ULTRAFFIC, NULL)) DOWNTRAFFICPER3,       MAX(DECODE(T.LTEUPSPEEDGROUP, 4, T.RATIO_ULTRAFFIC, NULL)) DOWNTRAFFICPER4,       MAX(DECODE(T.LTEUPSPEEDGROUP, 5, T.RATIO_ULTRAFFIC, NULL)) DOWNTRAFFICPER5,       MAX(DECODE(T.LTEUPSPEEDGROUP, 6, T.RATIO_ULTRAFFIC, NULL)) DOWNTRAFFICPER6,       MAX(DECODE(T.LTEUPSPEEDGROUP, 7, T.RATIO_ULTRAFFIC, NULL)) DOWNTRAFFICPER7,       MAX(DECODE(T.LTEUPSPEEDGROUP, 8, T.RATIO_ULTRAFFIC, NULL)) DOWNTRAFFICPER8,       MAX(DECODE(T.LTEUPSPEEDGROUP, 9, T.RATIO_ULTRAFFIC, NULL)) DOWNTRAFFICPER9       FROM (       SELECT       GN.EQUIPMENT,       GN.LTEUPSPEEDGROUP,       SUM(GN.ALLCOUNT) ALLCOUNT,       ROUND(100*SUM(GN.ALLCOUNT)/SUM(SUM(GN.ALLCOUNT)) OVER(),3.0) RATIO_ALLCOUNT,       SUM(GN.ULDELAY) DELAY,       ROUND(100*SUM(GN.ULDELAY)/SUM(SUM(GN.ULDELAY)) OVER(),3.0) RATIO_DELAY1,       SUM(GN.ULTRAFFIC) ULTRAFFIC,       ROUND(100*SUM(GN.ULTRAFFIC)/SUM(SUM(GN.ULTRAFFIC)) OVER(),3.0) RATIO_ULTRAFFIC       FROM lte_sys.[@p0]_T_GN_SUM_ALLFILE GN       WHERE 1=1 [@and] ${[@city0] [@and] [@time0]}& [@and] ${[@cate0] [@and] [@subapp0]}& [@and] [@terminal0] [@and] [@fac0]       GROUP BY GN.LTEUPSPEEDGROUP,GN.EQUIPMENT       ) T       GROUP BY T.EQUIPMENT       union       SELECT       '全国' PRONAME,       '汇总' CITYNAME,       '汇总' AS EQUIPMENT,       '[@terminalname0]' TERMINAL,       '[@filetypename]' FILETYPE,       CATE.CATEGORYNAME CATEGORY,       '汇总' BUSINESS,       ROUND(CASE WHEN SUM(T.DELAY)=0 THEN NULL ELSE SUM(T.ULTRAFFIC)*8000/1024/SUM(T.DELAY) END,3.0) DOWNSPEED,       ROUND(SUM(T.DELAY)/1000,3.0) DOWNDELAY,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 1, T.DELAY/1000, NULL)),3.0) DOWNDELAY1,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 2, T.DELAY/1000, NULL)),3.0) DOWNDELAY2,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 3, T.DELAY/1000, NULL)),3.0) DOWNDELAY3,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 4, T.DELAY/1000, NULL)),3.0) DOWNDELAY4,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 5, T.DELAY/1000, NULL)),3.0) DOWNDELAY5,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 6, T.DELAY/1000, NULL)),3.0) DOWNDELAY6,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 7, T.DELAY/1000, NULL)),3.0) DOWNDELAY7,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 8, T.DELAY/1000, NULL)),3.0) DOWNDELAY8,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 9, T.DELAY/1000, NULL)),3.0) DOWNDELAY9,        MAX(DECODE(T.LTEUPSPEEDGROUP, 1, T.RATIO_DELAY1, NULL)) DOWNDELAYPER1,       MAX(DECODE(T.LTEUPSPEEDGROUP, 2, T.RATIO_DELAY1, NULL)) DOWNDELAYPER2,       MAX(DECODE(T.LTEUPSPEEDGROUP, 3, T.RATIO_DELAY1, NULL)) DOWNDELAYPER3,       MAX(DECODE(T.LTEUPSPEEDGROUP, 4, T.RATIO_DELAY1, NULL)) DOWNDELAYPER4,       MAX(DECODE(T.LTEUPSPEEDGROUP, 5, T.RATIO_DELAY1, NULL)) DOWNDELAYPER5,       MAX(DECODE(T.LTEUPSPEEDGROUP, 6, T.RATIO_DELAY1, NULL)) DOWNDELAYPER6,       MAX(DECODE(T.LTEUPSPEEDGROUP, 7, T.RATIO_DELAY1, NULL)) DOWNDELAYPER7,       MAX(DECODE(T.LTEUPSPEEDGROUP, 8, T.RATIO_DELAY1, NULL)) DOWNDELAYPER8,       MAX(DECODE(T.LTEUPSPEEDGROUP, 9, T.RATIO_DELAY1, NULL)) DOWNDELAYPER9,       SUM(T.ALLCOUNT) DOWNREQUEST,       MAX(DECODE(T.LTEUPSPEEDGROUP, 1, T.ALLCOUNT, NULL)) DOWNREQUEST1,       MAX(DECODE(T.LTEUPSPEEDGROUP, 2, T.ALLCOUNT, NULL)) DOWNREQUEST2,       MAX(DECODE(T.LTEUPSPEEDGROUP, 3, T.ALLCOUNT, NULL)) DOWNREQUEST3,       MAX(DECODE(T.LTEUPSPEEDGROUP, 4, T.ALLCOUNT, NULL)) DOWNREQUEST4,       MAX(DECODE(T.LTEUPSPEEDGROUP, 5, T.ALLCOUNT, NULL)) DOWNREQUEST5,       MAX(DECODE(T.LTEUPSPEEDGROUP, 6, T.ALLCOUNT, NULL)) DOWNREQUEST6,       MAX(DECODE(T.LTEUPSPEEDGROUP, 7, T.ALLCOUNT, NULL)) DOWNREQUEST7,       MAX(DECODE(T.LTEUPSPEEDGROUP, 8, T.ALLCOUNT, NULL)) DOWNREQUEST8,       MAX(DECODE(T.LTEUPSPEEDGROUP, 9, T.ALLCOUNT, NULL)) DOWNREQUEST9,        MAX(DECODE(T.LTEUPSPEEDGROUP, 1, T.RATIO_ALLCOUNT, NULL)) DOWNREQUESTPER1,       MAX(DECODE(T.LTEUPSPEEDGROUP, 2, T.RATIO_ALLCOUNT, NULL)) DOWNREQUESTPER2,       MAX(DECODE(T.LTEUPSPEEDGROUP, 3, T.RATIO_ALLCOUNT, NULL)) DOWNREQUESTPER3,       MAX(DECODE(T.LTEUPSPEEDGROUP, 4, T.RATIO_ALLCOUNT, NULL)) DOWNREQUESTPER4,       MAX(DECODE(T.LTEUPSPEEDGROUP, 5, T.RATIO_ALLCOUNT, NULL)) DOWNREQUESTPER5,       MAX(DECODE(T.LTEUPSPEEDGROUP, 6, T.RATIO_ALLCOUNT, NULL)) DOWNREQUESTPER6,       MAX(DECODE(T.LTEUPSPEEDGROUP, 7, T.RATIO_ALLCOUNT, NULL)) DOWNREQUESTPER7,       MAX(DECODE(T.LTEUPSPEEDGROUP, 8, T.RATIO_ALLCOUNT, NULL)) DOWNREQUESTPER8,       MAX(DECODE(T.LTEUPSPEEDGROUP, 9, T.RATIO_ALLCOUNT, NULL)) DOWNREQUESTPER9,        ROUND(SUM(T.ULTRAFFIC/1024/1024), 3.0) DOWNTRAFFIC,        ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 1, T.ULTRAFFIC/1024/1024, NULL)),3.0) DOWNTRAFFIC1,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 2, T.ULTRAFFIC/1024/1024, NULL)),3.0) DOWNTRAFFIC2,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 3, T.ULTRAFFIC/1024/1024, NULL)),3.0) DOWNTRAFFIC3,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 4, T.ULTRAFFIC/1024/1024, NULL)),3.0) DOWNTRAFFIC4,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 5, T.ULTRAFFIC/1024/1024, NULL)),3.0) DOWNTRAFFIC5,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 6, T.ULTRAFFIC/1024/1024, NULL)),3.0) DOWNTRAFFIC6,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 7, T.ULTRAFFIC/1024/1024, NULL)),3.0) DOWNTRAFFIC7,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 8, T.ULTRAFFIC/1024/1024, NULL)),3.0) DOWNTRAFFIC8,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 9, T.ULTRAFFIC/1024/1024, NULL)),3.0) DOWNTRAFFIC9,        MAX(DECODE(T.LTEUPSPEEDGROUP, 1, T.RATIO_ULTRAFFIC, NULL)) DOWNTRAFFICPER1,       MAX(DECODE(T.LTEUPSPEEDGROUP, 2, T.RATIO_ULTRAFFIC, NULL)) DOWNTRAFFICPER2,       MAX(DECODE(T.LTEUPSPEEDGROUP, 3, T.RATIO_ULTRAFFIC, NULL)) DOWNTRAFFICPER3,       MAX(DECODE(T.LTEUPSPEEDGROUP, 4, T.RATIO_ULTRAFFIC, NULL)) DOWNTRAFFICPER4,       MAX(DECODE(T.LTEUPSPEEDGROUP, 5, T.RATIO_ULTRAFFIC, NULL)) DOWNTRAFFICPER5,       MAX(DECODE(T.LTEUPSPEEDGROUP, 6, T.RATIO_ULTRAFFIC, NULL)) DOWNTRAFFICPER6,       MAX(DECODE(T.LTEUPSPEEDGROUP, 7, T.RATIO_ULTRAFFIC, NULL)) DOWNTRAFFICPER7,       MAX(DECODE(T.LTEUPSPEEDGROUP, 8, T.RATIO_ULTRAFFIC, NULL)) DOWNTRAFFICPER8,       MAX(DECODE(T.LTEUPSPEEDGROUP, 9, T.RATIO_ULTRAFFIC, NULL)) DOWNTRAFFICPER9       FROM (       SELECT       GN.SERVICE,       GN.LTEUPSPEEDGROUP,       SUM(GN.ALLCOUNT) ALLCOUNT,       ROUND(100*SUM(GN.ALLCOUNT)/SUM(SUM(GN.ALLCOUNT)) OVER(PARTITION BY GN.SERVICE),3.0) RATIO_ALLCOUNT,       SUM(GN.ULDELAY) DELAY,       ROUND(100*SUM(GN.ULDELAY)/SUM(SUM(GN.ULDELAY)) OVER(PARTITION BY GN.SERVICE),3.0) RATIO_DELAY1,       SUM(GN.ULTRAFFIC) ULTRAFFIC,       ROUND(100*SUM(GN.ULTRAFFIC)/SUM(SUM(GN.ULTRAFFIC)) OVER(PARTITION BY GN.SERVICE),3.0) RATIO_ULTRAFFIC       FROM lte_sys.[@p0]_T_GN_SUM_ALLFILE GN       WHERE 1=1 [@and] ${[@city0] [@and] [@time0]}& [@and] ${[@cate0] [@and] [@subapp0]}& [@and] [@terminal0] [@and] [@fac0]       GROUP BY GN.LTEUPSPEEDGROUP,GN.SERVICE       ) T       INNER JOIN lte_sys.[@p0]_T_BASE_CATEGORYTYPE CATE ON CATE.CATEGORYID=T.SERVICE       GROUP BY CATE.CATEGORYNAME       UNION       SELECT       '全国' PRONAME,       '汇总' CITYNAME,       CASE WHEN T.EQUIPMENT IS NULL THEN '未匹配' ELSE T.EQUIPMENT END AS EQUIPMENT,       '[@terminalname0]' TERMINAL,       '[@filetypename]' FILETYPE,       CATE.CATEGORYNAME CATEGORY,       '汇总' BUSINESS,       ROUND(CASE WHEN SUM(T.DELAY)=0 THEN NULL ELSE SUM(T.ULTRAFFIC)*8000/1024/SUM(T.DELAY) END,3.0) DOWNSPEED,       ROUND(SUM(T.DELAY)/1000,3.0) DOWNDELAY,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 1, T.DELAY/1000, NULL)),3.0) DOWNDELAY1,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 2, T.DELAY/1000, NULL)),3.0) DOWNDELAY2,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 3, T.DELAY/1000, NULL)),3.0) DOWNDELAY3,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 4, T.DELAY/1000, NULL)),3.0) DOWNDELAY4,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 5, T.DELAY/1000, NULL)),3.0) DOWNDELAY5,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 6, T.DELAY/1000, NULL)),3.0) DOWNDELAY6,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 7, T.DELAY/1000, NULL)),3.0) DOWNDELAY7,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 8, T.DELAY/1000, NULL)),3.0) DOWNDELAY8,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 9, T.DELAY/1000, NULL)),3.0) DOWNDELAY9,        MAX(DECODE(T.LTEUPSPEEDGROUP, 1, T.RATIO_DELAY1, NULL)) DOWNDELAYPER1,       MAX(DECODE(T.LTEUPSPEEDGROUP, 2, T.RATIO_DELAY1, NULL)) DOWNDELAYPER2,       MAX(DECODE(T.LTEUPSPEEDGROUP, 3, T.RATIO_DELAY1, NULL)) DOWNDELAYPER3,       MAX(DECODE(T.LTEUPSPEEDGROUP, 4, T.RATIO_DELAY1, NULL)) DOWNDELAYPER4,       MAX(DECODE(T.LTEUPSPEEDGROUP, 5, T.RATIO_DELAY1, NULL)) DOWNDELAYPER5,       MAX(DECODE(T.LTEUPSPEEDGROUP, 6, T.RATIO_DELAY1, NULL)) DOWNDELAYPER6,       MAX(DECODE(T.LTEUPSPEEDGROUP, 7, T.RATIO_DELAY1, NULL)) DOWNDELAYPER7,       MAX(DECODE(T.LTEUPSPEEDGROUP, 8, T.RATIO_DELAY1, NULL)) DOWNDELAYPER8,       MAX(DECODE(T.LTEUPSPEEDGROUP, 9, T.RATIO_DELAY1, NULL)) DOWNDELAYPER9,       SUM(T.ALLCOUNT) DOWNREQUEST,       MAX(DECODE(T.LTEUPSPEEDGROUP, 1, T.ALLCOUNT, NULL)) DOWNREQUEST1,       MAX(DECODE(T.LTEUPSPEEDGROUP, 2, T.ALLCOUNT, NULL)) DOWNREQUEST2,       MAX(DECODE(T.LTEUPSPEEDGROUP, 3, T.ALLCOUNT, NULL)) DOWNREQUEST3,       MAX(DECODE(T.LTEUPSPEEDGROUP, 4, T.ALLCOUNT, NULL)) DOWNREQUEST4,       MAX(DECODE(T.LTEUPSPEEDGROUP, 5, T.ALLCOUNT, NULL)) DOWNREQUEST5,       MAX(DECODE(T.LTEUPSPEEDGROUP, 6, T.ALLCOUNT, NULL)) DOWNREQUEST6,       MAX(DECODE(T.LTEUPSPEEDGROUP, 7, T.ALLCOUNT, NULL)) DOWNREQUEST7,       MAX(DECODE(T.LTEUPSPEEDGROUP, 8, T.ALLCOUNT, NULL)) DOWNREQUEST8,       MAX(DECODE(T.LTEUPSPEEDGROUP, 9, T.ALLCOUNT, NULL)) DOWNREQUEST9,        MAX(DECODE(T.LTEUPSPEEDGROUP, 1, T.RATIO_ALLCOUNT, NULL)) DOWNREQUESTPER1,       MAX(DECODE(T.LTEUPSPEEDGROUP, 2, T.RATIO_ALLCOUNT, NULL)) DOWNREQUESTPER2,       MAX(DECODE(T.LTEUPSPEEDGROUP, 3, T.RATIO_ALLCOUNT, NULL)) DOWNREQUESTPER3,       MAX(DECODE(T.LTEUPSPEEDGROUP, 4, T.RATIO_ALLCOUNT, NULL)) DOWNREQUESTPER4,       MAX(DECODE(T.LTEUPSPEEDGROUP, 5, T.RATIO_ALLCOUNT, NULL)) DOWNREQUESTPER5,       MAX(DECODE(T.LTEUPSPEEDGROUP, 6, T.RATIO_ALLCOUNT, NULL)) DOWNREQUESTPER6,       MAX(DECODE(T.LTEUPSPEEDGROUP, 7, T.RATIO_ALLCOUNT, NULL)) DOWNREQUESTPER7,       MAX(DECODE(T.LTEUPSPEEDGROUP, 8, T.RATIO_ALLCOUNT, NULL)) DOWNREQUESTPER8,       MAX(DECODE(T.LTEUPSPEEDGROUP, 9, T.RATIO_ALLCOUNT, NULL)) DOWNREQUESTPER9,        ROUND(SUM(T.ULTRAFFIC/1024/1024), 3.0) DOWNTRAFFIC,        ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 1, T.ULTRAFFIC/1024/1024, NULL)),3.0) DOWNTRAFFIC1,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 2, T.ULTRAFFIC/1024/1024, NULL)),3.0) DOWNTRAFFIC2,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 3, T.ULTRAFFIC/1024/1024, NULL)),3.0) DOWNTRAFFIC3,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 4, T.ULTRAFFIC/1024/1024, NULL)),3.0) DOWNTRAFFIC4,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 5, T.ULTRAFFIC/1024/1024, NULL)),3.0) DOWNTRAFFIC5,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 6, T.ULTRAFFIC/1024/1024, NULL)),3.0) DOWNTRAFFIC6,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 7, T.ULTRAFFIC/1024/1024, NULL)),3.0) DOWNTRAFFIC7,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 8, T.ULTRAFFIC/1024/1024, NULL)),3.0) DOWNTRAFFIC8,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 9, T.ULTRAFFIC/1024/1024, NULL)),3.0) DOWNTRAFFIC9,        MAX(DECODE(T.LTEUPSPEEDGROUP, 1, T.RATIO_ULTRAFFIC, NULL)) DOWNTRAFFICPER1,       MAX(DECODE(T.LTEUPSPEEDGROUP, 2, T.RATIO_ULTRAFFIC, NULL)) DOWNTRAFFICPER2,       MAX(DECODE(T.LTEUPSPEEDGROUP, 3, T.RATIO_ULTRAFFIC, NULL)) DOWNTRAFFICPER3,       MAX(DECODE(T.LTEUPSPEEDGROUP, 4, T.RATIO_ULTRAFFIC, NULL)) DOWNTRAFFICPER4,       MAX(DECODE(T.LTEUPSPEEDGROUP, 5, T.RATIO_ULTRAFFIC, NULL)) DOWNTRAFFICPER5,       MAX(DECODE(T.LTEUPSPEEDGROUP, 6, T.RATIO_ULTRAFFIC, NULL)) DOWNTRAFFICPER6,       MAX(DECODE(T.LTEUPSPEEDGROUP, 7, T.RATIO_ULTRAFFIC, NULL)) DOWNTRAFFICPER7,       MAX(DECODE(T.LTEUPSPEEDGROUP, 8, T.RATIO_ULTRAFFIC, NULL)) DOWNTRAFFICPER8,       MAX(DECODE(T.LTEUPSPEEDGROUP, 9, T.RATIO_ULTRAFFIC, NULL)) DOWNTRAFFICPER9       FROM (       SELECT       GN.EQUIPMENT,       GN.SERVICE,       GN.LTEUPSPEEDGROUP,       SUM(GN.ALLCOUNT) ALLCOUNT,       ROUND(100*SUM(GN.ALLCOUNT)/SUM(SUM(GN.ALLCOUNT)) OVER(PARTITION BY GN.SERVICE),3.0) RATIO_ALLCOUNT,       SUM(GN.ULDELAY) DELAY,       ROUND(100*SUM(GN.ULDELAY)/SUM(SUM(GN.ULDELAY)) OVER(PARTITION BY GN.SERVICE),3.0) RATIO_DELAY1,       SUM(GN.ULTRAFFIC) ULTRAFFIC,       ROUND(100*SUM(GN.ULTRAFFIC)/SUM(SUM(GN.ULTRAFFIC)) OVER(PARTITION BY GN.SERVICE),3.0) RATIO_ULTRAFFIC       FROM lte_sys.[@p0]_T_GN_SUM_ALLFILE GN       WHERE 1=1 [@and] ${[@city0] [@and] [@time0]}& [@and] ${[@cate0] [@and] [@subapp0]}& [@and] [@terminal0] [@and] [@fac0]       GROUP BY GN.LTEUPSPEEDGROUP,GN.SERVICE,GN.EQUIPMENT       ) T       INNER JOIN lte_sys.[@p0]_T_BASE_CATEGORYTYPE CATE ON CATE.CATEGORYID=T.SERVICE       GROUP BY CATE.CATEGORYNAME,T.EQUIPMENT       union       SELECT       '全国' PRONAME,       '汇总' CITYNAME,       '汇总' AS EQUIPMENT,       '[@terminalname0]' TERMINAL,       '[@filetypename]' FILETYPE,       CATE.CATEGORYNAME CATEGORY,       CATE.BUSSINESSNAME BUSINESS,       ROUND(CASE WHEN SUM(T.DELAY)=0 THEN NULL ELSE SUM(T.ULTRAFFIC)*8000/1024/SUM(T.DELAY) END,3.0) DOWNSPEED,       ROUND(SUM(T.DELAY)/1000,3.0) DOWNDELAY,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 1, T.DELAY/1000, NULL)),3.0) DOWNDELAY1,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 2, T.DELAY/1000, NULL)),3.0) DOWNDELAY2,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 3, T.DELAY/1000, NULL)),3.0) DOWNDELAY3,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 4, T.DELAY/1000, NULL)),3.0) DOWNDELAY4,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 5, T.DELAY/1000, NULL)),3.0) DOWNDELAY5,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 6, T.DELAY/1000, NULL)),3.0) DOWNDELAY6,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 7, T.DELAY/1000, NULL)),3.0) DOWNDELAY7,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 8, T.DELAY/1000, NULL)),3.0) DOWNDELAY8,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 9, T.DELAY/1000, NULL)),3.0) DOWNDELAY9,        MAX(DECODE(T.LTEUPSPEEDGROUP, 1, T.RATIO_DELAY1, NULL)) DOWNDELAYPER1,       MAX(DECODE(T.LTEUPSPEEDGROUP, 2, T.RATIO_DELAY1, NULL)) DOWNDELAYPER2,       MAX(DECODE(T.LTEUPSPEEDGROUP, 3, T.RATIO_DELAY1, NULL)) DOWNDELAYPER3,       MAX(DECODE(T.LTEUPSPEEDGROUP, 4, T.RATIO_DELAY1, NULL)) DOWNDELAYPER4,       MAX(DECODE(T.LTEUPSPEEDGROUP, 5, T.RATIO_DELAY1, NULL)) DOWNDELAYPER5,       MAX(DECODE(T.LTEUPSPEEDGROUP, 6, T.RATIO_DELAY1, NULL)) DOWNDELAYPER6,       MAX(DECODE(T.LTEUPSPEEDGROUP, 7, T.RATIO_DELAY1, NULL)) DOWNDELAYPER7,       MAX(DECODE(T.LTEUPSPEEDGROUP, 8, T.RATIO_DELAY1, NULL)) DOWNDELAYPER8,       MAX(DECODE(T.LTEUPSPEEDGROUP, 9, T.RATIO_DELAY1, NULL)) DOWNDELAYPER9,       SUM(T.ALLCOUNT) DOWNREQUEST,       MAX(DECODE(T.LTEUPSPEEDGROUP, 1, T.ALLCOUNT, NULL)) DOWNREQUEST1,       MAX(DECODE(T.LTEUPSPEEDGROUP, 2, T.ALLCOUNT, NULL)) DOWNREQUEST2,       MAX(DECODE(T.LTEUPSPEEDGROUP, 3, T.ALLCOUNT, NULL)) DOWNREQUEST3,       MAX(DECODE(T.LTEUPSPEEDGROUP, 4, T.ALLCOUNT, NULL)) DOWNREQUEST4,       MAX(DECODE(T.LTEUPSPEEDGROUP, 5, T.ALLCOUNT, NULL)) DOWNREQUEST5,       MAX(DECODE(T.LTEUPSPEEDGROUP, 6, T.ALLCOUNT, NULL)) DOWNREQUEST6,       MAX(DECODE(T.LTEUPSPEEDGROUP, 7, T.ALLCOUNT, NULL)) DOWNREQUEST7,       MAX(DECODE(T.LTEUPSPEEDGROUP, 8, T.ALLCOUNT, NULL)) DOWNREQUEST8,       MAX(DECODE(T.LTEUPSPEEDGROUP, 9, T.ALLCOUNT, NULL)) DOWNREQUEST9,        MAX(DECODE(T.LTEUPSPEEDGROUP, 1, T.RATIO_ALLCOUNT, NULL)) DOWNREQUESTPER1,       MAX(DECODE(T.LTEUPSPEEDGROUP, 2, T.RATIO_ALLCOUNT, NULL)) DOWNREQUESTPER2,       MAX(DECODE(T.LTEUPSPEEDGROUP, 3, T.RATIO_ALLCOUNT, NULL)) DOWNREQUESTPER3,       MAX(DECODE(T.LTEUPSPEEDGROUP, 4, T.RATIO_ALLCOUNT, NULL)) DOWNREQUESTPER4,       MAX(DECODE(T.LTEUPSPEEDGROUP, 5, T.RATIO_ALLCOUNT, NULL)) DOWNREQUESTPER5,       MAX(DECODE(T.LTEUPSPEEDGROUP, 6, T.RATIO_ALLCOUNT, NULL)) DOWNREQUESTPER6,       MAX(DECODE(T.LTEUPSPEEDGROUP, 7, T.RATIO_ALLCOUNT, NULL)) DOWNREQUESTPER7,       MAX(DECODE(T.LTEUPSPEEDGROUP, 8, T.RATIO_ALLCOUNT, NULL)) DOWNREQUESTPER8,       MAX(DECODE(T.LTEUPSPEEDGROUP, 9, T.RATIO_ALLCOUNT, NULL)) DOWNREQUESTPER9,        ROUND(SUM(T.ULTRAFFIC/1024/1024), 3.0) DOWNTRAFFIC,        ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 1, T.ULTRAFFIC/1024/1024, NULL)),3.0) DOWNTRAFFIC1,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 2, T.ULTRAFFIC/1024/1024, NULL)),3.0) DOWNTRAFFIC2,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 3, T.ULTRAFFIC/1024/1024, NULL)),3.0) DOWNTRAFFIC3,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 4, T.ULTRAFFIC/1024/1024, NULL)),3.0) DOWNTRAFFIC4,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 5, T.ULTRAFFIC/1024/1024, NULL)),3.0) DOWNTRAFFIC5,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 6, T.ULTRAFFIC/1024/1024, NULL)),3.0) DOWNTRAFFIC6,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 7, T.ULTRAFFIC/1024/1024, NULL)),3.0) DOWNTRAFFIC7,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 8, T.ULTRAFFIC/1024/1024, NULL)),3.0) DOWNTRAFFIC8,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 9, T.ULTRAFFIC/1024/1024, NULL)),3.0) DOWNTRAFFIC9,        MAX(DECODE(T.LTEUPSPEEDGROUP, 1, T.RATIO_ULTRAFFIC, NULL)) DOWNTRAFFICPER1,       MAX(DECODE(T.LTEUPSPEEDGROUP, 2, T.RATIO_ULTRAFFIC, NULL)) DOWNTRAFFICPER2,       MAX(DECODE(T.LTEUPSPEEDGROUP, 3, T.RATIO_ULTRAFFIC, NULL)) DOWNTRAFFICPER3,       MAX(DECODE(T.LTEUPSPEEDGROUP, 4, T.RATIO_ULTRAFFIC, NULL)) DOWNTRAFFICPER4,       MAX(DECODE(T.LTEUPSPEEDGROUP, 5, T.RATIO_ULTRAFFIC, NULL)) DOWNTRAFFICPER5,       MAX(DECODE(T.LTEUPSPEEDGROUP, 6, T.RATIO_ULTRAFFIC, NULL)) DOWNTRAFFICPER6,       MAX(DECODE(T.LTEUPSPEEDGROUP, 7, T.RATIO_ULTRAFFIC, NULL)) DOWNTRAFFICPER7,       MAX(DECODE(T.LTEUPSPEEDGROUP, 8, T.RATIO_ULTRAFFIC, NULL)) DOWNTRAFFICPER8,       MAX(DECODE(T.LTEUPSPEEDGROUP, 9, T.RATIO_ULTRAFFIC, NULL)) DOWNTRAFFICPER9       FROM (       SELECT       GN.SERVICE,       GN.BUSSINESSTYPE,       GN.LTEUPSPEEDGROUP,       SUM(GN.ALLCOUNT) ALLCOUNT,       ROUND(100*SUM(GN.ALLCOUNT)/SUM(SUM(GN.ALLCOUNT)) OVER(PARTITION BY GN.SERVICE,GN.BUSSINESSTYPE),3.0) RATIO_ALLCOUNT,       SUM(GN.ULDELAY) DELAY,       ROUND(100*SUM(GN.ULDELAY)/SUM(SUM(GN.ULDELAY)) OVER(PARTITION BY GN.SERVICE,GN.BUSSINESSTYPE),3.0) RATIO_DELAY1,       SUM(GN.ULTRAFFIC) ULTRAFFIC,       ROUND(100*SUM(GN.ULTRAFFIC)/SUM(SUM(GN.ULTRAFFIC)) OVER(PARTITION BY GN.SERVICE,GN.BUSSINESSTYPE),3.0) RATIO_ULTRAFFIC       FROM lte_sys.[@p0]_T_GN_SUM_ALLFILE GN       WHERE 1=1 [@and] ${[@city0] [@and] [@time0]}& [@and] ${[@cate0] [@and] [@subapp0]}& [@and] [@terminal0] [@and] [@fac0]       GROUP BY GN.LTEUPSPEEDGROUP,GN.SERVICE,GN.BUSSINESSTYPE       ) T       INNER JOIN lte_sys.[@p0]_T_BASE_CATEGORYTYPE CATE ON CATE.CATEGORYID=T.SERVICE AND CATE.BUSSINESSTYPE=T.BUSSINESSTYPE       GROUP BY CATE.CATEGORYNAME,CATE.BUSSINESSNAME       UNION       SELECT       '全国' PRONAME,       '汇总' CITYNAME,       CASE WHEN T.EQUIPMENT IS NULL THEN '未匹配' ELSE T.EQUIPMENT END AS EQUIPMENT,       '[@terminalname0]' TERMINAL,       '[@filetypename]' FILETYPE,       CATE.CATEGORYNAME CATEGORY,       CATE.BUSSINESSNAME BUSINESS,       ROUND(CASE WHEN SUM(T.DELAY)=0 THEN NULL ELSE SUM(T.ULTRAFFIC)*8000/1024/SUM(T.DELAY) END,3.0) DOWNSPEED,       ROUND(SUM(T.DELAY)/1000,3.0) DOWNDELAY,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 1, T.DELAY/1000, NULL)),3.0) DOWNDELAY1,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 2, T.DELAY/1000, NULL)),3.0) DOWNDELAY2,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 3, T.DELAY/1000, NULL)),3.0) DOWNDELAY3,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 4, T.DELAY/1000, NULL)),3.0) DOWNDELAY4,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 5, T.DELAY/1000, NULL)),3.0) DOWNDELAY5,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 6, T.DELAY/1000, NULL)),3.0) DOWNDELAY6,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 7, T.DELAY/1000, NULL)),3.0) DOWNDELAY7,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 8, T.DELAY/1000, NULL)),3.0) DOWNDELAY8,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 9, T.DELAY/1000, NULL)),3.0) DOWNDELAY9,        MAX(DECODE(T.LTEUPSPEEDGROUP, 1, T.RATIO_DELAY1, NULL)) DOWNDELAYPER1,       MAX(DECODE(T.LTEUPSPEEDGROUP, 2, T.RATIO_DELAY1, NULL)) DOWNDELAYPER2,       MAX(DECODE(T.LTEUPSPEEDGROUP, 3, T.RATIO_DELAY1, NULL)) DOWNDELAYPER3,       MAX(DECODE(T.LTEUPSPEEDGROUP, 4, T.RATIO_DELAY1, NULL)) DOWNDELAYPER4,       MAX(DECODE(T.LTEUPSPEEDGROUP, 5, T.RATIO_DELAY1, NULL)) DOWNDELAYPER5,       MAX(DECODE(T.LTEUPSPEEDGROUP, 6, T.RATIO_DELAY1, NULL)) DOWNDELAYPER6,       MAX(DECODE(T.LTEUPSPEEDGROUP, 7, T.RATIO_DELAY1, NULL)) DOWNDELAYPER7,       MAX(DECODE(T.LTEUPSPEEDGROUP, 8, T.RATIO_DELAY1, NULL)) DOWNDELAYPER8,       MAX(DECODE(T.LTEUPSPEEDGROUP, 9, T.RATIO_DELAY1, NULL)) DOWNDELAYPER9,       SUM(T.ALLCOUNT) DOWNREQUEST,       MAX(DECODE(T.LTEUPSPEEDGROUP, 1, T.ALLCOUNT, NULL)) DOWNREQUEST1,       MAX(DECODE(T.LTEUPSPEEDGROUP, 2, T.ALLCOUNT, NULL)) DOWNREQUEST2,       MAX(DECODE(T.LTEUPSPEEDGROUP, 3, T.ALLCOUNT, NULL)) DOWNREQUEST3,       MAX(DECODE(T.LTEUPSPEEDGROUP, 4, T.ALLCOUNT, NULL)) DOWNREQUEST4,       MAX(DECODE(T.LTEUPSPEEDGROUP, 5, T.ALLCOUNT, NULL)) DOWNREQUEST5,       MAX(DECODE(T.LTEUPSPEEDGROUP, 6, T.ALLCOUNT, NULL)) DOWNREQUEST6,       MAX(DECODE(T.LTEUPSPEEDGROUP, 7, T.ALLCOUNT, NULL)) DOWNREQUEST7,       MAX(DECODE(T.LTEUPSPEEDGROUP, 8, T.ALLCOUNT, NULL)) DOWNREQUEST8,       MAX(DECODE(T.LTEUPSPEEDGROUP, 9, T.ALLCOUNT, NULL)) DOWNREQUEST9,        MAX(DECODE(T.LTEUPSPEEDGROUP, 1, T.RATIO_ALLCOUNT, NULL)) DOWNREQUESTPER1,       MAX(DECODE(T.LTEUPSPEEDGROUP, 2, T.RATIO_ALLCOUNT, NULL)) DOWNREQUESTPER2,       MAX(DECODE(T.LTEUPSPEEDGROUP, 3, T.RATIO_ALLCOUNT, NULL)) DOWNREQUESTPER3,       MAX(DECODE(T.LTEUPSPEEDGROUP, 4, T.RATIO_ALLCOUNT, NULL)) DOWNREQUESTPER4,       MAX(DECODE(T.LTEUPSPEEDGROUP, 5, T.RATIO_ALLCOUNT, NULL)) DOWNREQUESTPER5,       MAX(DECODE(T.LTEUPSPEEDGROUP, 6, T.RATIO_ALLCOUNT, NULL)) DOWNREQUESTPER6,       MAX(DECODE(T.LTEUPSPEEDGROUP, 7, T.RATIO_ALLCOUNT, NULL)) DOWNREQUESTPER7,       MAX(DECODE(T.LTEUPSPEEDGROUP, 8, T.RATIO_ALLCOUNT, NULL)) DOWNREQUESTPER8,       MAX(DECODE(T.LTEUPSPEEDGROUP, 9, T.RATIO_ALLCOUNT, NULL)) DOWNREQUESTPER9,        ROUND(SUM(T.ULTRAFFIC/1024/1024), 3.0) DOWNTRAFFIC,        ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 1, T.ULTRAFFIC/1024/1024, NULL)),3.0) DOWNTRAFFIC1,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 2, T.ULTRAFFIC/1024/1024, NULL)),3.0) DOWNTRAFFIC2,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 3, T.ULTRAFFIC/1024/1024, NULL)),3.0) DOWNTRAFFIC3,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 4, T.ULTRAFFIC/1024/1024, NULL)),3.0) DOWNTRAFFIC4,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 5, T.ULTRAFFIC/1024/1024, NULL)),3.0) DOWNTRAFFIC5,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 6, T.ULTRAFFIC/1024/1024, NULL)),3.0) DOWNTRAFFIC6,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 7, T.ULTRAFFIC/1024/1024, NULL)),3.0) DOWNTRAFFIC7,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 8, T.ULTRAFFIC/1024/1024, NULL)),3.0) DOWNTRAFFIC8,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 9, T.ULTRAFFIC/1024/1024, NULL)),3.0) DOWNTRAFFIC9,        MAX(DECODE(T.LTEUPSPEEDGROUP, 1, T.RATIO_ULTRAFFIC, NULL)) DOWNTRAFFICPER1,       MAX(DECODE(T.LTEUPSPEEDGROUP, 2, T.RATIO_ULTRAFFIC, NULL)) DOWNTRAFFICPER2,       MAX(DECODE(T.LTEUPSPEEDGROUP, 3, T.RATIO_ULTRAFFIC, NULL)) DOWNTRAFFICPER3,       MAX(DECODE(T.LTEUPSPEEDGROUP, 4, T.RATIO_ULTRAFFIC, NULL)) DOWNTRAFFICPER4,       MAX(DECODE(T.LTEUPSPEEDGROUP, 5, T.RATIO_ULTRAFFIC, NULL)) DOWNTRAFFICPER5,       MAX(DECODE(T.LTEUPSPEEDGROUP, 6, T.RATIO_ULTRAFFIC, NULL)) DOWNTRAFFICPER6,       MAX(DECODE(T.LTEUPSPEEDGROUP, 7, T.RATIO_ULTRAFFIC, NULL)) DOWNTRAFFICPER7,       MAX(DECODE(T.LTEUPSPEEDGROUP, 8, T.RATIO_ULTRAFFIC, NULL)) DOWNTRAFFICPER8,       MAX(DECODE(T.LTEUPSPEEDGROUP, 9, T.RATIO_ULTRAFFIC, NULL)) DOWNTRAFFICPER9       FROM (       SELECT       GN.EQUIPMENT,       GN.SERVICE,       GN.BUSSINESSTYPE,       GN.LTEUPSPEEDGROUP,       SUM(GN.ALLCOUNT) ALLCOUNT,       ROUND(100*SUM(GN.ALLCOUNT)/SUM(SUM(GN.ALLCOUNT)) OVER(PARTITION BY GN.SERVICE,GN.BUSSINESSTYPE),3.0) RATIO_ALLCOUNT,       SUM(GN.ULDELAY) DELAY,       ROUND(100*SUM(GN.ULDELAY)/SUM(SUM(GN.ULDELAY)) OVER(PARTITION BY GN.SERVICE,GN.BUSSINESSTYPE),3.0) RATIO_DELAY1,       SUM(GN.ULTRAFFIC) ULTRAFFIC,       ROUND(100*SUM(GN.ULTRAFFIC)/SUM(SUM(GN.ULTRAFFIC)) OVER(PARTITION BY GN.SERVICE,GN.BUSSINESSTYPE),3.0) RATIO_ULTRAFFIC       FROM lte_sys.[@p0]_T_GN_SUM_ALLFILE GN       WHERE 1=1 [@and] ${[@city0] [@and] [@time0]}& [@and] ${[@cate0] [@and] [@subapp0]}& [@and] [@terminal0] [@and] [@fac0]       GROUP BY GN.LTEUPSPEEDGROUP,GN.SERVICE,GN.BUSSINESSTYPE,GN.EQUIPMENT       ) T       INNER JOIN lte_sys.[@p0]_T_BASE_CATEGORYTYPE CATE ON CATE.CATEGORYID=T.SERVICE AND CATE.BUSSINESSTYPE=T.BUSSINESSTYPE       GROUP BY CATE.CATEGORYNAME,CATE.BUSSINESSNAME,T.EQUIPMENT"
      }
    },
    {
      "key": "query_gntab7_2",
      "desc": "占比分析-上行_省",
      "config": {
        "parameters": [
          {
            "name": "preData",
            "type": "object",
            "conditions": {
              "cnd": [
                {
                  "key": "city_no",
                  "columnname": "gn.city_no",
                  "type": "string",
                  "format": "",
                  "conditionid": "city0",
                  "symbol": "="
                },
                {
                  "key": "starttime",
                  "columnname": "starttime",
                  "type": "string",
                  "format": "",
                  "conditionid": "time0",
                  "symbol": "in"
                }
              ],
              "co": "or"
            }
          },
          {
            "name": "preDatacategory",
            "type": "object",
            "conditions": {
              "cnd": [
                {
                  "key": "service",
                  "columnname": "gn.city_no",
                  "type": "string",
                  "format": "",
                  "conditionid": "cate0",
                  "symbol": "="
                },
                {
                  "key": "bussinesstype",
                  "columnname": "service",
                  "type": "string",
                  "format": "",
                  "conditionid": "subapp0",
                  "symbol": "in"
                }
              ],
              "co": "or"
            }
          },
          {
            "name": "preDataterminal",
            "type": "projects",
            "conditions": [
              {
                "key": "terminal",
                "columnname": "",
                "type": "string",
                "format": "",
                "conditionid": "terminal0",
                "symbol": ""
              },
              {
                "key": "terminalname",
                "columnname": "",
                "type": "string",
                "format": "",
                "conditionid": "terminalname0",
                "symbol": ""
              },
              {
                "key": "filetypename",
                "columnname": "",
                "type": "string",
                "format": "",
                "conditionid": "filetypename",
                "symbol": ""
              }
            ]
          },
          {
            "name": "p_en",
            "columnname": "",
            "type": "string",
            "format": "",
            "conditionid": "p0",
            "symbol": ""
          },
          {
            "name": "factory",
            "columnname": "EQUIPMENT",
            "type": "string",
            "format": "",
            "conditionid": "fac0",
            "symbol": "="
          }
        ],
        "value": "SELECT       T.CITY_NO PRONAME,       '汇总' CITYNAME,       '汇总' AS EQUIPMENT,       '[@terminalname0]' TERMINAL,       '[@filetypename]' FILETYPE,       '' CATEGORY,       '' BUSINESS,       ROUND(CASE WHEN SUM(T.DELAY)=0 THEN NULL ELSE SUM(T.ULTRAFFIC)*8000/1024/SUM(T.DELAY) END,3.0) DOWNSPEED,       ROUND(SUM(T.DELAY)/1000,3.0) DOWNDELAY,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 1, T.DELAY/1000, NULL)),3.0) DOWNDELAY1,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 2, T.DELAY/1000, NULL)),3.0) DOWNDELAY2,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 3, T.DELAY/1000, NULL)),3.0) DOWNDELAY3,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 4, T.DELAY/1000, NULL)),3.0) DOWNDELAY4,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 5, T.DELAY/1000, NULL)),3.0) DOWNDELAY5,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 6, T.DELAY/1000, NULL)),3.0) DOWNDELAY6,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 7, T.DELAY/1000, NULL)),3.0) DOWNDELAY7,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 8, T.DELAY/1000, NULL)),3.0) DOWNDELAY8,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 9, T.DELAY/1000, NULL)),3.0) DOWNDELAY9,        MAX(DECODE(T.LTEUPSPEEDGROUP, 1, T.RATIO_DELAY1, NULL)) DOWNDELAYPER1,       MAX(DECODE(T.LTEUPSPEEDGROUP, 2, T.RATIO_DELAY1, NULL)) DOWNDELAYPER2,       MAX(DECODE(T.LTEUPSPEEDGROUP, 3, T.RATIO_DELAY1, NULL)) DOWNDELAYPER3,       MAX(DECODE(T.LTEUPSPEEDGROUP, 4, T.RATIO_DELAY1, NULL)) DOWNDELAYPER4,       MAX(DECODE(T.LTEUPSPEEDGROUP, 5, T.RATIO_DELAY1, NULL)) DOWNDELAYPER5,       MAX(DECODE(T.LTEUPSPEEDGROUP, 6, T.RATIO_DELAY1, NULL)) DOWNDELAYPER6,       MAX(DECODE(T.LTEUPSPEEDGROUP, 7, T.RATIO_DELAY1, NULL)) DOWNDELAYPER7,       MAX(DECODE(T.LTEUPSPEEDGROUP, 8, T.RATIO_DELAY1, NULL)) DOWNDELAYPER8,       MAX(DECODE(T.LTEUPSPEEDGROUP, 9, T.RATIO_DELAY1, NULL)) DOWNDELAYPER9,       SUM(T.ALLCOUNT) DOWNREQUEST,       MAX(DECODE(T.LTEUPSPEEDGROUP, 1, T.ALLCOUNT, NULL)) DOWNREQUEST1,       MAX(DECODE(T.LTEUPSPEEDGROUP, 2, T.ALLCOUNT, NULL)) DOWNREQUEST2,       MAX(DECODE(T.LTEUPSPEEDGROUP, 3, T.ALLCOUNT, NULL)) DOWNREQUEST3,       MAX(DECODE(T.LTEUPSPEEDGROUP, 4, T.ALLCOUNT, NULL)) DOWNREQUEST4,       MAX(DECODE(T.LTEUPSPEEDGROUP, 5, T.ALLCOUNT, NULL)) DOWNREQUEST5,       MAX(DECODE(T.LTEUPSPEEDGROUP, 6, T.ALLCOUNT, NULL)) DOWNREQUEST6,       MAX(DECODE(T.LTEUPSPEEDGROUP, 7, T.ALLCOUNT, NULL)) DOWNREQUEST7,       MAX(DECODE(T.LTEUPSPEEDGROUP, 8, T.ALLCOUNT, NULL)) DOWNREQUEST8,       MAX(DECODE(T.LTEUPSPEEDGROUP, 9, T.ALLCOUNT, NULL)) DOWNREQUEST9,        MAX(DECODE(T.LTEUPSPEEDGROUP, 1, T.RATIO_ALLCOUNT, NULL)) DOWNREQUESTPER1,       MAX(DECODE(T.LTEUPSPEEDGROUP, 2, T.RATIO_ALLCOUNT, NULL)) DOWNREQUESTPER2,       MAX(DECODE(T.LTEUPSPEEDGROUP, 3, T.RATIO_ALLCOUNT, NULL)) DOWNREQUESTPER3,       MAX(DECODE(T.LTEUPSPEEDGROUP, 4, T.RATIO_ALLCOUNT, NULL)) DOWNREQUESTPER4,       MAX(DECODE(T.LTEUPSPEEDGROUP, 5, T.RATIO_ALLCOUNT, NULL)) DOWNREQUESTPER5,       MAX(DECODE(T.LTEUPSPEEDGROUP, 6, T.RATIO_ALLCOUNT, NULL)) DOWNREQUESTPER6,       MAX(DECODE(T.LTEUPSPEEDGROUP, 7, T.RATIO_ALLCOUNT, NULL)) DOWNREQUESTPER7,       MAX(DECODE(T.LTEUPSPEEDGROUP, 8, T.RATIO_ALLCOUNT, NULL)) DOWNREQUESTPER8,       MAX(DECODE(T.LTEUPSPEEDGROUP, 9, T.RATIO_ALLCOUNT, NULL)) DOWNREQUESTPER9,        ROUND(SUM(T.ULTRAFFIC/1024/1024), 3.0) DOWNTRAFFIC,        ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 1, T.ULTRAFFIC/1024/1024, NULL)),3.0) DOWNTRAFFIC1,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 2, T.ULTRAFFIC/1024/1024, NULL)),3.0) DOWNTRAFFIC2,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 3, T.ULTRAFFIC/1024/1024, NULL)),3.0) DOWNTRAFFIC3,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 4, T.ULTRAFFIC/1024/1024, NULL)),3.0) DOWNTRAFFIC4,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 5, T.ULTRAFFIC/1024/1024, NULL)),3.0) DOWNTRAFFIC5,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 6, T.ULTRAFFIC/1024/1024, NULL)),3.0) DOWNTRAFFIC6,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 7, T.ULTRAFFIC/1024/1024, NULL)),3.0) DOWNTRAFFIC7,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 8, T.ULTRAFFIC/1024/1024, NULL)),3.0) DOWNTRAFFIC8,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 9, T.ULTRAFFIC/1024/1024, NULL)),3.0) DOWNTRAFFIC9,        MAX(DECODE(T.LTEUPSPEEDGROUP, 1, T.RATIO_ULTRAFFIC, NULL)) DOWNTRAFFICPER1,       MAX(DECODE(T.LTEUPSPEEDGROUP, 2, T.RATIO_ULTRAFFIC, NULL)) DOWNTRAFFICPER2,       MAX(DECODE(T.LTEUPSPEEDGROUP, 3, T.RATIO_ULTRAFFIC, NULL)) DOWNTRAFFICPER3,       MAX(DECODE(T.LTEUPSPEEDGROUP, 4, T.RATIO_ULTRAFFIC, NULL)) DOWNTRAFFICPER4,       MAX(DECODE(T.LTEUPSPEEDGROUP, 5, T.RATIO_ULTRAFFIC, NULL)) DOWNTRAFFICPER5,       MAX(DECODE(T.LTEUPSPEEDGROUP, 6, T.RATIO_ULTRAFFIC, NULL)) DOWNTRAFFICPER6,       MAX(DECODE(T.LTEUPSPEEDGROUP, 7, T.RATIO_ULTRAFFIC, NULL)) DOWNTRAFFICPER7,       MAX(DECODE(T.LTEUPSPEEDGROUP, 8, T.RATIO_ULTRAFFIC, NULL)) DOWNTRAFFICPER8,       MAX(DECODE(T.LTEUPSPEEDGROUP, 9, T.RATIO_ULTRAFFIC, NULL)) DOWNTRAFFICPER9       FROM (       SELECT       S.CITY_NO,       S.LTEUPSPEEDGROUP,       SUM(S.ALLCOUNT) ALLCOUNT,       ROUND(100*SUM(S.ALLCOUNT)/SUM(SUM(S.ALLCOUNT)) OVER(PARTITION BY S.CITY_NO),3.0) RATIO_ALLCOUNT,       SUM(S.DELAY) DELAY,       ROUND(100*SUM(S.DELAY)/SUM(SUM(S.DELAY)) OVER(PARTITION BY S.CITY_NO),3.0) RATIO_DELAY1,       SUM(S.ULTRAFFIC) ULTRAFFIC,       ROUND(100*SUM(S.ULTRAFFIC)/SUM(SUM(S.ULTRAFFIC)) OVER(PARTITION BY S.CITY_NO),3.0) RATIO_ULTRAFFIC       FROM (       SELECT       CITY.PRONAME CITY_NO,       GN.LTEUPSPEEDGROUP,       GN.ALLCOUNT,       GN.ULDELAY DELAY,       GN.ULTRAFFIC ULTRAFFIC       FROM lte_sys.[@p0]_T_GN_SUM_ALLFILE GN       INNER JOIN lte_sys.T_BASE_CITY CITY ON CITY.CITY_NO=GN.CITY_NO       WHERE 1=1 [@and] ${[@city0] [@and] [@time0]}& [@and] ${[@cate0] [@and] [@subapp0]}& [@and] [@terminal0] [@and] [@fac0]       ) S       GROUP BY S.CITY_NO,S.LTEUPSPEEDGROUP) T        GROUP BY T.CITY_NO       UNION       SELECT       T.CITY_NO PRONAME,       '汇总' CITYNAME,       CASE WHEN T.EQUIPMENT IS NULL THEN '未匹配' ELSE T.EQUIPMENT END AS EQUIPMENT,       '[@terminalname0]' TERMINAL,       '[@filetypename]' FILETYPE,       '' CATEGORY,       '' BUSINESS,       ROUND(CASE WHEN SUM(T.DELAY)=0 THEN NULL ELSE SUM(T.ULTRAFFIC)*8000/1024/SUM(T.DELAY) END,3.0) DOWNSPEED,       ROUND(SUM(T.DELAY)/1000,3.0) DOWNDELAY,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 1, T.DELAY/1000, NULL)),3.0) DOWNDELAY1,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 2, T.DELAY/1000, NULL)),3.0) DOWNDELAY2,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 3, T.DELAY/1000, NULL)),3.0) DOWNDELAY3,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 4, T.DELAY/1000, NULL)),3.0) DOWNDELAY4,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 5, T.DELAY/1000, NULL)),3.0) DOWNDELAY5,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 6, T.DELAY/1000, NULL)),3.0) DOWNDELAY6,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 7, T.DELAY/1000, NULL)),3.0) DOWNDELAY7,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 8, T.DELAY/1000, NULL)),3.0) DOWNDELAY8,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 9, T.DELAY/1000, NULL)),3.0) DOWNDELAY9,        MAX(DECODE(T.LTEUPSPEEDGROUP, 1, T.RATIO_DELAY1, NULL)) DOWNDELAYPER1,       MAX(DECODE(T.LTEUPSPEEDGROUP, 2, T.RATIO_DELAY1, NULL)) DOWNDELAYPER2,       MAX(DECODE(T.LTEUPSPEEDGROUP, 3, T.RATIO_DELAY1, NULL)) DOWNDELAYPER3,       MAX(DECODE(T.LTEUPSPEEDGROUP, 4, T.RATIO_DELAY1, NULL)) DOWNDELAYPER4,       MAX(DECODE(T.LTEUPSPEEDGROUP, 5, T.RATIO_DELAY1, NULL)) DOWNDELAYPER5,       MAX(DECODE(T.LTEUPSPEEDGROUP, 6, T.RATIO_DELAY1, NULL)) DOWNDELAYPER6,       MAX(DECODE(T.LTEUPSPEEDGROUP, 7, T.RATIO_DELAY1, NULL)) DOWNDELAYPER7,       MAX(DECODE(T.LTEUPSPEEDGROUP, 8, T.RATIO_DELAY1, NULL)) DOWNDELAYPER8,       MAX(DECODE(T.LTEUPSPEEDGROUP, 9, T.RATIO_DELAY1, NULL)) DOWNDELAYPER9,       SUM(T.ALLCOUNT) DOWNREQUEST,       MAX(DECODE(T.LTEUPSPEEDGROUP, 1, T.ALLCOUNT, NULL)) DOWNREQUEST1,       MAX(DECODE(T.LTEUPSPEEDGROUP, 2, T.ALLCOUNT, NULL)) DOWNREQUEST2,       MAX(DECODE(T.LTEUPSPEEDGROUP, 3, T.ALLCOUNT, NULL)) DOWNREQUEST3,       MAX(DECODE(T.LTEUPSPEEDGROUP, 4, T.ALLCOUNT, NULL)) DOWNREQUEST4,       MAX(DECODE(T.LTEUPSPEEDGROUP, 5, T.ALLCOUNT, NULL)) DOWNREQUEST5,       MAX(DECODE(T.LTEUPSPEEDGROUP, 6, T.ALLCOUNT, NULL)) DOWNREQUEST6,       MAX(DECODE(T.LTEUPSPEEDGROUP, 7, T.ALLCOUNT, NULL)) DOWNREQUEST7,       MAX(DECODE(T.LTEUPSPEEDGROUP, 8, T.ALLCOUNT, NULL)) DOWNREQUEST8,       MAX(DECODE(T.LTEUPSPEEDGROUP, 9, T.ALLCOUNT, NULL)) DOWNREQUEST9,        MAX(DECODE(T.LTEUPSPEEDGROUP, 1, T.RATIO_ALLCOUNT, NULL)) DOWNREQUESTPER1,       MAX(DECODE(T.LTEUPSPEEDGROUP, 2, T.RATIO_ALLCOUNT, NULL)) DOWNREQUESTPER2,       MAX(DECODE(T.LTEUPSPEEDGROUP, 3, T.RATIO_ALLCOUNT, NULL)) DOWNREQUESTPER3,       MAX(DECODE(T.LTEUPSPEEDGROUP, 4, T.RATIO_ALLCOUNT, NULL)) DOWNREQUESTPER4,       MAX(DECODE(T.LTEUPSPEEDGROUP, 5, T.RATIO_ALLCOUNT, NULL)) DOWNREQUESTPER5,       MAX(DECODE(T.LTEUPSPEEDGROUP, 6, T.RATIO_ALLCOUNT, NULL)) DOWNREQUESTPER6,       MAX(DECODE(T.LTEUPSPEEDGROUP, 7, T.RATIO_ALLCOUNT, NULL)) DOWNREQUESTPER7,       MAX(DECODE(T.LTEUPSPEEDGROUP, 8, T.RATIO_ALLCOUNT, NULL)) DOWNREQUESTPER8,       MAX(DECODE(T.LTEUPSPEEDGROUP, 9, T.RATIO_ALLCOUNT, NULL)) DOWNREQUESTPER9,        ROUND(SUM(T.ULTRAFFIC/1024/1024), 3.0) DOWNTRAFFIC,        ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 1, T.ULTRAFFIC/1024/1024, NULL)),3.0) DOWNTRAFFIC1,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 2, T.ULTRAFFIC/1024/1024, NULL)),3.0) DOWNTRAFFIC2,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 3, T.ULTRAFFIC/1024/1024, NULL)),3.0) DOWNTRAFFIC3,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 4, T.ULTRAFFIC/1024/1024, NULL)),3.0) DOWNTRAFFIC4,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 5, T.ULTRAFFIC/1024/1024, NULL)),3.0) DOWNTRAFFIC5,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 6, T.ULTRAFFIC/1024/1024, NULL)),3.0) DOWNTRAFFIC6,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 7, T.ULTRAFFIC/1024/1024, NULL)),3.0) DOWNTRAFFIC7,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 8, T.ULTRAFFIC/1024/1024, NULL)),3.0) DOWNTRAFFIC8,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 9, T.ULTRAFFIC/1024/1024, NULL)),3.0) DOWNTRAFFIC9,        MAX(DECODE(T.LTEUPSPEEDGROUP, 1, T.RATIO_ULTRAFFIC, NULL)) DOWNTRAFFICPER1,       MAX(DECODE(T.LTEUPSPEEDGROUP, 2, T.RATIO_ULTRAFFIC, NULL)) DOWNTRAFFICPER2,       MAX(DECODE(T.LTEUPSPEEDGROUP, 3, T.RATIO_ULTRAFFIC, NULL)) DOWNTRAFFICPER3,       MAX(DECODE(T.LTEUPSPEEDGROUP, 4, T.RATIO_ULTRAFFIC, NULL)) DOWNTRAFFICPER4,       MAX(DECODE(T.LTEUPSPEEDGROUP, 5, T.RATIO_ULTRAFFIC, NULL)) DOWNTRAFFICPER5,       MAX(DECODE(T.LTEUPSPEEDGROUP, 6, T.RATIO_ULTRAFFIC, NULL)) DOWNTRAFFICPER6,       MAX(DECODE(T.LTEUPSPEEDGROUP, 7, T.RATIO_ULTRAFFIC, NULL)) DOWNTRAFFICPER7,       MAX(DECODE(T.LTEUPSPEEDGROUP, 8, T.RATIO_ULTRAFFIC, NULL)) DOWNTRAFFICPER8,       MAX(DECODE(T.LTEUPSPEEDGROUP, 9, T.RATIO_ULTRAFFIC, NULL)) DOWNTRAFFICPER9       FROM (       SELECT       S.CITY_NO,       S.EQUIPMENT,       S.LTEUPSPEEDGROUP,       SUM(S.ALLCOUNT) ALLCOUNT,       ROUND(100*SUM(S.ALLCOUNT)/SUM(SUM(S.ALLCOUNT)) OVER(PARTITION BY S.CITY_NO),3.0) RATIO_ALLCOUNT,       SUM(S.DELAY) DELAY,       ROUND(100*SUM(S.DELAY)/SUM(SUM(S.DELAY)) OVER(PARTITION BY S.CITY_NO),3.0) RATIO_DELAY1,       SUM(S.ULTRAFFIC) ULTRAFFIC,       ROUND(100*SUM(S.ULTRAFFIC)/SUM(SUM(S.ULTRAFFIC)) OVER(PARTITION BY S.CITY_NO),3.0) RATIO_ULTRAFFIC       FROM (       SELECT       CITY.PRONAME CITY_NO,       GN.EQUIPMENT,       GN.LTEUPSPEEDGROUP,       GN.ALLCOUNT,       GN.ULDELAY DELAY,       GN.ULTRAFFIC ULTRAFFIC       FROM lte_sys.[@p0]_T_GN_SUM_ALLFILE GN       INNER JOIN lte_sys.T_BASE_CITY CITY ON CITY.CITY_NO=GN.CITY_NO       WHERE 1=1 [@and] ${[@city0] [@and] [@time0]}& [@and] ${[@cate0] [@and] [@subapp0]}& [@and] [@terminal0] [@and] [@fac0]       ) S       GROUP BY S.CITY_NO,S.LTEUPSPEEDGROUP,S.EQUIPMENT) T       GROUP BY T.CITY_NO,T.EQUIPMENT       union       SELECT       T.CITY_NO PRONAME,       '汇总' CITYNAME,       '汇总' AS EQUIPMENT,       '[@terminalname0]' TERMINAL,       '[@filetypename]' FILETYPE,       CATE.CATEGORYNAME CATEGORY,       '汇总' BUSINESS,       ROUND(CASE WHEN SUM(T.DELAY)=0 THEN NULL ELSE SUM(T.ULTRAFFIC)*8000/1024/SUM(T.DELAY) END,3.0) DOWNSPEED,       ROUND(SUM(T.DELAY)/1000,3.0) DOWNDELAY,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 1, T.DELAY/1000, NULL)),3.0) DOWNDELAY1,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 2, T.DELAY/1000, NULL)),3.0) DOWNDELAY2,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 3, T.DELAY/1000, NULL)),3.0) DOWNDELAY3,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 4, T.DELAY/1000, NULL)),3.0) DOWNDELAY4,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 5, T.DELAY/1000, NULL)),3.0) DOWNDELAY5,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 6, T.DELAY/1000, NULL)),3.0) DOWNDELAY6,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 7, T.DELAY/1000, NULL)),3.0) DOWNDELAY7,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 8, T.DELAY/1000, NULL)),3.0) DOWNDELAY8,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 9, T.DELAY/1000, NULL)),3.0) DOWNDELAY9,        MAX(DECODE(T.LTEUPSPEEDGROUP, 1, T.RATIO_DELAY1, NULL)) DOWNDELAYPER1,       MAX(DECODE(T.LTEUPSPEEDGROUP, 2, T.RATIO_DELAY1, NULL)) DOWNDELAYPER2,       MAX(DECODE(T.LTEUPSPEEDGROUP, 3, T.RATIO_DELAY1, NULL)) DOWNDELAYPER3,       MAX(DECODE(T.LTEUPSPEEDGROUP, 4, T.RATIO_DELAY1, NULL)) DOWNDELAYPER4,       MAX(DECODE(T.LTEUPSPEEDGROUP, 5, T.RATIO_DELAY1, NULL)) DOWNDELAYPER5,       MAX(DECODE(T.LTEUPSPEEDGROUP, 6, T.RATIO_DELAY1, NULL)) DOWNDELAYPER6,       MAX(DECODE(T.LTEUPSPEEDGROUP, 7, T.RATIO_DELAY1, NULL)) DOWNDELAYPER7,       MAX(DECODE(T.LTEUPSPEEDGROUP, 8, T.RATIO_DELAY1, NULL)) DOWNDELAYPER8,       MAX(DECODE(T.LTEUPSPEEDGROUP, 9, T.RATIO_DELAY1, NULL)) DOWNDELAYPER9,       SUM(T.ALLCOUNT) DOWNREQUEST,       MAX(DECODE(T.LTEUPSPEEDGROUP, 1, T.ALLCOUNT, NULL)) DOWNREQUEST1,       MAX(DECODE(T.LTEUPSPEEDGROUP, 2, T.ALLCOUNT, NULL)) DOWNREQUEST2,       MAX(DECODE(T.LTEUPSPEEDGROUP, 3, T.ALLCOUNT, NULL)) DOWNREQUEST3,       MAX(DECODE(T.LTEUPSPEEDGROUP, 4, T.ALLCOUNT, NULL)) DOWNREQUEST4,       MAX(DECODE(T.LTEUPSPEEDGROUP, 5, T.ALLCOUNT, NULL)) DOWNREQUEST5,       MAX(DECODE(T.LTEUPSPEEDGROUP, 6, T.ALLCOUNT, NULL)) DOWNREQUEST6,       MAX(DECODE(T.LTEUPSPEEDGROUP, 7, T.ALLCOUNT, NULL)) DOWNREQUEST7,       MAX(DECODE(T.LTEUPSPEEDGROUP, 8, T.ALLCOUNT, NULL)) DOWNREQUEST8,       MAX(DECODE(T.LTEUPSPEEDGROUP, 9, T.ALLCOUNT, NULL)) DOWNREQUEST9,        MAX(DECODE(T.LTEUPSPEEDGROUP, 1, T.RATIO_ALLCOUNT, NULL)) DOWNREQUESTPER1,       MAX(DECODE(T.LTEUPSPEEDGROUP, 2, T.RATIO_ALLCOUNT, NULL)) DOWNREQUESTPER2,       MAX(DECODE(T.LTEUPSPEEDGROUP, 3, T.RATIO_ALLCOUNT, NULL)) DOWNREQUESTPER3,       MAX(DECODE(T.LTEUPSPEEDGROUP, 4, T.RATIO_ALLCOUNT, NULL)) DOWNREQUESTPER4,       MAX(DECODE(T.LTEUPSPEEDGROUP, 5, T.RATIO_ALLCOUNT, NULL)) DOWNREQUESTPER5,       MAX(DECODE(T.LTEUPSPEEDGROUP, 6, T.RATIO_ALLCOUNT, NULL)) DOWNREQUESTPER6,       MAX(DECODE(T.LTEUPSPEEDGROUP, 7, T.RATIO_ALLCOUNT, NULL)) DOWNREQUESTPER7,       MAX(DECODE(T.LTEUPSPEEDGROUP, 8, T.RATIO_ALLCOUNT, NULL)) DOWNREQUESTPER8,       MAX(DECODE(T.LTEUPSPEEDGROUP, 9, T.RATIO_ALLCOUNT, NULL)) DOWNREQUESTPER9,        ROUND(SUM(T.ULTRAFFIC/1024/1024), 3.0) DOWNTRAFFIC,        ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 1, T.ULTRAFFIC/1024/1024, NULL)),3.0) DOWNTRAFFIC1,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 2, T.ULTRAFFIC/1024/1024, NULL)),3.0) DOWNTRAFFIC2,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 3, T.ULTRAFFIC/1024/1024, NULL)),3.0) DOWNTRAFFIC3,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 4, T.ULTRAFFIC/1024/1024, NULL)),3.0) DOWNTRAFFIC4,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 5, T.ULTRAFFIC/1024/1024, NULL)),3.0) DOWNTRAFFIC5,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 6, T.ULTRAFFIC/1024/1024, NULL)),3.0) DOWNTRAFFIC6,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 7, T.ULTRAFFIC/1024/1024, NULL)),3.0) DOWNTRAFFIC7,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 8, T.ULTRAFFIC/1024/1024, NULL)),3.0) DOWNTRAFFIC8,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 9, T.ULTRAFFIC/1024/1024, NULL)),3.0) DOWNTRAFFIC9,        MAX(DECODE(T.LTEUPSPEEDGROUP, 1, T.RATIO_ULTRAFFIC, NULL)) DOWNTRAFFICPER1,       MAX(DECODE(T.LTEUPSPEEDGROUP, 2, T.RATIO_ULTRAFFIC, NULL)) DOWNTRAFFICPER2,       MAX(DECODE(T.LTEUPSPEEDGROUP, 3, T.RATIO_ULTRAFFIC, NULL)) DOWNTRAFFICPER3,       MAX(DECODE(T.LTEUPSPEEDGROUP, 4, T.RATIO_ULTRAFFIC, NULL)) DOWNTRAFFICPER4,       MAX(DECODE(T.LTEUPSPEEDGROUP, 5, T.RATIO_ULTRAFFIC, NULL)) DOWNTRAFFICPER5,       MAX(DECODE(T.LTEUPSPEEDGROUP, 6, T.RATIO_ULTRAFFIC, NULL)) DOWNTRAFFICPER6,       MAX(DECODE(T.LTEUPSPEEDGROUP, 7, T.RATIO_ULTRAFFIC, NULL)) DOWNTRAFFICPER7,       MAX(DECODE(T.LTEUPSPEEDGROUP, 8, T.RATIO_ULTRAFFIC, NULL)) DOWNTRAFFICPER8,       MAX(DECODE(T.LTEUPSPEEDGROUP, 9, T.RATIO_ULTRAFFIC, NULL)) DOWNTRAFFICPER9       FROM (       SELECT       S.CITY_NO,       S.SERVICE,       S.LTEUPSPEEDGROUP,       SUM(S.ALLCOUNT) ALLCOUNT,       ROUND(100*SUM(S.ALLCOUNT)/SUM(SUM(S.ALLCOUNT)) OVER(PARTITION BY S.CITY_NO,S.SERVICE),3.0) RATIO_ALLCOUNT,       SUM(S.DELAY) DELAY,       ROUND(100*SUM(S.DELAY)/SUM(SUM(S.DELAY)) OVER(PARTITION BY S.CITY_NO,S.SERVICE),3.0) RATIO_DELAY1,       SUM(S.ULTRAFFIC) ULTRAFFIC,       ROUND(100*SUM(S.ULTRAFFIC)/SUM(SUM(S.ULTRAFFIC)) OVER(PARTITION BY S.CITY_NO,S.SERVICE),3.0) RATIO_ULTRAFFIC       FROM (       SELECT       CITY.PRONAME CITY_NO,       GN.SERVICE,       GN.LTEUPSPEEDGROUP,       GN.ALLCOUNT,       GN.ULDELAY DELAY,       GN.ULTRAFFIC       FROM lte_sys.[@p0]_T_GN_SUM_ALLFILE GN       INNER JOIN lte_sys.T_BASE_CITY CITY ON CITY.CITY_NO=GN.CITY_NO       WHERE 1=1 [@and] ${[@city0] [@and] [@time0]}& [@and] ${[@cate0] [@and] [@subapp0]}& [@and] [@terminal0] [@and] [@fac0]       ) S       GROUP BY S.CITY_NO,S.SERVICE,S.LTEUPSPEEDGROUP) T       INNER JOIN lte_sys.[@p0]_T_BASE_CATEGORYTYPE CATE ON CATE.CATEGORYID=T.SERVICE       GROUP BY T.CITY_NO,CATE.CATEGORYNAME       UNION       SELECT       T.CITY_NO PRONAME,       CASE WHEN T.EQUIPMENT IS NULL THEN '未匹配' ELSE T.EQUIPMENT END AS EQUIPMENT,       '汇总' CITYNAME,       '[@terminalname0]' TERMINAL,       '[@filetypename]' FILETYPE,       CATE.CATEGORYNAME CATEGORY,       '汇总' BUSINESS,       ROUND(CASE WHEN SUM(T.DELAY)=0 THEN NULL ELSE SUM(T.ULTRAFFIC)*8000/1024/SUM(T.DELAY) END,3.0) DOWNSPEED,       ROUND(SUM(T.DELAY)/1000,3.0) DOWNDELAY,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 1, T.DELAY/1000, NULL)),3.0) DOWNDELAY1,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 2, T.DELAY/1000, NULL)),3.0) DOWNDELAY2,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 3, T.DELAY/1000, NULL)),3.0) DOWNDELAY3,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 4, T.DELAY/1000, NULL)),3.0) DOWNDELAY4,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 5, T.DELAY/1000, NULL)),3.0) DOWNDELAY5,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 6, T.DELAY/1000, NULL)),3.0) DOWNDELAY6,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 7, T.DELAY/1000, NULL)),3.0) DOWNDELAY7,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 8, T.DELAY/1000, NULL)),3.0) DOWNDELAY8,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 9, T.DELAY/1000, NULL)),3.0) DOWNDELAY9,        MAX(DECODE(T.LTEUPSPEEDGROUP, 1, T.RATIO_DELAY1, NULL)) DOWNDELAYPER1,       MAX(DECODE(T.LTEUPSPEEDGROUP, 2, T.RATIO_DELAY1, NULL)) DOWNDELAYPER2,       MAX(DECODE(T.LTEUPSPEEDGROUP, 3, T.RATIO_DELAY1, NULL)) DOWNDELAYPER3,       MAX(DECODE(T.LTEUPSPEEDGROUP, 4, T.RATIO_DELAY1, NULL)) DOWNDELAYPER4,       MAX(DECODE(T.LTEUPSPEEDGROUP, 5, T.RATIO_DELAY1, NULL)) DOWNDELAYPER5,       MAX(DECODE(T.LTEUPSPEEDGROUP, 6, T.RATIO_DELAY1, NULL)) DOWNDELAYPER6,       MAX(DECODE(T.LTEUPSPEEDGROUP, 7, T.RATIO_DELAY1, NULL)) DOWNDELAYPER7,       MAX(DECODE(T.LTEUPSPEEDGROUP, 8, T.RATIO_DELAY1, NULL)) DOWNDELAYPER8,       MAX(DECODE(T.LTEUPSPEEDGROUP, 9, T.RATIO_DELAY1, NULL)) DOWNDELAYPER9,       SUM(T.ALLCOUNT) DOWNREQUEST,       MAX(DECODE(T.LTEUPSPEEDGROUP, 1, T.ALLCOUNT, NULL)) DOWNREQUEST1,       MAX(DECODE(T.LTEUPSPEEDGROUP, 2, T.ALLCOUNT, NULL)) DOWNREQUEST2,       MAX(DECODE(T.LTEUPSPEEDGROUP, 3, T.ALLCOUNT, NULL)) DOWNREQUEST3,       MAX(DECODE(T.LTEUPSPEEDGROUP, 4, T.ALLCOUNT, NULL)) DOWNREQUEST4,       MAX(DECODE(T.LTEUPSPEEDGROUP, 5, T.ALLCOUNT, NULL)) DOWNREQUEST5,       MAX(DECODE(T.LTEUPSPEEDGROUP, 6, T.ALLCOUNT, NULL)) DOWNREQUEST6,       MAX(DECODE(T.LTEUPSPEEDGROUP, 7, T.ALLCOUNT, NULL)) DOWNREQUEST7,       MAX(DECODE(T.LTEUPSPEEDGROUP, 8, T.ALLCOUNT, NULL)) DOWNREQUEST8,       MAX(DECODE(T.LTEUPSPEEDGROUP, 9, T.ALLCOUNT, NULL)) DOWNREQUEST9,        MAX(DECODE(T.LTEUPSPEEDGROUP, 1, T.RATIO_ALLCOUNT, NULL)) DOWNREQUESTPER1,       MAX(DECODE(T.LTEUPSPEEDGROUP, 2, T.RATIO_ALLCOUNT, NULL)) DOWNREQUESTPER2,       MAX(DECODE(T.LTEUPSPEEDGROUP, 3, T.RATIO_ALLCOUNT, NULL)) DOWNREQUESTPER3,       MAX(DECODE(T.LTEUPSPEEDGROUP, 4, T.RATIO_ALLCOUNT, NULL)) DOWNREQUESTPER4,       MAX(DECODE(T.LTEUPSPEEDGROUP, 5, T.RATIO_ALLCOUNT, NULL)) DOWNREQUESTPER5,       MAX(DECODE(T.LTEUPSPEEDGROUP, 6, T.RATIO_ALLCOUNT, NULL)) DOWNREQUESTPER6,       MAX(DECODE(T.LTEUPSPEEDGROUP, 7, T.RATIO_ALLCOUNT, NULL)) DOWNREQUESTPER7,       MAX(DECODE(T.LTEUPSPEEDGROUP, 8, T.RATIO_ALLCOUNT, NULL)) DOWNREQUESTPER8,       MAX(DECODE(T.LTEUPSPEEDGROUP, 9, T.RATIO_ALLCOUNT, NULL)) DOWNREQUESTPER9,        ROUND(SUM(T.ULTRAFFIC/1024/1024), 3.0) DOWNTRAFFIC,        ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 1, T.ULTRAFFIC/1024/1024, NULL)),3.0) DOWNTRAFFIC1,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 2, T.ULTRAFFIC/1024/1024, NULL)),3.0) DOWNTRAFFIC2,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 3, T.ULTRAFFIC/1024/1024, NULL)),3.0) DOWNTRAFFIC3,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 4, T.ULTRAFFIC/1024/1024, NULL)),3.0) DOWNTRAFFIC4,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 5, T.ULTRAFFIC/1024/1024, NULL)),3.0) DOWNTRAFFIC5,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 6, T.ULTRAFFIC/1024/1024, NULL)),3.0) DOWNTRAFFIC6,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 7, T.ULTRAFFIC/1024/1024, NULL)),3.0) DOWNTRAFFIC7,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 8, T.ULTRAFFIC/1024/1024, NULL)),3.0) DOWNTRAFFIC8,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 9, T.ULTRAFFIC/1024/1024, NULL)),3.0) DOWNTRAFFIC9,        MAX(DECODE(T.LTEUPSPEEDGROUP, 1, T.RATIO_ULTRAFFIC, NULL)) DOWNTRAFFICPER1,       MAX(DECODE(T.LTEUPSPEEDGROUP, 2, T.RATIO_ULTRAFFIC, NULL)) DOWNTRAFFICPER2,       MAX(DECODE(T.LTEUPSPEEDGROUP, 3, T.RATIO_ULTRAFFIC, NULL)) DOWNTRAFFICPER3,       MAX(DECODE(T.LTEUPSPEEDGROUP, 4, T.RATIO_ULTRAFFIC, NULL)) DOWNTRAFFICPER4,       MAX(DECODE(T.LTEUPSPEEDGROUP, 5, T.RATIO_ULTRAFFIC, NULL)) DOWNTRAFFICPER5,       MAX(DECODE(T.LTEUPSPEEDGROUP, 6, T.RATIO_ULTRAFFIC, NULL)) DOWNTRAFFICPER6,       MAX(DECODE(T.LTEUPSPEEDGROUP, 7, T.RATIO_ULTRAFFIC, NULL)) DOWNTRAFFICPER7,       MAX(DECODE(T.LTEUPSPEEDGROUP, 8, T.RATIO_ULTRAFFIC, NULL)) DOWNTRAFFICPER8,       MAX(DECODE(T.LTEUPSPEEDGROUP, 9, T.RATIO_ULTRAFFIC, NULL)) DOWNTRAFFICPER9       FROM (       SELECT       S.CITY_NO,       S.EQUIPMENT,       S.SERVICE,       S.LTEUPSPEEDGROUP,       SUM(S.ALLCOUNT) ALLCOUNT,       ROUND(100*SUM(S.ALLCOUNT)/SUM(SUM(S.ALLCOUNT)) OVER(PARTITION BY S.CITY_NO,S.SERVICE),3.0) RATIO_ALLCOUNT,       SUM(S.DELAY) DELAY,       ROUND(100*SUM(S.DELAY)/SUM(SUM(S.DELAY)) OVER(PARTITION BY S.CITY_NO,S.SERVICE),3.0) RATIO_DELAY1,       SUM(S.ULTRAFFIC) ULTRAFFIC,       ROUND(100*SUM(S.ULTRAFFIC)/SUM(SUM(S.ULTRAFFIC)) OVER(PARTITION BY S.CITY_NO,S.SERVICE),3.0) RATIO_ULTRAFFIC       FROM (       SELECT       CITY.PRONAME CITY_NO,       GN.EQUIPMENT,       GN.SERVICE,       GN.LTEUPSPEEDGROUP,       GN.ALLCOUNT,       GN.ULDELAY DELAY,       GN.ULTRAFFIC       FROM lte_sys.[@p0]_T_GN_SUM_ALLFILE GN       INNER JOIN lte_sys.T_BASE_CITY CITY ON CITY.CITY_NO=GN.CITY_NO       WHERE 1=1 [@and] ${[@city0] [@and] [@time0]}& [@and] ${[@cate0] [@and] [@subapp0]}& [@and] [@terminal0] [@and] [@fac0]       ) S       GROUP BY S.CITY_NO,S.SERVICE,S.LTEUPSPEEDGROUP,S.EQUIPMENT) T       INNER JOIN lte_sys.[@p0]_T_BASE_CATEGORYTYPE CATE ON CATE.CATEGORYID=T.SERVICE       GROUP BY T.CITY_NO,CATE.CATEGORYNAME,T.EQUIPMENT       union       SELECT       T.CITY_NO PRONAME,       '汇总' CITYNAME,       '汇总' AS EQUIPMENT,       '[@terminalname0]' TERMINAL,       '[@filetypename]' FILETYPE,       CATE.CATEGORYNAME CATEGORY,       CATE.BUSSINESSNAME BUSINESS,       ROUND(CASE WHEN SUM(T.DELAY)=0 THEN NULL ELSE SUM(T.ULTRAFFIC)*8000/1024/SUM(T.DELAY) END,3.0) DOWNSPEED,       ROUND(SUM(T.DELAY)/1000,3.0) DOWNDELAY,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 1, T.DELAY/1000, NULL)),3.0) DOWNDELAY1,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 2, T.DELAY/1000, NULL)),3.0) DOWNDELAY2,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 3, T.DELAY/1000, NULL)),3.0) DOWNDELAY3,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 4, T.DELAY/1000, NULL)),3.0) DOWNDELAY4,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 5, T.DELAY/1000, NULL)),3.0) DOWNDELAY5,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 6, T.DELAY/1000, NULL)),3.0) DOWNDELAY6,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 7, T.DELAY/1000, NULL)),3.0) DOWNDELAY7,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 8, T.DELAY/1000, NULL)),3.0) DOWNDELAY8,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 9, T.DELAY/1000, NULL)),3.0) DOWNDELAY9,        MAX(DECODE(T.LTEUPSPEEDGROUP, 1, T.RATIO_DELAY1, NULL)) DOWNDELAYPER1,       MAX(DECODE(T.LTEUPSPEEDGROUP, 2, T.RATIO_DELAY1, NULL)) DOWNDELAYPER2,       MAX(DECODE(T.LTEUPSPEEDGROUP, 3, T.RATIO_DELAY1, NULL)) DOWNDELAYPER3,       MAX(DECODE(T.LTEUPSPEEDGROUP, 4, T.RATIO_DELAY1, NULL)) DOWNDELAYPER4,       MAX(DECODE(T.LTEUPSPEEDGROUP, 5, T.RATIO_DELAY1, NULL)) DOWNDELAYPER5,       MAX(DECODE(T.LTEUPSPEEDGROUP, 6, T.RATIO_DELAY1, NULL)) DOWNDELAYPER6,       MAX(DECODE(T.LTEUPSPEEDGROUP, 7, T.RATIO_DELAY1, NULL)) DOWNDELAYPER7,       MAX(DECODE(T.LTEUPSPEEDGROUP, 8, T.RATIO_DELAY1, NULL)) DOWNDELAYPER8,       MAX(DECODE(T.LTEUPSPEEDGROUP, 9, T.RATIO_DELAY1, NULL)) DOWNDELAYPER9,       SUM(T.ALLCOUNT) DOWNREQUEST,       MAX(DECODE(T.LTEUPSPEEDGROUP, 1, T.ALLCOUNT, NULL)) DOWNREQUEST1,       MAX(DECODE(T.LTEUPSPEEDGROUP, 2, T.ALLCOUNT, NULL)) DOWNREQUEST2,       MAX(DECODE(T.LTEUPSPEEDGROUP, 3, T.ALLCOUNT, NULL)) DOWNREQUEST3,       MAX(DECODE(T.LTEUPSPEEDGROUP, 4, T.ALLCOUNT, NULL)) DOWNREQUEST4,       MAX(DECODE(T.LTEUPSPEEDGROUP, 5, T.ALLCOUNT, NULL)) DOWNREQUEST5,       MAX(DECODE(T.LTEUPSPEEDGROUP, 6, T.ALLCOUNT, NULL)) DOWNREQUEST6,       MAX(DECODE(T.LTEUPSPEEDGROUP, 7, T.ALLCOUNT, NULL)) DOWNREQUEST7,       MAX(DECODE(T.LTEUPSPEEDGROUP, 8, T.ALLCOUNT, NULL)) DOWNREQUEST8,       MAX(DECODE(T.LTEUPSPEEDGROUP, 9, T.ALLCOUNT, NULL)) DOWNREQUEST9,        MAX(DECODE(T.LTEUPSPEEDGROUP, 1, T.RATIO_ALLCOUNT, NULL)) DOWNREQUESTPER1,       MAX(DECODE(T.LTEUPSPEEDGROUP, 2, T.RATIO_ALLCOUNT, NULL)) DOWNREQUESTPER2,       MAX(DECODE(T.LTEUPSPEEDGROUP, 3, T.RATIO_ALLCOUNT, NULL)) DOWNREQUESTPER3,       MAX(DECODE(T.LTEUPSPEEDGROUP, 4, T.RATIO_ALLCOUNT, NULL)) DOWNREQUESTPER4,       MAX(DECODE(T.LTEUPSPEEDGROUP, 5, T.RATIO_ALLCOUNT, NULL)) DOWNREQUESTPER5,       MAX(DECODE(T.LTEUPSPEEDGROUP, 6, T.RATIO_ALLCOUNT, NULL)) DOWNREQUESTPER6,       MAX(DECODE(T.LTEUPSPEEDGROUP, 7, T.RATIO_ALLCOUNT, NULL)) DOWNREQUESTPER7,       MAX(DECODE(T.LTEUPSPEEDGROUP, 8, T.RATIO_ALLCOUNT, NULL)) DOWNREQUESTPER8,       MAX(DECODE(T.LTEUPSPEEDGROUP, 9, T.RATIO_ALLCOUNT, NULL)) DOWNREQUESTPER9,        ROUND(SUM(T.ULTRAFFIC/1024/1024), 3.0) DOWNTRAFFIC,        ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 1, T.ULTRAFFIC/1024/1024, NULL)),3.0) DOWNTRAFFIC1,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 2, T.ULTRAFFIC/1024/1024, NULL)),3.0) DOWNTRAFFIC2,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 3, T.ULTRAFFIC/1024/1024, NULL)),3.0) DOWNTRAFFIC3,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 4, T.ULTRAFFIC/1024/1024, NULL)),3.0) DOWNTRAFFIC4,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 5, T.ULTRAFFIC/1024/1024, NULL)),3.0) DOWNTRAFFIC5,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 6, T.ULTRAFFIC/1024/1024, NULL)),3.0) DOWNTRAFFIC6,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 7, T.ULTRAFFIC/1024/1024, NULL)),3.0) DOWNTRAFFIC7,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 8, T.ULTRAFFIC/1024/1024, NULL)),3.0) DOWNTRAFFIC8,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 9, T.ULTRAFFIC/1024/1024, NULL)),3.0) DOWNTRAFFIC9,        MAX(DECODE(T.LTEUPSPEEDGROUP, 1, T.RATIO_ULTRAFFIC, NULL)) DOWNTRAFFICPER1,       MAX(DECODE(T.LTEUPSPEEDGROUP, 2, T.RATIO_ULTRAFFIC, NULL)) DOWNTRAFFICPER2,       MAX(DECODE(T.LTEUPSPEEDGROUP, 3, T.RATIO_ULTRAFFIC, NULL)) DOWNTRAFFICPER3,       MAX(DECODE(T.LTEUPSPEEDGROUP, 4, T.RATIO_ULTRAFFIC, NULL)) DOWNTRAFFICPER4,       MAX(DECODE(T.LTEUPSPEEDGROUP, 5, T.RATIO_ULTRAFFIC, NULL)) DOWNTRAFFICPER5,       MAX(DECODE(T.LTEUPSPEEDGROUP, 6, T.RATIO_ULTRAFFIC, NULL)) DOWNTRAFFICPER6,       MAX(DECODE(T.LTEUPSPEEDGROUP, 7, T.RATIO_ULTRAFFIC, NULL)) DOWNTRAFFICPER7,       MAX(DECODE(T.LTEUPSPEEDGROUP, 8, T.RATIO_ULTRAFFIC, NULL)) DOWNTRAFFICPER8,       MAX(DECODE(T.LTEUPSPEEDGROUP, 9, T.RATIO_ULTRAFFIC, NULL)) DOWNTRAFFICPER9       FROM (       SELECT       S.CITY_NO,       S.SERVICE,       S.BUSSINESSTYPE,       S.LTEUPSPEEDGROUP,       SUM(S.ALLCOUNT) ALLCOUNT,       ROUND(100*SUM(S.ALLCOUNT)/SUM(SUM(S.ALLCOUNT)) OVER(PARTITION BY S.CITY_NO,S.SERVICE,S.BUSSINESSTYPE),3.0) RATIO_ALLCOUNT,       SUM(S.DELAY) DELAY,       ROUND(100*SUM(S.DELAY)/SUM(SUM(S.DELAY)) OVER(PARTITION BY S.CITY_NO,S.SERVICE,S.BUSSINESSTYPE),3.0) RATIO_DELAY1,       SUM(S.ULTRAFFIC) ULTRAFFIC,       ROUND(100*SUM(S.ULTRAFFIC)/SUM(SUM(S.ULTRAFFIC)) OVER(PARTITION BY S.CITY_NO,S.SERVICE,S.BUSSINESSTYPE),3.0) RATIO_ULTRAFFIC       FROM (       SELECT       CITY.PRONAME CITY_NO,       GN.SERVICE,       GN.BUSSINESSTYPE,       GN.LTEUPSPEEDGROUP,       GN.ALLCOUNT,       GN.ULDELAY DELAY,       GN.ULTRAFFIC       FROM lte_sys.[@p0]_T_GN_SUM_ALLFILE GN       INNER JOIN lte_sys.T_BASE_CITY CITY ON CITY.CITY_NO=GN.CITY_NO       WHERE 1=1 [@and] ${[@city0] [@and] [@time0]}& [@and] ${[@cate0] [@and] [@subapp0]}& [@and] [@terminal0] [@and] [@fac0]       ) S       GROUP BY S.CITY_NO,S.SERVICE,S.BUSSINESSTYPE,S.LTEUPSPEEDGROUP) T       INNER JOIN lte_sys.[@p0]_T_BASE_CATEGORYTYPE CATE ON CATE.CATEGORYID=T.SERVICE AND CATE.BUSSINESSTYPE=T.BUSSINESSTYPE       GROUP BY T.CITY_NO,CATE.CATEGORYNAME,CATE.BUSSINESSNAME       UNION       SELECT       T.CITY_NO PRONAME,       '汇总' CITYNAME,       CASE WHEN T.EQUIPMENT IS NULL THEN '未匹配' ELSE T.EQUIPMENT END AS EQUIPMENT,       '[@terminalname0]' TERMINAL,       '[@filetypename]' FILETYPE,       CATE.CATEGORYNAME CATEGORY,       CATE.BUSSINESSNAME BUSINESS,       ROUND(CASE WHEN SUM(T.DELAY)=0 THEN NULL ELSE SUM(T.ULTRAFFIC)*8000/1024/SUM(T.DELAY) END,3.0) DOWNSPEED,       ROUND(SUM(T.DELAY)/1000,3.0) DOWNDELAY,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 1, T.DELAY/1000, NULL)),3.0) DOWNDELAY1,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 2, T.DELAY/1000, NULL)),3.0) DOWNDELAY2,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 3, T.DELAY/1000, NULL)),3.0) DOWNDELAY3,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 4, T.DELAY/1000, NULL)),3.0) DOWNDELAY4,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 5, T.DELAY/1000, NULL)),3.0) DOWNDELAY5,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 6, T.DELAY/1000, NULL)),3.0) DOWNDELAY6,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 7, T.DELAY/1000, NULL)),3.0) DOWNDELAY7,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 8, T.DELAY/1000, NULL)),3.0) DOWNDELAY8,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 9, T.DELAY/1000, NULL)),3.0) DOWNDELAY9,        MAX(DECODE(T.LTEUPSPEEDGROUP, 1, T.RATIO_DELAY1, NULL)) DOWNDELAYPER1,       MAX(DECODE(T.LTEUPSPEEDGROUP, 2, T.RATIO_DELAY1, NULL)) DOWNDELAYPER2,       MAX(DECODE(T.LTEUPSPEEDGROUP, 3, T.RATIO_DELAY1, NULL)) DOWNDELAYPER3,       MAX(DECODE(T.LTEUPSPEEDGROUP, 4, T.RATIO_DELAY1, NULL)) DOWNDELAYPER4,       MAX(DECODE(T.LTEUPSPEEDGROUP, 5, T.RATIO_DELAY1, NULL)) DOWNDELAYPER5,       MAX(DECODE(T.LTEUPSPEEDGROUP, 6, T.RATIO_DELAY1, NULL)) DOWNDELAYPER6,       MAX(DECODE(T.LTEUPSPEEDGROUP, 7, T.RATIO_DELAY1, NULL)) DOWNDELAYPER7,       MAX(DECODE(T.LTEUPSPEEDGROUP, 8, T.RATIO_DELAY1, NULL)) DOWNDELAYPER8,       MAX(DECODE(T.LTEUPSPEEDGROUP, 9, T.RATIO_DELAY1, NULL)) DOWNDELAYPER9,       SUM(T.ALLCOUNT) DOWNREQUEST,       MAX(DECODE(T.LTEUPSPEEDGROUP, 1, T.ALLCOUNT, NULL)) DOWNREQUEST1,       MAX(DECODE(T.LTEUPSPEEDGROUP, 2, T.ALLCOUNT, NULL)) DOWNREQUEST2,       MAX(DECODE(T.LTEUPSPEEDGROUP, 3, T.ALLCOUNT, NULL)) DOWNREQUEST3,       MAX(DECODE(T.LTEUPSPEEDGROUP, 4, T.ALLCOUNT, NULL)) DOWNREQUEST4,       MAX(DECODE(T.LTEUPSPEEDGROUP, 5, T.ALLCOUNT, NULL)) DOWNREQUEST5,       MAX(DECODE(T.LTEUPSPEEDGROUP, 6, T.ALLCOUNT, NULL)) DOWNREQUEST6,       MAX(DECODE(T.LTEUPSPEEDGROUP, 7, T.ALLCOUNT, NULL)) DOWNREQUEST7,       MAX(DECODE(T.LTEUPSPEEDGROUP, 8, T.ALLCOUNT, NULL)) DOWNREQUEST8,       MAX(DECODE(T.LTEUPSPEEDGROUP, 9, T.ALLCOUNT, NULL)) DOWNREQUEST9,        MAX(DECODE(T.LTEUPSPEEDGROUP, 1, T.RATIO_ALLCOUNT, NULL)) DOWNREQUESTPER1,       MAX(DECODE(T.LTEUPSPEEDGROUP, 2, T.RATIO_ALLCOUNT, NULL)) DOWNREQUESTPER2,       MAX(DECODE(T.LTEUPSPEEDGROUP, 3, T.RATIO_ALLCOUNT, NULL)) DOWNREQUESTPER3,       MAX(DECODE(T.LTEUPSPEEDGROUP, 4, T.RATIO_ALLCOUNT, NULL)) DOWNREQUESTPER4,       MAX(DECODE(T.LTEUPSPEEDGROUP, 5, T.RATIO_ALLCOUNT, NULL)) DOWNREQUESTPER5,       MAX(DECODE(T.LTEUPSPEEDGROUP, 6, T.RATIO_ALLCOUNT, NULL)) DOWNREQUESTPER6,       MAX(DECODE(T.LTEUPSPEEDGROUP, 7, T.RATIO_ALLCOUNT, NULL)) DOWNREQUESTPER7,       MAX(DECODE(T.LTEUPSPEEDGROUP, 8, T.RATIO_ALLCOUNT, NULL)) DOWNREQUESTPER8,       MAX(DECODE(T.LTEUPSPEEDGROUP, 9, T.RATIO_ALLCOUNT, NULL)) DOWNREQUESTPER9,        ROUND(SUM(T.ULTRAFFIC/1024/1024), 3.0) DOWNTRAFFIC,        ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 1, T.ULTRAFFIC/1024/1024, NULL)),3.0) DOWNTRAFFIC1,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 2, T.ULTRAFFIC/1024/1024, NULL)),3.0) DOWNTRAFFIC2,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 3, T.ULTRAFFIC/1024/1024, NULL)),3.0) DOWNTRAFFIC3,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 4, T.ULTRAFFIC/1024/1024, NULL)),3.0) DOWNTRAFFIC4,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 5, T.ULTRAFFIC/1024/1024, NULL)),3.0) DOWNTRAFFIC5,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 6, T.ULTRAFFIC/1024/1024, NULL)),3.0) DOWNTRAFFIC6,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 7, T.ULTRAFFIC/1024/1024, NULL)),3.0) DOWNTRAFFIC7,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 8, T.ULTRAFFIC/1024/1024, NULL)),3.0) DOWNTRAFFIC8,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 9, T.ULTRAFFIC/1024/1024, NULL)),3.0) DOWNTRAFFIC9,        MAX(DECODE(T.LTEUPSPEEDGROUP, 1, T.RATIO_ULTRAFFIC, NULL)) DOWNTRAFFICPER1,       MAX(DECODE(T.LTEUPSPEEDGROUP, 2, T.RATIO_ULTRAFFIC, NULL)) DOWNTRAFFICPER2,       MAX(DECODE(T.LTEUPSPEEDGROUP, 3, T.RATIO_ULTRAFFIC, NULL)) DOWNTRAFFICPER3,       MAX(DECODE(T.LTEUPSPEEDGROUP, 4, T.RATIO_ULTRAFFIC, NULL)) DOWNTRAFFICPER4,       MAX(DECODE(T.LTEUPSPEEDGROUP, 5, T.RATIO_ULTRAFFIC, NULL)) DOWNTRAFFICPER5,       MAX(DECODE(T.LTEUPSPEEDGROUP, 6, T.RATIO_ULTRAFFIC, NULL)) DOWNTRAFFICPER6,       MAX(DECODE(T.LTEUPSPEEDGROUP, 7, T.RATIO_ULTRAFFIC, NULL)) DOWNTRAFFICPER7,       MAX(DECODE(T.LTEUPSPEEDGROUP, 8, T.RATIO_ULTRAFFIC, NULL)) DOWNTRAFFICPER8,       MAX(DECODE(T.LTEUPSPEEDGROUP, 9, T.RATIO_ULTRAFFIC, NULL)) DOWNTRAFFICPER9       FROM (       SELECT       S.CITY_NO,       S.EQUIPMENT,       S.SERVICE,       S.BUSSINESSTYPE,       S.LTEUPSPEEDGROUP,       SUM(S.ALLCOUNT) ALLCOUNT,       ROUND(100*SUM(S.ALLCOUNT)/SUM(SUM(S.ALLCOUNT)) OVER(PARTITION BY S.CITY_NO,S.SERVICE,S.BUSSINESSTYPE),3.0) RATIO_ALLCOUNT,       SUM(S.DELAY) DELAY,       ROUND(100*SUM(S.DELAY)/SUM(SUM(S.DELAY)) OVER(PARTITION BY S.CITY_NO,S.SERVICE,S.BUSSINESSTYPE),3.0) RATIO_DELAY1,       SUM(S.ULTRAFFIC) ULTRAFFIC,       ROUND(100*SUM(S.ULTRAFFIC)/SUM(SUM(S.ULTRAFFIC)) OVER(PARTITION BY S.CITY_NO,S.SERVICE,S.BUSSINESSTYPE),3.0) RATIO_ULTRAFFIC       FROM (       SELECT       CITY.PRONAME CITY_NO,       GN.EQUIPMENT,       GN.SERVICE,       GN.BUSSINESSTYPE,       GN.LTEUPSPEEDGROUP,       GN.ALLCOUNT,       GN.ULDELAY DELAY,       GN.ULTRAFFIC       FROM lte_sys.[@p0]_T_GN_SUM_ALLFILE GN       INNER JOIN lte_sys.T_BASE_CITY CITY ON CITY.CITY_NO=GN.CITY_NO       WHERE 1=1 [@and] ${[@city0] [@and] [@time0]}& [@and] ${[@cate0] [@and] [@subapp0]}& [@and] [@terminal0] [@and] [@fac0]       ) S       GROUP BY S.CITY_NO,S.SERVICE,S.BUSSINESSTYPE,S.LTEUPSPEEDGROUP,S.EQUIPMENT) T       INNER JOIN lte_sys.[@p0]_T_BASE_CATEGORYTYPE CATE ON CATE.CATEGORYID=T.SERVICE AND CATE.BUSSINESSTYPE=T.BUSSINESSTYPE       GROUP BY T.CITY_NO,CATE.CATEGORYNAME,CATE.BUSSINESSNAME,T.EQUIPMENT"
      }
    },
    {
      "key": "query_gntab7_3",
      "desc": "占比分析-上行_市",
      "config": {
        "parameters": [
          {
            "name": "preData",
            "type": "object",
            "conditions": {
              "cnd": [
                {
                  "key": "city_no",
                  "columnname": "gn.city_no",
                  "type": "string",
                  "format": "",
                  "conditionid": "city0",
                  "symbol": "="
                },
                {
                  "key": "starttime",
                  "columnname": "starttime",
                  "type": "string",
                  "format": "",
                  "conditionid": "time0",
                  "symbol": "in"
                }
              ],
              "co": "or"
            }
          },
          {
            "name": "preDatacategory",
            "type": "object",
            "conditions": {
              "cnd": [
                {
                  "key": "service",
                  "columnname": "gn.city_no",
                  "type": "string",
                  "format": "",
                  "conditionid": "cate0",
                  "symbol": "="
                },
                {
                  "key": "bussinesstype",
                  "columnname": "service",
                  "type": "string",
                  "format": "",
                  "conditionid": "subapp0",
                  "symbol": "in"
                }
              ],
              "co": "or"
            }
          },
          {
            "name": "preDataterminal",
            "type": "projects",
            "conditions": [
              {
                "key": "terminal",
                "columnname": "",
                "type": "string",
                "format": "",
                "conditionid": "terminal0",
                "symbol": ""
              },
              {
                "key": "terminalname",
                "columnname": "",
                "type": "string",
                "format": "",
                "conditionid": "terminalname0",
                "symbol": ""
              },
              {
                "key": "filetypename",
                "columnname": "",
                "type": "string",
                "format": "",
                "conditionid": "filetypename",
                "symbol": ""
              }
            ]
          },
          {
            "name": "p_en",
            "columnname": "",
            "type": "string",
            "format": "",
            "conditionid": "p0",
            "symbol": ""
          },
          {
            "name": "factory",
            "columnname": "EQUIPMENT",
            "type": "string",
            "format": "",
            "conditionid": "fac0",
            "symbol": "="
          }
        ],
        "value": "SELECT       CITY.PRONAME,       CITY.CITYNAME,       '汇总' AS EQUIPMENT,       '[@terminalname0]' TERMINAL,       '[@filetypename]' FILETYPE,       '' CATEGORY,       '' BUSINESS,       ROUND(CASE WHEN SUM(T.DELAY)=0 THEN NULL ELSE SUM(T.ULTRAFFIC)*8000/1024/SUM(T.DELAY) END,3.0) DOWNSPEED,       ROUND(SUM(T.DELAY)/1000,3.0) DOWNDELAY,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 1, T.DELAY/1000, NULL)),3.0) DOWNDELAY1,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 2, T.DELAY/1000, NULL)),3.0) DOWNDELAY2,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 3, T.DELAY/1000, NULL)),3.0) DOWNDELAY3,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 4, T.DELAY/1000, NULL)),3.0) DOWNDELAY4,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 5, T.DELAY/1000, NULL)),3.0) DOWNDELAY5,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 6, T.DELAY/1000, NULL)),3.0) DOWNDELAY6,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 7, T.DELAY/1000, NULL)),3.0) DOWNDELAY7,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 8, T.DELAY/1000, NULL)),3.0) DOWNDELAY8,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 9, T.DELAY/1000, NULL)),3.0) DOWNDELAY9,        MAX(DECODE(T.LTEUPSPEEDGROUP, 1, T.RATIO_DELAY1, NULL)) DOWNDELAYPER1,       MAX(DECODE(T.LTEUPSPEEDGROUP, 2, T.RATIO_DELAY1, NULL)) DOWNDELAYPER2,       MAX(DECODE(T.LTEUPSPEEDGROUP, 3, T.RATIO_DELAY1, NULL)) DOWNDELAYPER3,       MAX(DECODE(T.LTEUPSPEEDGROUP, 4, T.RATIO_DELAY1, NULL)) DOWNDELAYPER4,       MAX(DECODE(T.LTEUPSPEEDGROUP, 5, T.RATIO_DELAY1, NULL)) DOWNDELAYPER5,       MAX(DECODE(T.LTEUPSPEEDGROUP, 6, T.RATIO_DELAY1, NULL)) DOWNDELAYPER6,       MAX(DECODE(T.LTEUPSPEEDGROUP, 7, T.RATIO_DELAY1, NULL)) DOWNDELAYPER7,       MAX(DECODE(T.LTEUPSPEEDGROUP, 8, T.RATIO_DELAY1, NULL)) DOWNDELAYPER8,       MAX(DECODE(T.LTEUPSPEEDGROUP, 9, T.RATIO_DELAY1, NULL)) DOWNDELAYPER9,       SUM(T.ALLCOUNT) DOWNREQUEST,       MAX(DECODE(T.LTEUPSPEEDGROUP, 1, T.ALLCOUNT, NULL)) DOWNREQUEST1,       MAX(DECODE(T.LTEUPSPEEDGROUP, 2, T.ALLCOUNT, NULL)) DOWNREQUEST2,       MAX(DECODE(T.LTEUPSPEEDGROUP, 3, T.ALLCOUNT, NULL)) DOWNREQUEST3,       MAX(DECODE(T.LTEUPSPEEDGROUP, 4, T.ALLCOUNT, NULL)) DOWNREQUEST4,       MAX(DECODE(T.LTEUPSPEEDGROUP, 5, T.ALLCOUNT, NULL)) DOWNREQUEST5,       MAX(DECODE(T.LTEUPSPEEDGROUP, 6, T.ALLCOUNT, NULL)) DOWNREQUEST6,       MAX(DECODE(T.LTEUPSPEEDGROUP, 7, T.ALLCOUNT, NULL)) DOWNREQUEST7,       MAX(DECODE(T.LTEUPSPEEDGROUP, 8, T.ALLCOUNT, NULL)) DOWNREQUEST8,       MAX(DECODE(T.LTEUPSPEEDGROUP, 9, T.ALLCOUNT, NULL)) DOWNREQUEST9,        MAX(DECODE(T.LTEUPSPEEDGROUP, 1, T.RATIO_ALLCOUNT, NULL)) DOWNREQUESTPER1,       MAX(DECODE(T.LTEUPSPEEDGROUP, 2, T.RATIO_ALLCOUNT, NULL)) DOWNREQUESTPER2,       MAX(DECODE(T.LTEUPSPEEDGROUP, 3, T.RATIO_ALLCOUNT, NULL)) DOWNREQUESTPER3,       MAX(DECODE(T.LTEUPSPEEDGROUP, 4, T.RATIO_ALLCOUNT, NULL)) DOWNREQUESTPER4,       MAX(DECODE(T.LTEUPSPEEDGROUP, 5, T.RATIO_ALLCOUNT, NULL)) DOWNREQUESTPER5,       MAX(DECODE(T.LTEUPSPEEDGROUP, 6, T.RATIO_ALLCOUNT, NULL)) DOWNREQUESTPER6,       MAX(DECODE(T.LTEUPSPEEDGROUP, 7, T.RATIO_ALLCOUNT, NULL)) DOWNREQUESTPER7,       MAX(DECODE(T.LTEUPSPEEDGROUP, 8, T.RATIO_ALLCOUNT, NULL)) DOWNREQUESTPER8,       MAX(DECODE(T.LTEUPSPEEDGROUP, 9, T.RATIO_ALLCOUNT, NULL)) DOWNREQUESTPER9,        ROUND(SUM(T.ULTRAFFIC/1024/1024), 3.0) DOWNTRAFFIC,        ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 1, T.ULTRAFFIC/1024/1024, NULL)),3.0) DOWNTRAFFIC1,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 2, T.ULTRAFFIC/1024/1024, NULL)),3.0) DOWNTRAFFIC2,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 3, T.ULTRAFFIC/1024/1024, NULL)),3.0) DOWNTRAFFIC3,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 4, T.ULTRAFFIC/1024/1024, NULL)),3.0) DOWNTRAFFIC4,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 5, T.ULTRAFFIC/1024/1024, NULL)),3.0) DOWNTRAFFIC5,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 6, T.ULTRAFFIC/1024/1024, NULL)),3.0) DOWNTRAFFIC6,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 7, T.ULTRAFFIC/1024/1024, NULL)),3.0) DOWNTRAFFIC7,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 8, T.ULTRAFFIC/1024/1024, NULL)),3.0) DOWNTRAFFIC8,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 9, T.ULTRAFFIC/1024/1024, NULL)),3.0) DOWNTRAFFIC9,        MAX(DECODE(T.LTEUPSPEEDGROUP, 1, T.RATIO_ULTRAFFIC, NULL)) DOWNTRAFFICPER1,       MAX(DECODE(T.LTEUPSPEEDGROUP, 2, T.RATIO_ULTRAFFIC, NULL)) DOWNTRAFFICPER2,       MAX(DECODE(T.LTEUPSPEEDGROUP, 3, T.RATIO_ULTRAFFIC, NULL)) DOWNTRAFFICPER3,       MAX(DECODE(T.LTEUPSPEEDGROUP, 4, T.RATIO_ULTRAFFIC, NULL)) DOWNTRAFFICPER4,       MAX(DECODE(T.LTEUPSPEEDGROUP, 5, T.RATIO_ULTRAFFIC, NULL)) DOWNTRAFFICPER5,       MAX(DECODE(T.LTEUPSPEEDGROUP, 6, T.RATIO_ULTRAFFIC, NULL)) DOWNTRAFFICPER6,       MAX(DECODE(T.LTEUPSPEEDGROUP, 7, T.RATIO_ULTRAFFIC, NULL)) DOWNTRAFFICPER7,       MAX(DECODE(T.LTEUPSPEEDGROUP, 8, T.RATIO_ULTRAFFIC, NULL)) DOWNTRAFFICPER8,       MAX(DECODE(T.LTEUPSPEEDGROUP, 9, T.RATIO_ULTRAFFIC, NULL)) DOWNTRAFFICPER9        FROM (       SELECT       GN.CITY_NO,       GN.LTEUPSPEEDGROUP,       SUM(GN.ALLCOUNT) ALLCOUNT,       ROUND(100*SUM(GN.ALLCOUNT)/SUM(SUM(GN.ALLCOUNT)) OVER(PARTITION BY GN.CITY_NO),3.0) RATIO_ALLCOUNT,       SUM(GN.ULDELAY) DELAY,       ROUND(100*SUM(GN.ULDELAY)/SUM(SUM(GN.ULDELAY)) OVER(PARTITION BY GN.CITY_NO),3.0) RATIO_DELAY1,       SUM(GN.ULTRAFFIC) ULTRAFFIC,       ROUND(100*SUM(GN.ULTRAFFIC)/SUM(SUM(GN.ULTRAFFIC)) OVER(PARTITION BY GN.CITY_NO),3.0) RATIO_ULTRAFFIC       FROM lte_sys.[@p0]_T_GN_SUM_ALLFILE GN       WHERE 1=1 [@and] ${[@city0] [@and] [@time0]}& [@and] ${[@cate0] [@and] [@subapp0]}& [@and] [@terminal0] [@and] [@fac0]       GROUP BY GN.CITY_NO,GN.LTEUPSPEEDGROUP       ) T       INNER JOIN lte_sys.T_BASE_CITY CITY ON CITY.CITY_NO=T.CITY_NO       GROUP BY CITY.PRONAME,CITY.CITYNAME       UNION       SELECT       CITY.PRONAME,       CITY.CITYNAME,       CASE WHEN T.EQUIPMENT IS NULL THEN '未匹配' ELSE T.EQUIPMENT END AS EQUIPMENT,       '[@terminalname0]' TERMINAL,       '[@filetypename]' FILETYPE,       '' CATEGORY,       '' BUSINESS,       ROUND(CASE WHEN SUM(T.DELAY)=0 THEN NULL ELSE SUM(T.ULTRAFFIC)*8000/1024/SUM(T.DELAY) END,3.0) DOWNSPEED,       ROUND(SUM(T.DELAY)/1000,3.0) DOWNDELAY,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 1, T.DELAY/1000, NULL)),3.0) DOWNDELAY1,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 2, T.DELAY/1000, NULL)),3.0) DOWNDELAY2,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 3, T.DELAY/1000, NULL)),3.0) DOWNDELAY3,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 4, T.DELAY/1000, NULL)),3.0) DOWNDELAY4,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 5, T.DELAY/1000, NULL)),3.0) DOWNDELAY5,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 6, T.DELAY/1000, NULL)),3.0) DOWNDELAY6,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 7, T.DELAY/1000, NULL)),3.0) DOWNDELAY7,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 8, T.DELAY/1000, NULL)),3.0) DOWNDELAY8,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 9, T.DELAY/1000, NULL)),3.0) DOWNDELAY9,        MAX(DECODE(T.LTEUPSPEEDGROUP, 1, T.RATIO_DELAY1, NULL)) DOWNDELAYPER1,       MAX(DECODE(T.LTEUPSPEEDGROUP, 2, T.RATIO_DELAY1, NULL)) DOWNDELAYPER2,       MAX(DECODE(T.LTEUPSPEEDGROUP, 3, T.RATIO_DELAY1, NULL)) DOWNDELAYPER3,       MAX(DECODE(T.LTEUPSPEEDGROUP, 4, T.RATIO_DELAY1, NULL)) DOWNDELAYPER4,       MAX(DECODE(T.LTEUPSPEEDGROUP, 5, T.RATIO_DELAY1, NULL)) DOWNDELAYPER5,       MAX(DECODE(T.LTEUPSPEEDGROUP, 6, T.RATIO_DELAY1, NULL)) DOWNDELAYPER6,       MAX(DECODE(T.LTEUPSPEEDGROUP, 7, T.RATIO_DELAY1, NULL)) DOWNDELAYPER7,       MAX(DECODE(T.LTEUPSPEEDGROUP, 8, T.RATIO_DELAY1, NULL)) DOWNDELAYPER8,       MAX(DECODE(T.LTEUPSPEEDGROUP, 9, T.RATIO_DELAY1, NULL)) DOWNDELAYPER9,       SUM(T.ALLCOUNT) DOWNREQUEST,       MAX(DECODE(T.LTEUPSPEEDGROUP, 1, T.ALLCOUNT, NULL)) DOWNREQUEST1,       MAX(DECODE(T.LTEUPSPEEDGROUP, 2, T.ALLCOUNT, NULL)) DOWNREQUEST2,       MAX(DECODE(T.LTEUPSPEEDGROUP, 3, T.ALLCOUNT, NULL)) DOWNREQUEST3,       MAX(DECODE(T.LTEUPSPEEDGROUP, 4, T.ALLCOUNT, NULL)) DOWNREQUEST4,       MAX(DECODE(T.LTEUPSPEEDGROUP, 5, T.ALLCOUNT, NULL)) DOWNREQUEST5,       MAX(DECODE(T.LTEUPSPEEDGROUP, 6, T.ALLCOUNT, NULL)) DOWNREQUEST6,       MAX(DECODE(T.LTEUPSPEEDGROUP, 7, T.ALLCOUNT, NULL)) DOWNREQUEST7,       MAX(DECODE(T.LTEUPSPEEDGROUP, 8, T.ALLCOUNT, NULL)) DOWNREQUEST8,       MAX(DECODE(T.LTEUPSPEEDGROUP, 9, T.ALLCOUNT, NULL)) DOWNREQUEST9,        MAX(DECODE(T.LTEUPSPEEDGROUP, 1, T.RATIO_ALLCOUNT, NULL)) DOWNREQUESTPER1,       MAX(DECODE(T.LTEUPSPEEDGROUP, 2, T.RATIO_ALLCOUNT, NULL)) DOWNREQUESTPER2,       MAX(DECODE(T.LTEUPSPEEDGROUP, 3, T.RATIO_ALLCOUNT, NULL)) DOWNREQUESTPER3,       MAX(DECODE(T.LTEUPSPEEDGROUP, 4, T.RATIO_ALLCOUNT, NULL)) DOWNREQUESTPER4,       MAX(DECODE(T.LTEUPSPEEDGROUP, 5, T.RATIO_ALLCOUNT, NULL)) DOWNREQUESTPER5,       MAX(DECODE(T.LTEUPSPEEDGROUP, 6, T.RATIO_ALLCOUNT, NULL)) DOWNREQUESTPER6,       MAX(DECODE(T.LTEUPSPEEDGROUP, 7, T.RATIO_ALLCOUNT, NULL)) DOWNREQUESTPER7,       MAX(DECODE(T.LTEUPSPEEDGROUP, 8, T.RATIO_ALLCOUNT, NULL)) DOWNREQUESTPER8,       MAX(DECODE(T.LTEUPSPEEDGROUP, 9, T.RATIO_ALLCOUNT, NULL)) DOWNREQUESTPER9,        ROUND(SUM(T.ULTRAFFIC/1024/1024), 3.0) DOWNTRAFFIC,        ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 1, T.ULTRAFFIC/1024/1024, NULL)),3.0) DOWNTRAFFIC1,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 2, T.ULTRAFFIC/1024/1024, NULL)),3.0) DOWNTRAFFIC2,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 3, T.ULTRAFFIC/1024/1024, NULL)),3.0) DOWNTRAFFIC3,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 4, T.ULTRAFFIC/1024/1024, NULL)),3.0) DOWNTRAFFIC4,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 5, T.ULTRAFFIC/1024/1024, NULL)),3.0) DOWNTRAFFIC5,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 6, T.ULTRAFFIC/1024/1024, NULL)),3.0) DOWNTRAFFIC6,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 7, T.ULTRAFFIC/1024/1024, NULL)),3.0) DOWNTRAFFIC7,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 8, T.ULTRAFFIC/1024/1024, NULL)),3.0) DOWNTRAFFIC8,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 9, T.ULTRAFFIC/1024/1024, NULL)),3.0) DOWNTRAFFIC9,        MAX(DECODE(T.LTEUPSPEEDGROUP, 1, T.RATIO_ULTRAFFIC, NULL)) DOWNTRAFFICPER1,       MAX(DECODE(T.LTEUPSPEEDGROUP, 2, T.RATIO_ULTRAFFIC, NULL)) DOWNTRAFFICPER2,       MAX(DECODE(T.LTEUPSPEEDGROUP, 3, T.RATIO_ULTRAFFIC, NULL)) DOWNTRAFFICPER3,       MAX(DECODE(T.LTEUPSPEEDGROUP, 4, T.RATIO_ULTRAFFIC, NULL)) DOWNTRAFFICPER4,       MAX(DECODE(T.LTEUPSPEEDGROUP, 5, T.RATIO_ULTRAFFIC, NULL)) DOWNTRAFFICPER5,       MAX(DECODE(T.LTEUPSPEEDGROUP, 6, T.RATIO_ULTRAFFIC, NULL)) DOWNTRAFFICPER6,       MAX(DECODE(T.LTEUPSPEEDGROUP, 7, T.RATIO_ULTRAFFIC, NULL)) DOWNTRAFFICPER7,       MAX(DECODE(T.LTEUPSPEEDGROUP, 8, T.RATIO_ULTRAFFIC, NULL)) DOWNTRAFFICPER8,       MAX(DECODE(T.LTEUPSPEEDGROUP, 9, T.RATIO_ULTRAFFIC, NULL)) DOWNTRAFFICPER9       FROM (       SELECT       GN.CITY_NO,       GN.EQUIPMENT,       GN.LTEUPSPEEDGROUP,       SUM(GN.ALLCOUNT) ALLCOUNT,       ROUND(100*SUM(GN.ALLCOUNT)/SUM(SUM(GN.ALLCOUNT)) OVER(PARTITION BY GN.CITY_NO),3.0) RATIO_ALLCOUNT,       SUM(GN.ULDELAY) DELAY,       ROUND(100*SUM(GN.ULDELAY)/SUM(SUM(GN.ULDELAY)) OVER(PARTITION BY GN.CITY_NO),3.0) RATIO_DELAY1,       SUM(GN.ULTRAFFIC) ULTRAFFIC,       ROUND(100*SUM(GN.ULTRAFFIC)/SUM(SUM(GN.ULTRAFFIC)) OVER(PARTITION BY GN.CITY_NO),3.0) RATIO_ULTRAFFIC       FROM lte_sys.[@p0]_T_GN_SUM_ALLFILE GN       WHERE 1=1 [@and] ${[@city0] [@and] [@time0]}& [@and] ${[@cate0] [@and] [@subapp0]}& [@and] [@terminal0] [@and] [@fac0]       GROUP BY GN.CITY_NO,GN.LTEUPSPEEDGROUP,GN.EQUIPMENT       ) T       INNER JOIN lte_sys.T_BASE_CITY CITY ON CITY.CITY_NO=T.CITY_NO       GROUP BY CITY.PRONAME,CITY.CITYNAME,T.EQUIPMENT       union       SELECT       CITY.PRONAME,       CITY.CITYNAME,       '汇总' AS EQUIPMENT,       '[@terminalname0]' TERMINAL,       '[@filetypename]' FILETYPE,       CATE.CATEGORYNAME CATEGORY,       '汇总' BUSINESS,       ROUND(CASE WHEN SUM(T.DELAY)=0 THEN NULL ELSE SUM(T.ULTRAFFIC)*8000/1024/SUM(T.DELAY) END,3.0) DOWNSPEED,       ROUND(SUM(T.DELAY)/1000,3.0) DOWNDELAY,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 1, T.DELAY/1000, NULL)),3.0) DOWNDELAY1,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 2, T.DELAY/1000, NULL)),3.0) DOWNDELAY2,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 3, T.DELAY/1000, NULL)),3.0) DOWNDELAY3,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 4, T.DELAY/1000, NULL)),3.0) DOWNDELAY4,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 5, T.DELAY/1000, NULL)),3.0) DOWNDELAY5,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 6, T.DELAY/1000, NULL)),3.0) DOWNDELAY6,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 7, T.DELAY/1000, NULL)),3.0) DOWNDELAY7,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 8, T.DELAY/1000, NULL)),3.0) DOWNDELAY8,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 9, T.DELAY/1000, NULL)),3.0) DOWNDELAY9,        MAX(DECODE(T.LTEUPSPEEDGROUP, 1, T.RATIO_DELAY1, NULL)) DOWNDELAYPER1,       MAX(DECODE(T.LTEUPSPEEDGROUP, 2, T.RATIO_DELAY1, NULL)) DOWNDELAYPER2,       MAX(DECODE(T.LTEUPSPEEDGROUP, 3, T.RATIO_DELAY1, NULL)) DOWNDELAYPER3,       MAX(DECODE(T.LTEUPSPEEDGROUP, 4, T.RATIO_DELAY1, NULL)) DOWNDELAYPER4,       MAX(DECODE(T.LTEUPSPEEDGROUP, 5, T.RATIO_DELAY1, NULL)) DOWNDELAYPER5,       MAX(DECODE(T.LTEUPSPEEDGROUP, 6, T.RATIO_DELAY1, NULL)) DOWNDELAYPER6,       MAX(DECODE(T.LTEUPSPEEDGROUP, 7, T.RATIO_DELAY1, NULL)) DOWNDELAYPER7,       MAX(DECODE(T.LTEUPSPEEDGROUP, 8, T.RATIO_DELAY1, NULL)) DOWNDELAYPER8,       MAX(DECODE(T.LTEUPSPEEDGROUP, 9, T.RATIO_DELAY1, NULL)) DOWNDELAYPER9,       SUM(T.ALLCOUNT) DOWNREQUEST,       MAX(DECODE(T.LTEUPSPEEDGROUP, 1, T.ALLCOUNT, NULL)) DOWNREQUEST1,       MAX(DECODE(T.LTEUPSPEEDGROUP, 2, T.ALLCOUNT, NULL)) DOWNREQUEST2,       MAX(DECODE(T.LTEUPSPEEDGROUP, 3, T.ALLCOUNT, NULL)) DOWNREQUEST3,       MAX(DECODE(T.LTEUPSPEEDGROUP, 4, T.ALLCOUNT, NULL)) DOWNREQUEST4,       MAX(DECODE(T.LTEUPSPEEDGROUP, 5, T.ALLCOUNT, NULL)) DOWNREQUEST5,       MAX(DECODE(T.LTEUPSPEEDGROUP, 6, T.ALLCOUNT, NULL)) DOWNREQUEST6,       MAX(DECODE(T.LTEUPSPEEDGROUP, 7, T.ALLCOUNT, NULL)) DOWNREQUEST7,       MAX(DECODE(T.LTEUPSPEEDGROUP, 8, T.ALLCOUNT, NULL)) DOWNREQUEST8,       MAX(DECODE(T.LTEUPSPEEDGROUP, 9, T.ALLCOUNT, NULL)) DOWNREQUEST9,        MAX(DECODE(T.LTEUPSPEEDGROUP, 1, T.RATIO_ALLCOUNT, NULL)) DOWNREQUESTPER1,       MAX(DECODE(T.LTEUPSPEEDGROUP, 2, T.RATIO_ALLCOUNT, NULL)) DOWNREQUESTPER2,       MAX(DECODE(T.LTEUPSPEEDGROUP, 3, T.RATIO_ALLCOUNT, NULL)) DOWNREQUESTPER3,       MAX(DECODE(T.LTEUPSPEEDGROUP, 4, T.RATIO_ALLCOUNT, NULL)) DOWNREQUESTPER4,       MAX(DECODE(T.LTEUPSPEEDGROUP, 5, T.RATIO_ALLCOUNT, NULL)) DOWNREQUESTPER5,       MAX(DECODE(T.LTEUPSPEEDGROUP, 6, T.RATIO_ALLCOUNT, NULL)) DOWNREQUESTPER6,       MAX(DECODE(T.LTEUPSPEEDGROUP, 7, T.RATIO_ALLCOUNT, NULL)) DOWNREQUESTPER7,       MAX(DECODE(T.LTEUPSPEEDGROUP, 8, T.RATIO_ALLCOUNT, NULL)) DOWNREQUESTPER8,       MAX(DECODE(T.LTEUPSPEEDGROUP, 9, T.RATIO_ALLCOUNT, NULL)) DOWNREQUESTPER9,        ROUND(SUM(T.ULTRAFFIC/1024/1024), 3.0) DOWNTRAFFIC,        ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 1, T.ULTRAFFIC/1024/1024, NULL)),3.0) DOWNTRAFFIC1,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 2, T.ULTRAFFIC/1024/1024, NULL)),3.0) DOWNTRAFFIC2,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 3, T.ULTRAFFIC/1024/1024, NULL)),3.0) DOWNTRAFFIC3,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 4, T.ULTRAFFIC/1024/1024, NULL)),3.0) DOWNTRAFFIC4,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 5, T.ULTRAFFIC/1024/1024, NULL)),3.0) DOWNTRAFFIC5,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 6, T.ULTRAFFIC/1024/1024, NULL)),3.0) DOWNTRAFFIC6,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 7, T.ULTRAFFIC/1024/1024, NULL)),3.0) DOWNTRAFFIC7,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 8, T.ULTRAFFIC/1024/1024, NULL)),3.0) DOWNTRAFFIC8,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 9, T.ULTRAFFIC/1024/1024, NULL)),3.0) DOWNTRAFFIC9,        MAX(DECODE(T.LTEUPSPEEDGROUP, 1, T.RATIO_ULTRAFFIC, NULL)) DOWNTRAFFICPER1,       MAX(DECODE(T.LTEUPSPEEDGROUP, 2, T.RATIO_ULTRAFFIC, NULL)) DOWNTRAFFICPER2,       MAX(DECODE(T.LTEUPSPEEDGROUP, 3, T.RATIO_ULTRAFFIC, NULL)) DOWNTRAFFICPER3,       MAX(DECODE(T.LTEUPSPEEDGROUP, 4, T.RATIO_ULTRAFFIC, NULL)) DOWNTRAFFICPER4,       MAX(DECODE(T.LTEUPSPEEDGROUP, 5, T.RATIO_ULTRAFFIC, NULL)) DOWNTRAFFICPER5,       MAX(DECODE(T.LTEUPSPEEDGROUP, 6, T.RATIO_ULTRAFFIC, NULL)) DOWNTRAFFICPER6,       MAX(DECODE(T.LTEUPSPEEDGROUP, 7, T.RATIO_ULTRAFFIC, NULL)) DOWNTRAFFICPER7,       MAX(DECODE(T.LTEUPSPEEDGROUP, 8, T.RATIO_ULTRAFFIC, NULL)) DOWNTRAFFICPER8,       MAX(DECODE(T.LTEUPSPEEDGROUP, 9, T.RATIO_ULTRAFFIC, NULL)) DOWNTRAFFICPER9       FROM (       SELECT       GN.CITY_NO,       GN.SERVICE,       GN.LTEUPSPEEDGROUP,       SUM(GN.ALLCOUNT) ALLCOUNT,       ROUND(100*SUM(GN.ALLCOUNT)/SUM(SUM(GN.ALLCOUNT)) OVER(PARTITION BY GN.CITY_NO,GN.SERVICE),3.0) RATIO_ALLCOUNT,       SUM(GN.ULDELAY) DELAY,       ROUND(100*SUM(GN.ULDELAY)/SUM(SUM(GN.ULDELAY)) OVER(PARTITION BY GN.CITY_NO,GN.SERVICE),3.0) RATIO_DELAY1,       SUM(GN.ULTRAFFIC) ULTRAFFIC,       ROUND(100*SUM(GN.ULTRAFFIC)/SUM(SUM(GN.ULTRAFFIC)) OVER(PARTITION BY GN.CITY_NO,GN.SERVICE),3.0) RATIO_ULTRAFFIC       FROM lte_sys.[@p0]_T_GN_SUM_ALLFILE GN       WHERE 1=1 [@and] ${[@city0] [@and] [@time0]}& [@and] ${[@cate0] [@and] [@subapp0]}& [@and] [@terminal0] [@and] [@fac0]       GROUP BY GN.CITY_NO,GN.LTEUPSPEEDGROUP,GN.SERVICE       ) T       INNER JOIN lte_sys.T_BASE_CITY CITY ON CITY.CITY_NO=T.CITY_NO       INNER JOIN lte_sys.[@p0]_T_BASE_CATEGORYTYPE CATE ON CATE.CATEGORYID=T.SERVICE       GROUP BY CITY.PRONAME,CITY.CITYNAME,CATE.CATEGORYNAME       UNION       SELECT       CITY.PRONAME,       CITY.CITYNAME,       CASE WHEN T.EQUIPMENT IS NULL THEN '未匹配' ELSE T.EQUIPMENT END AS EQUIPMENT,       '[@terminalname0]' TERMINAL,       '[@filetypename]' FILETYPE,       CATE.CATEGORYNAME CATEGORY,       '汇总' BUSINESS,       ROUND(CASE WHEN SUM(T.DELAY)=0 THEN NULL ELSE SUM(T.ULTRAFFIC)*8000/1024/SUM(T.DELAY) END,3.0) DOWNSPEED,       ROUND(SUM(T.DELAY)/1000,3.0) DOWNDELAY,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 1, T.DELAY/1000, NULL)),3.0) DOWNDELAY1,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 2, T.DELAY/1000, NULL)),3.0) DOWNDELAY2,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 3, T.DELAY/1000, NULL)),3.0) DOWNDELAY3,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 4, T.DELAY/1000, NULL)),3.0) DOWNDELAY4,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 5, T.DELAY/1000, NULL)),3.0) DOWNDELAY5,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 6, T.DELAY/1000, NULL)),3.0) DOWNDELAY6,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 7, T.DELAY/1000, NULL)),3.0) DOWNDELAY7,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 8, T.DELAY/1000, NULL)),3.0) DOWNDELAY8,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 9, T.DELAY/1000, NULL)),3.0) DOWNDELAY9,        MAX(DECODE(T.LTEUPSPEEDGROUP, 1, T.RATIO_DELAY1, NULL)) DOWNDELAYPER1,       MAX(DECODE(T.LTEUPSPEEDGROUP, 2, T.RATIO_DELAY1, NULL)) DOWNDELAYPER2,       MAX(DECODE(T.LTEUPSPEEDGROUP, 3, T.RATIO_DELAY1, NULL)) DOWNDELAYPER3,       MAX(DECODE(T.LTEUPSPEEDGROUP, 4, T.RATIO_DELAY1, NULL)) DOWNDELAYPER4,       MAX(DECODE(T.LTEUPSPEEDGROUP, 5, T.RATIO_DELAY1, NULL)) DOWNDELAYPER5,       MAX(DECODE(T.LTEUPSPEEDGROUP, 6, T.RATIO_DELAY1, NULL)) DOWNDELAYPER6,       MAX(DECODE(T.LTEUPSPEEDGROUP, 7, T.RATIO_DELAY1, NULL)) DOWNDELAYPER7,       MAX(DECODE(T.LTEUPSPEEDGROUP, 8, T.RATIO_DELAY1, NULL)) DOWNDELAYPER8,       MAX(DECODE(T.LTEUPSPEEDGROUP, 9, T.RATIO_DELAY1, NULL)) DOWNDELAYPER9,       SUM(T.ALLCOUNT) DOWNREQUEST,       MAX(DECODE(T.LTEUPSPEEDGROUP, 1, T.ALLCOUNT, NULL)) DOWNREQUEST1,       MAX(DECODE(T.LTEUPSPEEDGROUP, 2, T.ALLCOUNT, NULL)) DOWNREQUEST2,       MAX(DECODE(T.LTEUPSPEEDGROUP, 3, T.ALLCOUNT, NULL)) DOWNREQUEST3,       MAX(DECODE(T.LTEUPSPEEDGROUP, 4, T.ALLCOUNT, NULL)) DOWNREQUEST4,       MAX(DECODE(T.LTEUPSPEEDGROUP, 5, T.ALLCOUNT, NULL)) DOWNREQUEST5,       MAX(DECODE(T.LTEUPSPEEDGROUP, 6, T.ALLCOUNT, NULL)) DOWNREQUEST6,       MAX(DECODE(T.LTEUPSPEEDGROUP, 7, T.ALLCOUNT, NULL)) DOWNREQUEST7,       MAX(DECODE(T.LTEUPSPEEDGROUP, 8, T.ALLCOUNT, NULL)) DOWNREQUEST8,       MAX(DECODE(T.LTEUPSPEEDGROUP, 9, T.ALLCOUNT, NULL)) DOWNREQUEST9,        MAX(DECODE(T.LTEUPSPEEDGROUP, 1, T.RATIO_ALLCOUNT, NULL)) DOWNREQUESTPER1,       MAX(DECODE(T.LTEUPSPEEDGROUP, 2, T.RATIO_ALLCOUNT, NULL)) DOWNREQUESTPER2,       MAX(DECODE(T.LTEUPSPEEDGROUP, 3, T.RATIO_ALLCOUNT, NULL)) DOWNREQUESTPER3,       MAX(DECODE(T.LTEUPSPEEDGROUP, 4, T.RATIO_ALLCOUNT, NULL)) DOWNREQUESTPER4,       MAX(DECODE(T.LTEUPSPEEDGROUP, 5, T.RATIO_ALLCOUNT, NULL)) DOWNREQUESTPER5,       MAX(DECODE(T.LTEUPSPEEDGROUP, 6, T.RATIO_ALLCOUNT, NULL)) DOWNREQUESTPER6,       MAX(DECODE(T.LTEUPSPEEDGROUP, 7, T.RATIO_ALLCOUNT, NULL)) DOWNREQUESTPER7,       MAX(DECODE(T.LTEUPSPEEDGROUP, 8, T.RATIO_ALLCOUNT, NULL)) DOWNREQUESTPER8,       MAX(DECODE(T.LTEUPSPEEDGROUP, 9, T.RATIO_ALLCOUNT, NULL)) DOWNREQUESTPER9,        ROUND(SUM(T.ULTRAFFIC/1024/1024), 3.0) DOWNTRAFFIC,        ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 1, T.ULTRAFFIC/1024/1024, NULL)),3.0) DOWNTRAFFIC1,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 2, T.ULTRAFFIC/1024/1024, NULL)),3.0) DOWNTRAFFIC2,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 3, T.ULTRAFFIC/1024/1024, NULL)),3.0) DOWNTRAFFIC3,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 4, T.ULTRAFFIC/1024/1024, NULL)),3.0) DOWNTRAFFIC4,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 5, T.ULTRAFFIC/1024/1024, NULL)),3.0) DOWNTRAFFIC5,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 6, T.ULTRAFFIC/1024/1024, NULL)),3.0) DOWNTRAFFIC6,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 7, T.ULTRAFFIC/1024/1024, NULL)),3.0) DOWNTRAFFIC7,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 8, T.ULTRAFFIC/1024/1024, NULL)),3.0) DOWNTRAFFIC8,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 9, T.ULTRAFFIC/1024/1024, NULL)),3.0) DOWNTRAFFIC9,        MAX(DECODE(T.LTEUPSPEEDGROUP, 1, T.RATIO_ULTRAFFIC, NULL)) DOWNTRAFFICPER1,       MAX(DECODE(T.LTEUPSPEEDGROUP, 2, T.RATIO_ULTRAFFIC, NULL)) DOWNTRAFFICPER2,       MAX(DECODE(T.LTEUPSPEEDGROUP, 3, T.RATIO_ULTRAFFIC, NULL)) DOWNTRAFFICPER3,       MAX(DECODE(T.LTEUPSPEEDGROUP, 4, T.RATIO_ULTRAFFIC, NULL)) DOWNTRAFFICPER4,       MAX(DECODE(T.LTEUPSPEEDGROUP, 5, T.RATIO_ULTRAFFIC, NULL)) DOWNTRAFFICPER5,       MAX(DECODE(T.LTEUPSPEEDGROUP, 6, T.RATIO_ULTRAFFIC, NULL)) DOWNTRAFFICPER6,       MAX(DECODE(T.LTEUPSPEEDGROUP, 7, T.RATIO_ULTRAFFIC, NULL)) DOWNTRAFFICPER7,       MAX(DECODE(T.LTEUPSPEEDGROUP, 8, T.RATIO_ULTRAFFIC, NULL)) DOWNTRAFFICPER8,       MAX(DECODE(T.LTEUPSPEEDGROUP, 9, T.RATIO_ULTRAFFIC, NULL)) DOWNTRAFFICPER9       FROM (       SELECT       GN.CITY_NO,       GN.EQUIPMENT,       GN.SERVICE,       GN.LTEUPSPEEDGROUP,       SUM(GN.ALLCOUNT) ALLCOUNT,       ROUND(100*SUM(GN.ALLCOUNT)/SUM(SUM(GN.ALLCOUNT)) OVER(PARTITION BY GN.CITY_NO,GN.SERVICE),3.0) RATIO_ALLCOUNT,       SUM(GN.ULDELAY) DELAY,       ROUND(100*SUM(GN.ULDELAY)/SUM(SUM(GN.ULDELAY)) OVER(PARTITION BY GN.CITY_NO,GN.SERVICE),3.0) RATIO_DELAY1,       SUM(GN.ULTRAFFIC) ULTRAFFIC,       ROUND(100*SUM(GN.ULTRAFFIC)/SUM(SUM(GN.ULTRAFFIC)) OVER(PARTITION BY GN.CITY_NO,GN.SERVICE),3.0) RATIO_ULTRAFFIC       FROM lte_sys.[@p0]_T_GN_SUM_ALLFILE GN       WHERE 1=1 [@and] ${[@city0] [@and] [@time0]}& [@and] ${[@cate0] [@and] [@subapp0]}& [@and] [@terminal0] [@and] [@fac0]       GROUP BY GN.CITY_NO,GN.LTEUPSPEEDGROUP,GN.SERVICE,GN.EQUIPMENT       ) T       INNER JOIN lte_sys.T_BASE_CITY CITY ON CITY.CITY_NO=T.CITY_NO       INNER JOIN lte_sys.[@p0]_T_BASE_CATEGORYTYPE CATE ON CATE.CATEGORYID=T.SERVICE       GROUP BY CITY.PRONAME,CITY.CITYNAME,CATE.CATEGORYNAME,T.EQUIPMENT       union       SELECT       CITY.PRONAME,       CITY.CITYNAME,       '汇总' AS EQUIPMENT,       '[@terminalname0]' TERMINAL,       '[@filetypename]' FILETYPE,       CATE.CATEGORYNAME CATEGORY,       CATE.BUSSINESSNAME BUSINESS,       ROUND(CASE WHEN SUM(T.DELAY)=0 THEN NULL ELSE SUM(T.ULTRAFFIC)*8000/1024/SUM(T.DELAY) END,3.0) DOWNSPEED,       ROUND(SUM(T.DELAY)/1000,3.0) DOWNDELAY,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 1, T.DELAY/1000, NULL)),3.0) DOWNDELAY1,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 2, T.DELAY/1000, NULL)),3.0) DOWNDELAY2,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 3, T.DELAY/1000, NULL)),3.0) DOWNDELAY3,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 4, T.DELAY/1000, NULL)),3.0) DOWNDELAY4,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 5, T.DELAY/1000, NULL)),3.0) DOWNDELAY5,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 6, T.DELAY/1000, NULL)),3.0) DOWNDELAY6,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 7, T.DELAY/1000, NULL)),3.0) DOWNDELAY7,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 8, T.DELAY/1000, NULL)),3.0) DOWNDELAY8,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 9, T.DELAY/1000, NULL)),3.0) DOWNDELAY9,        MAX(DECODE(T.LTEUPSPEEDGROUP, 1, T.RATIO_DELAY1, NULL)) DOWNDELAYPER1,       MAX(DECODE(T.LTEUPSPEEDGROUP, 2, T.RATIO_DELAY1, NULL)) DOWNDELAYPER2,       MAX(DECODE(T.LTEUPSPEEDGROUP, 3, T.RATIO_DELAY1, NULL)) DOWNDELAYPER3,       MAX(DECODE(T.LTEUPSPEEDGROUP, 4, T.RATIO_DELAY1, NULL)) DOWNDELAYPER4,       MAX(DECODE(T.LTEUPSPEEDGROUP, 5, T.RATIO_DELAY1, NULL)) DOWNDELAYPER5,       MAX(DECODE(T.LTEUPSPEEDGROUP, 6, T.RATIO_DELAY1, NULL)) DOWNDELAYPER6,       MAX(DECODE(T.LTEUPSPEEDGROUP, 7, T.RATIO_DELAY1, NULL)) DOWNDELAYPER7,       MAX(DECODE(T.LTEUPSPEEDGROUP, 8, T.RATIO_DELAY1, NULL)) DOWNDELAYPER8,       MAX(DECODE(T.LTEUPSPEEDGROUP, 9, T.RATIO_DELAY1, NULL)) DOWNDELAYPER9,       SUM(T.ALLCOUNT) DOWNREQUEST,       MAX(DECODE(T.LTEUPSPEEDGROUP, 1, T.ALLCOUNT, NULL)) DOWNREQUEST1,       MAX(DECODE(T.LTEUPSPEEDGROUP, 2, T.ALLCOUNT, NULL)) DOWNREQUEST2,       MAX(DECODE(T.LTEUPSPEEDGROUP, 3, T.ALLCOUNT, NULL)) DOWNREQUEST3,       MAX(DECODE(T.LTEUPSPEEDGROUP, 4, T.ALLCOUNT, NULL)) DOWNREQUEST4,       MAX(DECODE(T.LTEUPSPEEDGROUP, 5, T.ALLCOUNT, NULL)) DOWNREQUEST5,       MAX(DECODE(T.LTEUPSPEEDGROUP, 6, T.ALLCOUNT, NULL)) DOWNREQUEST6,       MAX(DECODE(T.LTEUPSPEEDGROUP, 7, T.ALLCOUNT, NULL)) DOWNREQUEST7,       MAX(DECODE(T.LTEUPSPEEDGROUP, 8, T.ALLCOUNT, NULL)) DOWNREQUEST8,       MAX(DECODE(T.LTEUPSPEEDGROUP, 9, T.ALLCOUNT, NULL)) DOWNREQUEST9,        MAX(DECODE(T.LTEUPSPEEDGROUP, 1, T.RATIO_ALLCOUNT, NULL)) DOWNREQUESTPER1,       MAX(DECODE(T.LTEUPSPEEDGROUP, 2, T.RATIO_ALLCOUNT, NULL)) DOWNREQUESTPER2,       MAX(DECODE(T.LTEUPSPEEDGROUP, 3, T.RATIO_ALLCOUNT, NULL)) DOWNREQUESTPER3,       MAX(DECODE(T.LTEUPSPEEDGROUP, 4, T.RATIO_ALLCOUNT, NULL)) DOWNREQUESTPER4,       MAX(DECODE(T.LTEUPSPEEDGROUP, 5, T.RATIO_ALLCOUNT, NULL)) DOWNREQUESTPER5,       MAX(DECODE(T.LTEUPSPEEDGROUP, 6, T.RATIO_ALLCOUNT, NULL)) DOWNREQUESTPER6,       MAX(DECODE(T.LTEUPSPEEDGROUP, 7, T.RATIO_ALLCOUNT, NULL)) DOWNREQUESTPER7,       MAX(DECODE(T.LTEUPSPEEDGROUP, 8, T.RATIO_ALLCOUNT, NULL)) DOWNREQUESTPER8,       MAX(DECODE(T.LTEUPSPEEDGROUP, 9, T.RATIO_ALLCOUNT, NULL)) DOWNREQUESTPER9,        ROUND(SUM(T.ULTRAFFIC/1024/1024), 3.0) DOWNTRAFFIC,        ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 1, T.ULTRAFFIC/1024/1024, NULL)),3.0) DOWNTRAFFIC1,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 2, T.ULTRAFFIC/1024/1024, NULL)),3.0) DOWNTRAFFIC2,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 3, T.ULTRAFFIC/1024/1024, NULL)),3.0) DOWNTRAFFIC3,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 4, T.ULTRAFFIC/1024/1024, NULL)),3.0) DOWNTRAFFIC4,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 5, T.ULTRAFFIC/1024/1024, NULL)),3.0) DOWNTRAFFIC5,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 6, T.ULTRAFFIC/1024/1024, NULL)),3.0) DOWNTRAFFIC6,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 7, T.ULTRAFFIC/1024/1024, NULL)),3.0) DOWNTRAFFIC7,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 8, T.ULTRAFFIC/1024/1024, NULL)),3.0) DOWNTRAFFIC8,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 9, T.ULTRAFFIC/1024/1024, NULL)),3.0) DOWNTRAFFIC9,        MAX(DECODE(T.LTEUPSPEEDGROUP, 1, T.RATIO_ULTRAFFIC, NULL)) DOWNTRAFFICPER1,       MAX(DECODE(T.LTEUPSPEEDGROUP, 2, T.RATIO_ULTRAFFIC, NULL)) DOWNTRAFFICPER2,       MAX(DECODE(T.LTEUPSPEEDGROUP, 3, T.RATIO_ULTRAFFIC, NULL)) DOWNTRAFFICPER3,       MAX(DECODE(T.LTEUPSPEEDGROUP, 4, T.RATIO_ULTRAFFIC, NULL)) DOWNTRAFFICPER4,       MAX(DECODE(T.LTEUPSPEEDGROUP, 5, T.RATIO_ULTRAFFIC, NULL)) DOWNTRAFFICPER5,       MAX(DECODE(T.LTEUPSPEEDGROUP, 6, T.RATIO_ULTRAFFIC, NULL)) DOWNTRAFFICPER6,       MAX(DECODE(T.LTEUPSPEEDGROUP, 7, T.RATIO_ULTRAFFIC, NULL)) DOWNTRAFFICPER7,       MAX(DECODE(T.LTEUPSPEEDGROUP, 8, T.RATIO_ULTRAFFIC, NULL)) DOWNTRAFFICPER8,       MAX(DECODE(T.LTEUPSPEEDGROUP, 9, T.RATIO_ULTRAFFIC, NULL)) DOWNTRAFFICPER9       FROM (       SELECT       GN.CITY_NO,       GN.SERVICE,       GN.BUSSINESSTYPE,       GN.LTEUPSPEEDGROUP,       SUM(GN.ALLCOUNT) ALLCOUNT,       ROUND(100*SUM(GN.ALLCOUNT)/SUM(SUM(GN.ALLCOUNT)) OVER(PARTITION BY GN.CITY_NO,GN.SERVICE,GN.BUSSINESSTYPE),3.0) RATIO_ALLCOUNT,       SUM(GN.ULDELAY) DELAY,       ROUND(100*SUM(GN.ULDELAY)/SUM(SUM(GN.ULDELAY)) OVER(PARTITION BY GN.CITY_NO,GN.SERVICE,GN.BUSSINESSTYPE),3.0) RATIO_DELAY1,       SUM(GN.ULTRAFFIC) ULTRAFFIC,       ROUND(100*SUM(GN.ULTRAFFIC)/SUM(SUM(GN.ULTRAFFIC)) OVER(PARTITION BY GN.CITY_NO,GN.SERVICE,GN.BUSSINESSTYPE),3.0) RATIO_ULTRAFFIC       FROM lte_sys.[@p0]_T_GN_SUM_ALLFILE GN       WHERE 1=1 [@and] ${[@city0] [@and] [@time0]}& [@and] ${[@cate0] [@and] [@subapp0]}& [@and] [@terminal0] [@and] [@fac0]       GROUP BY GN.CITY_NO,GN.LTEUPSPEEDGROUP,GN.SERVICE,GN.BUSSINESSTYPE       ) T       INNER JOIN lte_sys.T_BASE_CITY CITY ON CITY.CITY_NO=T.CITY_NO       INNER JOIN lte_sys.[@p0]_T_BASE_CATEGORYTYPE CATE ON CATE.CATEGORYID=T.SERVICE AND CATE.BUSSINESSTYPE=T.BUSSINESSTYPE       GROUP BY CITY.PRONAME,CITY.CITYNAME,CATE.CATEGORYNAME,CATE.BUSSINESSNAME       UNION       SELECT       CITY.PRONAME,       CITY.CITYNAME,       CASE WHEN T.EQUIPMENT IS NULL THEN '未匹配' ELSE T.EQUIPMENT END AS EQUIPMENT,       '[@terminalname0]' TERMINAL,       '[@filetypename]' FILETYPE,       CATE.CATEGORYNAME CATEGORY,       CATE.BUSSINESSNAME BUSINESS,       ROUND(CASE WHEN SUM(T.DELAY)=0 THEN NULL ELSE SUM(T.ULTRAFFIC)*8000/1024/SUM(T.DELAY) END,3.0) DOWNSPEED,       ROUND(SUM(T.DELAY)/1000,3.0) DOWNDELAY,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 1, T.DELAY/1000, NULL)),3.0) DOWNDELAY1,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 2, T.DELAY/1000, NULL)),3.0) DOWNDELAY2,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 3, T.DELAY/1000, NULL)),3.0) DOWNDELAY3,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 4, T.DELAY/1000, NULL)),3.0) DOWNDELAY4,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 5, T.DELAY/1000, NULL)),3.0) DOWNDELAY5,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 6, T.DELAY/1000, NULL)),3.0) DOWNDELAY6,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 7, T.DELAY/1000, NULL)),3.0) DOWNDELAY7,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 8, T.DELAY/1000, NULL)),3.0) DOWNDELAY8,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 9, T.DELAY/1000, NULL)),3.0) DOWNDELAY9,        MAX(DECODE(T.LTEUPSPEEDGROUP, 1, T.RATIO_DELAY1, NULL)) DOWNDELAYPER1,       MAX(DECODE(T.LTEUPSPEEDGROUP, 2, T.RATIO_DELAY1, NULL)) DOWNDELAYPER2,       MAX(DECODE(T.LTEUPSPEEDGROUP, 3, T.RATIO_DELAY1, NULL)) DOWNDELAYPER3,       MAX(DECODE(T.LTEUPSPEEDGROUP, 4, T.RATIO_DELAY1, NULL)) DOWNDELAYPER4,       MAX(DECODE(T.LTEUPSPEEDGROUP, 5, T.RATIO_DELAY1, NULL)) DOWNDELAYPER5,       MAX(DECODE(T.LTEUPSPEEDGROUP, 6, T.RATIO_DELAY1, NULL)) DOWNDELAYPER6,       MAX(DECODE(T.LTEUPSPEEDGROUP, 7, T.RATIO_DELAY1, NULL)) DOWNDELAYPER7,       MAX(DECODE(T.LTEUPSPEEDGROUP, 8, T.RATIO_DELAY1, NULL)) DOWNDELAYPER8,       MAX(DECODE(T.LTEUPSPEEDGROUP, 9, T.RATIO_DELAY1, NULL)) DOWNDELAYPER9,       SUM(T.ALLCOUNT) DOWNREQUEST,       MAX(DECODE(T.LTEUPSPEEDGROUP, 1, T.ALLCOUNT, NULL)) DOWNREQUEST1,       MAX(DECODE(T.LTEUPSPEEDGROUP, 2, T.ALLCOUNT, NULL)) DOWNREQUEST2,       MAX(DECODE(T.LTEUPSPEEDGROUP, 3, T.ALLCOUNT, NULL)) DOWNREQUEST3,       MAX(DECODE(T.LTEUPSPEEDGROUP, 4, T.ALLCOUNT, NULL)) DOWNREQUEST4,       MAX(DECODE(T.LTEUPSPEEDGROUP, 5, T.ALLCOUNT, NULL)) DOWNREQUEST5,       MAX(DECODE(T.LTEUPSPEEDGROUP, 6, T.ALLCOUNT, NULL)) DOWNREQUEST6,       MAX(DECODE(T.LTEUPSPEEDGROUP, 7, T.ALLCOUNT, NULL)) DOWNREQUEST7,       MAX(DECODE(T.LTEUPSPEEDGROUP, 8, T.ALLCOUNT, NULL)) DOWNREQUEST8,       MAX(DECODE(T.LTEUPSPEEDGROUP, 9, T.ALLCOUNT, NULL)) DOWNREQUEST9,        MAX(DECODE(T.LTEUPSPEEDGROUP, 1, T.RATIO_ALLCOUNT, NULL)) DOWNREQUESTPER1,       MAX(DECODE(T.LTEUPSPEEDGROUP, 2, T.RATIO_ALLCOUNT, NULL)) DOWNREQUESTPER2,       MAX(DECODE(T.LTEUPSPEEDGROUP, 3, T.RATIO_ALLCOUNT, NULL)) DOWNREQUESTPER3,       MAX(DECODE(T.LTEUPSPEEDGROUP, 4, T.RATIO_ALLCOUNT, NULL)) DOWNREQUESTPER4,       MAX(DECODE(T.LTEUPSPEEDGROUP, 5, T.RATIO_ALLCOUNT, NULL)) DOWNREQUESTPER5,       MAX(DECODE(T.LTEUPSPEEDGROUP, 6, T.RATIO_ALLCOUNT, NULL)) DOWNREQUESTPER6,       MAX(DECODE(T.LTEUPSPEEDGROUP, 7, T.RATIO_ALLCOUNT, NULL)) DOWNREQUESTPER7,       MAX(DECODE(T.LTEUPSPEEDGROUP, 8, T.RATIO_ALLCOUNT, NULL)) DOWNREQUESTPER8,       MAX(DECODE(T.LTEUPSPEEDGROUP, 9, T.RATIO_ALLCOUNT, NULL)) DOWNREQUESTPER9,        ROUND(SUM(T.ULTRAFFIC/1024/1024), 3.0) DOWNTRAFFIC,        ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 1, T.ULTRAFFIC/1024/1024, NULL)),3.0) DOWNTRAFFIC1,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 2, T.ULTRAFFIC/1024/1024, NULL)),3.0) DOWNTRAFFIC2,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 3, T.ULTRAFFIC/1024/1024, NULL)),3.0) DOWNTRAFFIC3,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 4, T.ULTRAFFIC/1024/1024, NULL)),3.0) DOWNTRAFFIC4,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 5, T.ULTRAFFIC/1024/1024, NULL)),3.0) DOWNTRAFFIC5,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 6, T.ULTRAFFIC/1024/1024, NULL)),3.0) DOWNTRAFFIC6,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 7, T.ULTRAFFIC/1024/1024, NULL)),3.0) DOWNTRAFFIC7,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 8, T.ULTRAFFIC/1024/1024, NULL)),3.0) DOWNTRAFFIC8,       ROUND(MAX(DECODE(T.LTEUPSPEEDGROUP, 9, T.ULTRAFFIC/1024/1024, NULL)),3.0) DOWNTRAFFIC9,        MAX(DECODE(T.LTEUPSPEEDGROUP, 1, T.RATIO_ULTRAFFIC, NULL)) DOWNTRAFFICPER1,       MAX(DECODE(T.LTEUPSPEEDGROUP, 2, T.RATIO_ULTRAFFIC, NULL)) DOWNTRAFFICPER2,       MAX(DECODE(T.LTEUPSPEEDGROUP, 3, T.RATIO_ULTRAFFIC, NULL)) DOWNTRAFFICPER3,       MAX(DECODE(T.LTEUPSPEEDGROUP, 4, T.RATIO_ULTRAFFIC, NULL)) DOWNTRAFFICPER4,       MAX(DECODE(T.LTEUPSPEEDGROUP, 5, T.RATIO_ULTRAFFIC, NULL)) DOWNTRAFFICPER5,       MAX(DECODE(T.LTEUPSPEEDGROUP, 6, T.RATIO_ULTRAFFIC, NULL)) DOWNTRAFFICPER6,       MAX(DECODE(T.LTEUPSPEEDGROUP, 7, T.RATIO_ULTRAFFIC, NULL)) DOWNTRAFFICPER7,       MAX(DECODE(T.LTEUPSPEEDGROUP, 8, T.RATIO_ULTRAFFIC, NULL)) DOWNTRAFFICPER8,       MAX(DECODE(T.LTEUPSPEEDGROUP, 9, T.RATIO_ULTRAFFIC, NULL)) DOWNTRAFFICPER9       FROM (       SELECT       GN.CITY_NO,       GN.EQUIPMENT,       GN.SERVICE,       GN.BUSSINESSTYPE,       GN.LTEUPSPEEDGROUP,       SUM(GN.ALLCOUNT) ALLCOUNT,       ROUND(100*SUM(GN.ALLCOUNT)/SUM(SUM(GN.ALLCOUNT)) OVER(PARTITION BY GN.CITY_NO,GN.SERVICE,GN.BUSSINESSTYPE),3.0) RATIO_ALLCOUNT,       SUM(GN.ULDELAY) DELAY,       ROUND(100*SUM(GN.ULDELAY)/SUM(SUM(GN.ULDELAY)) OVER(PARTITION BY GN.CITY_NO,GN.SERVICE,GN.BUSSINESSTYPE),3.0) RATIO_DELAY1,       SUM(GN.ULTRAFFIC) ULTRAFFIC,       ROUND(100*SUM(GN.ULTRAFFIC)/SUM(SUM(GN.ULTRAFFIC)) OVER(PARTITION BY GN.CITY_NO,GN.SERVICE,GN.BUSSINESSTYPE),3.0) RATIO_ULTRAFFIC       FROM lte_sys.[@p0]_T_GN_SUM_ALLFILE GN       WHERE 1=1 [@and] ${[@city0] [@and] [@time0]}& [@and] ${[@cate0] [@and] [@subapp0]}& [@and] [@terminal0] [@and] [@fac0]       GROUP BY GN.CITY_NO,GN.LTEUPSPEEDGROUP,GN.SERVICE,GN.BUSSINESSTYPE,GN.EQUIPMENT       ) T       INNER JOIN lte_sys.T_BASE_CITY CITY ON CITY.CITY_NO=T.CITY_NO       INNER JOIN lte_sys.[@p0]_T_BASE_CATEGORYTYPE CATE ON CATE.CATEGORYID=T.SERVICE AND CATE.BUSSINESSTYPE=T.BUSSINESSTYPE       GROUP BY CITY.PRONAME,CITY.CITYNAME,CATE.CATEGORYNAME,CATE.BUSSINESSNAME,T.EQUIPMENT"
      }
    }
  ]
}