<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My Works</title>
    <link rel="icon" href="favicon.ico" type="image/x-icon">
    <link rel="stylesheet" href="https://api.fontshare.com/v2/css?f[]=clash-display@400,500,600,700&display=swap">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/ScrollToPlugin.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/interactjs/dist/interact.min.js"></script>
    <style>
        :root {
            font-size: 16px;
            --primary-color: #ff3e7f;
            --secondary-color: #ffb56b;
            --bg-color: #121212;
            --text-color: #ffffff;
            --section-padding: 0 2.5rem;
            --content-max-width: 1600px;
            --grid-side-margin: 2rem;
        }
        
        /* Reset and base styles */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'SpaceGrotesk', sans-serif;
        }
        
        /* Update headings to use Space Grotesk with appropriate weight */
        h1, h2, h3, h4, h5, h6, .section-title {
            font-family: 'SpaceGrotesk', sans-serif;
            font-weight: 700; /* Bold weight for headings */
        }
        
        body, html {
            margin: 0;
            padding: 0;
            font-family: 'Satoshi', sans-serif;
            font-weight: 400;
            line-height: 1.5;
            color: #fff;
            background-color: #0D0C0E;
            overflow-x: hidden; /* 确保始终隐藏水平滚动条 */
            width: 100%; /* 限制宽度为容器宽度 */
            cursor: auto;
        }
        
        /* Interactive elements cursor style */
        a, button, .nav-btn, .slider-btn, .slider-dot {
            cursor: pointer;
            position: relative;
            z-index: 100;
            overflow: visible;
        }
        
        /* Custom cursor styles - 移除自定义光标 */
        .cursor-container {
            display: none; /* 隐藏自定义光标容器 */
        }
        
        .cursor-dot {
            display: none; /* 隐藏自定义光标点 */
        }
        
        .cursor-outline {
            display: none; /* 已经是none */
        }
        
        .cursor-trail {
            display: none; /* 隐藏光标轨迹 */
        }
        
        /* Add background for text links */
        a:not(.logo), .nav-btn {
            position: relative;
            z-index: 2;
        }
        
        a:not(.logo)::before, .nav-btn::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 100%;
            height: 100%;
            background-color: rgba(255, 62, 127, 0.05);
            border-radius: 8px;
            transform: translate(-50%, -50%);
            z-index: -1;
            opacity: 0;
            transition: opacity 0.3s ease;
            padding: 8px 12px;
        }
        
        a:not(.logo):hover::before, .nav-btn:hover::before {
            opacity: 1;
        }
        
        /* Remove the hover styles that were trying to modify the outline */
        a:hover ~ .cursor-container .cursor-outline,
        button:hover ~ .cursor-container .cursor-outline,
        .nav-btn:hover ~ .cursor-container .cursor-outline,
        .slider-btn:hover ~ .cursor-container .cursor-outline,
        .slider-dot:hover ~ .cursor-container .cursor-outline,
        .scroll-indicator:hover ~ .cursor-container .cursor-outline {
            display: none;
        }
        
        /* Logo specific styles */
        .logo {
            text-decoration: none;
            position: relative;
            display: flex;
            align-items: center;
            padding: 4px;
            transition: transform 0.3s ease;
        }
        
        .logo:hover {
            transform: scale(1.05);
        }
        
        .logo img {
            width: 45px;
            height:45px;
            object-fit: contain;
            filter: drop-shadow(0 0 8px rgba(255, 62, 127, 0.3));
            transition: all 0.3s ease;
        }
        
        .logo:hover img {
            filter: drop-shadow(0 0 12px rgba(255, 62, 127, 0.5));
            transform: scale(1.15);
        }
        
        /* Remove the dot before logo */
        .logo::before {
            display: none;
        }
        
        /* Remove the colored span style */
        .logo span {
            display: none;
        }
        
        /* Update the glow effect for logo */
        .logo::after {
            display: none;
        }
        
        /* Navigation styles */
        .navbar-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            z-index: 1000;
            display: flex;
            justify-content: center;
            padding-top: 25px;
            overflow: visible;
        }
        
        .navbar {
            width: 100%;
            max-width: 3440px;
            padding: 0.5rem 3%;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: all 0.3s ease;
            overflow: visible;
        }
        
        .logo {
            font-size: 1.8rem;
            font-weight: 700;
            color: #fff;
            text-decoration: none;
            position: relative;
            display: flex;
            align-items: center;
        }
        
        .logo::before {
            content: '';
            position: absolute;
            width: 8px;
            height: 8px;
            background: #ff3e7f;
            border-radius: 50%;
            left: -15px;
            top: 50%;
            transform: translateY(-50%);
        }
        
        .logo span {
            color: #ff3e7f;
        }
        
        .nav-links {
            display: flex;
            gap: 2.5rem;
            margin-left: auto;
            overflow: visible;
            white-space: nowrap;
        }
        
        .nav-links a {
            color: var(--text-color);
            text-decoration: none;
            font-size: 1.3rem;
            font-weight: 600;
            position: relative;
            transition: all 0.3s ease;
            letter-spacing: 0.4px;
            text-transform: uppercase;
            font-family: 'SpaceGrotesk', sans-serif;
        }
        
        .nav-links a::after {
            content: '';
            position: absolute;
            width: 0;
            height: 2.5px;
            background: #ff3e7f;
            left: 0;
            bottom: -6px;
            transition: width 0.3s ease !important;
        }
        
        .nav-links a:hover {
            color: #ff3e7f !important;
            transform: translateY(-1px) !important;
        }
        
        .nav-links a:hover::after {
            width: 100% !important;
        }
        
        /* 添加当前页面链接的激活状态 */
        .nav-links a.active {
            color: #ff3e7f !important;
            transform: translateY(-1px) !important;
        }
        
        .nav-links a.active::after {
            width: 100% !important;
        }
        
        .menu-toggle {
            display: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: #f5f5f5;
        }
        
        /* 添加导航栏响应式设计 */
        @media (max-width: 768px) {
            .navbar {
                padding: 0.5rem 5%;
                overflow-x: auto;
                -webkit-overflow-scrolling: touch;
                scrollbar-width: none;
            }
            
            .navbar::-webkit-scrollbar {
                display: none;
            }
            
            .nav-links {
                gap: 1.8rem;
                padding-right: 1rem;
            }
            
            .nav-links a {
                font-size: 1.1rem;
            }
        }
        
        @media (max-width: 480px) {
            .nav-links {
                gap: 1.2rem;
            }
            
            .nav-links a {
                font-size: 1rem;
                letter-spacing: 0.2px;
            }
        }
        
        /* Works Content Section */
        .works-content {
            padding-top: 120px; /* 确保内容不被导航栏遮挡 */
            min-height: 70vh; /* Reduced min-height slightly */
            padding-bottom: 30px; /* Reduced bottom padding */
            max-width: 3840px; /* Updated max-width */
            margin: 0 auto;
            /* Adjust padding to ensure 40px side margins */
            padding-left: 40px;
            padding-right: 40px;
        }
        
        .works-title {
            text-align: center;
            margin-bottom: 3rem; /* Further reduced bottom margin */
        }
        
        .works-title h1 {
            font-size: 4.5rem; /* Increased font size */
            background: linear-gradient(45deg, var(--primary-color), var(--secondary-color));
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            display: inline-block;
            font-weight: 700;
            font-family: 'SpaceGrotesk', sans-serif; /* Ensure font consistency */
            letter-spacing: 0.1em; /* Added letter spacing */
            /* Removed margin-bottom */
        }
        
        /* Removed .works-title p selector as the paragraph is removed */
        
        /* 媒体查询 */
        @media (max-width: 480px) {
            /* .work-item {
                width: calc(100% - 1rem);
                min-width: 250px;
            } */
        }
        
        /* 添加字体 */
        @font-face {
            font-family: 'Million Smiles';
            src: url('Sources/Million Smiles.otf') format('opentype');
            font-weight: normal;
            font-style: normal;
            font-display: swap;
        }

        @font-face {
            font-family: 'SpaceGrotesk';
            src: url('Sources/SpaceGrotesk-VariableFont_wght.ttf') format('truetype-variations');
            font-weight: 100 900;
            font-style: normal;
            font-display: swap;
        }

        /* Final Section styles */
        .final-section {
            max-width: var(--content-max-width);
            margin: 0 auto;
            padding: 3rem var(--section-padding);
            text-align: center;
            position: relative;
            border-top: 1px solid transparent;
            background-image: linear-gradient(90deg, 
                rgba(255, 255, 255, 0), 
                rgba(255, 62, 127, 0.5), 
                rgba(255, 181, 107, 0.5), 
                rgba(255, 255, 255, 0));
            background-position: top;
            background-size: 100% 1px;
            background-repeat: no-repeat;
            padding-top: 4rem; /* 增加顶部内边距 */
        }
        
        .awesome-together {
            margin-bottom: 1rem;
        }
        
        .awesome-together h2 {
            font-size: 3.5rem;
            font-weight: 700;
            line-height: 1.2;
            margin-bottom: 0.8rem;
            color: #fff;
            letter-spacing: 0.15em;
        }
        
        .awesome-together .highlight {
            background: linear-gradient(90deg, #ff3e7f, #ffb56b);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            display: inline-block;
        }
        
        .contact-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 0.8rem;
        }
        
        .social-buttons {
            display: flex;
            justify-content: center;
            gap: 3.5rem;
            margin-top: 0.8rem;
        }
        
        .plain-text {
            color: rgba(255, 255, 255, 0.6);
            font-size: 1.3rem;
            font-weight: 600;
            text-decoration: none;
            transition: color 0.3s ease;
            background: transparent !important;
            border: none !important;
            box-shadow: none !important;
            border-radius: 0 !important;
            position: static !important;
            display: inline !important;
            margin: 0 !important;
            padding: 0 !important;
            overflow: visible !important;
        }
        
        .plain-text::before,
        .plain-text::after,
        .plain-text *,
        .plain-text *::before,
        .plain-text *::after {
            display: none !important;
            content: none !important;
            background: none !important;
            border: none !important;
            border-radius: 0 !important;
            box-shadow: none !important;
        }
        
        .plain-text:hover {
            color: #fff;
        }
        
        .email-info {
            margin-top: 1rem;
        }
        
        .email-info p {
            font-size: 1.2rem;
            color: rgba(255, 255, 255, 0.7);
            font-weight: 500;
            padding-bottom: 0.5rem;
            border-bottom: 2px solid rgba(255, 62, 127, 0.5);
            display: inline-block;
            transition: all 0.3s ease;
        }
        
        .email-info p:hover {
            color: #fff;
            border-bottom-color: #ffb56b;
        }
        
        /* Final Section Responsive */
        @media (max-width: 1200px) {
            .awesome-together h2 {
                font-size: 3rem;
            }
        }
        
        @media (max-width: 768px) {
            .final-section {
                padding: 2.5rem 1.5rem;
            }
            
            .awesome-together h2 {
                font-size: 2.2rem;
            }
            
            .social-buttons {
                flex-wrap: wrap;
                gap: 2.5rem;
            }
            
            .plain-text {
                font-size: 1.2rem;
            }
        }
        
        @media (max-width: 480px) {
            .awesome-together h2 {
                font-size: 1.8rem;
            }
            
            .social-buttons {
                gap: 1.2rem;
                justify-content: space-around;
                width: 100%;
            }
            
            .plain-text {
                font-size: 1rem;
            }
            
            .email-info p {
                font-size: 1rem;
            }
        }

        /* 应用SpaceGrotesk到特定文本元素 */
        p, .paragraph, .text, .works-title p, .email-info p {
            font-family: 'SpaceGrotesk', sans-serif;
        }

        /* 作品分类样式 */
        /* Tab Navigation for Categories */
        .category-tabs {
            display: flex;
            justify-content: center;
            gap: 2.5rem; /* Increased gap between buttons */
            margin-bottom: 0.25rem; /* Further reduced margin-bottom */
            padding-bottom: 1rem;
            flex-wrap: wrap;
        }

        .tab-btn {
            background: none;
            border: none;
            color: rgba(255, 255, 255, 0.6);
            font-size: 1.2rem;
            font-weight: 600;
            padding: 0.8rem 1.5rem;
            cursor: pointer;
            transition: all 0.3s ease;
            border-radius: 8px;
            position: relative;
            font-family: 'SpaceGrotesk', sans-serif;
        }

        .tab-btn::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 0;
            height: 3px;
            background: linear-gradient(90deg, var(--primary-color), var(--secondary-color));
            border-radius: 3px;
            transition: width 0.3s ease;
        }

        .tab-btn:hover {
            color: #fff;
        }

        .tab-btn.active {
            color: #fff;
        }

        .tab-btn.active::after {
            width: 70%;
        }

        .works-categories {
            display: flex;
            flex-direction: column;
            gap: 0; /* Remove gap as only one category shown at a time */
            margin-bottom: 0.5rem; /* Further reduced bottom margin */
            position: relative;
            /* min-height: 450px; /* Removed fixed min-height */
        }

        .category {
            margin-bottom: 0; /* Removed margin-bottom */
            position: absolute; /* Position categories absolutely for transitions */
            top: 0;
            left: 0;
            width: 100%;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.5s ease, visibility 0.5s ease;
            z-index: 1;
        }

        .category.active {
            opacity: 1;
            visibility: visible;
            position: relative; /* Make active category part of the flow */
            z-index: 2;
        }

        .category-header {
            margin-bottom: 1.5rem;
        }

        .category-title {
            font-size: 2.2rem;
            color: #fff;
            margin-bottom: 0.5rem;
            position: relative;
            display: inline-block;
        }

        .category-title::after {
            content: '';
            position: absolute;
            bottom: -8px;
            left: 0;
            width: 60px;
            height: 3px;
            background: linear-gradient(90deg, var(--primary-color), var(--secondary-color));
            border-radius: 3px;
        }

        .category-desc {
            color: rgba(255, 255, 255, 0.7);
            font-size: 1.1rem;
            max-width: 800px;
        }

        /* 作品滑块样式 (Now a draggable container) */
        .works-slider {
            position: relative;
            overflow: visible; /* Allow vertical overflow */
            padding: 0.5rem 0; /* Keep minimal vertical padding */
            /* Removed horizontal padding */
        }

        .slider-wrapper { /* Container for absolutely positioned items */
             /* display: flex; Removed */
            /* align-items: flex-start; Removed */
            /* flex-wrap: wrap; Removed */
            position: relative; /* Needed for absolute children */
            min-height: 2500px; /* Significantly increased height */
            padding: 0.5rem 0;
        }


        /* 作品项目样式 */
        .work-item {
            /* Removed column width/min-width */
            background-color: rgba(35, 35, 35, 0.7);
            border-radius: 16px;
            overflow: hidden; /* Hide overflow during resize */
            position: absolute; /* Needed for drag positioning */
            /* Start items offset slightly to prevent overlap before layout loads */
            top: 10px;
            left: 10px;
            transition: transform 0.1s ease-out, /* Faster transition for drag */
                        all 0.4s cubic-bezier(0.16, 1, 0.3, 1); /* Keep existing transition */
            border: 1px solid rgba(255, 255, 255, 0.08);
            /* Removed column layout properties */
            /* flex-shrink: 0; Removed */
            /* width: 300px; /* Removed default width - JS will handle */
            touch-action: none; /* Improve mobile dragging */
            cursor: grab; /* Indicate draggable */
        }
        .work-item:active {
            cursor: grabbing;
        }


        .work-item:hover {
            transform: translateY(-12px) scale(1.03); /* More lift */
            /* Remove the glow part (0 0 30px ...), keep the standard shadow */
            box-shadow: 0 25px 50px rgba(0, 0, 0, 0.4);
            border-color: rgba(255, 62, 127, 0.8); /* Brighter border */
            /* Ensure transform from hover doesn't break drag transform */
            /* Drag logic updates transform directly, so this should be okay */
            z-index: 15; /* Ensure hovered item is definitely on top */
        }

        .work-item.selected {
            outline: 3px solid var(--primary-color);
            outline-offset: 2px;
            box-shadow: 0 0 25px rgba(255, 62, 127, 0.5); /* Add glow when selected */
        }

        .work-image {
            height: 100%; /* Make image container fill parent */
            width: 100%;
            overflow: hidden;
            position: relative;
            background: linear-gradient(45deg, rgba(30, 30, 30, 0.4), rgba(45, 45, 45, 0.6));
            display: flex; /* Keep flex for centering icon */
            align-items: center;
            justify-content: center;
            border-radius: 16px 16px 0 0; /* Only top corners rounded */
        }

        /* Image inside the container */
        .work-image img,
        .work-image i /* Apply zoom effect to icon too if used as placeholder */
        {
            width: 100%;
            height: auto; /* Let height be determined by aspect ratio */
            object-fit: cover;
            transition: transform 0.5s cubic-bezier(0.16, 1, 0.3, 1); /* Smooth zoom transition */
            display: block; /* Remove extra space below image */
        }

        .work-item:hover .work-image img,
        .work-item:hover .work-image i
        {
            transform: scale(1.12); /* More pronounced zoom effect */
        }

        /* Placeholder Icon Styling */
        .work-image i {
            font-size: 3.5rem; /* Larger icon */
            color: rgba(255, 255, 255, 0.1); /* Even more subtle icon */
            transition: color 0.3s ease, transform 0.5s cubic-bezier(0.16, 1, 0.3, 1);
            height: 150px; /* Give icon a placeholder height */
            width: 100%; /* Make icon container take width */
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .work-item:hover .work-image i {
             color: rgba(255, 255, 255, 0.25);
        }

        .work-info {
            position: absolute; /* Take out of flow */
            bottom: 0;
            left: 0;
            width: 100%; /* Span the full width */
            padding: 0.8rem 1rem; /* Adjust padding slightly */
            background: linear-gradient(to top, rgba(18, 18, 18, 0.9) 0%, rgba(18, 18, 18, 0) 100%); /* Gradient background for readability */
            box-sizing: border-box;
            z-index: 2; /* Ensure info is above image */
            border-radius: 0 0 16px 16px; /* Keep bottom rounded corners */
            /* Font sizes are fixed, so content size won't change */
        }

        .work-title {
            font-size: 1.2rem;
            font-weight: 600;
            margin-bottom: 0.5rem;
            color: #fff;
        }

        .work-tag {
            display: inline-block;
            font-size: 0.8rem;
            padding: 0.2rem 0.8rem;
            background: rgba(255, 62, 127, 0.1);
            border-radius: 20px;
            color: rgba(255, 255, 255, 0.9);
            margin-right: 0.5rem;
            margin-bottom: 0.5rem;
        }

        /* 响应式布局 */
        @media (max-width: 1024px) {
            /* Adjustments for drag layout might be needed */
            .work-item {
                width: 250px; /* Slightly smaller width on tablets */
            }
            .slider-wrapper {
                min-height: 500px; /* Adjust min-height */
            }
            /* Keep rest of 1024px styles for tabs etc. */
            .category-tabs {
                gap: 0.8rem;
                justify-content: flex-start;
                overflow-x: auto;
                padding-bottom: 0.8rem;
                margin-bottom: 2rem;
                flex-wrap: nowrap;
                -webkit-overflow-scrolling: touch;
            }
            .tab-btn {
                font-size: 1rem;
                padding: 0.6rem 1rem;
                white-space: nowrap;
            }
        }

        @media (max-width: 768px) {
             /* No major changes needed here now, drag works within parent */
            .slider-wrapper {
                 min-height: 3000px; /* Increase height */
            }
            .work-item {
                 width: clamp(220px, 80%, 300px); /* Responsive width */
            }
            .works-content {
                padding-left: 20px; /* Reduce padding */
                padding-right: 20px;
            }
            /* Keep rest of 768px styles for tabs etc. */
            .category-tabs {
                gap: 0.8rem;
                justify-content: flex-start;
                overflow-x: auto;
                padding-bottom: 0.8rem;
                margin-bottom: 2rem;
                flex-wrap: nowrap;
                -webkit-overflow-scrolling: touch;
            }
            .tab-btn {
                font-size: 1rem;
                padding: 0.6rem 1rem;
                white-space: nowrap;
            }
        }

        @media (max-width: 480px) {
            .works-content {
                padding-left: 15px; /* Further adjust padding */
                padding-right: 15px;
            }
            .works-title h1 {
                font-size: 2.5rem; /* Adjust title size */
            }
             .slider-wrapper {
                 min-height: 3500px; /* Increase height */
            }
             .work-item {
                 width: clamp(200px, 90%, 280px); /* Adjust width */
            }
            .layout-controls button { /* Stack buttons */
                display: block;
                width: 80%;
                margin: 0.5rem auto;
            }
        }

        /* 添加页面元素的动画效果 */
        /* Note: Animations might conflict with absolute positioning/transforms initially */
        /* Apply animation to parent or ensure initial state matches animation start */
        .works-content .works-title,
        .works-content .works-portfolio,
        .final-section {
            opacity: 0;
            transform: translateY(30px);
            transition: opacity 0.8s ease, transform 0.8s cubic-bezier(0.16, 1, 0.3, 1);
            will-change: opacity, transform;
            overflow: hidden; /* Keep overflow hidden */
            max-width: 100%;
            box-sizing: border-box;
            position: relative; /* Keep relative */
        }

        .works-content .works-title.show,
        .works-content .works-portfolio.show,
        .final-section.show {
            opacity: 1;
            transform: translateY(0);
        }

        /* 为不同元素设置不同的延迟 */
        .works-content .works-title {
            transition-delay: 0.2s;
        }

        .works-content .works-portfolio {
            transition-delay: 0.4s;
        }

        .final-section {
            transition-delay: 0.6s;
        }

        /* 为作品项目添加逐个显示的动画效果 */
        /* This animation might need adjustment as items are now absolute */
        /* Maybe animate opacity only, or apply animation class *after* positioning */
        .works-portfolio .work-item {
            opacity: 0;
            /* transform: translateY(30px); // Remove transform animation */
            transition: opacity 0.6s ease; /* Animate only opacity */
            will-change: opacity;
            /* overflow: hidden; // Already on work-item */
            box-sizing: border-box;
            max-width: 100%;
        }

        .works-portfolio.show .work-item {
            opacity: 1;
            /* transform: translateY(0); // Remove transform animation */
        }

        /* Stagger delay still applies */
        .works-portfolio.show .work-item:nth-child(1) {
            transition-delay: 0.1s;
        }

        .works-portfolio.show .work-item:nth-child(2) {
            transition-delay: 0.2s;
        }

        .works-portfolio.show .work-item:nth-child(3) {
            transition-delay: 0.3s;
        }

        .works-portfolio.show .work-item:nth-child(4) {
            transition-delay: 0.4s;
        }

        /* Keep specific aspect ratio classes for image */
        .work-item.aspect-2-1 .work-image {
            aspect-ratio: 2 / 1;
            height: auto;
        }
        .work-item.aspect-1-075 .work-image {
            aspect-ratio: 1 / 0.75;
            height: auto;
        }
        .work-item.aspect-05-1 .work-image {
            aspect-ratio: 0.5 / 1;
            height: auto;
        }

        /* Ensure image/icon fills the specific aspect ratio container */
        .work-item.aspect-2-1 .work-image img,
        .work-item.aspect-2-1 .work-image i,
        .work-item.aspect-1-075 .work-image img,
        .work-item.aspect-1-075 .work-image i,
        .work-item.aspect-05-1 .work-image img,
        .work-item.aspect-05-1 .work-image i {
           height: 100%;
           width: 100%;
           object-fit: cover;
        }

        .layout-controls {
            text-align: center;
            margin: 1.5rem 0 2rem 0;
            position: relative; /* Ensure buttons are easily clickable */
            z-index: 10;
        }

        .layout-controls button {
            background-color: rgba(255, 62, 127, 0.15);
            border: 1px solid rgba(255, 62, 127, 0.5);
            color: #fff;
            padding: 0.6rem 1.2rem;
            margin: 0 0.5rem;
            border-radius: 6px;
            cursor: pointer;
            transition: background-color 0.3s ease;
            font-size: 0.9rem;
            font-weight: 500;
        }

        .layout-controls button:hover {
            background-color: rgba(255, 62, 127, 0.3);
        }
    </style>
</head>
<body>
    <!-- Cursor elements (hidden but needed for structure) -->
    <div class="cursor-container">
        <div id="cursor-dot" class="cursor-dot"></div>
        <div id="cursor-outline" class="cursor-outline"></div>
        <div id="cursor-trail" class="cursor-trail"></div>
    </div>
    
    <!-- Navigation Bar -->
    <div class="navbar-container">
        <nav class="navbar">
            <a href="index.html" class="logo">
                <img src="Z_s_icon.png" alt="Logo">
            </a>
            
            <div class="nav-links">
                <a href="index.html">Home</a>
                <a href="About ME.html">About Me</a>
                <a href="works.html" class="active">Works</a>
                <a href="Contact.html">Contact</a>
            </div>
        </nav>
    </div>
    
    <!-- Works Content Section -->
    <section class="works-content">
        <div class="works-title">
            <h1>MY WORLD OF MAKING</h1>
            <!-- Subtitle paragraph removed -->
        </div>
            
        <!-- Category Tab Navigation -->
        <div class="category-tabs">
            <button class="tab-btn active" data-category="interactive">Interactive Systems</button>
            <button class="tab-btn" data-category="media">Media & Motion Design</button>
            <button class="tab-btn" data-category="physical">Physical Computing & Prototyping</button>
            <button class="tab-btn" data-category="visual">Visual & Fine Art</button>
        </div>

        <!-- Layout Control Buttons -->
        <div class="layout-controls">
            <button id="save-layout-btn">Save Current Layout</button>
            <button id="reset-layout-btn">Reset Current Layout</button>
        </div>

        <!-- 作品类别和作品展示 -->
        <div class="works-portfolio">
            <div class="works-categories">
                <!-- 交互系统类别 -->
                <div class="category active" id="interactive">
                    <div class="works-slider">
                        <div class="slider-wrapper">
                            <!-- 作品项目1 -->
                            <div class="work-item" data-id="interactive-1" data-x="10" data-y="10" data-width="300" data-height="300">
                                <div class="work-image">
                                    <i class="fas fa-laptop-code"></i>
                                </div>
                                <div class="work-info">
                                    <div>
                                        <h3 class="work-title">Project Title 1</h3>
                                    </div>
                                    <div>
                                        <span class="work-tag">Web</span>
                                        <span class="work-tag">Interactive</span>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- 作品项目2 -->
                            <div class="work-item" data-id="interactive-2" data-x="350" data-y="10" data-width="300" data-height="300">
                                <div class="work-image">
                                    <i class="fas fa-laptop-code"></i>
                                </div>
                                <div class="work-info">
                                    <div>
                                        <h3 class="work-title">Project Title 2</h3>
                                    </div>
                                    <div>
                                        <span class="work-tag">UX/UI</span>
                                        <span class="work-tag">App</span>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- 作品项目3 -->
                            <div class="work-item" data-id="interactive-3" data-x="10" data-y="350" data-width="300" data-height="300">
                                <div class="work-image">
                                    <i class="fas fa-laptop-code"></i>
                                </div>
                                <div class="work-info">
                                    <div>
                                        <h3 class="work-title">Project Title 3</h3>
                                    </div>
                                    <div>
                                        <span class="work-tag">Frontend</span>
                                        <span class="work-tag">JavaScript</span>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- 作品项目4 -->
                            <div class="work-item" data-id="interactive-4" data-x="350" data-y="350" data-width="300" data-height="300">
                                <div class="work-image">
                                    <i class="fas fa-laptop-code"></i>
                                </div>
                                <div class="work-info">
                                    <div>
                                        <h3 class="work-title">Project Title 4</h3>
                                    </div>
                                    <div>
                                        <span class="work-tag">Mobile</span>
                                        <span class="work-tag">React</span>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- 作品项目5 -->
                            <div class="work-item" data-id="interactive-5" data-x="690" data-y="10" data-width="300" data-height="300">
                                <div class="work-image">
                                    <i class="fas fa-laptop-code"></i>
                                </div>
                                <div class="work-info">
                                    <div>
                                        <h3 class="work-title">Project Title 5</h3>
                                    </div>
                                    <div>
                                        <span class="work-tag">Game</span>
                                        <span class="work-tag">Unity</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- 媒体与动效设计类别 -->
                <div class="category" id="media">
                    <div class="works-slider">
                        <div class="slider-wrapper">
                            <!-- 作品项目1 -->
                            <div class="work-item" data-id="media-1" data-x="10" data-y="10" data-width="300" data-height="300">
                                <div class="work-image">
                                    <i class="fas fa-film"></i>
                                </div>
                                <div class="work-info">
                                    <div>
                                        <h3 class="work-title">Media Project 1</h3>
                                    </div>
                                    <div>
                                        <span class="work-tag">Motion</span>
                                        <span class="work-tag">After Effects</span>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- 作品项目2 -->
                            <div class="work-item" data-id="media-2" data-x="350" data-y="10" data-width="300" data-height="300">
                                <div class="work-image">
                                    <i class="fas fa-film"></i>
                                </div>
                                <div class="work-info">
                                    <div>
                                        <h3 class="work-title">Media Project 2</h3>
                                    </div>
                                    <div>
                                        <span class="work-tag">Video</span>
                                        <span class="work-tag">Premiere</span>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- 作品项目3 -->
                            <div class="work-item" data-id="media-3" data-x="10" data-y="350" data-width="300" data-height="300">
                                <div class="work-image">
                                    <i class="fas fa-film"></i>
                                </div>
                                <div class="work-info">
                                    <div>
                                        <h3 class="work-title">Media Project 3</h3>
                                    </div>
                                    <div>
                                        <span class="work-tag">Animation</span>
                                        <span class="work-tag">Character</span>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- 作品项目4 -->
                            <div class="work-item" data-id="media-4" data-x="350" data-y="350" data-width="300" data-height="300">
                                <div class="work-image">
                                    <i class="fas fa-film"></i>
                                </div>
                                <div class="work-info">
                                    <div>
                                        <h3 class="work-title">Media Project 4</h3>
                                    </div>
                                    <div>
                                        <span class="work-tag">3D</span>
                                        <span class="work-tag">Cinema 4D</span>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- 作品项目5 -->
                            <div class="work-item" data-id="media-5" data-x="690" data-y="10" data-width="300" data-height="300">
                                <div class="work-image">
                                    <i class="fas fa-film"></i>
                                </div>
                                <div class="work-info">
                                    <div>
                                        <h3 class="work-title">Media Project 5</h3>
                                    </div>
                                    <div>
                                        <span class="work-tag">Visual FX</span>
                                        <span class="work-tag">Compositing</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- 物理计算与原型制作类别 -->
                <div class="category" id="physical">
                    <div class="works-slider">
                        <div class="slider-wrapper">
                            <!-- 作品项目1 -->
                            <div class="work-item" data-id="physical-1" data-x="10" data-y="10" data-width="300" data-height="300">
                                <div class="work-image">
                                    <i class="fas fa-microchip"></i>
                                </div>
                                <div class="work-info">
                                    <div>
                                        <h3 class="work-title">Physical Project 1</h3>
                                    </div>
                                    <div>
                                        <span class="work-tag">Arduino</span>
                                        <span class="work-tag">Sensors</span>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- 作品项目2 -->
                            <div class="work-item" data-id="physical-2" data-x="350" data-y="10" data-width="300" data-height="300">
                                <div class="work-image">
                                    <i class="fas fa-microchip"></i>
                                </div>
                                <div class="work-info">
                                    <div>
                                        <h3 class="work-title">Physical Project 2</h3>
                                    </div>
                                    <div>
                                        <span class="work-tag">Wearable</span>
                                        <span class="work-tag">IoT</span>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- 作品项目3 -->
                            <div class="work-item" data-id="physical-3" data-x="10" data-y="350" data-width="300" data-height="300">
                                <div class="work-image">
                                    <i class="fas fa-microchip"></i>
                                </div>
                                <div class="work-info">
                                    <div>
                                        <h3 class="work-title">Physical Project 3</h3>
                                    </div>
                                    <div>
                                        <span class="work-tag">Robotics</span>
                                        <span class="work-tag">Mechatronics</span>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- 作品项目4 -->
                            <div class="work-item" data-id="physical-4" data-x="350" data-y="350" data-width="300" data-height="300">
                                <div class="work-image">
                                    <i class="fas fa-microchip"></i>
                                </div>
                                <div class="work-info">
                                    <div>
                                        <h3 class="work-title">Physical Project 4</h3>
                                    </div>
                                    <div>
                                        <span class="work-tag">Interactive</span>
                                        <span class="work-tag">Installation</span>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- 作品项目5 -->
                            <div class="work-item" data-id="physical-5" data-x="690" data-y="10" data-width="300" data-height="300">
                                <div class="work-image">
                                    <i class="fas fa-microchip"></i>
                                </div>
                                <div class="work-info">
                                    <div>
                                        <h3 class="work-title">Physical Project 5</h3>
                                    </div>
                                    <div>
                                        <span class="work-tag">Rapid</span>
                                        <span class="work-tag">Prototype</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- 视觉与纯艺术类别 -->
                <div class="category" id="visual">
                    <div class="works-slider">
                        <div class="slider-wrapper">
                            <!-- 作品项目1 -->
                            <div class="work-item" data-id="visual-1" data-x="10" data-y="10" data-width="300" data-height="300">
                                <div class="work-image">
                                    <i class="fas fa-palette"></i>
                                </div>
                                <div class="work-info">
                                    <div>
                                        <h3 class="work-title">Visual Project 1</h3>
                                    </div>
                                    <div>
                                        <span class="work-tag">Digital</span>
                                        <span class="work-tag">Illustration</span>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- 作品项目2 -->
                            <div class="work-item" data-id="visual-2" data-x="350" data-y="10" data-width="300" data-height="300">
                                <div class="work-image">
                                    <i class="fas fa-palette"></i>
                                </div>
                                <div class="work-info">
                                    <div>
                                        <h3 class="work-title">Visual Project 2</h3>
                                    </div>
                                    <div>
                                        <span class="work-tag">Painting</span>
                                        <span class="work-tag">Acrylic</span>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- 作品项目3 -->
                            <div class="work-item" data-id="visual-3" data-x="10" data-y="350" data-width="300" data-height="300">
                                <div class="work-image">
                                    <i class="fas fa-palette"></i>
                                </div>
                                <div class="work-info">
                                    <div>
                                        <h3 class="work-title">Visual Project 3</h3>
                                    </div>
                                    <div>
                                        <span class="work-tag">Mixed</span>
                                        <span class="work-tag">Media</span>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- 作品项目4 -->
                            <div class="work-item" data-id="visual-4" data-x="350" data-y="350" data-width="300" data-height="300">
                                <div class="work-image">
                                    <i class="fas fa-palette"></i>
                                </div>
                                <div class="work-info">
                                    <div>
                                        <h3 class="work-title">Visual Project 4</h3>
                                    </div>
                                    <div>
                                        <span class="work-tag">Photography</span>
                                        <span class="work-tag">Portrait</span>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- 作品项目5 -->
                            <div class="work-item" data-id="visual-5" data-x="690" data-y="10" data-width="300" data-height="300">
                                <div class="work-image">
                                    <i class="fas fa-palette"></i>
                                </div>
                                <div class="work-info">
                                    <div>
                                        <h3 class="work-title">Visual Project 5</h3>
                                    </div>
                                    <div>
                                        <span class="work-tag">Generative</span>
                                        <span class="work-tag">AI Art</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>
    
    <!-- Final Section -->
    <section class="final-section">
        <div class="awesome-together">
            <h2>LET'S MAKE SOMETHING <span class="highlight">AWESOME</span> TOGETHER</h2>
            </div>
        <div class="contact-container">
            <div class="social-buttons">
                <a href="#" class="plain-text">Instagram</a>
                <a href="#" class="plain-text">LinkedIn</a>
                <a href="#" class="plain-text">YouTube</a>
                <a href="#" class="plain-text">TikTok</a>
                        </div>
            <div class="email-info">
                <p>zhengyuanzhao6@gmail.com</p>
            </div>
        </div>
    </section>
    
    <script>
        // Add scroll effect to navbar
        window.addEventListener('scroll', () => {
            const navbar = document.querySelector('.navbar');
            const navbarContainer = document.querySelector('.navbar-container');
            
            if (window.scrollY > 50) {
                navbar.style.padding = '1rem 3%';
                // Keep navbar transparent on scroll
                // navbarContainer.style.background = 'rgba(13, 12, 14, 0.7)'; 
                // navbarContainer.style.backdropFilter = 'blur(10px)'; 
                navbarContainer.style.paddingTop = '8px';
            } else {
                navbar.style.padding = '1.5rem 3%'; // Revert padding
                navbarContainer.style.paddingTop = '15px'; // Revert padding top
            }
        });
        
        // 设置当前页面的导航链接为激活状态
        function setActiveNavLink() {
            const currentPage = window.location.pathname.split('/').pop() || 'index.html';
            const navLinks = document.querySelectorAll('.nav-links a');

            navLinks.forEach(link => {
                const href = link.getAttribute('href');
                link.classList.remove('active'); // Remove active from all first

                // Simplified logic for active state
                if (href === currentPage || (currentPage === 'index.html' && href === '#')) {
                   link.classList.add('active');
                } else if (currentPage.includes("About") && href.includes("About")) {
                    link.classList.add('active');
                } else if (currentPage.includes("works") && href.includes("works")) {
                    link.classList.add('active');
                } else if (currentPage.includes("Contact") && href.includes("Contact")) {
                     link.classList.add('active');
                }

            });
        }

        // --- Draggable Layout Logic ---

        // Function to get the currently active category ID
        function getActiveCategoryId() {
            const activeTab = document.querySelector('.tab-btn.active');
            return activeTab ? activeTab.dataset.category : null;
        }

        // Function to apply layout from data
        function applyLayout(layoutData) {
            if (!layoutData) return;
            // Find items within the *currently visible* category
            const activeCategory = document.querySelector('.category.active');
            if (!activeCategory) return;

            Object.keys(layoutData).forEach(itemId => {
                // Ensure we only select items within the active category
                const item = activeCategory.querySelector(`.work-item[data-id="${itemId}"]`);
                const pos = layoutData[itemId];
                if (item && pos && typeof pos.x === 'number' && typeof pos.y === 'number') {
                    item.style.transform = `translate(${pos.x}px, ${pos.y}px)`;
                    item.setAttribute('data-x', pos.x);
                    item.setAttribute('data-y', pos.y);

                    // Apply size if present
                    if (typeof pos.width === 'number' && typeof pos.height === 'number') {
                        item.style.width = `${pos.width}px`;
                        item.style.height = `${pos.height}px`;
                        item.setAttribute('data-width', pos.width);
                        item.setAttribute('data-height', pos.height);
                    } else {
                         // Apply default size if missing from saved data (for backward compatibility)
                         applyDefaultItemSize(item);
                    }
                } else {
                     console.warn(`Could not apply layout for item ${itemId}: Item not found in active category or position invalid.`, item, pos);
                }
            });
        }

        // Helper function to apply default size from data attributes
        function applyDefaultItemSize(item) {
            let initialWidth = parseFloat(item.getAttribute('data-width'));
            let initialHeight = parseFloat(item.getAttribute('data-height'));

            // Fallback size if data attributes are missing/invalid
            initialWidth = !isNaN(initialWidth) && initialWidth > 50 ? initialWidth : 300;
            initialHeight = !isNaN(initialHeight) && initialHeight > 50 ? initialHeight : 300;

            item.style.width = `${initialWidth}px`;
            item.style.height = `${initialHeight}px`;
            item.setAttribute('data-width', initialWidth);
            item.setAttribute('data-height', initialHeight);
        }

        // Function to load layout from Local Storage for a category
        function loadLayout(categoryId) {
            if (!categoryId) return;
             console.log(`Loading layout for ${categoryId}`);
            const savedLayout = localStorage.getItem(`worksLayout_${categoryId}`);
            const categoryElement = document.getElementById(categoryId); // Get the specific category container

            if (!categoryElement) {
                console.error(`Category element not found for ID: ${categoryId}`);
                return;
            }
            
            const sliderWrapper = categoryElement.querySelector('.slider-wrapper');
            if (!sliderWrapper) {
                console.error(`Slider wrapper not found in category: ${categoryId}`);
                return;
            }
            
            // 清除现有项目，以防止重复
            const existingItems = categoryElement.querySelectorAll('.work-item');
            
            if (savedLayout) {
                try {
                    const layoutData = JSON.parse(savedLayout);
                    console.log(`Applying saved layout for ${categoryId}`);
                    
                    // 检查是否存在复制粘贴的项目
                    const copiedItems = {};
                    Object.keys(layoutData).forEach(itemId => {
                        // 检查ID是否包含"-copy-"，表示这是一个粘贴的项目
                        if (itemId.includes("-copy-")) {
                            copiedItems[itemId] = layoutData[itemId];
                        }
                    });
                    
                    // 先应用已有元素的布局
                    applyLayout(layoutData);
                    
                    // 然后创建复制的元素
                    Object.keys(copiedItems).forEach(itemId => {
                        // 检查元素是否已存在
                        const existingItem = categoryElement.querySelector(`.work-item[data-id="${itemId}"]`);
                        if (!existingItem) {
                            // 如果不存在，需要创建一个新的元素
                            // 找出原始项目ID（去掉-copy-后缀的部分）
                            const originalIdParts = itemId.split("-copy-")[0];
                            // 寻找任何一个可以用作模板的元素
                            const templateItems = document.querySelectorAll(`.work-item[data-id^="${originalIdParts}"]`);
                            let templateItem = null;
                            
                            if (templateItems.length > 0) {
                                templateItem = templateItems[0];
                            } else {
                                // 找不到原始模板，使用当前类别下的任何项目作为模板
                                const anyItem = categoryElement.querySelector('.work-item');
                                if (anyItem) {
                                    templateItem = anyItem;
                                }
                            }
                            
                            if (templateItem) {
                                // 创建新元素
                                const newItem = templateItem.cloneNode(true);
                                newItem.setAttribute('data-id', itemId);
                                
                                // 设置位置和尺寸
                                const pos = copiedItems[itemId];
                                if (pos) {
                                    newItem.setAttribute('data-x', pos.x);
                                    newItem.setAttribute('data-y', pos.y);
                                    newItem.setAttribute('data-width', pos.width);
                                    newItem.setAttribute('data-height', pos.height);
                                    newItem.style.transform = `translate(${pos.x}px, ${pos.y}px)`;
                                    newItem.style.width = `${pos.width}px`;
                                    newItem.style.height = `${pos.height}px`;
                                }
                                
                                // 添加到DOM
                                sliderWrapper.appendChild(newItem);
                                
                                // 重新初始化交互功能
                                interact(newItem).draggable(interact('.work-item').draggable().options);
                                interact(newItem).resizable(interact('.work-item').resizable().options);
                                
                                console.log(`Recreated copied item: ${itemId}`);
                            } else {
                                console.warn(`Could not find template item for ${itemId}`);
                            }
                        }
                    });
                    
                } catch (e) {
                    console.error('Error parsing saved layout:', e);
                    // Apply default positions if parsing fails
                    applyDefaultLayout(existingItems);
                }
            } else {
                 // Apply initial default positions if no layout saved
                 console.log(`No saved layout found for ${categoryId}. Applying default.`);
                applyDefaultLayout(existingItems);
            }
        }

        // Helper function to apply default layout based on data attributes
        function applyDefaultLayout(items) {
             items.forEach(item => {
                 // Use 10,10 as fallback if data attributes are missing/invalid
                let initialX = parseFloat(item.getAttribute('data-x'));
                let initialY = parseFloat(item.getAttribute('data-y'));

                 initialX = !isNaN(initialX) ? initialX : 10;
                 initialY = !isNaN(initialY) ? initialY : 10;

                // Apply default size as well
                applyDefaultItemSize(item);

                item.style.transform = `translate(${initialX}px, ${initialY}px)`;
                // Ensure data attributes are set to defaults as well
                item.setAttribute('data-x', initialX);
                item.setAttribute('data-y', initialY);
             });
        }


        // Function to save the current layout to Local Storage
        function saveLayout(categoryId) {
            if (!categoryId) return;
            console.log(`Saving layout for ${categoryId}`);
            const categoryElement = document.getElementById(categoryId);
            if (!categoryElement) {
                 console.error(`Cannot save layout: Category element ${categoryId} not found.`);
                return;
            }

            const items = categoryElement.querySelectorAll('.work-item');
            const layoutData = {};
            items.forEach(item => {
                const itemId = item.dataset.id;
                 // Read directly from data attributes, ensuring they are numbers
                let x = parseFloat(item.getAttribute('data-x'));
                let y = parseFloat(item.getAttribute('data-y'));

                 x = !isNaN(x) ? x : 0; // Default to 0 if invalid
                 y = !isNaN(y) ? y : 0; // Default to 0 if invalid

                // Get size as well
                let width = parseFloat(item.getAttribute('data-width'));
                let height = parseFloat(item.getAttribute('data-height'));
                width = !isNaN(width) ? width : 300; // Default size if invalid
                height = !isNaN(height) ? height : 300;

                if (itemId) {
                    layoutData[itemId] = { x, y, width, height }; // Save size too
                    // 对于复制的元素，我们需要确保保存它们的content信息
                    if (itemId.includes("-copy-")) {
                        // 保存标题和标签信息
                        const titleEl = item.querySelector('.work-title');
                        const tags = item.querySelectorAll('.work-tag');
                        const iconEl = item.querySelector('.work-image i');
                        
                        if (titleEl) {
                            layoutData[itemId].title = titleEl.textContent;
                        }
                        
                        if (tags.length > 0) {
                            layoutData[itemId].tags = Array.from(tags).map(tag => tag.textContent);
                        }
                        
                        if (iconEl) {
                            layoutData[itemId].iconClass = iconEl.className;
                        }
                    }
                } else {
                    console.warn('Work item missing data-id, cannot save position.', item);
                }
            });

            if (Object.keys(layoutData).length === 0) {
                 console.warn(`No items found or no items with data-id in category ${categoryId}. Nothing to save.`);
                 return;
            }


            try {
                localStorage.setItem(`worksLayout_${categoryId}`, JSON.stringify(layoutData));
                console.log(`Layout saved for ${categoryId}`, layoutData);
                alert(`Layout for ${categoryId.replace(/-/g, ' ').replace(/\b\w/g, l => l.toUpperCase())} saved!`); // User feedback with better formatting
            } catch (e) {
                console.error('Error saving layout to Local Storage:', e);
                alert('Error saving layout. Local Storage might be full or disabled.');
            }
        }

        // Function to reset layout (remove from Local Storage and apply defaults)
        function resetLayout(categoryId) {
            if (!categoryId) return;
            console.log(`Resetting layout for ${categoryId}`);
            localStorage.removeItem(`worksLayout_${categoryId}`);
             const categoryElement = document.getElementById(categoryId);
             if(categoryElement) {
                const items = categoryElement.querySelectorAll('.work-item');
                 applyDefaultLayout(items); // Use helper to apply defaults
                 alert(`Layout for ${categoryId.replace(/-/g, ' ').replace(/\b\w/g, l => l.toUpperCase())} reset.`); // User feedback
             } else {
                  console.error(`Cannot reset layout: Category element ${categoryId} not found.`);
             }
        }

        // Initialize Interact.js for draggable items
        interact('.work-item')
            .draggable({
                inertia: false,
                modifiers: [
                    interact.modifiers.restrictRect({
                        restriction: 'parent', // Keep within the .slider-wrapper
                        endOnly: false, // 改为false，以便在整个拖动过程中应用限制
                        elementRect: { top: 0, left: 0, bottom: 1, right: 1 } // 考虑元素自身的尺寸
                    })
                ],
                autoScroll: true, // Enable autoScroll
                 listeners: {
                    start (event) {
                      // Optional: Add class on drag start? e.g., event.target.classList.add('dragging');
                      event.target.style.zIndex = 10; // Bring to front while dragging
                    },
                    move (event) {
                        const target = event.target;
                        // Keep the dragged position in the data-x/data-y attributes
                        const x = (parseFloat(target.getAttribute('data-x')) || 0) + event.dx;
                        const y = (parseFloat(target.getAttribute('data-y')) || 0) + event.dy;

                        // Translate the element
                        target.style.transform = `translate(${x}px, ${y}px)`;

                        // Update the position attributes
                        target.setAttribute('data-x', x);
                        target.setAttribute('data-y', y);
                    },
                    end (event) {
                       // Optional: Remove class on drag end? e.g., event.target.classList.remove('dragging');
                       event.target.style.zIndex = ''; // Reset z-index
                       console.log(`Dragged ${event.target.dataset.id} to x:${event.target.getAttribute('data-x')}, y:${event.target.getAttribute('data-y')}`);
                    }
                }
            })
            .resizable({
                // Resize from all edges and corners
                edges: { left: true, right: true, bottom: true, top: true },

                listeners: {
                    move (event) {
                        let target = event.target;
                        let x = (parseFloat(target.getAttribute('data-x')) || 0);
                        let y = (parseFloat(target.getAttribute('data-y')) || 0);

                        // Update the element's style
                        target.style.width = `${event.rect.width}px`;
                        target.style.height = `${event.rect.height}px`;

                        // Translate when resizing from top or left edges
                        x += event.deltaRect.left;
                        y += event.deltaRect.top;

                        target.style.transform = `translate(${x}px, ${y}px)`;

                        // Update position and size attributes
                        target.setAttribute('data-x', x);
                        target.setAttribute('data-y', y);
                        target.setAttribute('data-width', Math.round(event.rect.width));
                        target.setAttribute('data-height', Math.round(event.rect.height));
                    }
                },
                modifiers: [
                    // Keep the edges inside the parent
                    interact.modifiers.restrictEdges({
                        outer: 'parent'
                    }),

                    // Minimum size
                    interact.modifiers.restrictSize({
                        min: { width: 100, height: 100 }
                    })
                ],

                inertia: false
            });

        // --- End Draggable Logic ---


        // 页面加载时执行
        document.addEventListener('DOMContentLoaded', function() {
            // Strict scrollbar control
            document.documentElement.style.overflowX = 'hidden';
            document.body.style.overflowX = 'hidden';

            setActiveNavLink();

            // --- Animations ---
            // Initial fade-in animations
            // Consider if these conflict with absolute positioning; maybe fade in wrapper first?
            setTimeout(() => {
                const title = document.querySelector('.works-content .works-title');
                const portfolio = document.querySelector('.works-content .works-portfolio');
                 const finalSection = document.querySelector('.final-section');

                if(title) title.classList.add('show');

                setTimeout(() => {
                    if(portfolio) portfolio.classList.add('show'); // This triggers the item animation

                     setTimeout(() => {
                        if(finalSection) finalSection.classList.add('show');
                    }, 200); // Delay final section slightly more

                }, 200); // Delay portfolio after title

            }, 100); // Initial delay

            // --- Category Tab & Layout Loading Logic ---
            const worksPortfolio = document.querySelector('.works-portfolio'); // Get main container
            const tabs = document.querySelectorAll('.tab-btn');
            const categories = document.querySelectorAll('.category');
            const saveBtn = document.getElementById('save-layout-btn');
            const resetBtn = document.getElementById('reset-layout-btn');

            tabs.forEach(tab => {
                tab.addEventListener('click', () => {
                    const targetCategory = tab.dataset.category;
                     const currentActiveCategory = document.querySelector('.category.active');

                     // Don't reload if clicking the already active tab
                     if (currentActiveCategory && currentActiveCategory.id === targetCategory) {
                         return;
                     }

                    // Update tab active state
                    tabs.forEach(t => t.classList.remove('active'));
                    tab.classList.add('active');

                    // Update category visibility
                    categories.forEach(category => {
                        if (category.id === targetCategory) {
                            category.classList.add('active');
                             // Load layout *after* making the category visible
                             loadLayout(targetCategory);
                        } else {
                            category.classList.remove('active');
                        }
                    });
                });
            });

            // --- Layout Button Listeners ---
            if (saveBtn) {
                saveBtn.addEventListener('click', () => {
                    const activeCategory = getActiveCategoryId();
                    saveLayout(activeCategory);
                });
            } else {
                 console.error("Save layout button not found");
            }

            if (resetBtn) {
                resetBtn.addEventListener('click', () => {
                    const activeCategory = getActiveCategoryId();
                    resetLayout(activeCategory);
                });
            } else {
                 console.error("Reset layout button not found");
            }


            // --- Event Listener for Selection ---
            // Use event delegation on the container
            if (worksPortfolio) {
                worksPortfolio.addEventListener('click', (event) => {
                    const clickedItem = event.target.closest('.work-item');
                    if (clickedItem) {
                         // Prevent interfering with drag start (optional, check if needed)
                         // event.stopPropagation();
                         selectItem(clickedItem);
                    } else {
                        // Clicked outside a work item within the portfolio area
                         if (!event.target.closest('.layout-controls')) { // Don't deselect if clicking buttons
                            deselectItem();
                         }
                    }
                });
            }

            // --- Global Keydown Listener for Copy/Paste ---
            document.addEventListener('keydown', (event) => {
                // Check if focus is not in an input field (if any existed)
                // if (document.activeElement && /INPUT|TEXTAREA/i.test(document.activeElement.tagName)) {
                //     return;
                // }

                // --- Copy (Ctrl+C) ---
                if (event.ctrlKey && event.key === 'c') {
                    if (selectedItemId) {
                        copiedItemId = selectedItemId;
                        console.log("Copied item ID:", copiedItemId);
                        // Optional: visual feedback
                        const selectedItem = document.querySelector(`.work-item[data-id="${selectedItemId}"]`);
                        if(selectedItem) {
                           // Simple flash effect
                            selectedItem.style.transition = 'outline-color 0.1s ease-in-out';
                            selectedItem.style.outlineColor = '#fff';
                            setTimeout(() => {
                                if (selectedItem.classList.contains('selected')) {
                                    selectedItem.style.outlineColor = 'var(--primary-color)';
                                } else {
                                     selectedItem.style.outlineColor = ''; // Or transparent
                                }
                            }, 150);
                        }
                        event.preventDefault(); // Prevent default browser copy action
                    }
                }

                // --- Paste (Ctrl+V) ---
                if (event.ctrlKey && event.key === 'v') {
                     if (copiedItemId) {
                        console.log("Pasting item ID:", copiedItemId);
                        const originalItem = document.querySelector(`.work-item[data-id="${copiedItemId}"]`);
                        const activeCategory = document.querySelector('.category.active .slider-wrapper');

                        if (originalItem && activeCategory) {
                            event.preventDefault(); // Prevent default browser paste action

                            const newItem = originalItem.cloneNode(true);

                            // Generate new ID
                            const newId = `${copiedItemId}-copy-${Date.now()}`;
                            newItem.dataset.id = newId;

                            // Calculate new position (offset slightly)
                            let newX = (parseFloat(originalItem.getAttribute('data-x')) || 0) + 20;
                            let newY = (parseFloat(originalItem.getAttribute('data-y')) || 0) + 20;
                            const originalWidth = parseFloat(originalItem.getAttribute('data-width')) || 300;
                            const originalHeight = parseFloat(originalItem.getAttribute('data-height')) || 300;

                            // Set attributes and initial style for the new item
                            newItem.setAttribute('data-x', newX);
                            newItem.setAttribute('data-y', newY);
                            newItem.setAttribute('data-width', originalWidth); // Keep original size
                            newItem.setAttribute('data-height', originalHeight);
                            newItem.style.transform = `translate(${newX}px, ${newY}px)`;
                            newItem.style.width = `${originalWidth}px`;
                            newItem.style.height = `${originalHeight}px`;
                            newItem.classList.remove('selected'); // Pasted item shouldn't start selected

                            // Append to active category
                            activeCategory.appendChild(newItem);

                            // IMPORTANT: Make the new item interactive
                            // Re-initialize interact for the new element specifically
                            interact(newItem).draggable(interact('.work-item').draggable().options);
                            interact(newItem).resizable(interact('.work-item').resizable().options);

                             console.log("Pasted new item with ID:", newId);

                             // Optionally select the newly pasted item
                             // selectItem(newItem);

                        } else {
                            console.warn("Cannot paste: Original item or active category not found.");
                        }
                    } else {
                         console.log("Nothing to paste.");
                    }
                }

                // --- Delete (Backspace) ---
                if (event.key === 'Backspace') {
                    if (selectedItemId) {
                        console.log("Deleting item ID:", selectedItemId);
                        const itemToDelete = document.querySelector(`.work-item[data-id="${selectedItemId}"]`);
                        if (itemToDelete) {
                            event.preventDefault(); // Prevent browser back navigation
                            itemToDelete.remove();
                            console.log("Item removed.");
                            selectedItemId = null; // Clear selection
                            copiedItemId = (copiedItemId === selectedItemId) ? null : copiedItemId; // Clear copied if it was the deleted item
                        } else {
                            console.warn("Item to delete not found in DOM, clearing selection ID.");
                            selectedItemId = null;
                        }
                    } else {
                         console.log("Backspace pressed, but nothing selected.");
                    }
                }
            });

              // --- Initial Layout Load ---
             const initialActiveCategory = getActiveCategoryId(); // Find initially active tab
             if (initialActiveCategory) {
                 // Ensure the category is visible before loading layout
                 const initialCategoryElement = document.getElementById(initialActiveCategory);
                 if (initialCategoryElement && initialCategoryElement.classList.contains('active')) {
                      loadLayout(initialActiveCategory);
                 } else {
                      console.warn("Initial active category element not found or not active.");
                 }
            } else {
                 console.warn("No initial active category tab found.");
            }


        }); // End DOMContentLoaded


        // Function to scroll to top (Keep this if used elsewhere or needed)
        function scrollToTop() {
            gsap.to(window, {
                duration: 1.5,
                scrollTo: 0,
                ease: "power2.inOut"
            });
        }

        // Modified scroll to top for Works link
        const worksLink = document.querySelector('.nav-links a[href="works.html"]');
        if (worksLink) {
            worksLink.addEventListener('click', (e) => {
                 if (window.location.pathname.includes('works.html')) {
                    e.preventDefault();
                    scrollToTop();
                }
            });
        }

        // --- Copy/Paste/Selection Logic ---
        let selectedItemId = null;
        let copiedItemId = null;
        // let mousePosOverCanvas = { x: 0, y: 0 }; // For paste-at-cursor later

        function selectItem(itemElement) {
            if (!itemElement) return;

            // Deselect previous if any
            if (selectedItemId) {
                const previousSelectedItem = document.querySelector(`.work-item[data-id="${selectedItemId}"]`);
                if (previousSelectedItem) {
                    previousSelectedItem.classList.remove('selected');
                }
            }

            // Select new item
            itemElement.classList.add('selected');
            selectedItemId = itemElement.dataset.id;
            console.log("Selected:", selectedItemId);
        }

        function deselectItem() {
            if (selectedItemId) {
                const selectedItem = document.querySelector(`.work-item[data-id="${selectedItemId}"]`);
                if (selectedItem) {
                    selectedItem.classList.remove('selected');
                }
                selectedItemId = null;
                console.log("Deselected");
            }
        }

        // --- End Copy/Paste/Selection Logic ---

    </script>
</body>
</html>
